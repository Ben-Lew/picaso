

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Setup PICASO &mdash; picaso 2.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../../../_static/jquery.js"></script>
        <script type="text/javascript" src="../../../_static/underscore.js"></script>
        <script type="text/javascript" src="../../../_static/doctools.js"></script>
        <script type="text/javascript" src="../../../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Intuition Building: Young Planet Spectroscopy" href="../SaganSchool2021/1_Spectroscopy.html" />
    <link rel="prev" title="ESO ATMO 2021 Tutorial: Chemistry and Clouds in Exoplanet Transit Spectroscopy" href="../ESO2021/ESO_Tutorial.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> picaso
          

          
          </a>

          
            
            
              <div class="version">
                2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../../../installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../tutorials.html">The Tutorials</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../picaso.html">The Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../contribution.html">Contributing</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../../../workshops.html">Workshop Material</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../../../workshops.html#eso-atmo-2021">ESO ATMO 2021</a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../../../workshops.html#early-release-workshop-2021">Early Release Workshop 2021</a><ul class="current">
<li class="toctree-l3 current"><a class="current reference internal" href="#">Setup <code class="docutils literal notranslate"><span class="pre">PICASO</span></code></a></li>
<li class="toctree-l3"><a class="reference internal" href="#Basic-Inputs">Basic Inputs</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Cross-Section-Connection">Cross Section Connection</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Set-Basic-Planet-and-Stellar-Inputs">Set Basic Planet and Stellar Inputs</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Toy-Models">Toy Models</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#How-does-climate-structure-influence-resultant-thermal-flux?">How does climate structure influence resultant thermal flux?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#How-does-absorption-influence-resultant-thermal-flux?">How does absorption influence resultant thermal flux?</a></li>
<li class="toctree-l4"><a class="reference internal" href="#How-to-determine-what-pressures-you-are-sensitive-to?">How to determine what pressures you are sensitive to?</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#Parameterized-Pressure-Temperature-Profiles">Parameterized Pressure-Temperature Profiles</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Combing-parameterized-climate-with-chemistry">Combing parameterized climate with chemistry</a></li>
<li class="toctree-l3"><a class="reference internal" href="#Combing-parameterized-climate-with-chemistry-AND-clouds">Combing parameterized climate with chemistry AND clouds</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Adding-a-box-model-cloud">Adding a box model cloud</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#References">References</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../../../workshops.html#sagan-school-2021-spectroscopy-of-young-planets">Sagan School 2021: Spectroscopy of Young Planets</a></li>
<li class="toctree-l2"><a class="reference internal" href="../../../workshops.html#sagan-school-2020-writing-a-jwst-proposal">Sagan School 2020: Writing a JWST Proposal</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://natashabatalha.github.io/picaso_dev">The Derivations</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/natashabatalha/picaso">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://arxiv.org/abs/1904.09355">The Paper</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">picaso</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../../../workshops.html">Tutorials</a> &raquo;</li>
        
      <li>Setup <code class="docutils literal notranslate"><span class="pre">PICASO</span></code></li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/notebooks/workshops/ERS2021/ThermalEmissionTutorial.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="https://github.com/natashabatalha/picaso/tree/master/docs/notebooks/workshops/ERS2021/ThermalEmissionTutorial.ipynb">Download full notebook here</a></p>
</div>
<div class="section" id="Setup-PICASO">
<h1>Setup <code class="docutils literal notranslate"><span class="pre">PICASO</span></code><a class="headerlink" href="#Setup-PICASO" title="Permalink to this headline">¶</a></h1>
<p>In this tutorial you will learn:</p>
<ol class="arabic simple">
<li><p>What is a thermal emission spectrum</p></li>
<li><p>How various atmospheric factors (temperature, abundances, clouds) influence an emission spectrum</p></li>
<li><p>Given a spectrum, how do we analyze it’s components</p></li>
</ol>
<p>What you should have already done:</p>
<ol class="arabic simple">
<li><p>Complete all <a class="reference external" href="https://natashabatalha.github.io/picaso/installation.html">Installation instructions</a></p>
<ul class="simple">
<li><p>This involves downloading two files, one of which is large (6 Gig). So plan accordingly!</p></li>
</ul>
</li>
</ol>
<p><strong>Questions?</strong> <a class="reference external" href="https://github.com/natashabatalha/picaso/issues">Submit an Issue to PICASO Github</a> with any issues you are experiencing. Don’t be shy! Others are likely experiencing similar problems</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>

</pre></div>
</div>
</div>
<p>Here are the two main PICASO functions you will be exploring:</p>
<p><code class="docutils literal notranslate"><span class="pre">justdoit</span></code> contains all the spectroscopic modeling functionality you will need in these exercises.</p>
<p><code class="docutils literal notranslate"><span class="pre">justplotit</span></code> contains all the of the plotting functionality you will need in these exercises.</p>
<p>Tips if you are not familiar with Python or <code class="docutils literal notranslate"><span class="pre">jupyter</span> <span class="pre">notebooks</span></code>:</p>
<ul class="simple">
<li><p>Run a cell by clicking shift-enter. You can always go back and edit cells. But, make sure to rerun them if you edit it. You can check the order in which you have run your cells by looking at the bracket numbers (e.g. [1]) next to each cell.</p></li>
<li><p>In any cell you can write <code class="docutils literal notranslate"><span class="pre">help(INSERT_FUNCTION)</span></code> and it will give you documentation on the input/output</p></li>
<li><p>If you type <code class="docutils literal notranslate"><span class="pre">jdi.</span></code> followed by “tab” a box will pop up with all the available functions in <code class="docutils literal notranslate"><span class="pre">jdi</span></code>. This applies to any python function (e.g. <code class="docutils literal notranslate"><span class="pre">numpy</span></code>, <code class="docutils literal notranslate"><span class="pre">pandas</span></code>)</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">picaso.justdoit</span> <span class="k">as</span> <span class="nn">jdi</span>
<span class="kn">import</span> <span class="nn">picaso.justplotit</span> <span class="k">as</span> <span class="nn">jpi</span>
<span class="kn">import</span> <span class="nn">picaso.opacity_factory</span> <span class="k">as</span> <span class="nn">op</span>
<span class="n">jpi</span><span class="o">.</span><span class="n">output_notebook</span><span class="p">()</span> <span class="c1">#will force all our plots to appear in the notebook</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div class="bk-root">
    <a href="https://bokeh.org" target="_blank" class="bk-logo bk-logo-small bk-logo-notebook"></a>
    <span id="1001">Loading BokehJS ...</span>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="output_javascript"></div>
<script type="text/javascript">
var element = document.currentScript.previousSibling.previousSibling;

(function(root) {
  function now() {
    return new Date();
  }

  var force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

  var JS_MIME_TYPE = 'application/javascript';
  var HTML_MIME_TYPE = 'text/html';
  var EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  var CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    var script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    var cell = handle.cell;

    var id = cell.output_area._bokeh_element_id;
    var server_id = cell.output_area._bokeh_server_id;
    // Clean up Bokeh references
    if (id != null && id in Bokeh.index) {
      Bokeh.index[id].model.document.clear();
      delete Bokeh.index[id];
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      var cmd = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd, {
        iopub: {
          output: function(msg) {
            var id = msg.content.text.trim();
            if (id in Bokeh.index) {
              Bokeh.index[id].model.document.clear();
              delete Bokeh.index[id];
            }
          }
        }
      });
      // Destroy server and session
      var cmd = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    var output_area = handle.output_area;
    var output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
      return
    }

    var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      var bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      var script_attrs = bk_div.children[0].attributes;
      for (var i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
        toinsert[toinsert.length - 1].firstChild.textContent = bk_div.children[0].textContent
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      var toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }


  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  var NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded() {
    var el = document.getElementById("1001");
    if (el != null) {
      el.textContent = "BokehJS is loading...";
    }
    if (root.Bokeh !== undefined) {
      if (el != null) {
        el.textContent = "BokehJS " + root.Bokeh.version + " successfully loaded.";
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(display_loaded, 100)
    }
  }


  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error() {
      console.error("failed to load " + url);
    }

    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    const hashes = {"https://cdn.bokeh.org/bokeh/release/bokeh-2.0.1.min.js": "JpP8FXbgAZLkfur7LiK3j9AGBhHNIvF742meBJrjO2ShJDhCG2I1uVvW+0DUtrmc", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.0.1.min.js": "xZlADit0Q04ISQEdKg2k3L4W9AwQBAuDs9nJL9fM/WwzL1tEU9VPNezOFX0nLEAz", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.0.1.min.js": "4BuPRZkdMKSnj3zoxiNrQ86XgNw0rYmBOxe7nshquXwwcauupgBF2DHLVG1WuZlV", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-2.0.1.min.js": "Dv1SQ87hmDqK6S5OhBf0bCuwAEvL5QYL0PuR/F1SPVhCS/r/abjkbpKDYL2zeM19"};

    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      if (url in hashes) {
        element.crossOrigin = "anonymous";
        element.integrity = "sha384-" + hashes[url];
      }
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
  };var element = document.getElementById("1001");
  if (element == null) {
    console.error("Bokeh: ERROR: autoload.js configured with elementid '1001' but no matching script tag was found. ")
    return false;
  }

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }


  var js_urls = ["https://cdn.bokeh.org/bokeh/release/bokeh-2.0.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.0.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.0.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-2.0.1.min.js"];
  var css_urls = [];


  var inline_js = [
    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
    function(Bokeh) {


    }
  ];

  function run_inline_js() {

    if (root.Bokeh !== undefined || force === true) {

    for (var i = 0; i < inline_js.length; i++) {
      inline_js[i].call(root, root.Bokeh);
    }
    if (force === true) {
        display_loaded();
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      var cell = $(document.getElementById("1001")).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }

  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));
</script></div>
</div>
<p>If you get an error regarding environment variables you can directly add them in the notebook. <strong>You just need to make sure you run this line of code BEFORE the import the ``picaso`` functions.</strong></p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#os.environ[&#39;picaso_refdata&#39;]=&#39;your_path&#39;</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Basic-Inputs">
<h1>Basic Inputs<a class="headerlink" href="#Basic-Inputs" title="Permalink to this headline">¶</a></h1>
<div class="section" id="Cross-Section-Connection">
<h2>Cross Section Connection<a class="headerlink" href="#Cross-Section-Connection" title="Permalink to this headline">¶</a></h2>
<p>As you will continue seeing throughout the ERS training sessions, all rapid radiative transfer codes rely on a database of pre-computed cross sections. Cross sections are computed by using line lists in combination with critical molecular pressure broadening parameters. Both can either be derived from theoretical first principles (e.g. <a class="reference external" href="https://www.exomol.com/">UCL ExoMol’s line lists</a>), measured in a lab, and/or some combination thereof (e.g. <a class="reference external" href="https://hitran.org/">HITRAN/HITEMP line
lists</a>).</p>
<p>When cross sections are initially computed, a resolution (<span class="math notranslate nohighlight">\(\lambda/\Delta \lambda\)</span>) is assumed. Cross sections are computed on a line-by-line nature and therefore usually computed for R~1e6. For JWST we are often interested in large bands (e.g. 1-14 <span class="math notranslate nohighlight">\(\mu\)</span>m). Therefore we need creative ways to speed up these runs. You will usually find one of two methods: correlated-k tables, and resampled cross sections. <a class="reference external" href="https://arxiv.org/pdf/1903.03997.pdf">Garland et al. 2019</a> is a good
resource on the differences between these two.</p>
<p>For this demonstration we will use the resampled cross section method. <strong>The major thing to note about using resampled cross sections</strong> is that you have to compute your model at ~100x higher resolution that your data. You will note that the opacity file you downloaded is resampled at R=10,000. Therefore you will note that <strong>in this tutorial we will always bin it down to R=100</strong>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">opa</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">opannection</span><span class="p">(</span><span class="n">wave_range</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">])</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="Set-Basic-Planet-and-Stellar-Inputs">
<h2>Set Basic Planet and Stellar Inputs<a class="headerlink" href="#Set-Basic-Planet-and-Stellar-Inputs" title="Permalink to this headline">¶</a></h2>
<p>Second step is to set basic planet parameters. To compute raw thermal flux, you only need gravity. However, if you want contrast units (relative flux of planet, to flux of star) you also need planet mass and radius, and steller radius. Below, we specify the planet’s mass and radius.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">case1</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">inputs</span><span class="p">()</span>

<span class="c1">#here we are going to have to specify gravity through R and M since we need it in the Flux calc</span>
<span class="n">case1</span><span class="o">.</span><span class="n">gravity</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mass_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;M_jup&#39;</span><span class="p">),</span> <span class="n">radius</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">radius_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;R_jup&#39;</span><span class="p">))</span>

<span class="c1">#here we are going to have to specify R as well</span>
<span class="n">case1</span><span class="o">.</span><span class="n">star</span><span class="p">(</span><span class="n">opa</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span><span class="mf">0.0122</span><span class="p">,</span><span class="mf">4.437</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">radius_unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;R_sun&#39;</span><span class="p">)</span> <span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Toy-Models">
<h1>Toy Models<a class="headerlink" href="#Toy-Models" title="Permalink to this headline">¶</a></h1>
<div class="section" id="How-does-climate-structure-influence-resultant-thermal-flux?">
<h2>How does climate structure influence resultant thermal flux?<a class="headerlink" href="#How-does-climate-structure-influence-resultant-thermal-flux?" title="Permalink to this headline">¶</a></h2>
<p>Before we load in full atmospheric profiles. Let’s first gain intuition for how temperature-pressure profile influences your spectrum.</p>
<p>Building a toy model: 1. Select a pressure scale - More layers will increase the runtime of your code. The standard is ~50-90 levels. - It is critical that the range of pressure cover optically thick to optically thin regions. If you are concerned your range is too narrow, increase and test determine if it affects your spectrum. If it does, it is too narrow. - The standard is a pressure range is from 100 bar -1 microbar to be safe.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">nlevels</span> <span class="o">=</span> <span class="mi">50</span>
<span class="n">pressure</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="n">nlevels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<ol class="arabic simple" start="2">
<li><p>Specify vertical temperature profile that follows this scaling. We will try a few toy model examples:</p>
<ul class="simple">
<li><p>isothermal</p></li>
<li><p>linearly increasing w/ pressure</p></li>
<li><p>linearly decreasing w/ pressure</p></li>
</ul>
</li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cases</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;iso&#39;</span><span class="p">,</span><span class="s1">&#39;inc&#39;</span><span class="p">,</span><span class="s1">&#39;dec&#39;</span><span class="p">]</span><span class="c1">#will turn into the keys of our output</span>
<span class="n">min_t</span> <span class="o">=</span> <span class="mi">500</span>
<span class="n">max_t</span> <span class="o">=</span> <span class="mi">2000</span>
<span class="n">t_iso</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">nlevels</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1300</span> <span class="c1">#temperature in kelvin (totally arbitrary!)</span>
<span class="n">t_inc</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">min_t</span><span class="p">,</span><span class="n">max_t</span><span class="p">,</span><span class="n">nlevels</span><span class="p">)</span>
<span class="n">t_dec</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="n">max_t</span><span class="p">,</span><span class="n">min_t</span><span class="p">,</span><span class="n">nlevels</span><span class="p">)</span>
</pre></div>
</div>
</div>
<ol class="arabic simple" start="3">
<li><p>Specify your atmospheric abundance breakdown. We will try these toy models:</p>
<ul class="simple">
<li><p>“well-mixed” : equal abundance at all pressure levels</p></li>
</ul>
</li>
</ol>
<p>For now, we will keep molecular abundances fixed, and vary the pressure-temperature profile. Let’s put these all together.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">atmo_iso</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;pressure&#39;</span><span class="p">:</span><span class="n">pressure</span><span class="p">,</span>
    <span class="s1">&#39;temperature&#39;</span><span class="p">:</span><span class="n">t_iso</span><span class="p">,</span>
    <span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="mf">0.80</span><span class="p">,</span>
    <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="mf">0.19</span><span class="p">,</span>
    <span class="s1">&#39;H2O&#39;</span><span class="p">:</span><span class="mf">1e-3</span>
<span class="p">}</span>
<span class="n">atmo_inc</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;pressure&#39;</span><span class="p">:</span><span class="n">pressure</span><span class="p">,</span>
    <span class="s1">&#39;temperature&#39;</span><span class="p">:</span><span class="n">t_inc</span><span class="p">,</span>
    <span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="mf">0.80</span><span class="p">,</span>
    <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="mf">0.19</span><span class="p">,</span>
    <span class="s1">&#39;H2O&#39;</span><span class="p">:</span><span class="mf">1e-3</span>
<span class="p">}</span>
<span class="n">atmo_dec</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;pressure&#39;</span><span class="p">:</span><span class="n">pressure</span><span class="p">,</span>
    <span class="s1">&#39;temperature&#39;</span><span class="p">:</span><span class="n">t_dec</span><span class="p">,</span>
    <span class="s1">&#39;H2&#39;</span><span class="p">:</span> <span class="mf">0.80</span><span class="p">,</span>
    <span class="s1">&#39;He&#39;</span><span class="p">:</span> <span class="mf">0.19</span><span class="p">,</span>
    <span class="s1">&#39;H2O&#39;</span><span class="p">:</span><span class="mf">1e-3</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<p>We want to loop through these three different cases. So we need to repeat the steps above three times, while changing the atmospheric input each time.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#let&#39;s store our three cases in toy_models</span>
<span class="n">toy_models</span><span class="o">=</span><span class="p">{}</span>

<span class="c1">#same as above but in a loop! three at once!</span>
<span class="k">for</span> <span class="n">case</span><span class="p">,</span> <span class="n">atmo</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">cases</span><span class="p">,[</span><span class="n">atmo_iso</span><span class="p">,</span><span class="n">atmo_inc</span><span class="p">,</span><span class="n">atmo_dec</span> <span class="p">]):</span>
    <span class="n">toy_models</span><span class="p">[</span><span class="n">case</span><span class="p">]</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">inputs</span><span class="p">()</span>
    <span class="n">toy_models</span><span class="p">[</span><span class="n">case</span><span class="p">]</span><span class="o">.</span><span class="n">gravity</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mass_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;M_jup&#39;</span><span class="p">),</span> <span class="n">radius</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">radius_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;R_jup&#39;</span><span class="p">))</span>
    <span class="n">toy_models</span><span class="p">[</span><span class="n">case</span><span class="p">]</span><span class="o">.</span><span class="n">star</span><span class="p">(</span><span class="n">opa</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span><span class="mf">0.0122</span><span class="p">,</span><span class="mf">4.437</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">radius_unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;R_sun&#39;</span><span class="p">)</span> <span class="p">)</span>

    <span class="c1">#NOW we vary this to run our three different toy models</span>
    <span class="n">toy_models</span><span class="p">[</span><span class="n">case</span><span class="p">]</span><span class="o">.</span><span class="n">atmosphere</span><span class="p">(</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">atmo</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>And finally let’s create three different toy model spectra</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">toy_out</span><span class="o">=</span><span class="p">{}</span>
<span class="k">for</span> <span class="n">case</span> <span class="ow">in</span> <span class="n">toy_models</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="c1">#picaso also has transmission, and reflected light options but let&#39;s specify</span>
    <span class="c1">#thermal for this tutorial</span>
    <span class="n">toy_out</span><span class="p">[</span><span class="n">case</span><span class="p">]</span> <span class="o">=</span> <span class="n">toy_models</span><span class="p">[</span><span class="n">case</span><span class="p">]</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">opa</span><span class="p">,</span> <span class="n">calculation</span><span class="o">=</span><span class="s1">&#39;thermal&#39;</span><span class="p">,</span><span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Finally plot the sequence!</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wno</span><span class="p">,</span><span class="n">spec</span><span class="o">=</span><span class="p">[],[]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">y_axis_type</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span>
                 <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Wavelength(um)&#39;</span><span class="p">,</span><span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Flux (erg/s/cm2/cm)&#39;</span><span class="p">)</span>
<span class="c1">#for reference, let&#39;s plot our three pt profiles next door</span>
<span class="n">pt_fig</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">y_axis_type</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span><span class="n">y_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1e2</span><span class="p">,</span><span class="mf">1e-6</span><span class="p">],</span>
                 <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span><span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Pressure(bar)&#39;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">case</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">toy_out</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">mean_regrid</span><span class="p">(</span><span class="n">toy_out</span><span class="p">[</span><span class="n">case</span><span class="p">][</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">],</span>
                          <span class="n">toy_out</span><span class="p">[</span><span class="n">case</span><span class="p">][</span><span class="s1">&#39;thermal&#39;</span><span class="p">],</span> <span class="n">R</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="mf">1e4</span><span class="o">/</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">jpi</span><span class="o">.</span><span class="n">Colorblind8</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
               <span class="n">legend_label</span><span class="o">=</span><span class="n">case</span><span class="p">)</span>

    <span class="n">pt_fig</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">toy_out</span><span class="p">[</span><span class="n">case</span><span class="p">][</span><span class="s1">&#39;full_output&#39;</span><span class="p">][</span><span class="s1">&#39;level&#39;</span><span class="p">][</span><span class="s1">&#39;temperature&#39;</span><span class="p">],</span>
             <span class="n">pressure</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">jpi</span><span class="o">.</span><span class="n">Colorblind8</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">location</span><span class="o">=</span><span class="s1">&#39;bottom_right&#39;</span>

<span class="n">jpi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">jpi</span><span class="o">.</span><span class="n">row</span><span class="p">([</span><span class="n">fig</span><span class="p">,</span><span class="n">pt_fig</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<p>What are the characteristic features of each spectrum?</p>
<p>The first obvious feature is that our isothermal case follows a perfect blackbody. The second two might not be immediately noticeable if you are not familiar with the absorption cross section of H2O. Let’s take a look.</p>
</div>
<div class="section" id="How-does-absorption-influence-resultant-thermal-flux?">
<h2>How does absorption influence resultant thermal flux?<a class="headerlink" href="#How-does-absorption-influence-resultant-thermal-flux?" title="Permalink to this headline">¶</a></h2>
<div class="section" id="Molecular-Absorption">
<h3>Molecular Absorption<a class="headerlink" href="#Molecular-Absorption" title="Permalink to this headline">¶</a></h3>
<p>Our toy model included water absorption, along with H2/He. In order to see the cross section of H2O we can use <code class="docutils literal notranslate"><span class="pre">PICASO</span></code>’s opacity factory. This will show you the specific absorptive power of H2O at a specific pressure and temperature. Let’s pick a single P and T that is representative of our toy models in order to gain an intuition for where water is absorbing</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#database should be the same for everyone</span>
<span class="n">db_filename</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">getenv</span><span class="p">(</span><span class="s1">&#39;picaso_refdata&#39;</span><span class="p">),</span> <span class="s1">&#39;opacities&#39;</span><span class="p">,</span><span class="s1">&#39;opacities.db&#39;</span><span class="p">)</span>
<span class="n">species_to_get</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">]</span>
<span class="n">t_to_get</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1500</span><span class="p">]</span><span class="c1">#kelvin</span>
<span class="n">p_to_get</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#in bars</span>
<span class="n">data</span>  <span class="o">=</span> <span class="n">op</span><span class="o">.</span><span class="n">get_molecular</span><span class="p">(</span><span class="n">db_filename</span><span class="p">,</span> <span class="n">species_to_get</span><span class="p">,</span> <span class="n">t_to_get</span><span class="p">,</span><span class="n">p_to_get</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">mean_regrid</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">],</span><span class="n">data</span><span class="p">[</span><span class="s1">&#39;H2O&#39;</span><span class="p">][</span><span class="mi">1500</span><span class="p">][</span><span class="mf">1.0</span><span class="p">],</span> <span class="n">R</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="c1">#plot data</span>
<span class="n">h2o_fig</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span><span class="n">y_axis_type</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span><span class="n">x_range</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span><span class="n">y_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1e-24</span><span class="p">,</span><span class="mf">5e-20</span><span class="p">]</span>
                    <span class="p">,</span> <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Micron&#39;</span><span class="p">,</span><span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Cross Section (cm2/species)&#39;</span><span class="p">)</span>
<span class="n">h2o_fig</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="mf">1e4</span><span class="o">/</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span><span class="n">line_width</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">jpi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">h2o_fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>Exercise:</strong> This plot shows where the absorptive strength of water peaks. Find the peaks of water in the cross section plot and correlate them with the peaks and troughs of your toy model.</p>
<p>In the case where temperature is increasing with increasing pressure, does the flux or your spectrum increase toward the peak of an absorption feature? And vice versa? What does this tell you about where the flux is emanating from at band center, band trough?</p>
</div>
<div class="section" id="Continuum-Absorption">
<h3>Continuum Absorption<a class="headerlink" href="#Continuum-Absorption" title="Permalink to this headline">¶</a></h3>
<p>A second, more subtle contributor to the spectrum is the continuum absorption from H2, He, which we included. At first glance it might look like H2O contribution is the only contributor to our toy models. Let’s take a closer look at one case by using the <code class="docutils literal notranslate"><span class="pre">get_contribution</span></code> function.</p>
</div>
<div class="section" id="Get-contribution-function">
<h3>Get contribution function<a class="headerlink" href="#Get-contribution-function" title="Permalink to this headline">¶</a></h3>
<p>This output consists of three important items:</p>
<ol class="arabic simple">
<li><p>The by layer optical depth of each absorbing species (number of midpoint layers by number of wave points)</p></li>
<li><p>The cumulative optical depth of each absorbing species (number of boundary levels by number of wave points)</p></li>
<li><p>The optical depth ~ 1 surface (or whatever the user input for at_tau)</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">contribution</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">get_contribution</span><span class="p">(</span><span class="n">toy_models</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">],</span> <span class="n">opa</span><span class="p">,</span> <span class="n">at_tau</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#explore the output</span>
<span class="n">contribution</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wno</span><span class="o">=</span><span class="p">[]</span>
<span class="n">spec</span><span class="o">=</span><span class="p">[]</span>
<span class="n">labels</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">contribution</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">mean_regrid</span><span class="p">(</span><span class="n">opa</span><span class="o">.</span><span class="n">wno</span><span class="p">,</span> <span class="n">contribution</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">R</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">:</span> <span class="c1"># Bars</span>
        <span class="n">wno</span><span class="o">+=</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="n">spec</span><span class="o">+=</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
        <span class="n">labels</span> <span class="o">+=</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">wno</span><span class="p">,</span><span class="n">spec</span><span class="p">,</span><span class="n">plot_width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span><span class="n">plot_height</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span>
                   <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Tau~1 Pressure (bars)&#39;</span><span class="p">,</span>
                   <span class="n">y_axis_type</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span><span class="n">x_range</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                     <span class="n">y_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1e2</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">],</span><span class="n">legend</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">jpi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>This plot shows where the optical depth=1 (i.e. tau=1) surface is for the different absorbing components of your model. In this case, the tau=1 surface of H2O is far above that of the continuum. Therefore, for the toy model we have specified, the continuum is not contributing to the overall spectrum.</p>
<p><strong>Exercise:</strong> In this toy model example, at what abundance of H2O does the continuum become important? In those cases, what is the result on the final spectrum? Run the abundance cases below to find out.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#let&#39;s store our three cases in toy_models</span>
<span class="n">vary_h2o_out</span><span class="o">=</span><span class="p">{}</span>

<span class="c1">#same as above but in a loop over a h2o abundance multilier</span>
<span class="n">h2o_factors</span> <span class="o">=</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">1e-1</span><span class="p">,</span> <span class="mf">1e-2</span><span class="p">]</span>
<span class="k">for</span> <span class="n">ifact</span> <span class="ow">in</span> <span class="n">h2o_factors</span><span class="p">:</span>
    <span class="n">pln</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">inputs</span><span class="p">()</span>
    <span class="n">pln</span><span class="o">.</span><span class="n">gravity</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mass_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;M_jup&#39;</span><span class="p">),</span> <span class="n">radius</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">radius_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;R_jup&#39;</span><span class="p">))</span>
    <span class="n">pln</span><span class="o">.</span><span class="n">star</span><span class="p">(</span><span class="n">opa</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span><span class="mf">0.0122</span><span class="p">,</span><span class="mf">4.437</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">radius_unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;R_sun&#39;</span><span class="p">)</span> <span class="p">)</span>

    <span class="c1">#NOW we vary this to run our three different toy models</span>
    <span class="n">pln</span><span class="o">.</span><span class="n">atmosphere</span><span class="p">(</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">atmo_inc</span><span class="p">))</span>

    <span class="c1">#to figure out the problem above, we can artificially decrease/increase H2O</span>
    <span class="n">pln</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;atmosphere&#39;</span><span class="p">][</span><span class="s1">&#39;profile&#39;</span><span class="p">][</span><span class="s1">&#39;H2O&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">ifact</span> <span class="o">*</span>
                                                  <span class="n">pln</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;atmosphere&#39;</span><span class="p">][</span><span class="s1">&#39;profile&#39;</span><span class="p">][</span><span class="s1">&#39;H2O&#39;</span><span class="p">])</span>
    <span class="c1">#and rerun the spectrum with those different abundances</span>
    <span class="n">vary_h2o_out</span><span class="p">[</span><span class="n">ifact</span><span class="p">]</span> <span class="o">=</span> <span class="n">pln</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">opa</span><span class="p">,</span> <span class="n">calculation</span><span class="o">=</span><span class="s1">&#39;thermal&#39;</span><span class="p">,</span> <span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Finally plot!</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wno</span><span class="p">,</span><span class="n">spec</span><span class="o">=</span><span class="p">[],[]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">y_axis_type</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span>
                 <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Wavelength(um)&#39;</span><span class="p">,</span><span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Flux (erg/s/cm2/cm)&#39;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Toy model with varied H2O abundance&#39;</span><span class="p">)</span>

<span class="c1">#can create a little color scale for each of our spectra</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">viridis</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h2o_factors</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">case</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vary_h2o_out</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">mean_regrid</span><span class="p">(</span><span class="n">vary_h2o_out</span><span class="p">[</span><span class="n">case</span><span class="p">][</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">],</span>
                          <span class="n">vary_h2o_out</span><span class="p">[</span><span class="n">case</span><span class="p">][</span><span class="s1">&#39;thermal&#39;</span><span class="p">],</span> <span class="n">R</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="mf">1e4</span><span class="o">/</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
               <span class="n">legend_label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{case}</span><span class="s1">xH2O&#39;</span><span class="p">)</span>

<span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">location</span><span class="o">=</span><span class="s1">&#39;bottom_right&#39;</span>

<span class="n">jpi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>There are two factors influencing the spectrum. The first is the increased opacity of the water itself. Why does flux increase with decreasing water abundance?</p>
<p>The second, less noticeable is the new contribution from the continuum opacity. Can you eyeball where the continuum kicks in? One trick is to normalize each spectrum by its mean value to compare the relative size of the absorption features. This isolates the size of the absorption features while removing the increased flux from decreased water abundance.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wno</span><span class="p">,</span><span class="n">spec</span><span class="o">=</span><span class="p">[],[]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="c1">#y_axis_type=&#39;log&#39;,</span>
                 <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Wavelength(um)&#39;</span><span class="p">,</span><span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Flux (erg/s/cm2/cm)&#39;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Normalized toy model with varied H2O abundance&#39;</span><span class="p">)</span>

<span class="c1">#can create a little color scale for each of our spectra</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">viridis</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h2o_factors</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">case</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vary_h2o_out</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">mean_regrid</span><span class="p">(</span><span class="n">vary_h2o_out</span><span class="p">[</span><span class="n">case</span><span class="p">][</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">],</span>
                          <span class="n">vary_h2o_out</span><span class="p">[</span><span class="n">case</span><span class="p">][</span><span class="s1">&#39;thermal&#39;</span><span class="p">],</span> <span class="n">R</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
    <span class="n">spec</span> <span class="o">+=</span> <span class="p">[</span><span class="n">y</span><span class="p">]</span>
    <span class="n">fig</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="mf">1e4</span><span class="o">/</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">y</span><span class="p">),</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
               <span class="n">legend_label</span><span class="o">=</span><span class="nb">str</span><span class="p">(</span><span class="n">case</span><span class="p">))</span>

<span class="n">fig</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">location</span><span class="o">=</span><span class="s1">&#39;bottom_right&#39;</span>

<span class="n">jpi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now can you tell? When water is fully dominant (dark purple) the delta peak-trough flux is the highest. When the continuum is added, the H2H2/H2He opacity interferes with the H2O absorption. The window regions, which would otherwise be optically thin and sensitive to the highest pressures, are now blocked by the continuum opacity. This is an important effect as it will come back to haunt us in the cloud exercises. Let’s take a look at the contribution plot for our 0.01xH2O case, to see how H2H2
and H2He now play a role.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#PLN is from the last run in the cell above</span>
<span class="n">contribution</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">get_contribution</span><span class="p">(</span><span class="n">pln</span><span class="p">,</span> <span class="n">opa</span><span class="p">,</span> <span class="n">at_tau</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">wno</span><span class="o">=</span><span class="p">[]</span>
<span class="n">spec</span><span class="o">=</span><span class="p">[]</span>
<span class="n">labels</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">contribution</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">mean_regrid</span><span class="p">(</span><span class="n">opa</span><span class="o">.</span><span class="n">wno</span><span class="p">,</span> <span class="n">contribution</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">R</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">:</span> <span class="c1"># Bars</span>
        <span class="n">wno</span><span class="o">+=</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="n">spec</span><span class="o">+=</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
        <span class="n">labels</span> <span class="o">+=</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">wno</span><span class="p">,</span><span class="n">spec</span><span class="p">,</span><span class="n">plot_width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span><span class="n">plot_height</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span>
                   <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Tau~1 Pressure (bars)&#39;</span><span class="p">,</span>
                   <span class="n">y_axis_type</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span><span class="n">x_range</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                     <span class="n">y_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1e2</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">],</span><span class="n">legend</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">jpi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Ah ha! We see in this case the continuum and the molecular absorption from H2H2 and H2He now compete across wavelength space.</p>
<p><strong>Confirm understanding:</strong> Does this make sense with what you noted from the raw and normalized spectra? What is happening to the raw spectra in the regions most dominated by continuum opacity?</p>
</div>
</div>
<div class="section" id="How-to-determine-what-pressures-you-are-sensitive-to?">
<h2>How to determine what pressures you are sensitive to?<a class="headerlink" href="#How-to-determine-what-pressures-you-are-sensitive-to?" title="Permalink to this headline">¶</a></h2>
<p>One major aspect of understanding thermal emission is understanding where (in pressure) your flux is emanating from. The tau=1 surface plots should give you a rough idea of this. You can see that in our 0.01xH2O case above, the flux is coming from roughly 1 bars.</p>
<p>Another way to visualize this, and relate it back to your spectrum is by comparing your raw spectra against blackbody curves. What is most helpful is to pick temperatures at known pressures along your climate profile.</p>
<p><strong>Exercise:</strong> Revisit the Pressure-temperature profile for the <code class="docutils literal notranslate"><span class="pre">inc</span></code> case. Even though we are increasing water abundance, all those cases still are computed from the same pressure-temperature profile. Pick three pressures along this curve. Determine what the temperature is at those pressures. Use the <code class="docutils literal notranslate"><span class="pre">blackbody</span></code> function to compute three blackbodies and compare against your thermal flux spectra.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wno</span><span class="p">,</span><span class="n">spec</span><span class="o">=</span><span class="p">[],[]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">y_axis_type</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span>
                 <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Wavelength(um)&#39;</span><span class="p">,</span><span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Flux (erg/s/cm2/cm)&#39;</span><span class="p">,</span>
                <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Toy model with varied H2O abundance&#39;</span><span class="p">)</span>

<span class="c1">#for reference, let&#39;s plot our pt profile next door</span>
<span class="n">pt_fig</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">y_axis_type</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span><span class="n">y_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1e2</span><span class="p">,</span><span class="mf">1e-6</span><span class="p">],</span>
                 <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span><span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Pressure(bar)&#39;</span><span class="p">)</span>
<span class="n">pt_fig</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">toy_out</span><span class="p">[</span><span class="s1">&#39;inc&#39;</span><span class="p">][</span><span class="s1">&#39;full_output&#39;</span><span class="p">][</span><span class="s1">&#39;level&#39;</span><span class="p">][</span><span class="s1">&#39;temperature&#39;</span><span class="p">],</span>
             <span class="n">pressure</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>

<span class="c1">#same exact code as before</span>
<span class="n">colors</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">viridis</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">h2o_factors</span><span class="p">))</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">case</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">vary_h2o_out</span><span class="o">.</span><span class="n">keys</span><span class="p">()):</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">mean_regrid</span><span class="p">(</span><span class="n">vary_h2o_out</span><span class="p">[</span><span class="n">case</span><span class="p">][</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">],</span>
                          <span class="n">vary_h2o_out</span><span class="p">[</span><span class="n">case</span><span class="p">][</span><span class="s1">&#39;thermal&#39;</span><span class="p">],</span> <span class="n">R</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>

    <span class="n">fig</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="mf">1e4</span><span class="o">/</span><span class="n">x</span><span class="p">,</span><span class="n">y</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
               <span class="n">legend_label</span><span class="o">=</span><span class="sa">f</span><span class="s1">&#39;</span><span class="si">{case}</span><span class="s1">xH2O&#39;</span><span class="p">)</span>
<span class="c1">#show for reference first</span>
<span class="n">jpi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">jpi</span><span class="o">.</span><span class="n">row</span><span class="p">([</span><span class="n">fig</span><span class="p">,</span> <span class="n">pt_fig</span><span class="p">]))</span>

</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#STEPS FOR EXERCISE</span>
<span class="c1">#Step 1: pick a pressure</span>
<span class="n">at_pressure</span><span class="o">=</span><span class="mi">1</span><span class="c1">#bar</span>
<span class="c1">#Step 2: what is the temperature of your planet at that pressure</span>
<span class="n">corresponding_t</span> <span class="o">=</span> <span class="mi">1630</span> <span class="c1">#Kelvin, I have just eyeballed this from the plot</span>
<span class="c1">#Step 3: use the plack function to compute the blackbody flux</span>
<span class="n">corr_intensity</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">blackbody</span><span class="p">(</span><span class="n">corresponding_t</span><span class="p">,</span> <span class="mi">1</span><span class="o">/</span><span class="n">opa</span><span class="o">.</span><span class="n">wno</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">corr_flux</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">*</span> <span class="n">corr_intensity</span>
<span class="c1">#Step4: add to your plots</span>
<span class="n">pt_fig</span><span class="o">.</span><span class="n">circle</span><span class="p">(</span><span class="n">corresponding_t</span><span class="p">,</span> <span class="n">at_pressure</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">)</span>
<span class="n">fig</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="mf">1e4</span><span class="o">/</span><span class="n">opa</span><span class="o">.</span><span class="n">wno</span><span class="p">,</span> <span class="n">corr_flux</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;black&#39;</span><span class="p">,</span><span class="n">line_width</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="n">jpi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">jpi</span><span class="o">.</span><span class="n">row</span><span class="p">([</span><span class="n">fig</span><span class="p">,</span> <span class="n">pt_fig</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<p>Does this checkout out with your tau=1 pressure curves for the 0.01xH2O case you made above? What about the increased water abundance plots?</p>
<p><strong>Exercise:</strong> Using this methodology, for each of these 1-5 micron spectra, determine the range of pressures your spectrum is sensitive to?</p>
<p>Now that you have gone through the exercise, you can use the prebuilt <code class="docutils literal notranslate"><span class="pre">PICASO</span></code> function.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">f</span><span class="o">=</span><span class="n">jpi</span><span class="o">.</span><span class="n">flux_at_top</span><span class="p">(</span><span class="n">vary_h2o_out</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">pressures</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">0.01</span><span class="p">],</span><span class="n">R</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">f</span><span class="o">.</span><span class="n">legend</span><span class="o">.</span><span class="n">location</span><span class="o">=</span><span class="s1">&#39;bottom_right&#39;</span>
<span class="n">jpi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Parameterized-Pressure-Temperature-Profiles">
<h1>Parameterized Pressure-Temperature Profiles<a class="headerlink" href="#Parameterized-Pressure-Temperature-Profiles" title="Permalink to this headline">¶</a></h1>
<p>In lecture you learned about the double gray model, which is an exoplanet-relevant analytic solution of the two-stream equation <a class="reference external" href="#References">Guillot et al. 2010</a>. You also encountered this in last week’s transmission tutorial. The basic equation is:</p>
<div class="math notranslate nohighlight">
\[T = \left(\frac{F_\odot}{2 \sigma} \left[(\frac{1}{\gamma} - \gamma)\exp^{-\tau/\gamma} + 1 + \gamma \right] \right)^{1/4}\]</div>
<p>Where the limits are:</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\gamma&gt;&gt;1\)</span> : “greenhouse” limit with a hot deep atmosphere</p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma=1\)</span> : isothermal atmosphere with T <span class="math notranslate nohighlight">\(= \frac{F_\odot}{\sigma}^{1/4}\)</span></p></li>
<li><p><span class="math notranslate nohighlight">\(\gamma&lt;&lt;1\)</span> : “anti-greenhouse” limit, thermal inversion</p></li>
</ul>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">pt_fig</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">width</span><span class="o">=</span><span class="mi">300</span><span class="p">,</span> <span class="n">y_axis_type</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span><span class="n">y_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1e2</span><span class="p">,</span><span class="mf">1e-6</span><span class="p">],</span>
                 <span class="n">x_axis_label</span><span class="o">=</span><span class="s1">&#39;Temperature&#39;</span><span class="p">,</span><span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Pressure(bar)&#39;</span><span class="p">)</span>
<span class="c1">#first, tau</span>
<span class="c1">#let&#39;s assume the optical depth logarithmically increases from 1e-5-1000</span>
<span class="n">tau</span> <span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">3</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>
<span class="c1">#this will roughly follow our pressure scale</span>
<span class="n">pressure</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">6</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">50</span><span class="p">)</span>

<span class="n">F_sig</span> <span class="o">=</span> <span class="mi">1500</span><span class="o">**</span><span class="mi">4</span> <span class="c1">#we can play around with this insolation scaling</span>

<span class="c1">#gamma</span>
<span class="n">gamma_gt_1</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">gamma_lt_1</span> <span class="o">=</span> <span class="mf">0.1</span>
<span class="n">gamma_1</span> <span class="o">=</span> <span class="mi">1</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span><span class="n">ig</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="nb">zip</span><span class="p">([</span><span class="n">gamma_1</span><span class="p">,</span><span class="n">gamma_lt_1</span><span class="p">,</span> <span class="n">gamma_gt_1</span><span class="p">],[</span><span class="s1">&#39;g=1&#39;</span><span class="p">,</span><span class="s1">&#39;g&lt;1&#39;</span><span class="p">,</span><span class="s1">&#39;g&gt;1&#39;</span><span class="p">])):</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">ig</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">legend</span><span class="o">=</span><span class="n">ig</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>

    <span class="n">temperature</span> <span class="o">=</span> <span class="p">(</span><span class="n">F_sig</span> <span class="o">*</span> <span class="p">((</span><span class="mi">1</span><span class="o">/</span><span class="n">g</span> <span class="o">-</span><span class="n">g</span><span class="p">)</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="n">tau</span><span class="o">/</span><span class="n">g</span><span class="p">)</span> <span class="o">+</span><span class="mi">1</span> <span class="o">+</span> <span class="n">g</span><span class="p">))</span> <span class="o">**</span><span class="p">(</span><span class="mf">0.25</span><span class="p">)</span>
    <span class="n">pt_fig</span><span class="o">.</span><span class="n">line</span><span class="p">(</span><span class="n">temperature</span><span class="p">,</span>
             <span class="n">pressure</span><span class="p">,</span><span class="n">color</span><span class="o">=</span><span class="n">jpi</span><span class="o">.</span><span class="n">Colorblind8</span><span class="p">[</span><span class="n">i</span><span class="p">],</span><span class="n">line_width</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="n">legend_label</span><span class="o">=</span><span class="n">legend</span><span class="p">)</span>

<span class="n">jpi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">pt_fig</span><span class="p">)</span>


</pre></div>
</div>
</div>
<p><strong>Exercise</strong>: Make sure you have an intuition for how the parameters gamma, tau, and Fsig affect the resulting PT profile.</p>
<p>We’ve already learned that the isothermal profile will return back the blackbody. Let’s use one of the “greenhouse” limit pressure-temperature profiles to proceed with creating a full thermal emission spectrum.</p>
</div>
<div class="section" id="Combing-parameterized-climate-with-chemistry">
<h1>Combing parameterized climate with chemistry<a class="headerlink" href="#Combing-parameterized-climate-with-chemistry" title="Permalink to this headline">¶</a></h1>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">case1</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">inputs</span><span class="p">()</span>
<span class="n">case1</span><span class="o">.</span><span class="n">gravity</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mass_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;M_jup&#39;</span><span class="p">),</span> <span class="n">radius</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">radius_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;R_jup&#39;</span><span class="p">))</span>
<span class="n">case1</span><span class="o">.</span><span class="n">star</span><span class="p">(</span><span class="n">opa</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span><span class="mf">0.0122</span><span class="p">,</span><span class="mf">4.437</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">radius_unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;R_sun&#39;</span><span class="p">)</span> <span class="p">)</span>

<span class="c1">#NOW let&#39;s add our parameterized profile</span>
<span class="n">case1</span><span class="o">.</span><span class="n">atmosphere</span><span class="p">(</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                <span class="s1">&#39;pressure&#39;</span><span class="p">:</span><span class="n">pressure</span><span class="p">,</span>
                <span class="s1">&#39;temperature&#39;</span><span class="p">:</span><span class="n">temperature</span><span class="p">}),</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now we need to add the chemistry! <code class="docutils literal notranslate"><span class="pre">PICASO</span></code> has a prebuilt chemistry table that was computed by Channon Visscher. You can use it by adding it to your <code class="docutils literal notranslate"><span class="pre">case1</span></code>. Two more chemistry parameters are now going to be introduced:</p>
<ol class="arabic simple">
<li><p>C/O ratio: Elemental carbon to oxygen ratio</p></li>
<li><p>M/H: Atmospheric metallicity</p></li>
</ol>
<p>Let’s choose Solar values. Feel free to explore the effect of this after the first completed spectrum.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">log_mh</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#log relative to solar</span>
<span class="n">c_o</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#relative to solar</span>
<span class="n">case1</span><span class="o">.</span><span class="n">chemeq_visscher</span><span class="p">(</span> <span class="n">c_o</span><span class="p">,</span> <span class="n">log_mh</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Now you can check out what has been added to your <code class="docutils literal notranslate"><span class="pre">case1</span></code> bundle</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">case1</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;atmosphere&#39;</span><span class="p">][</span><span class="s1">&#39;profile&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Now we are ready to compute the spectrum</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">out_solar</span> <span class="o">=</span> <span class="n">case1</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">opa</span><span class="p">,</span> <span class="n">calculation</span><span class="o">=</span><span class="s1">&#39;thermal&#39;</span><span class="p">,</span><span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#get the contribution as well now that we have all the chemistry!</span>
<span class="n">contribution</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">get_contribution</span><span class="p">(</span><span class="n">case1</span><span class="p">,</span> <span class="n">opa</span><span class="p">,</span> <span class="n">at_tau</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#regrid</span>
<span class="n">wno</span><span class="p">,</span> <span class="n">fp</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">mean_regrid</span><span class="p">(</span><span class="n">out_solar</span><span class="p">[</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">],</span> <span class="n">out_solar</span><span class="p">[</span><span class="s1">&#39;thermal&#39;</span><span class="p">],</span> <span class="n">R</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">jpi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">jpi</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">wno</span><span class="p">,</span> <span class="n">fp</span><span class="p">,</span> <span class="n">y_axis_type</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span>
                      <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Flux (erg/cm2/s/cm)&#39;</span><span class="p">,</span><span class="n">plot_width</span><span class="o">=</span><span class="mi">400</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>When comparing to transit observations we will mostly be looking at contrast units, relative to the stellar flux. Note the 1e6 multiplier gets us to PPM units. This allows you to orient your brain to an observers. Remember the hypothesized JWST noise from is 20 &amp; 50 ppm for near-IR and mid-IR modes, respectively.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wno</span><span class="p">,</span> <span class="n">fpfs</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">mean_regrid</span><span class="p">(</span><span class="n">out_solar</span><span class="p">[</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">],</span> <span class="n">out_solar</span><span class="p">[</span><span class="s1">&#39;fpfs_thermal&#39;</span><span class="p">],</span> <span class="n">R</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">jpi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">jpi</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">wno</span><span class="p">,</span> <span class="n">fpfs</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span>
                      <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Relative Flux (ppm)&#39;</span><span class="p">,</span><span class="n">plot_width</span><span class="o">=</span><span class="mi">400</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Now we can revisit our contribution plot, which will look more complicated now.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wno</span><span class="o">=</span><span class="p">[]</span>
<span class="n">spec</span><span class="o">=</span><span class="p">[]</span>
<span class="n">labels</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">contribution</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">mean_regrid</span><span class="p">(</span><span class="n">opa</span><span class="o">.</span><span class="n">wno</span><span class="p">,</span> <span class="n">contribution</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">R</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">:</span> <span class="c1"># Bars</span>
        <span class="n">wno</span><span class="o">+=</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="n">spec</span><span class="o">+=</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
        <span class="n">labels</span> <span class="o">+=</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">wno</span><span class="p">,</span><span class="n">spec</span><span class="p">,</span><span class="n">plot_width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span><span class="n">plot_height</span><span class="o">=</span><span class="mi">350</span><span class="p">,</span>
                   <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Tau~1 Pressure (bars)&#39;</span><span class="p">,</span>
                   <span class="n">y_axis_type</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span><span class="n">x_range</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                     <span class="n">y_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1e2</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">],</span><span class="n">legend</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">jpi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><strong>Exercise</strong>:</p>
<ol class="arabic simple">
<li><p>Cross compare this contribution plot with your resultant spectrum. Can you properly account for all the molecules that you should be dominant.</p></li>
<li><p>What molecules are barely visible. What is the approximate signal size of those features?</p></li>
<li><p>Look through the JWST modes from the figure on the <a class="reference external" href="https://exoctk.stsci.edu/pandexo/calculation/new">PandExo webiste</a>. For the transit time series modes you see, what molecules are observable with what JWST models.</p></li>
<li><p>Repeat the exercise such that your upper atmospheric temperature is ~600 K.</p>
<ul class="simple">
<li><p>What major differences do you notice in your contribution plot?</p></li>
<li><p>What are the dominant carbon-bearing species?</p></li>
<li><p>What are the dominant nitrogen-bearing species?</p></li>
<li><p>What are the dominant continuum species?</p></li>
</ul>
</li>
</ol>
</div>
<div class="section" id="Combing-parameterized-climate-with-chemistry-AND-clouds">
<h1>Combing parameterized climate with chemistry AND clouds<a class="headerlink" href="#Combing-parameterized-climate-with-chemistry-AND-clouds" title="Permalink to this headline">¶</a></h1>
<p>In this last module we will think about how clouds affect your thermal emission spectrum. We will use the same general procedure outlined above but add one additional step to add a box model cloud.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">cld1</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">inputs</span><span class="p">()</span>
<span class="n">cld1</span><span class="o">.</span><span class="n">gravity</span><span class="p">(</span><span class="n">mass</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mass_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;M_jup&#39;</span><span class="p">),</span> <span class="n">radius</span><span class="o">=</span><span class="mf">1.2</span><span class="p">,</span> <span class="n">radius_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;R_jup&#39;</span><span class="p">))</span>
<span class="n">cld1</span><span class="o">.</span><span class="n">star</span><span class="p">(</span><span class="n">opa</span><span class="p">,</span> <span class="mi">4000</span><span class="p">,</span><span class="mf">0.0122</span><span class="p">,</span><span class="mf">4.437</span><span class="p">,</span><span class="n">radius</span><span class="o">=</span><span class="mf">0.7</span><span class="p">,</span> <span class="n">radius_unit</span> <span class="o">=</span> <span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;R_sun&#39;</span><span class="p">)</span> <span class="p">)</span>

<span class="c1">#NOW let&#39;s add our parameterized profile</span>
<span class="n">cld1</span><span class="o">.</span><span class="n">atmosphere</span><span class="p">(</span><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span>
                <span class="s1">&#39;pressure&#39;</span><span class="p">:</span><span class="n">pressure</span><span class="p">,</span>
                <span class="s1">&#39;temperature&#39;</span><span class="p">:</span><span class="n">temperature</span><span class="p">}),</span><span class="n">verbose</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">log_mh</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#log relative to solar</span>
<span class="n">c_o</span> <span class="o">=</span> <span class="mi">1</span> <span class="c1">#relative to solar</span>
<span class="n">cld1</span><span class="o">.</span><span class="n">chemeq_visscher</span><span class="p">(</span> <span class="n">c_o</span><span class="p">,</span> <span class="n">log_mh</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="Adding-a-box-model-cloud">
<h2>Adding a box model cloud<a class="headerlink" href="#Adding-a-box-model-cloud" title="Permalink to this headline">¶</a></h2>
<p>Later in the ERS series, you will learn how to compute full cloud models. For now, we will use a simple box model cloud to understand the effect of adding a cloud.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">PICASO</span></code> box model is specified by a cloud layer with an asymmetry parameter (g0), a single scattering abledo (w0), an optical depth (opd) and a vertical pressure location (p,the pressure level in log10 bars) and finally the vertical cloud thickness (dp, the cloud thickness also in log10 bars). Such that:</p>
<p>cloud_base(bars)=<span class="math notranslate nohighlight">\(10^p\)</span></p>
<p>cloud_top(bars)=<span class="math notranslate nohighlight">\(10^{p−dp}\)</span></p>
<p>The single scattering albedo controls how scattering the cloud is. The asymmetry controls the degree of forward scattering. Checkout the <code class="docutils literal notranslate"><span class="pre">PICASO</span></code> <a class="reference external" href="https://natashabatalha.github.io/picaso_dev#slide02">radiative transfer tutorial</a> to see a visual of the asymmetry phase function.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1"># highly forward scattering cloud from 1.0 bar up to 0.1 bar</span>
<span class="n">cld1</span><span class="o">.</span><span class="n">clouds</span><span class="p">(</span> <span class="n">g0</span><span class="o">=</span><span class="p">[</span><span class="mf">0.9</span><span class="p">],</span> <span class="n">w0</span><span class="o">=</span><span class="p">[</span><span class="mf">0.8</span><span class="p">],</span> <span class="n">opd</span><span class="o">=</span><span class="p">[</span><span class="mf">0.5</span><span class="p">],</span> <span class="n">p</span> <span class="o">=</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">],</span> <span class="n">dp</span><span class="o">=</span><span class="p">[</span><span class="mf">1.0</span><span class="p">])</span>
</pre></div>
</div>
</div>
<p>We can use the cloud input function to visualize what we just added to our code</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">nwno</span> <span class="o">=</span> <span class="mi">196</span> <span class="c1">#this is just the default number for the simple case above</span>
<span class="n">nlayer</span> <span class="o">=</span> <span class="n">cld1</span><span class="o">.</span><span class="n">nlevel</span><span class="o">-</span><span class="mi">1</span> <span class="c1">#one less than the number of PT points in your input</span>
<span class="n">jpi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">jpi</span><span class="o">.</span><span class="n">plot_cld_input</span><span class="p">(</span><span class="n">nwno</span><span class="p">,</span> <span class="n">nlayer</span><span class="p">,</span><span class="n">df</span><span class="o">=</span><span class="n">cld1</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;clouds&#39;</span><span class="p">][</span><span class="s1">&#39;profile&#39;</span><span class="p">]))</span>
</pre></div>
</div>
</div>
<p>Let’s similarly compute the spectrum and compare to our cloud free case</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">out_cld</span> <span class="o">=</span> <span class="n">cld1</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">opa</span><span class="p">,</span> <span class="n">calculation</span><span class="o">=</span><span class="s1">&#39;thermal&#39;</span><span class="p">,</span><span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="c1">#get the contribution as well now that we have all the chemistry!</span>
<span class="n">contribution_cld</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">get_contribution</span><span class="p">(</span><span class="n">cld1</span><span class="p">,</span> <span class="n">opa</span><span class="p">,</span> <span class="n">at_tau</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="c1">#regrid</span>
<span class="n">wno</span><span class="p">,</span> <span class="n">fp_cld</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">mean_regrid</span><span class="p">(</span><span class="n">out_cld</span><span class="p">[</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">],</span> <span class="n">out_cld</span><span class="p">[</span><span class="s1">&#39;thermal&#39;</span><span class="p">],</span> <span class="n">R</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
<span class="n">wno</span><span class="p">,</span> <span class="n">fpfs_cld</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">mean_regrid</span><span class="p">(</span><span class="n">out_cld</span><span class="p">[</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">],</span> <span class="n">out_cld</span><span class="p">[</span><span class="s1">&#39;fpfs_thermal&#39;</span><span class="p">],</span> <span class="n">R</span><span class="o">=</span><span class="mi">150</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">jpi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">jpi</span><span class="o">.</span><span class="n">spectrum</span><span class="p">([</span><span class="n">wno</span><span class="p">,</span><span class="n">wno</span><span class="p">],</span> <span class="p">[</span><span class="n">fpfs</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">fpfs_cld</span><span class="o">*</span><span class="mf">1e6</span><span class="p">],</span> <span class="n">legend</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;Cloud free&#39;</span><span class="p">,</span><span class="s1">&#39;Cloudy&#39;</span><span class="p">],</span>
                      <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Relative Flux (ppm)&#39;</span><span class="p">,</span><span class="n">plot_width</span><span class="o">=</span><span class="mi">600</span><span class="p">))</span>
</pre></div>
</div>
</div>
<p>Looks relatively minor! Why is this? Let’s see the contribution plot with the cloud to find out</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[ ]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">wno</span><span class="o">=</span><span class="p">[]</span>
<span class="n">spec</span><span class="o">=</span><span class="p">[]</span>
<span class="n">labels</span><span class="o">=</span><span class="p">[]</span>
<span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="n">contribution_cld</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span><span class="o">.</span><span class="n">keys</span><span class="p">():</span>
    <span class="n">x</span><span class="p">,</span><span class="n">y</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">mean_regrid</span><span class="p">(</span><span class="n">opa</span><span class="o">.</span><span class="n">wno</span><span class="p">,</span> <span class="n">contribution_cld</span><span class="p">[</span><span class="mi">2</span><span class="p">][</span><span class="n">j</span><span class="p">],</span><span class="n">R</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">y</span><span class="p">)</span><span class="o">&lt;</span><span class="mi">5</span><span class="p">:</span> <span class="c1"># Bars</span>
        <span class="n">wno</span><span class="o">+=</span><span class="p">[</span><span class="n">x</span><span class="p">]</span>
        <span class="n">spec</span><span class="o">+=</span><span class="p">[</span><span class="n">y</span><span class="p">]</span>
        <span class="n">labels</span> <span class="o">+=</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
<span class="n">fig</span> <span class="o">=</span> <span class="n">jpi</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">wno</span><span class="p">,</span><span class="n">spec</span><span class="p">,</span><span class="n">plot_width</span><span class="o">=</span><span class="mi">600</span><span class="p">,</span><span class="n">plot_height</span><span class="o">=</span><span class="mi">400</span><span class="p">,</span><span class="n">title</span><span class="o">=</span><span class="s1">&#39;Check to see if the cloud contirbutes!&#39;</span><span class="p">,</span>
                   <span class="n">y_axis_label</span><span class="o">=</span><span class="s1">&#39;Tau~1 Pressure (bars)&#39;</span><span class="p">,</span>
                   <span class="n">y_axis_type</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">,</span><span class="n">x_range</span><span class="o">=</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">5</span><span class="p">],</span>
                     <span class="n">y_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1e2</span><span class="p">,</span><span class="mf">1e-4</span><span class="p">],</span><span class="n">legend</span><span class="o">=</span><span class="n">labels</span><span class="p">)</span>
<span class="n">jpi</span><span class="o">.</span><span class="n">show</span><span class="p">(</span><span class="n">fig</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>Do the minor modulations that you see in your cloudy thermal emission spectrum make sense with there the cloud tau=1 surface is?</p>
<p><strong>Final Exercise:</strong> Return to where we defined the box model. Increase the cloud thickness until you can see it in the contribution plot.</p>
<ol class="arabic simple">
<li><p>What does your spectrum approach in the 100% cloud coverage?</p></li>
<li><p>What spectral features are first made undetectable because of clouds?</p></li>
<li><p>What spectral features are least inhibited by cloud coverage?</p></li>
<li><p>What JWST spectral models in 1-5 micron region are most susceptible to cloud coverage?</p></li>
</ol>
</div>
</div>
<div class="section" id="References">
<h1>References<a class="headerlink" href="#References" title="Permalink to this headline">¶</a></h1>
<p><a class="reference external" href="https://arxiv.org/abs/1006.4702">Guillot, Tristan. “On the radiative equilibrium of irradiated planetary atmospheres.” Astronomy &amp; Astrophysics 520 (2010): A27.</a></p>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../SaganSchool2021/1_Spectroscopy.html" class="btn btn-neutral float-right" title="Intuition Building: Young Planet Spectroscopy" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="../ESO2021/ESO_Tutorial.html" class="btn btn-neutral float-left" title="ESO ATMO 2021 Tutorial: Chemistry and Clouds in Exoplanet Transit Spectroscopy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>