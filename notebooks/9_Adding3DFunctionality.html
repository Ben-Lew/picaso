

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Moving from 1D to 3D Calculations &mdash; picaso 2.2 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script type="text/javascript" src="../_static/jquery.js"></script>
        <script type="text/javascript" src="../_static/underscore.js"></script>
        <script type="text/javascript" src="../_static/doctools.js"></script>
        <script type="text/javascript" src="../_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Opacity Factory" href="9_SwappingOpacities.html" />
    <link rel="prev" title="Spherical Integration in PICASO" href="8_SphericalIntegration.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> picaso
          

          
          </a>

          
            
            
              <div class="version">
                2.2
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../installation.html">Installation</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../tutorials.html">The Tutorials</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#basics-of-reflected-light">Basics of Reflected Light</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#basics-of-transmisison">Basics of Transmisison</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#basics-of-thermal-emission">Basics of Thermal Emission</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#cloud-modeling-with-virga">Cloud Modeling with <cite>Virga</cite></a></li>
<li class="toctree-l2 current"><a class="reference internal" href="../tutorials.html#moving-to-3-dimensions">Moving to 3 Dimensions</a><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="8_SphericalIntegration.html">Non-Zero Phase and Spherical Integration</a></li>
<li class="toctree-l3 current"><a class="current reference internal" href="#">From 1D to 3D</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#Same-procedure-as-normal">Same procedure as normal</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Build-3D-Chemistry-and-PT-Input">Build 3D Chemistry and PT Input</a></li>
<li class="toctree-l4"><a class="reference internal" href="#1)-MIT-GCM">1) MIT GCM</a></li>
<li class="toctree-l4"><a class="reference internal" href="#2)-Building-Generic-Input">2) Building Generic Input</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Create-1D-Thermal-Emission-Spectrum-from-3D-Output">Create 1D Thermal Emission Spectrum from 3D Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Analyze-3D-Output">Analyze 3D Output</a></li>
<li class="toctree-l4"><a class="reference internal" href="#Compare-flux-to-blackbodies">Compare flux to blackbodies</a></li>
<li class="toctree-l4"><a class="reference internal" href="#3D-Map-of-Flux">3D Map of Flux</a></li>
<li class="toctree-l4"><a class="reference internal" href="#More-3D-Mapping-Functions">More 3D Mapping Functions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#opacities-approximatons">Opacities &amp; Approximatons</a></li>
<li class="toctree-l2"><a class="reference internal" href="../tutorials.html#miscellaneous">Miscellaneous</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../picaso.html">The Code</a></li>
<li class="toctree-l1"><a class="reference internal" href="../contribution.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../workshops.html">Workshop Material</a></li>
<li class="toctree-l1"><a class="reference external" href="https://natashabatalha.github.io/picaso_dev">The Derivations</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/natashabatalha/picaso">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://arxiv.org/abs/1904.09355">The Paper</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">picaso</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
          <li><a href="../tutorials.html">Tutorials</a> &raquo;</li>
        
      <li>Moving from 1D to 3D Calculations</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/notebooks/9_Adding3DFunctionality.ipynb.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container,
div.nbinput.container div.prompt,
div.nbinput.container div.input_area,
div.nbinput.container div[class*=highlight],
div.nbinput.container div[class*=highlight] pre,
div.nboutput.container,
div.nboutput.container div.prompt,
div.nboutput.container div.output_area,
div.nboutput.container div[class*=highlight],
div.nboutput.container div[class*=highlight] pre {
    background: none;
    border: none;
    padding: 0 0;
    margin: 0;
    box-shadow: none;
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    min-width: 5ex;
    padding-top: 0.3rem;
    padding-right: 0.3rem;
    text-align: right;
    flex: 0;
}
@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }
}

/* disable scrollbars on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    background: #f5f5f5;
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 0.3rem;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt a.copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
div.rendered_html th {
  font-weight: bold;
}
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><a class="reference external" href="https://github.com/natashabatalha/picaso/tree/master/docs/notebooks/9_Adding3DFunctionality.ipynb">Download full notebook here</a></p>
</div>
<div class="section" id="Moving-from-1D-to-3D-Calculations">
<h1>Moving from 1D to 3D Calculations<a class="headerlink" href="#Moving-from-1D-to-3D-Calculations" title="Permalink to this headline">¶</a></h1>
<p>The biggest difference here is that now we are going to be working with GCM input. Currently, all this functionality is based on the output from the MIT GCM. I have worked with a few GCM groups to write tailored functions. If you are interested, contact a <code class="docutils literal notranslate"><span class="pre">picaso</span></code> code maintainer and we will work with your team.</p>
<p>In any case, in what follows is a description of the input format so that you may replicate the functionality.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s1">&#39;ignore&#39;</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">astropy.units</span> <span class="k">as</span> <span class="nn">u</span>

<span class="c1">#picaso</span>
<span class="kn">from</span> <span class="nn">picaso</span> <span class="kn">import</span> <span class="n">justdoit</span> <span class="k">as</span> <span class="n">jdi</span>
<span class="kn">from</span> <span class="nn">picaso</span> <span class="kn">import</span> <span class="n">justplotit</span> <span class="k">as</span> <span class="n">jpi</span>
<span class="kn">from</span> <span class="nn">picaso</span> <span class="kn">import</span> <span class="n">build_3d_input</span> <span class="k">as</span> <span class="n">threed</span>
<span class="c1">#plotting</span>
<span class="kn">from</span> <span class="nn">bokeh.io</span> <span class="kn">import</span> <span class="n">output_notebook</span>
<span class="kn">from</span> <span class="nn">bokeh.layouts</span> <span class="kn">import</span> <span class="n">row</span>
<span class="n">output_notebook</span><span class="p">()</span>
<span class="kn">from</span> <span class="nn">bokeh.plotting</span> <span class="kn">import</span> <span class="n">show</span>

<span class="kn">import</span> <span class="nn">pickle</span> <span class="k">as</span> <span class="nn">pk</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div class="bk-root">
    <a href="https://bokeh.org" target="_blank" class="bk-logo bk-logo-small bk-logo-notebook"></a>
    <span id="1001">Loading BokehJS ...</span>
</div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="output_javascript"></div>
<script type="text/javascript">
var element = document.currentScript.previousSibling.previousSibling;

(function(root) {
  function now() {
    return new Date();
  }

  var force = true;

  if (typeof root._bokeh_onload_callbacks === "undefined" || force === true) {
    root._bokeh_onload_callbacks = [];
    root._bokeh_is_loading = undefined;
  }

  var JS_MIME_TYPE = 'application/javascript';
  var HTML_MIME_TYPE = 'text/html';
  var EXEC_MIME_TYPE = 'application/vnd.bokehjs_exec.v0+json';
  var CLASS_NAME = 'output_bokeh rendered_html';

  /**
   * Render data to the DOM node
   */
  function render(props, node) {
    var script = document.createElement("script");
    node.appendChild(script);
  }

  /**
   * Handle when an output is cleared or removed
   */
  function handleClearOutput(event, handle) {
    var cell = handle.cell;

    var id = cell.output_area._bokeh_element_id;
    var server_id = cell.output_area._bokeh_server_id;
    // Clean up Bokeh references
    if (id != null && id in Bokeh.index) {
      Bokeh.index[id].model.document.clear();
      delete Bokeh.index[id];
    }

    if (server_id !== undefined) {
      // Clean up Bokeh references
      var cmd = "from bokeh.io.state import curstate; print(curstate().uuid_to_server['" + server_id + "'].get_sessions()[0].document.roots[0]._id)";
      cell.notebook.kernel.execute(cmd, {
        iopub: {
          output: function(msg) {
            var id = msg.content.text.trim();
            if (id in Bokeh.index) {
              Bokeh.index[id].model.document.clear();
              delete Bokeh.index[id];
            }
          }
        }
      });
      // Destroy server and session
      var cmd = "import bokeh.io.notebook as ion; ion.destroy_server('" + server_id + "')";
      cell.notebook.kernel.execute(cmd);
    }
  }

  /**
   * Handle when a new output is added
   */
  function handleAddOutput(event, handle) {
    var output_area = handle.output_area;
    var output = handle.output;

    // limit handleAddOutput to display_data with EXEC_MIME_TYPE content only
    if ((output.output_type != "display_data") || (!output.data.hasOwnProperty(EXEC_MIME_TYPE))) {
      return
    }

    var toinsert = output_area.element.find("." + CLASS_NAME.split(' ')[0]);

    if (output.metadata[EXEC_MIME_TYPE]["id"] !== undefined) {
      toinsert[toinsert.length - 1].firstChild.textContent = output.data[JS_MIME_TYPE];
      // store reference to embed id on output_area
      output_area._bokeh_element_id = output.metadata[EXEC_MIME_TYPE]["id"];
    }
    if (output.metadata[EXEC_MIME_TYPE]["server_id"] !== undefined) {
      var bk_div = document.createElement("div");
      bk_div.innerHTML = output.data[HTML_MIME_TYPE];
      var script_attrs = bk_div.children[0].attributes;
      for (var i = 0; i < script_attrs.length; i++) {
        toinsert[toinsert.length - 1].firstChild.setAttribute(script_attrs[i].name, script_attrs[i].value);
        toinsert[toinsert.length - 1].firstChild.textContent = bk_div.children[0].textContent
      }
      // store reference to server id on output_area
      output_area._bokeh_server_id = output.metadata[EXEC_MIME_TYPE]["server_id"];
    }
  }

  function register_renderer(events, OutputArea) {

    function append_mime(data, metadata, element) {
      // create a DOM node to render to
      var toinsert = this.create_output_subarea(
        metadata,
        CLASS_NAME,
        EXEC_MIME_TYPE
      );
      this.keyboard_manager.register_events(toinsert);
      // Render to node
      var props = {data: data, metadata: metadata[EXEC_MIME_TYPE]};
      render(props, toinsert[toinsert.length - 1]);
      element.append(toinsert);
      return toinsert
    }

    /* Handle when an output is cleared or removed */
    events.on('clear_output.CodeCell', handleClearOutput);
    events.on('delete.Cell', handleClearOutput);

    /* Handle when a new output is added */
    events.on('output_added.OutputArea', handleAddOutput);

    /**
     * Register the mime type and append_mime function with output_area
     */
    OutputArea.prototype.register_mime_type(EXEC_MIME_TYPE, append_mime, {
      /* Is output safe? */
      safe: true,
      /* Index of renderer in `output_area.display_order` */
      index: 0
    });
  }

  // register the mime type if in Jupyter Notebook environment and previously unregistered
  if (root.Jupyter !== undefined) {
    var events = require('base/js/events');
    var OutputArea = require('notebook/js/outputarea').OutputArea;

    if (OutputArea.prototype.mime_types().indexOf(EXEC_MIME_TYPE) == -1) {
      register_renderer(events, OutputArea);
    }
  }


  if (typeof (root._bokeh_timeout) === "undefined" || force === true) {
    root._bokeh_timeout = Date.now() + 5000;
    root._bokeh_failed_load = false;
  }

  var NB_LOAD_WARNING = {'data': {'text/html':
     "<div style='background-color: #fdd'>\n"+
     "<p>\n"+
     "BokehJS does not appear to have successfully loaded. If loading BokehJS from CDN, this \n"+
     "may be due to a slow or bad network connection. Possible fixes:\n"+
     "</p>\n"+
     "<ul>\n"+
     "<li>re-rerun `output_notebook()` to attempt to load from CDN again, or</li>\n"+
     "<li>use INLINE resources instead, as so:</li>\n"+
     "</ul>\n"+
     "<code>\n"+
     "from bokeh.resources import INLINE\n"+
     "output_notebook(resources=INLINE)\n"+
     "</code>\n"+
     "</div>"}};

  function display_loaded() {
    var el = document.getElementById("1001");
    if (el != null) {
      el.textContent = "BokehJS is loading...";
    }
    if (root.Bokeh !== undefined) {
      if (el != null) {
        el.textContent = "BokehJS " + root.Bokeh.version + " successfully loaded.";
      }
    } else if (Date.now() < root._bokeh_timeout) {
      setTimeout(display_loaded, 100)
    }
  }


  function run_callbacks() {
    try {
      root._bokeh_onload_callbacks.forEach(function(callback) {
        if (callback != null)
          callback();
      });
    } finally {
      delete root._bokeh_onload_callbacks
    }
    console.debug("Bokeh: all callbacks have finished");
  }

  function load_libs(css_urls, js_urls, callback) {
    if (css_urls == null) css_urls = [];
    if (js_urls == null) js_urls = [];

    root._bokeh_onload_callbacks.push(callback);
    if (root._bokeh_is_loading > 0) {
      console.debug("Bokeh: BokehJS is being loaded, scheduling callback at", now());
      return null;
    }
    if (js_urls == null || js_urls.length === 0) {
      run_callbacks();
      return null;
    }
    console.debug("Bokeh: BokehJS not loaded, scheduling load and callback at", now());
    root._bokeh_is_loading = css_urls.length + js_urls.length;

    function on_load() {
      root._bokeh_is_loading--;
      if (root._bokeh_is_loading === 0) {
        console.debug("Bokeh: all BokehJS libraries/stylesheets loaded");
        run_callbacks()
      }
    }

    function on_error() {
      console.error("failed to load " + url);
    }

    for (var i = 0; i < css_urls.length; i++) {
      var url = css_urls[i];
      const element = document.createElement("link");
      element.onload = on_load;
      element.onerror = on_error;
      element.rel = "stylesheet";
      element.type = "text/css";
      element.href = url;
      console.debug("Bokeh: injecting link tag for BokehJS stylesheet: ", url);
      document.body.appendChild(element);
    }

    const hashes = {"https://cdn.bokeh.org/bokeh/release/bokeh-2.0.1.min.js": "JpP8FXbgAZLkfur7LiK3j9AGBhHNIvF742meBJrjO2ShJDhCG2I1uVvW+0DUtrmc", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.0.1.min.js": "xZlADit0Q04ISQEdKg2k3L4W9AwQBAuDs9nJL9fM/WwzL1tEU9VPNezOFX0nLEAz", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.0.1.min.js": "4BuPRZkdMKSnj3zoxiNrQ86XgNw0rYmBOxe7nshquXwwcauupgBF2DHLVG1WuZlV", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-2.0.1.min.js": "Dv1SQ87hmDqK6S5OhBf0bCuwAEvL5QYL0PuR/F1SPVhCS/r/abjkbpKDYL2zeM19"};

    for (var i = 0; i < js_urls.length; i++) {
      var url = js_urls[i];
      var element = document.createElement('script');
      element.onload = on_load;
      element.onerror = on_error;
      element.async = false;
      element.src = url;
      if (url in hashes) {
        element.crossOrigin = "anonymous";
        element.integrity = "sha384-" + hashes[url];
      }
      console.debug("Bokeh: injecting script tag for BokehJS library: ", url);
      document.head.appendChild(element);
    }
  };var element = document.getElementById("1001");
  if (element == null) {
    console.error("Bokeh: ERROR: autoload.js configured with elementid '1001' but no matching script tag was found. ")
    return false;
  }

  function inject_raw_css(css) {
    const element = document.createElement("style");
    element.appendChild(document.createTextNode(css));
    document.body.appendChild(element);
  }


  var js_urls = ["https://cdn.bokeh.org/bokeh/release/bokeh-2.0.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-widgets-2.0.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-tables-2.0.1.min.js", "https://cdn.bokeh.org/bokeh/release/bokeh-gl-2.0.1.min.js"];
  var css_urls = [];


  var inline_js = [
    function(Bokeh) {
      Bokeh.set_log_level("info");
    },
    function(Bokeh) {


    }
  ];

  function run_inline_js() {

    if (root.Bokeh !== undefined || force === true) {

    for (var i = 0; i < inline_js.length; i++) {
      inline_js[i].call(root, root.Bokeh);
    }
    if (force === true) {
        display_loaded();
      }} else if (Date.now() < root._bokeh_timeout) {
      setTimeout(run_inline_js, 100);
    } else if (!root._bokeh_failed_load) {
      console.log("Bokeh: BokehJS failed to load within specified timeout.");
      root._bokeh_failed_load = true;
    } else if (force !== true) {
      var cell = $(document.getElementById("1001")).parents('.cell').data().cell;
      cell.output_area.append_execute_result(NB_LOAD_WARNING)
    }

  }

  if (root._bokeh_is_loading === 0) {
    console.debug("Bokeh: BokehJS loaded, going straight to plotting");
    run_inline_js();
  } else {
    load_libs(css_urls, js_urls, function() {
      console.debug("Bokeh: BokehJS plotting callback run at", now());
      run_inline_js();
    });
  }
}(window));
</script></div>
</div>
<div class="section" id="Same-procedure-as-normal">
<h2>Same procedure as normal<a class="headerlink" href="#Same-procedure-as-normal" title="Permalink to this headline">¶</a></h2>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">opacity</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">opannection</span><span class="p">(</span><span class="n">wave_range</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1</span><span class="p">,</span><span class="mf">1.7</span><span class="p">])</span>

<span class="n">start_case</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">inputs</span><span class="p">()</span>

<span class="c1">#phase angle</span>
<span class="n">num_gangle</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">num_tangle</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">phase</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">start_case</span><span class="o">.</span><span class="n">phase_angle</span><span class="p">(</span><span class="n">phase</span><span class="p">,</span><span class="n">num_gangle</span><span class="o">=</span><span class="n">num_gangle</span><span class="p">,</span> <span class="n">num_tangle</span><span class="o">=</span><span class="n">num_tangle</span><span class="p">)</span> <span class="c1">#radians</span>

<span class="c1">#define gravity</span>
<span class="n">start_case</span><span class="o">.</span><span class="n">gravity</span><span class="p">(</span><span class="n">radius</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">radius_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;R_jup&#39;</span><span class="p">),</span> <span class="n">mass</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">mass_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;M_jup&#39;</span><span class="p">))</span> <span class="c1">#any astropy units available</span>

<span class="c1">#define star</span>
<span class="n">start_case</span><span class="o">.</span><span class="n">star</span><span class="p">(</span><span class="n">opacity</span><span class="p">,</span><span class="mi">5000</span><span class="p">,</span><span class="mi">0</span><span class="p">,</span><span class="mf">4.0</span><span class="p">,</span> <span class="n">radius</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">radius_unit</span><span class="o">=</span><span class="n">u</span><span class="o">.</span><span class="n">Unit</span><span class="p">(</span><span class="s1">&#39;R_sun&#39;</span><span class="p">))</span> <span class="c1">#pysynphot database, temp, metallicity, logg</span>

</pre></div>
</div>
</div>
</div>
<div class="section" id="Build-3D-Chemistry-and-PT-Input">
<h2>Build 3D Chemistry and PT Input<a class="headerlink" href="#Build-3D-Chemistry-and-PT-Input" title="Permalink to this headline">¶</a></h2>
<p>The biggest complication with moving to 3D is making sure that the latitude/longitude grids of some users GCM and <code class="docutils literal notranslate"><span class="pre">picaso</span></code> line up properly. <code class="docutils literal notranslate"><span class="pre">picaso</span></code> computes a flux integration on specific <code class="docutils literal notranslate"><span class="pre">gauss</span></code> and <code class="docutils literal notranslate"><span class="pre">chebychev</span></code> angles. Meaning, your GCM input will need to be regridded to fit our angles. Our prebuilt function, <code class="docutils literal notranslate"><span class="pre">picaso.build_3d_input.rebin_mitgcm_pt</span></code>, uses <code class="docutils literal notranslate"><span class="pre">scipy.spatial.cKDTree</span></code> to do rebinning. If you want to hack our methodology <a class="reference external" href="https://github.com/natashabatalha/picaso/blob/master/picaso/build_3d_input.py">this is the function you are
after</a>.</p>
</div>
<div class="section" id="1)-MIT-GCM">
<h2>1) MIT GCM<a class="headerlink" href="#1)-MIT-GCM" title="Permalink to this headline">¶</a></h2>
<p>The MIT GCM file is formated as such:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">longitude1</span> <span class="n">latitude1</span>
<span class="n">p1</span> <span class="n">t1</span> <span class="n">kzz1</span>
<span class="n">p2</span> <span class="n">t2</span> <span class="n">kzz2</span>
<span class="o">..</span>
<span class="n">longitude1</span> <span class="n">latitude2</span>
<span class="n">p1</span> <span class="n">t1</span> <span class="n">kzz1</span>
<span class="n">p2</span> <span class="n">t2</span> <span class="n">kzz2</span>
<span class="o">..</span>
<span class="n">longitude1</span> <span class="n">latitudeN</span>
<span class="n">p1</span> <span class="n">t1</span> <span class="n">kzz1</span>
<span class="n">p2</span> <span class="n">t2</span> <span class="n">kzz2</span>
<span class="o">..</span>
<span class="n">longitudeM</span> <span class="n">latitudeN</span>
</pre></div>
</div>
<p>If your file is structured like this then you can use <code class="docutils literal notranslate"><span class="pre">picaso.build_3d_input.rebin_mitgcm_pt</span></code> directly. If not, below I will teach you how to build the input from scratch.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#define output file</span>
<span class="n">outfile</span> <span class="o">=</span> <span class="s1">&#39;HAT1.pk&#39;</span>


<span class="n">threed</span><span class="o">.</span><span class="n">rebin_mitgcm_pt</span><span class="p">(</span><span class="n">num_gangle</span><span class="p">,</span><span class="n">num_tangle</span><span class="p">,</span><span class="c1">#here we define the num_gangles, and num_tangles</span>
                       <span class="n">phase</span><span class="p">,</span>                <span class="c1">#and phase exactly as above.</span>
                       <span class="n">jdi</span><span class="o">.</span><span class="n">HJ_pt_3d</span><span class="p">(),</span> <span class="c1">#insert your input file here</span>
                       <span class="n">outfile</span><span class="p">,</span> <span class="c1">#define your output file</span>
                       <span class="n">p_unit</span><span class="o">=</span><span class="s1">&#39;bar&#39;</span><span class="p">,</span> <span class="c1">#specify your pressure units</span>
                       <span class="n">run_chem</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1">#tell picaso if you want to add post processed chemistry</span>
                       <span class="n">MH</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="n">CtoO</span><span class="o">=</span><span class="mf">0.55</span><span class="p">)</span> <span class="c1">#If so, specify metallicity and c/o (see further note below)</span>

<span class="n">start_case</span><span class="o">.</span><span class="n">atmosphere_3d</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">outfile</span><span class="p">)</span><span class="c1">#add file to atmosphere. `atmosphere_3d` only works with dictionaries</span>
<span class="c1">#that are in the proper format OR a `pickle` file of the dictionary.</span>
</pre></div>
</div>
</div>
<p><strong>Note about run_chem. The correct thing to do is to grab the full atmospheric chemical composition from the GCM output. If for whatever reason that is not available, you can set ``run_chem`` to True and it will compute the chemical equilibrium calculation for you.</strong></p>
</div>
<div class="section" id="2)-Building-Generic-Input">
<h2>2) Building Generic Input<a class="headerlink" href="#2)-Building-Generic-Input" title="Permalink to this headline">¶</a></h2>
<p>Below is an aside that shows the generic methodology of how you would build your 3D input file.</p>
<div class="section" id="1)-Get-required-latitude/longitudes">
<h3>1) Get required latitude/longitudes<a class="headerlink" href="#1)-Get-required-latitude/longitudes" title="Permalink to this headline">¶</a></h3>
<p>Convert latitudes and longitudes to degress and turn into integer values.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">lats</span> <span class="o">=</span> <span class="p">(</span><span class="n">start_case</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;disco&#39;</span><span class="p">][</span><span class="s1">&#39;latitude&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
<span class="n">lons</span> <span class="o">=</span> <span class="p">(</span><span class="n">start_case</span><span class="o">.</span><span class="n">inputs</span><span class="p">[</span><span class="s1">&#39;disco&#39;</span><span class="p">][</span><span class="s1">&#39;longitude&#39;</span><span class="p">]</span><span class="o">*</span><span class="mi">180</span><span class="o">/</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">int</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="2)-Build-dictionary-to-be-used-by-3D-picaso">
<h3>2) Build dictionary to be used by 3D <code class="docutils literal notranslate"><span class="pre">picaso</span></code><a class="headerlink" href="#2)-Build-dictionary-to-be-used-by-3D-picaso" title="Permalink to this headline">¶</a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">dict_3d</span> <span class="o">=</span> <span class="p">{</span><span class="n">la</span><span class="p">:</span> <span class="p">{</span><span class="n">lo</span> <span class="p">:</span> <span class="p">[]</span> <span class="k">for</span> <span class="n">lo</span> <span class="ow">in</span> <span class="n">lons</span><span class="p">}</span> <span class="k">for</span> <span class="n">la</span> <span class="ow">in</span> <span class="n">lats</span><span class="p">}</span> <span class="c1">#build empty one</span>
<span class="n">dict_3d</span><span class="p">[</span><span class="s1">&#39;phase_angle&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="mi">0</span> <span class="c1">#I required that phase angle be put in the dictionary. This because</span>
<span class="c1">#all too often people take a 3d file they&#39;ve binned for one phase angle, and use it on another phase angle.</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="3)-Fill-dictionary-with-regridded-GCM-output">
<h3>3) Fill dictionary with regridded GCM output<a class="headerlink" href="#3)-Fill-dictionary-with-regridded-GCM-output" title="Permalink to this headline">¶</a></h3>
<p>We use dictionaries as opposed to matrices so that there is never any confusion with what PT-composition data bundle is paired with what latitude longitude point. This also allows you to go back to your output file and check what points were run, what phase angle was used.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="k">for</span> <span class="n">ilat</span> <span class="ow">in</span> <span class="n">lats</span><span class="p">:</span>
    <span class="k">for</span> <span class="n">ilon</span> <span class="ow">in</span> <span class="n">lons</span><span class="p">:</span>
        <span class="c1">#EXAMPLE ONLY!!!!</span>
        <span class="n">dict_3d</span><span class="p">[</span><span class="n">ilat</span><span class="p">][</span><span class="n">ilon</span><span class="p">]</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;pressure&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">52</span><span class="p">),</span>
                                                  <span class="s1">&#39;temperature&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">52</span><span class="p">)</span><span class="o">*</span><span class="mi">0</span><span class="o">+</span><span class="mi">1000</span><span class="p">,</span><span class="c1">#filler values</span>
                                                  <span class="s1">&#39;H2O&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">52</span><span class="p">)</span><span class="o">*</span><span class="mi">0</span><span class="o">+</span><span class="mf">0.1</span><span class="p">,</span><span class="c1">#your GCM</span>
                                                  <span class="s1">&#39;H2&#39;</span> <span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">52</span><span class="p">)</span><span class="o">*</span><span class="mi">0</span><span class="o">+</span><span class="mf">0.70</span><span class="p">,</span> <span class="c1">#input will go</span>
                                                  <span class="s1">&#39;He&#39;</span><span class="p">:</span><span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">52</span><span class="p">)</span><span class="o">*</span><span class="mi">0</span><span class="o">+</span><span class="mf">0.29</span><span class="p">})</span> <span class="c1">#here</span>

<span class="c1">#this is just an example. But, once you fill out this dict with yoru 3D input you can directly put it into</span>
<span class="c1">#picaso:</span>
<span class="c1">#start_case.atmosphere_3d(dictionary=dict_3d)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="Create-1D-Thermal-Emission-Spectrum-from-3D-Output">
<h2>Create 1D Thermal Emission Spectrum from 3D Output<a class="headerlink" href="#Create-1D-Thermal-Emission-Spectrum-from-3D-Output" title="Permalink to this headline">¶</a></h2>
<p>Let’s create our first spectrum of HAT 1’s thermal emission</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#only difference is we need to speciy 3d</span>
<span class="n">out</span> <span class="o">=</span> <span class="n">start_case</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">opacity</span><span class="p">,</span><span class="n">dimension</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">,</span><span class="n">calculation</span><span class="o">=</span><span class="s1">&#39;thermal&#39;</span><span class="p">,</span><span class="n">full_output</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

</pre></div>
</div>
</div>
<p><strong>NOTE</strong> You can just as well use <code class="docutils literal notranslate"><span class="pre">calculation='reflected'</span></code>. I just chose this as an example.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#same old same old</span>
<span class="n">wno</span><span class="p">,</span><span class="n">fpfs</span> <span class="o">=</span> <span class="n">jdi</span><span class="o">.</span><span class="n">mean_regrid</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;wavenumber&#39;</span><span class="p">],</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;fpfs_thermal&#39;</span><span class="p">],</span><span class="n">R</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">show</span><span class="p">(</span><span class="n">jpi</span><span class="o">.</span><span class="n">spectrum</span><span class="p">(</span><span class="n">wno</span><span class="p">,</span> <span class="n">fpfs</span><span class="o">*</span><span class="mf">1e6</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span><span class="n">y_axis_type</span><span class="o">=</span><span class="s1">&#39;log&#39;</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div class="bk-root" id="8317fea6-7cca-4642-a097-a7d8ba17e3fb" data-root-id="1295"></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="output_javascript"></div>
<script type="text/javascript">
var element = document.currentScript.previousSibling.previousSibling;
(function(root) {
  function embed_document(root) {

  var docs_json = {"575c7037-e500-4e8d-b74b-26fb959d7084":{"roots":{"references":[{"attributes":{"below":[{"id":"1304"}],"center":[{"id":"1307"},{"id":"1311"}],"left":[{"id":"1308"}],"plot_height":345,"plot_width":500,"renderers":[{"id":"1329"}],"title":{"id":"1354"},"toolbar":{"id":"1319"},"x_range":{"id":"1296"},"x_scale":{"id":"1300"},"y_range":{"id":"1298"},"y_scale":{"id":"1302"}},"id":"1295","subtype":"Figure","type":"Plot"},{"attributes":{"data":{"x":{"__ndarray__":"UQxxXDcx+z/WE8lO8+v6P09FWLFfp/o/5UWvwnpj+j8Rj9fFQiD6P3UKSAK23fk/q8rZw9Kb+T/Z4Lxal1r5P7BObRsCGvk/mBSoXhHa+D+2W2CBw5r4P5e7tOQWXPg/KJvk7Qke+D+4rEUGm+D3P8qEOZvIo/c/bksjHpFn9z/Qh10E8yv3P9IFMMfs8PY/XtXF43y29j8pYyPboXz2P8WqHDJaQ/Y/l4FLcaQK9j+S+gUlf9L1P2ziVN3omvU/ElTqLeBj9T8QZRiuYy31P8npx/hx9/Q/LFFvrAnC9D+wlwlrKY30P2ZRDdrPWPQ/3Mpjovsk9D+PQGBwq/HzP9Ast/PdvvM/u6t135GM8z8q9fjpxVrzP1vs5cx4KfM/EcUgRan48j8CvsQSVsjyP1fwG/l9mPI//zOXvh9p8j+7GMYsOjryP4zzThDMC/I/aADnONTd8T/4l0p5UbDxPw==","dtype":"float64","shape":[44]},"y":{"__ndarray__":"SM4SCX+EX0DcotG0/zxgQPvSUFCt6V5ARjc4RknrXUAfToIm2q9bQEn+VJlFbVpA8nxDLmuSV0BqcWeOnUBVQDSbDF5DmVJADAr7fu4KUEC2YqiEQX5JQClQNAPNPEZAfDmkyjiDRECODLYY33hCQDwaRcty3D5Ad7qvOmL+O0BGSw4KIyY6QG6BN9yAazVAGA1MfMxeM0ActKtIl9szQGtqQT2AJzVA+aM66jbjMkAxoN4aSE0yQJiwSoGdlTNAQjArXLlOO0DVLK1kT4xOQOP9Gd9+61BAPxZNXx/wUUD0uHD3I3pSQDbTQNtMeVJADi9nox0hUUCf5dJ75QhOQL9IcNT3pE1Az53CtZN2SUCT1OnhQ6pGQM8R6YujqkJA9TC6u1xeP0AyguHQ5WA4QFExQnbMPDpAgp9460g5OUA93LQGfj81QPq8wIZ9LTlAdG6sB9J6N0DO5Et8Wds5QA==","dtype":"float64","shape":[44]}},"selected":{"id":"1360"},"selection_policy":{"id":"1361"}},"id":"1326","type":"ColumnDataSource"},{"attributes":{"num_minor_ticks":10},"id":"1309","type":"LogTicker"},{"attributes":{"bottom_units":"screen","fill_alpha":0.5,"fill_color":"lightgrey","left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"render_mode":"css","right_units":"screen","top_units":"screen"},"id":"1318","type":"BoxAnnotation"},{"attributes":{},"id":"1361","type":"UnionRenderers"},{"attributes":{},"id":"1316","type":"ResetTool"},{"attributes":{},"id":"1315","type":"SaveTool"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","tools":[{"id":"1312"},{"id":"1313"},{"id":"1314"},{"id":"1315"},{"id":"1316"},{"id":"1317"}]},"id":"1319","type":"Toolbar"},{"attributes":{"overlay":{"id":"1318"}},"id":"1314","type":"BoxZoomTool"},{"attributes":{"line_alpha":0.1,"line_color":"#0072B2","line_width":3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1328","type":"Line"},{"attributes":{"axis_label":"Spectrum","axis_label_text_font":"times","axis_label_text_font_size":"14pt","axis_label_text_font_style":"bold","formatter":{"id":"1358"},"major_label_text_font":"times","major_label_text_font_size":"14pt","ticker":{"id":"1309"}},"id":"1308","type":"LogAxis"},{"attributes":{},"id":"1300","type":"LinearScale"},{"attributes":{},"id":"1356","type":"BasicTickFormatter"},{"attributes":{},"id":"1302","type":"LogScale"},{"attributes":{"axis":{"id":"1308"},"dimension":1,"ticker":null},"id":"1311","type":"Grid"},{"attributes":{"ticker":null},"id":"1358","type":"LogTickFormatter"},{"attributes":{},"id":"1317","type":"HelpTool"},{"attributes":{},"id":"1298","type":"DataRange1d"},{"attributes":{"axis_label":"Wavelength [\u03bcm]","axis_label_text_font":"times","axis_label_text_font_size":"14pt","axis_label_text_font_style":"bold","formatter":{"id":"1356"},"major_label_text_font":"times","major_label_text_font_size":"14pt","ticker":{"id":"1305"}},"id":"1304","type":"LinearAxis"},{"attributes":{},"id":"1305","type":"BasicTicker"},{"attributes":{"line_color":"#0072B2","line_width":3,"x":{"field":"x"},"y":{"field":"y"}},"id":"1327","type":"Line"},{"attributes":{},"id":"1312","type":"PanTool"},{"attributes":{"source":{"id":"1326"}},"id":"1330","type":"CDSView"},{"attributes":{"text":""},"id":"1354","type":"Title"},{"attributes":{"data_source":{"id":"1326"},"glyph":{"id":"1327"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1328"},"selection_glyph":null,"view":{"id":"1330"}},"id":"1329","type":"GlyphRenderer"},{"attributes":{},"id":"1296","type":"DataRange1d"},{"attributes":{},"id":"1360","type":"Selection"},{"attributes":{},"id":"1313","type":"WheelZoomTool"},{"attributes":{"axis":{"id":"1304"},"ticker":null},"id":"1307","type":"Grid"}],"root_ids":["1295"]},"title":"Bokeh Application","version":"2.0.1"}};
  var render_items = [{"docid":"575c7037-e500-4e8d-b74b-26fb959d7084","root_ids":["1295"],"roots":{"1295":"8317fea6-7cca-4642-a097-a7d8ba17e3fb"}}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);

  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);
</script></div>
</div>
</div>
<div class="section" id="Analyze-3D-Output">
<h2>Analyze 3D Output<a class="headerlink" href="#Analyze-3D-Output" title="Permalink to this headline">¶</a></h2>
<p>Some of the functionality you will recognize from other tutorials (e.g. the thermal emission tutorial). The only difference is that you will need to add <code class="docutils literal notranslate"><span class="pre">ng</span></code> and <code class="docutils literal notranslate"><span class="pre">nt</span></code> to specify which facet you want to look at.</p>
</div>
<div class="section" id="Compare-flux-to-blackbodies">
<h2>Compare flux to blackbodies<a class="headerlink" href="#Compare-flux-to-blackbodies" title="Permalink to this headline">¶</a></h2>
<p>This is the same plot as was in the 1D Thermal Emission tutorial. However, we again have to specify the <code class="docutils literal notranslate"><span class="pre">ng</span></code> and <code class="docutils literal notranslate"><span class="pre">nt</span></code> angles that we are looking at.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">show</span><span class="p">(</span><span class="n">jpi</span><span class="o">.</span><span class="n">flux_at_top</span><span class="p">(</span><span class="n">out</span> <span class="p">,</span>
                     <span class="n">pressures</span> <span class="o">=</span> <span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mf">1e-1</span><span class="p">],</span>
                     <span class="n">ng</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">nt</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="n">R</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span>
                     <span class="n">plot_height</span><span class="o">=</span><span class="mi">500</span><span class="p">,</span> <span class="n">plot_width</span><span class="o">=</span><span class="mi">500</span><span class="p">))</span><span class="c1">#note the addition of ng and nt</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<div class="bk-root" id="48b073fc-e920-4283-8da9-58433d445e85" data-root-id="1101"></div></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="output_javascript"></div>
<script type="text/javascript">
var element = document.currentScript.previousSibling.previousSibling;
(function(root) {
  function embed_document(root) {

  var docs_json = {"7bc67d6d-ccbc-4369-b667-831eae03ca66":{"roots":{"references":[{"attributes":{"below":[{"id":"1112"}],"center":[{"id":"1115"},{"id":"1119"},{"id":"1152"}],"left":[{"id":"1116"}],"plot_height":500,"plot_width":500,"renderers":[{"id":"1137"},{"id":"1142"},{"id":"1157"},{"id":"1173"}],"title":{"id":"1102"},"toolbar":{"id":"1127"},"x_range":{"id":"1104"},"x_scale":{"id":"1108"},"y_range":{"id":"1106"},"y_scale":{"id":"1110"}},"id":"1101","subtype":"Figure","type":"Plot"},{"attributes":{"data_source":{"id":"1154"},"glyph":{"id":"1155"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1156"},"selection_glyph":null,"view":{"id":"1158"}},"id":"1157","type":"GlyphRenderer"},{"attributes":{"num_minor_ticks":10},"id":"1113","type":"LogTicker"},{"attributes":{"overlay":{"id":"1126"}},"id":"1122","type":"BoxZoomTool"},{"attributes":{},"id":"1121","type":"WheelZoomTool"},{"attributes":{},"id":"1120","type":"PanTool"},{"attributes":{"line_alpha":0.5,"line_color":"#B53679","line_width":4,"x":{"field":"x"},"y":{"field":"y"}},"id":"1155","type":"Line"},{"attributes":{"num_minor_ticks":10},"id":"1117","type":"LogTicker"},{"attributes":{"line_alpha":0.1,"line_width":4,"x":{"field":"x"},"y":{"field":"y"}},"id":"1136","type":"Line"},{"attributes":{},"id":"1125","type":"HelpTool"},{"attributes":{},"id":"1104","type":"DataRange1d"},{"attributes":{"ticker":null},"id":"1147","type":"LogTickFormatter"},{"attributes":{"source":{"id":"1134"}},"id":"1138","type":"CDSView"},{"attributes":{"label":{"value":"1257 K at 0.1 bars"},"renderers":[{"id":"1173"}]},"id":"1187","type":"LegendItem"},{"attributes":{},"id":"1106","type":"DataRange1d"},{"attributes":{},"id":"1123","type":"SaveTool"},{"attributes":{},"id":"1208","type":"Selection"},{"attributes":{"data_source":{"id":"1139"},"glyph":{"id":"1140"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1141"},"selection_glyph":null,"view":{"id":"1143"}},"id":"1142","type":"GlyphRenderer"},{"attributes":{},"id":"1124","type":"ResetTool"},{"attributes":{},"id":"1184","type":"Selection"},{"attributes":{"line_width":4,"x":{"field":"x"},"y":{"field":"y"}},"id":"1135","type":"Line"},{"attributes":{"data":{"x":{"__ndarray__":"UQxxXDcx+z/WE8lO8+v6P09FWLFfp/o/5UWvwnpj+j8Rj9fFQiD6P3UKSAK23fk/q8rZw9Kb+T/Z4Lxal1r5P7BObRsCGvk/mBSoXhHa+D+2W2CBw5r4P5e7tOQWXPg/KJvk7Qke+D+4rEUGm+D3P8qEOZvIo/c/bksjHpFn9z/Qh10E8yv3P9IFMMfs8PY/XtXF43y29j8pYyPboXz2P8WqHDJaQ/Y/l4FLcaQK9j+S+gUlf9L1P2ziVN3omvU/ElTqLeBj9T8QZRiuYy31P8npx/hx9/Q/LFFvrAnC9D+wlwlrKY30P2ZRDdrPWPQ/3Mpjovsk9D+PQGBwq/HzP9Ast/PdvvM/u6t135GM8z8q9fjpxVrzP1vs5cx4KfM/EcUgRan48j8CvsQSVsjyP1fwG/l9mPI//zOXvh9p8j+7GMYsOjryP4zzThDMC/I/aADnONTd8T/4l0p5UbDxPw==","dtype":"float64","shape":[44]},"y":{"__ndarray__":"GjMD7SOZgULH+Sb6oaOBQnCaxWESrIFCokMhK2yygUKEw64Dp7aBQsDkdke7uIFCi+Y7CaK4gUIfDloaVbaBQso+WhLPsYFCZn8tVgurgUIUWAgfBqKBQlIC1YC8loFCyIAzcCyJgULL2/7HVHmBQmDyTk41Z4FCgZDuuM5SgUKAyD2xIjyBQubmeNczI4FCvMBcxQUIgUJPjiEQneqAQukHxkn/yoBCRgWlATOpgELDfFDEP4WAQtNjrRouX4BCUqRMiAc3gEK5Fv6I1gyAQqVvNhtNwX9C7kAQ8Adlf0JjPdQs+AR/QlpfKDs6oX5CaQFVRew5fkLWE/4nLs99QnKLVGIhYX1CIfbHBOnvfELhC0KeqXt8QmP99yeJBHxCrCff766Ke0Jet9SBQw57QqyeiY9wj3pCVA5G12AOekLZX5kJQIt5QmALDa46BnlCaNnyBn5/eEJ+/2f0N/d3Qg==","dtype":"float64","shape":[44]}},"selected":{"id":"1166"},"selection_policy":{"id":"1167"}},"id":"1139","type":"ColumnDataSource"},{"attributes":{},"id":"1149","type":"Selection"},{"attributes":{"text":"Outgoing Thermal Radiation"},"id":"1102","type":"Title"},{"attributes":{"source":{"id":"1170"}},"id":"1174","type":"CDSView"},{"attributes":{"axis":{"id":"1112"},"ticker":null},"id":"1115","type":"Grid"},{"attributes":{"items":[{"id":"1153"},{"id":"1169"},{"id":"1187"}]},"id":"1152","type":"Legend"},{"attributes":{"label":{"value":"1591 K at 1 bars"},"renderers":[{"id":"1157"}]},"id":"1169","type":"LegendItem"},{"attributes":{"ticker":null},"id":"1145","type":"LogTickFormatter"},{"attributes":{"data_source":{"id":"1134"},"glyph":{"id":"1135"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1136"},"selection_glyph":null,"view":{"id":"1138"}},"id":"1137","type":"GlyphRenderer"},{"attributes":{"active_drag":"auto","active_inspect":"auto","active_multi":null,"active_scroll":"auto","active_tap":"auto","tools":[{"id":"1120"},{"id":"1121"},{"id":"1122"},{"id":"1123"},{"id":"1124"},{"id":"1125"}]},"id":"1127","type":"Toolbar"},{"attributes":{},"id":"1166","type":"Selection"},{"attributes":{"axis_label":"Flux (erg/s/cm^3)","formatter":{"id":"1147"},"ticker":{"id":"1117"}},"id":"1116","type":"LogAxis"},{"attributes":{"data":{"x":{"__ndarray__":"UQxxXDcx+z/WE8lO8+v6P09FWLFfp/o/5UWvwnpj+j8Rj9fFQiD6P3UKSAK23fk/q8rZw9Kb+T/Z4Lxal1r5P7BObRsCGvk/mBSoXhHa+D+2W2CBw5r4P5e7tOQWXPg/KJvk7Qke+D+4rEUGm+D3P8qEOZvIo/c/bksjHpFn9z/Qh10E8yv3P9IFMMfs8PY/XtXF43y29j8pYyPboXz2P8WqHDJaQ/Y/l4FLcaQK9j+S+gUlf9L1P2ziVN3omvU/ElTqLeBj9T8QZRiuYy31P8npx/hx9/Q/LFFvrAnC9D+wlwlrKY30P2ZRDdrPWPQ/3Mpjovsk9D+PQGBwq/HzP9Ast/PdvvM/u6t135GM8z8q9fjpxVrzP1vs5cx4KfM/EcUgRan48j8CvsQSVsjyP1fwG/l9mPI//zOXvh9p8j+7GMYsOjryP4zzThDMC/I/aADnONTd8T/4l0p5UbDxPw==","dtype":"float64","shape":[44]},"y":{"__ndarray__":"uQGjm+LjckKjnBRY79FyQqSptpSGvXJCRV9wcammckIoFi8WWo1yQn5ZMrabcXJC5OmlknJTckKpjIL84zJyQmERr1X2D3JCtZRbEbHqcUKUs5GzHMNxQkoX9c9CmXFChIiwBy5tcUKBhYwG6j5xQrQxLX+DDnFCr1h2JgjccEKuKxWuhqdwQktUML4OcXBCA/M/7rA4cEJPQCB6/fxvQv0V4w8VhW9CW7I5As8Jb0J15JxKU4tuQqbSQmHLCW5CSH5iJWKFbUK8bRbEQ/5sQpLt8Z2ddGxCOEZeK57oa0LdHdffdFprQrgCHwxSympCz8mGv2Y4akJi/WOo5KRpQkoL1PP9D2lC7DLrLOV5aEL6X28bzeJnQq4iQKLoSmdCTNCNnWqyZkLOhALBhRlmQo88AHZsgGVCHYsXulDnZEK7j9r9Y05kQq6xLwTXtWNC72BHwtkdY0JPmVdAm4ZiQg==","dtype":"float64","shape":[44]}},"selected":{"id":"1184"},"selection_policy":{"id":"1185"}},"id":"1154","type":"ColumnDataSource"},{"attributes":{},"id":"1150","type":"UnionRenderers"},{"attributes":{},"id":"1209","type":"UnionRenderers"},{"attributes":{"label":{"value":"1800 K at 10 bars"},"renderers":[{"id":"1142"}]},"id":"1153","type":"LegendItem"},{"attributes":{"axis_label":"Wavelength [\u03bcm]","formatter":{"id":"1145"},"ticker":{"id":"1113"}},"id":"1112","type":"LogAxis"},{"attributes":{"line_alpha":0.1,"line_color":"#FBFCBF","line_width":4,"x":{"field":"x"},"y":{"field":"y"}},"id":"1172","type":"Line"},{"attributes":{"line_alpha":0.1,"line_color":"#B53679","line_width":4,"x":{"field":"x"},"y":{"field":"y"}},"id":"1156","type":"Line"},{"attributes":{"bottom_units":"screen","fill_alpha":0.5,"fill_color":"lightgrey","left_units":"screen","level":"overlay","line_alpha":1.0,"line_color":"black","line_dash":[4,4],"line_width":2,"render_mode":"css","right_units":"screen","top_units":"screen"},"id":"1126","type":"BoxAnnotation"},{"attributes":{"axis":{"id":"1116"},"dimension":1,"ticker":null},"id":"1119","type":"Grid"},{"attributes":{"source":{"id":"1154"}},"id":"1158","type":"CDSView"},{"attributes":{"source":{"id":"1139"}},"id":"1143","type":"CDSView"},{"attributes":{"data":{"x":{"__ndarray__":"UQxxXDcx+z/WE8lO8+v6P09FWLFfp/o/5UWvwnpj+j8Rj9fFQiD6P3UKSAK23fk/q8rZw9Kb+T/Z4Lxal1r5P7BObRsCGvk/mBSoXhHa+D+2W2CBw5r4P5e7tOQWXPg/KJvk7Qke+D+4rEUGm+D3P8qEOZvIo/c/bksjHpFn9z/Qh10E8yv3P9IFMMfs8PY/XtXF43y29j8pYyPboXz2P8WqHDJaQ/Y/l4FLcaQK9j+S+gUlf9L1P2ziVN3omvU/ElTqLeBj9T8QZRiuYy31P8npx/hx9/Q/LFFvrAnC9D+wlwlrKY30P2ZRDdrPWPQ/3Mpjovsk9D+PQGBwq/HzP9Ast/PdvvM/u6t135GM8z8q9fjpxVrzP1vs5cx4KfM/EcUgRan48j8CvsQSVsjyP1fwG/l9mPI//zOXvh9p8j+7GMYsOjryP4zzThDMC/I/aADnONTd8T/4l0p5UbDxPw==","dtype":"float64","shape":[44]},"y":{"__ndarray__":"bvSXpoE8bEJZCLZYWFJtQv3kKLhUIW1CG5dG5pPwbEIYZjGrpolrQhpYyTKo0mpC9BYhqJJ0aEKPxLulfAJmQpJt2JyUDGRCvlIKMd65YULnowg1WcdcQkjQ+sIKZFlCR7ZEMMtWV0JYe4oUsZxVQjNurAksRFJCs6nyf/35UEKPYWBBYRpQQoMxxaCK2EpC9NWTxQymSEKZ2ZtFDCFKQicLnRrJk0xCue7/h9b0SUIxxZJPomlJQq/wSy0J2UtCmBNgjm2yU0KTGWZeilNmQmD/jbPALWlCuuDuuTs2a0I+XWObbD5sQpzBRwPIF21CHb9/cytxa0KfDHgb3nZoQkH60oEukGhCbliCuECBZUKxrVe2Yj9jQtKX7Sg7BWBCDWISYvl0W0J0aqC8deNVQmN51F6rvVdCdQV9Mg5iV0LBuiw/OblTQnhsZOyAzFdCs/T/b1CSVkIRrnV7AP5YQg==","dtype":"float64","shape":[44]}},"selected":{"id":"1149"},"selection_policy":{"id":"1150"}},"id":"1134","type":"ColumnDataSource"},{"attributes":{},"id":"1185","type":"UnionRenderers"},{"attributes":{},"id":"1108","type":"LogScale"},{"attributes":{"line_alpha":0.5,"line_color":"#000003","line_width":4,"x":{"field":"x"},"y":{"field":"y"}},"id":"1140","type":"Line"},{"attributes":{"line_alpha":0.1,"line_color":"#000003","line_width":4,"x":{"field":"x"},"y":{"field":"y"}},"id":"1141","type":"Line"},{"attributes":{"line_alpha":0.5,"line_color":"#FBFCBF","line_width":4,"x":{"field":"x"},"y":{"field":"y"}},"id":"1171","type":"Line"},{"attributes":{"data":{"x":{"__ndarray__":"UQxxXDcx+z/WE8lO8+v6P09FWLFfp/o/5UWvwnpj+j8Rj9fFQiD6P3UKSAK23fk/q8rZw9Kb+T/Z4Lxal1r5P7BObRsCGvk/mBSoXhHa+D+2W2CBw5r4P5e7tOQWXPg/KJvk7Qke+D+4rEUGm+D3P8qEOZvIo/c/bksjHpFn9z/Qh10E8yv3P9IFMMfs8PY/XtXF43y29j8pYyPboXz2P8WqHDJaQ/Y/l4FLcaQK9j+S+gUlf9L1P2ziVN3omvU/ElTqLeBj9T8QZRiuYy31P8npx/hx9/Q/LFFvrAnC9D+wlwlrKY30P2ZRDdrPWPQ/3Mpjovsk9D+PQGBwq/HzP9Ast/PdvvM/u6t135GM8z8q9fjpxVrzP1vs5cx4KfM/EcUgRan48j8CvsQSVsjyP1fwG/l9mPI//zOXvh9p8j+7GMYsOjryP4zzThDMC/I/aADnONTd8T/4l0p5UbDxPw==","dtype":"float64","shape":[44]},"y":{"__ndarray__":"PvaX3fdXUkKst8rSbwVSQkFs3pBLsVFCxMF5b6dbUUKxAEBpoARRQglcvAlUrFBCP2OzWuBSUELuG9ehx/BPQruO/XD6OU9Cj2+PQZeBTkLZn/yP3MdNQsGILw0JDU1CZXT9dFtRTEK7vHFkEpVLQtj4HjBs2EpCQc2huqYbSkJTQ4FL/15JQm6MmGayokhCEdU1pPvmR0I5SxmKFSxHQte7fmU5ckZC0iVbJp+5RUIEX/Y7fQJFQl5mB3MITURC9Tp41XOZQ0LWFvSL8OdCQny0YMGtOEJCCdxgiNiLQUIs1vvCm+FAQueVggwgOkBCJuaQSxcrP0LdZYTHBOg9Qne8NUFLqzxCkhiVXih1O0KFuW+j1EU6Qtm60mKDHTlCxSSRtWL8N0K6n+l1m+I2Qm0cQUBR0DVCIs7geKLFNELW/Z5WqMIzQhaYU/J2xzJCEefyWh3UMUJbxiKupegwQg==","dtype":"float64","shape":[44]}},"selected":{"id":"1208"},"selection_policy":{"id":"1209"}},"id":"1170","type":"ColumnDataSource"},{"attributes":{},"id":"1167","type":"UnionRenderers"},{"attributes":{},"id":"1110","type":"LogScale"},{"attributes":{"data_source":{"id":"1170"},"glyph":{"id":"1171"},"hover_glyph":null,"muted_glyph":null,"nonselection_glyph":{"id":"1172"},"selection_glyph":null,"view":{"id":"1174"}},"id":"1173","type":"GlyphRenderer"}],"root_ids":["1101"]},"title":"Bokeh Application","version":"2.0.1"}};
  var render_items = [{"docid":"7bc67d6d-ccbc-4369-b667-831eae03ca66","root_ids":["1101"],"roots":{"1101":"48b073fc-e920-4283-8da9-58433d445e85"}}];
  root.Bokeh.embed.embed_items_notebook(docs_json, render_items);

  }
  if (root.Bokeh !== undefined) {
    embed_document(root);
  } else {
    var attempts = 0;
    var timer = setInterval(function(root) {
      if (root.Bokeh !== undefined) {
        clearInterval(timer);
        embed_document(root);
      } else {
        attempts++;
        if (attempts > 100) {
          clearInterval(timer);
          console.log("Bokeh: ERROR: Unable to run BokehJS code because BokehJS library is missing");
        }
      }
    }, 10, root)
  }
})(window);
</script></div>
</div>
</div>
<div class="section" id="3D-Map-of-Flux">
<h2>3D Map of Flux<a class="headerlink" href="#3D-Map-of-Flux" title="Permalink to this headline">¶</a></h2>
<p>We can use the same plot as we used for reflected light. In 3D this plot is quite a bit more interesting since we can see variations accross the disk from out input file.</p>
<p><strong>Note</strong> below I specify <code class="docutils literal notranslate"><span class="pre">thermal</span></code>. The default is <code class="docutils literal notranslate"><span class="pre">reflected</span></code>, I just chose this as an example.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="n">jpi</span><span class="o">.</span><span class="n">disco</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;full_output&#39;</span><span class="p">]</span> <span class="p">,</span><span class="n">wavelength</span><span class="o">=</span><span class="p">[</span><span class="mf">1.1</span><span class="p">,</span> <span class="mf">1.4</span><span class="p">],</span> <span class="n">calculation</span><span class="o">=</span><span class="s1">&#39;thermal&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_9_Adding3DFunctionality_22_0.png" src="../_images/notebooks_9_Adding3DFunctionality_22_0.png" />
</div>
</div>
</div>
<div class="section" id="More-3D-Mapping-Functions">
<h2>More 3D Mapping Functions<a class="headerlink" href="#More-3D-Mapping-Functions" title="Permalink to this headline">¶</a></h2>
<p>In addition to <code class="docutils literal notranslate"><span class="pre">disco</span></code> there is now a general <code class="docutils literal notranslate"><span class="pre">map</span></code> function that can plot anything in <code class="docutils literal notranslate"><span class="pre">picaso</span></code>’s full output <code class="docutils literal notranslate"><span class="pre">dict</span></code>. Below is an example of the <code class="docutils literal notranslate"><span class="pre">taugas</span></code> where we must specify both a <code class="docutils literal notranslate"><span class="pre">pressure</span></code> and <code class="docutils literal notranslate"><span class="pre">wavelenth</span></code> to plot the map</p>
<div class="section" id="Example-of-Molecular-Opacity-Map">
<h3>Example of Molecular Opacity Map<a class="headerlink" href="#Example-of-Molecular-Opacity-Map" title="Permalink to this headline">¶</a></h3>
<p>When runnint <code class="docutils literal notranslate"><span class="pre">map</span></code> for a 4D (nlevel,nlayer, nwave, nlong, nlat) you can speficy</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Since Taugas is [nlayer, nwave, nlong, nlat] we can specify a list of pressures and a SINGLE wavelength.</span>
<span class="n">jpi</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;full_output&#39;</span><span class="p">],</span><span class="n">plot</span><span class="o">=</span><span class="s1">&#39;taugas&#39;</span><span class="p">,</span><span class="n">pressure</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">1e-3</span><span class="p">],</span><span class="n">wavelength</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_9_Adding3DFunctionality_24_0.png" src="../_images/notebooks_9_Adding3DFunctionality_24_0.png" />
</div>
</div>
</div>
<div class="section" id="Example-of-Temperature-Map">
<h3>Example of Temperature Map<a class="headerlink" href="#Example-of-Temperature-Map" title="Permalink to this headline">¶</a></h3>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#Since temperature is [nlayer, nlong, nlat] we just have to specify a list of pressures</span>

<span class="n">jpi</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;full_output&#39;</span><span class="p">],</span><span class="n">plot</span><span class="o">=</span><span class="s1">&#39;temperature&#39;</span><span class="p">,</span><span class="n">pressure</span><span class="o">=</span><span class="p">[</span><span class="mi">10</span><span class="p">,</span><span class="mf">0.1</span><span class="p">,</span><span class="mf">1e-3</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_9_Adding3DFunctionality_26_0.png" src="../_images/notebooks_9_Adding3DFunctionality_26_0.png" />
</div>
</div>
</div>
<div class="section" id="Example-of-Tau~1-Pressure-Map">
<h3>Example of Tau~1 Pressure Map<a class="headerlink" href="#Example-of-Tau~1-Pressure-Map" title="Permalink to this headline">¶</a></h3>
<p>Here we can break down a full map of the molecular, cloud and rayleigh opacity. Whereas in <code class="docutils literal notranslate"><span class="pre">map</span></code> we had to specify a specific pressure and wavelength, here we can specify an opactical depth and it will produce a map of what pressure level corresponds to that optical depth. We tend to see photons that originate from tau=1. Therefore, it is interesting to plot a tau=1 map so we can see if we are seeing different pressure levels at different locations accross the disk.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre>
<span></span><span class="c1">#This is not a terribly interesting case since the lat/lon variation in abundance is relatively small</span>
<span class="c1">#and we never gave it a specific cloud opacity...</span>
<span class="c1">#BUT, the functionality exists for cases that are more interest :)</span>
<span class="n">jpi</span><span class="o">.</span><span class="n">taumap</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="s1">&#39;full_output&#39;</span><span class="p">],</span> <span class="n">wavelength</span><span class="o">=</span><span class="mf">1.4</span><span class="p">,</span> <span class="n">at_tau</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<img alt="../_images/notebooks_9_Adding3DFunctionality_28_0.png" src="../_images/notebooks_9_Adding3DFunctionality_28_0.png" />
</div>
</div>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="9_SwappingOpacities.html" class="btn btn-neutral float-right" title="Opacity Factory" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="8_SphericalIntegration.html" class="btn btn-neutral float-left" title="Spherical Integration in PICASO" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>