

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Code &mdash; picaso 2.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="SQLITE Tutorial" href="notebooks/11_Sqlite3Tutorial.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> picaso
          

          
          </a>

          
            
            
              <div class="version">
                2.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">The Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://natashabatalha.github.io/picaso_dev">The Derivations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.atmsetup">picaso.atmsetup module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.build_3d_input">picaso.build_3d_input module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.disco">picaso.disco module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.elements">picaso.elements module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.fluxes">picaso.fluxes module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.io_utils">picaso.io_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.justdoit">picaso.justdoit module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.justplotit">picaso.justplotit module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.opacity_factory">picaso.opacity_factory module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.optics">picaso.optics module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.test">picaso.test module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.wavelength">picaso.wavelength module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/natashabatalha/picaso">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://arxiv.org/abs/1904.09355">The Paper</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">picaso</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>The Code</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/picaso.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="the-code">
<h1>The Code<a class="headerlink" href="#the-code" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-picaso.atmsetup">
<span id="picaso-atmsetup-module"></span><h2>picaso.atmsetup module<a class="headerlink" href="#module-picaso.atmsetup" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="picaso.atmsetup.ATMSETUP">
<em class="property">class </em><code class="sig-prename descclassname">picaso.atmsetup.</code><code class="sig-name descname">ATMSETUP</code><span class="sig-paren">(</span><em class="sig-param">config</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Reads in default source configuration from JSON and creates a full atmosphere class.</p>
<ul class="simple">
<li><p>Gets PT profile</p></li>
<li><p>Computes mean molecular weight, density, column density, mixing ratios</p></li>
<li><p>Gets cloud profile</p></li>
<li><p>Gets stellar profile</p></li>
</ul>
<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.add_warnings">
<code class="sig-name descname">add_warnings</code><span class="sig-paren">(</span><em class="sig-param">warn</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.add_warnings" title="Permalink to this definition">¶</a></dt>
<dd><p>Accumulate warnings from ATMSETUP</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.as_dict">
<code class="sig-name descname">as_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get output into picklable dict format</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.calc_PT">
<code class="sig-name descname">calc_PT</code><span class="sig-paren">(</span><em class="sig-param">logPc</em>, <em class="sig-param">T</em>, <em class="sig-param">logKir</em>, <em class="sig-param">logg1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.calc_PT" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates parameterized PT profile from Guillot. This isntance is here
primary for the retrieval scheme, so this can be updated</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> (<em>float</em>) – </p></li>
<li><p><strong>logKir</strong> (<em>float</em>) – </p></li>
<li><p><strong>logg1</strong> (<em>float</em>) – </p></li>
<li><p><strong>logPc</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.disect">
<code class="sig-name descname">disect</code><span class="sig-paren">(</span><em class="sig-param">g</em>, <em class="sig-param">t</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.disect" title="Permalink to this definition">¶</a></dt>
<dd><p>This disects the 3d input to a 1d input which is a function of a single gangle and tangle.
This makes it possible for us to get the opacities at each facet before we go into the
flux calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> (<em>int</em>) – Gauss angle index</p></li>
<li><p><strong>t</strong> (<em>int</em>) – Tchebyshev angle index</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_clouds">
<code class="sig-name descname">get_clouds</code><span class="sig-paren">(</span><em class="sig-param">wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_clouds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get cloud properties from .cld input returned from eddysed. The eddysed file should have the following specifications</p>
<ol class="arabic simple">
<li><p>Have the following column names (any order)  opd g0 w0</p></li>
<li><p>Be white space delimeted</p></li>
<li><p>Has to have values for pressure levels (N) and wwavenumbers (M). The row order should go:</p></li>
</ol>
<p>level wavenumber opd w0 g0
1.       1.   … . .
1.       2.   … . .
1.       3.   … . .
.         .     … . .
.         .     … . .
1.       M.   … . .
2.       1.   … . .
.         .     … . .
N.       .      … . .</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The order of the rows is very important because each column will be transformed
into a matrix that has the size: [nlayer,nwave].</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wno</strong> (<em>array</em>) – Array in ascending order of wavenumbers. This is used to regrid the cloud output</p>
</dd>
</dl>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Take regridding out of here and add it to <cite>justdoit</cite></p></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_column_density">
<code class="sig-name descname">get_column_density</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_column_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the column desntiy based on TP profile: LAYER</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_constants">
<code class="sig-name descname">get_constants</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_constants" title="Permalink to this definition">¶</a></dt>
<dd><p>This function gets all conversion factors based on input units and all
constants. Goal here is to get everything to cgs and make sure we are only
call lengths of things once (e.g. number of wavelength points, number of layers etc)</p>
<p>Some stuff will be added to this in other routines (e.g. number of layers)</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_density">
<code class="sig-name descname">get_density</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates density of atmospheres used on TP profile: LEVEL</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_mmw">
<code class="sig-name descname">get_mmw</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_mmw" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mean molecular weight of the atmosphere</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_needed_continuum">
<code class="sig-name descname">get_needed_continuum</code><span class="sig-paren">(</span><em class="sig-param">available_ray_mol</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_needed_continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>This will define which molecules are needed for the continuum opacities. THis is based on
temperature and molecules. Eventually CIA’s will expand but we may not necessarily
want all of them.
‘wno’,’h2h2’,’h2he’,’h2h’,’h2ch4’,’h2n2’]</p>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Add in temperature dependent to negate h- and things when not necessary</p></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_profile">
<code class="sig-name descname">get_profile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Get profile from file or from user input file or direct pandas dataframe. If PT profile
is not given, use parameterization</p>
<p>Currently only needs inputs from config file</p>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Add regridding to this by having users be able to set a different nlevel than the input cloud code is</p></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_profile_3d">
<code class="sig-name descname">get_profile_3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_profile_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Get profile from file or from user input file or direct pandas dataframe. If PT profile
is not given, use parameterization</p>
<p>Currently only needs inputs from config file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat</strong> (<em>array</em>) – Array of latitudes (radians)</p></li>
<li><p><strong>lon</strong> (<em>array</em>) – Array of longitudes (radians)</p></li>
</ul>
</dd>
</dl>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Add regridding to this by having users be able to set a different nlevel than the input cloud code is</p></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_surf_reflect">
<code class="sig-name descname">get_surf_reflect</code><span class="sig-paren">(</span><em class="sig-param">nwno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_surf_reflect" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the surface reflectivity from input</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_weights">
<code class="sig-name descname">get_weights</code><span class="sig-paren">(</span><em class="sig-param">molecule</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically gets mean molecular weights of any molecule. Requires that
user inputs case sensitive molecules i.e. TiO instead of TIO.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>str</em><em> or </em><em>list</em>) – any molecule string e.g. “H2O”, “CH4” etc “TiO” or [“H2O”, ‘CH4’]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>molecule as keys with molecular weights as value</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-picaso.build_3d_input">
<span id="picaso-build-3d-input-module"></span><h2>picaso.build_3d_input module<a class="headerlink" href="#module-picaso.build_3d_input" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.build_3d_input.lon_lat_to_cartesian">
<code class="sig-prename descclassname">picaso.build_3d_input.</code><code class="sig-name descname">lon_lat_to_cartesian</code><span class="sig-paren">(</span><em class="sig-param">lon</em>, <em class="sig-param">lat</em>, <em class="sig-param">R=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.lon_lat_to_cartesian" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates lon, lat coordinates of a point on a sphere with
radius R</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> (<em>array</em>) – Longitude</p></li>
<li><p><strong>lat</strong> (<em>array</em>) – Latitude</p></li>
<li><p><strong>R</strong> (<em>float</em>) – radius of sphere</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>x, y, z</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.build_3d_input.make_3d_cld_input">
<code class="sig-prename descclassname">picaso.build_3d_input.</code><code class="sig-name descname">make_3d_cld_input</code><span class="sig-paren">(</span><em class="sig-param">ng</em>, <em class="sig-param">nt</em>, <em class="sig-param">phase_angle</em>, <em class="sig-param">input_file</em>, <em class="sig-param">output_file</em>, <em class="sig-param">lat_range=None</em>, <em class="sig-param">lon_range=None</em>, <em class="sig-param">rand_coverage=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.make_3d_cld_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Discontinued
Program to create 3d CLOUD input. Used to feed GCM input into disco ball.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ng</strong> (<em>int</em>) – Number of gauss angles</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – Number of Tchebysehv angles</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>) – Geometry of phase angle</p></li>
<li><p><strong>input_file</strong> (<em>str</em>) – CLD input file you want to create the 3d grid from. Currently takes in a single 1d CLD profile.
Input file must be structured with the following columns in the correct order: [‘lvl’, ‘wv’,’opd’,’g0’,’w0’,’sigma’]
input file</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – Output file location</p></li>
<li><p><strong>lat_range</strong> (<em>list</em>) – (Optional)Range of latitudes to exclude in the CLD file</p></li>
<li><p><strong>lon_range</strong> (<em>list</em>) – (Optional)Range of longitudes to exclud in the CLD file</p></li>
<li><p><strong>rand_coverage</strong> (<em>float</em>) – (Optional)Fractional cloud coverage. rand_cov=1 introduces full cloud coverage. rand_cov=0 has no
coverage.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Key word arguments used for <cite>panads.read_csv</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Creates output file. No other returns.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Basic use of creating a 3D file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phase_angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_gauss_angles</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_tcheby_angles</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phase_angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_file</span><span class="o">=</span><span class="n">jdi</span><span class="o">.</span><span class="n">jupiter_cld</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;jupiter3D.hdf5&#39;</span>
<span class="go">&gt;&gt;&gt;make_3d_pt_input(number_gauss_angles, number_tcheby_angles,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">phase_angle</span><span class="p">,</span> <span class="n">input_file</span><span class="p">,</span><span class="n">output_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="picaso.build_3d_input.make_3d_pt_input">
<code class="sig-prename descclassname">picaso.build_3d_input.</code><code class="sig-name descname">make_3d_pt_input</code><span class="sig-paren">(</span><em class="sig-param">ng</em>, <em class="sig-param">nt</em>, <em class="sig-param">phase_angle</em>, <em class="sig-param">input_file</em>, <em class="sig-param">output_file</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.make_3d_pt_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Discontinued
Program to create 3d PT input. Used to feed GCM input into disco ball.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ng</strong> (<em>int</em>) – Number of gauss angles</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – Number of Tchebysehv angles</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>) – Geometry of phase angle</p></li>
<li><p><strong>input_file</strong> (<em>str</em>) – PT input file you want to create the 3d grid from. Currently takes in a single 1d PT profile.
Must have labeled, whitespace delimeted columns. In the columns, must have <cite>temperature</cite>,
<cite>pressure</cite>, and at least some molecular species (which are ALL case-sensitive)</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – Output file location</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Creates output file. No other returns.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Basic use of creating a 3D file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phase_angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_gauss_angles</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_tcheby_angles</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phase_angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_file</span><span class="o">=</span><span class="n">jdi</span><span class="o">.</span><span class="n">jupiter_pt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;jupiter3D.hdf5&#39;</span>
<span class="go">&gt;&gt;&gt;make_3d_pt_input(number_gauss_angles, number_tcheby_angles,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">phase_angle</span><span class="p">,</span> <span class="n">input_file</span><span class="p">,</span><span class="n">output_file</span><span class="p">)</span>
</pre></div>
</div>
<p>Can also use <cite>**kwargs</cite> to control how pandas reads in input file</p>
<p>&gt;&gt;&gt;make_3d_pt_input(number_gauss_angles, number_tcheby_angles,
&gt;&gt;&gt;         phase_angle, input_file,output_file,usecols=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20,21])</p>
</dd></dl>

<dl class="function">
<dt id="picaso.build_3d_input.rebin_mitgcm_cld">
<code class="sig-prename descclassname">picaso.build_3d_input.</code><code class="sig-name descname">rebin_mitgcm_cld</code><span class="sig-paren">(</span><em class="sig-param">ng, nt, phase_angle, input_file, output_file, names=['i', 'j', 'opd', 'g0', 'w0']</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.rebin_mitgcm_cld" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebin post processed GCM cloud grid to a smaller grid. This function creates a pickle file
that can be directly input into <cite>clouds_3d</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ng</strong> (<em>int</em>) – Number of gauss angles</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – Number of Tchebysehv angles</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>) – Geometry of phase angle (radians)</p></li>
<li><p><strong>input_file</strong> (<em>str</em>) – PT input file you want to create the 3d grid from. Currently takes in a single 1d PT profile.
Must have labeled, whitespace delimeted columns. In the columns, must have <cite>temperature</cite>,
<cite>pressure</cite>, and at least some molecular species (which are ALL case-sensitive)</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – output file location</p></li>
<li><p><strong>names</strong> (<em>list</em><em>,</em><em>str</em><em>,</em><em>optional</em>) – List of names for the post processed file. The Default value is what generallly
comes out of A&amp;M code.. But double check before running!!</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.build_3d_input.rebin_mitgcm_pt">
<code class="sig-prename descclassname">picaso.build_3d_input.</code><code class="sig-name descname">rebin_mitgcm_pt</code><span class="sig-paren">(</span><em class="sig-param">ng</em>, <em class="sig-param">nt</em>, <em class="sig-param">phase_angle</em>, <em class="sig-param">input_file</em>, <em class="sig-param">output_file</em>, <em class="sig-param">p_unit='Pa'</em>, <em class="sig-param">kzz_unit='m*m/s'</em>, <em class="sig-param">run_chem=False</em>, <em class="sig-param">MH=None</em>, <em class="sig-param">CtoO=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.rebin_mitgcm_pt" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebin GCM grid to a smaller grid. This function creates a pickle file
that can be directly input into <cite>atmosphere_3d</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ng</strong> (<em>int</em>) – Number of gauss angles</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – Number of Tchebysehv angles</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>) – Geometry of phase angle (radians)</p></li>
<li><p><strong>input_file</strong> (<em>str</em>) – PT input file you want to create the 3d grid from. Currently takes in a single 1d PT profile.
Must have labeled, whitespace delimeted columns. In the columns, must have <cite>temperature</cite>,
<cite>pressure</cite>, and at least some molecular species (which are ALL case-sensitive)</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – output file location</p></li>
<li><p><strong>p_unit</strong> (<em>str</em><em>,</em><em>optional</em>) – Pressure Unit (default Pascal)</p></li>
<li><p><strong>kzz_unit</strong> (<em>str</em><em>,</em><em>optional</em>) – Kzz Unit (default is m*m/s)</p></li>
<li><p><strong>run_chem</strong> (<em>bool</em><em> , </em><em>optional</em>) – (Optional) runs chemistry and adds to json file</p></li>
<li><p><strong>run_chem</strong> – (Optional) MIT gcm output doesn’t usually come with chemistry in the files
If this is the case then you can post process chemistry by setting this to True.</p></li>
<li><p><strong>MH</strong> (<em>float</em><em> , </em><em>optional</em>) – (Optional) This is only used if run_chem is set to True. It is the Metallicity of
the planet in NON log units. MH = 1 is solar.</p></li>
<li><p><strong>CtoO</strong> (<em>float</em><em> , </em><em>optional</em>) – (Optional) This is the C/O ratio of the planet also in NON log units.
CtoO = 0.55 is solar.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso.disco">
<span id="picaso-disco-module"></span><h2>picaso.disco module<a class="headerlink" href="#module-picaso.disco" title="Permalink to this headline">¶</a></h2>
<dl class="attribute">
<dt id="picaso.disco.compress_disco">
<code class="sig-prename descclassname">picaso.disco.</code><code class="sig-name descname">compress_disco</code><a class="headerlink" href="#picaso.disco.compress_disco" title="Permalink to this definition">¶</a></dt>
<dd><p>Last step in albedo code. Integrates over phase angle based on the
Gaussian-Chebychev weights in geometry.json</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumbers</p></li>
<li><p><strong>cos_theta</strong> (<em>float</em>) – Cosine of phase angle</p></li>
<li><p><strong>xint_at_top</strong> (<em>ndarray of floats</em>) – Planetary intensity at the top of the atmosphere with dimensions (ng, nt, nwno)</p></li>
<li><p><strong>gweight</strong> (<em>ndarray of floats</em>) – Gaussian weights for integration</p></li>
<li><p><strong>tweight</strong> (<em>ndarray of floats</em>) – Chebychev weights for integration</p></li>
<li><p><strong>F0PI</strong> (<em>ndarray of floats</em>) – Stellar flux</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.disco.compress_thermal">
<code class="sig-prename descclassname">picaso.disco.</code><code class="sig-name descname">compress_thermal</code><a class="headerlink" href="#picaso.disco.compress_thermal" title="Permalink to this definition">¶</a></dt>
<dd><p>Last step in albedo code. Integrates over phase angle based on the
Gaussian-Chebychev weights in geometry.json</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumbers</p></li>
<li><p><strong>ubar1</strong> (<em>ndarray of floats</em>) – Outgoing angles</p></li>
<li><p><strong>flux_at_top</strong> (<em>ndarray of floats</em>) – Thermal Flux at the top of the atmosphere with dimensions (ng, nt, nwno)</p></li>
<li><p><strong>gweight</strong> (<em>ndarray of floats</em>) – Gaussian weights for integration</p></li>
<li><p><strong>tweight</strong> (<em>ndarray of floats</em>) – Chebychev weights for integration</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.disco.compute_disco">
<code class="sig-prename descclassname">picaso.disco.</code><code class="sig-name descname">compute_disco</code><a class="headerlink" href="#picaso.disco.compute_disco" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes ubar0, the incident angle, and ubar1, the outgoing angle from the
chebyshev angles in geometry.json</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ng</strong> (<em>int</em>) – Number of gauss angles</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – Number of tchebyshev angles</p></li>
<li><p><strong>gangle</strong> (<em>float</em>) – Gaussian Angles</p></li>
<li><p><strong>tangle</strong> (<em>float</em>) – Chevychev Angles</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>) – Planetary phase angle</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>ubar0</em> – the incident angles</p></li>
<li><p><em>ubar1</em> – the outgoing angles</p></li>
<li><p><em>cos_theta</em> – Cosine of the phase angle</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.disco.get_angles_1d">
<code class="sig-prename descclassname">picaso.disco.</code><code class="sig-name descname">get_angles_1d</code><span class="sig-paren">(</span><em class="sig-param">ngauss</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.disco.get_angles_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes integration over half sphere. ngauss=5 is 5 angles over half a
sphere.</p>
<p>These are taken from :
Abramowitz and Stegun Table 25.8
<a class="reference external" href="https://books.google.com/books?id=32HJ1orVXDEC&amp;pg=PA876&amp;lpg=PA876&amp;dq=Abramowitz+and+Stegun+Table+25.8&amp;source=bl&amp;ots=_eKu6k5SG8&amp;sig=ACfU3U0_piSAi8aDHOVd0itf_QSAFxcFLQ&amp;hl=en&amp;sa=X&amp;ved=2ahUKEwj5neLR2fDoAhXemHIEHUSVCjEQ6AEwD3oECAwQKQ#v=onepage&amp;q=Abramowitz%20and%20Stegun%20Table%2025.8&amp;f=false">https://books.google.com/books?id=32HJ1orVXDEC&amp;pg=PA876&amp;lpg=PA876&amp;dq=Abramowitz+and+Stegun+Table+25.8&amp;source=bl&amp;ots=_eKu6k5SG8&amp;sig=ACfU3U0_piSAi8aDHOVd0itf_QSAFxcFLQ&amp;hl=en&amp;sa=X&amp;ved=2ahUKEwj5neLR2fDoAhXemHIEHUSVCjEQ6AEwD3oECAwQKQ#v=onepage&amp;q=Abramowitz%20and%20Stegun%20Table%2025.8&amp;f=false</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ngauss</strong> (<em>int</em>) – Can only be 5, 6, 7, 8</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.disco.get_angles_3d">
<code class="sig-prename descclassname">picaso.disco.</code><code class="sig-name descname">get_angles_3d</code><span class="sig-paren">(</span><em class="sig-param">num_gangle</em>, <em class="sig-param">num_tangle</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.disco.get_angles_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes angles for full disco ball</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_gangles</strong> (<em>int</em>) – Number of Gauss angles</p></li>
<li><p><strong>num_tangles</strong> (<em>int</em>) – Number of Tchebychev angles desired</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gauss Angles,Gauss Weights,Tchebyshev Angles,Tchebyshev weights</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray, np.ndarray, np.ndarray, np.ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso.elements">
<span id="picaso-elements-module"></span><h2>picaso.elements module<a class="headerlink" href="#module-picaso.elements" title="Permalink to this headline">¶</a></h2>
<p>Properties of the chemical elements.</p>
<p>Each chemical element is represented as an object instance. Physicochemical
and descriptive properties of the elements are stored as instance attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p><a class="reference external" href="http://www.lfd.uci.edu/~gohlke/">Christoph Gohlke</a></p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>2015.01.29</p>
</dd>
</dl>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="http://www.python.org">CPython 2.7 or 3.4</a></p></li>
</ul>
<p class="rubric">References</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="http://physics.nist.gov/PhysRefData/Compositions/">http://physics.nist.gov/PhysRefData/Compositions/</a></p></li>
<li><p><a class="reference external" href="http://physics.nist.gov/PhysRefData/IonEnergy/tblNew.html">http://physics.nist.gov/PhysRefData/IonEnergy/tblNew.html</a></p></li>
<li><p><a class="reference external" href="http://en.wikipedia.org/wiki/%(element.name)s">http://en.wikipedia.org/wiki/%(element.name)s</a></p></li>
<li><p><a class="reference external" href="http://www.miranda.org/~jkominek/elements/elements.db">http://www.miranda.org/~jkominek/elements/elements.db</a></p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">elements</span> <span class="kn">import</span> <span class="n">ELEMENTS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ELEMENTS</span><span class="p">)</span>
<span class="go">109</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">ELEMENTS</span><span class="p">[</span><span class="mi">109</span><span class="p">])</span>
<span class="go">&#39;Meitnerium&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ele</span> <span class="o">=</span> <span class="n">ELEMENTS</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ele</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">ele</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span> <span class="n">ele</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ele</span><span class="o">.</span><span class="n">eleconfig</span>
<span class="go">(6, &#39;C&#39;, &#39;Carbon&#39;, &#39;[He] 2s2 2p2&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ele</span><span class="o">.</span><span class="n">eleconfig_dict</span>
<span class="go">{(1, &#39;s&#39;): 2, (2, &#39;p&#39;): 2, (2, &#39;s&#39;): 2}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">(</span><span class="n">ele</span><span class="o">.</span><span class="n">mass</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">ELEMENTS</span><span class="p">)</span>
<span class="go">14659.1115599</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">ELEMENTS</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ele</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">ele</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">ele</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="module-picaso.fluxes">
<span id="picaso-fluxes-module"></span><h2>picaso.fluxes module<a class="headerlink" href="#module-picaso.fluxes" title="Permalink to this headline">¶</a></h2>
<dl class="attribute">
<dt id="picaso.fluxes.blackbody">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">blackbody</code><a class="headerlink" href="#picaso.fluxes.blackbody" title="Permalink to this definition">¶</a></dt>
<dd><p>Blackbody flux in cgs units in per unit wavelength</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>array</em><em>,</em><em>float</em>) – Temperature (K)</p></li>
<li><p><strong>w</strong> (<em>array</em><em>, </em><em>float</em>) – Wavelength (cgs)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray with shape ntemp x numwave</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_flux_toon">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_flux_toon</code><a class="headerlink" href="#picaso.fluxes.get_flux_toon" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Discontinued function. See <cite>get_flux_geom_1d</cite> and <cite>get_flux_geom_3d</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>) – Number of levels in the model</p></li>
<li><p><strong>wno</strong> (<em>array of float</em>) – Wave number grid in cm -1</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wave points</p></li>
<li><p><strong>dtau</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
Dimensions=# layer by # wave</p></li>
<li><p><strong>w0</strong> (<em>ndarray of float</em>) – This is the single scattering albedo, from scattering, clouds, raman, etc
Dimensions=# layer by # wave</p></li>
<li><p><strong>cosbar</strong> (<em>ndarray of float</em>) – This is the asymmetry factor
Dimensions=# layer by # wave</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>) – Surface reflectivity</p></li>
<li><p><strong>ubar0</strong> (<em>float</em>) – Cosine of the incident angle</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>) – Downward incident solar radiation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>flux_up and flux_down through each layer as a function of wavelength</p>
</dd>
</dl>
<div class="admonition-todo admonition" id="id5">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Replace detla-function adjustment with better approximation (e.g. Cuzzi)</p></li>
<li><dl class="simple">
<dt>F0PI Solar flux shouldn’t always be 1.. Follow up to make sure that this isn’t a bad</dt><dd><p>hardwiring to solar</p>
</dd>
</dl>
</li>
</ul>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flux_plus</span><span class="p">,</span> <span class="n">flux_minus</span>  <span class="o">=</span> <span class="n">fluxes</span><span class="o">.</span><span class="n">get_flux_toon</span><span class="p">(</span><span class="n">atm</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">nlevel</span><span class="p">,</span> <span class="n">wno</span><span class="p">,</span><span class="n">nwno</span><span class="p">,</span>
<span class="go">                                                                                                tau_dedd,dtau_dedd, w0_dedd, cosb_dedd, surf_reflect, ubar0, F0PI)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_reflected_1d">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_reflected_1d</code><a class="headerlink" href="#picaso.fluxes.get_reflected_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes toon fluxes given tau and everything is 1 dimensional. This is the exact same function
as <cite>get_flux_geom_3d</cite> but is kept separately so we don’t have to do unecessary indexing for fast
retrievals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>) – Number of levels in the model</p></li>
<li><p><strong>wno</strong> (<em>array of float</em>) – Wave number grid in cm -1</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wave points</p></li>
<li><p><strong>numg</strong> (<em>int</em>) – Number of Gauss angles</p></li>
<li><p><strong>numt</strong> (<em>int</em>) – Number of Chebyshev angles</p></li>
<li><p><strong>DTAU</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>TAU</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</p></li>
<li><p><strong>W0</strong> (<em>ndarray of float</em>) – This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>COSB</strong> (<em>ndarray of float</em>) – This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>GCOS2</strong> (<em>ndarray of float</em>) – Parameter that allows us to directly include Rayleigh scattering
= 0.5*tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_cld</strong> (<em>ndarray of float</em>) – Fraction of cloud extinction to total
= tau_cloud/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_ray</strong> (<em>ndarray of float</em>) – Fraction of rayleigh extinction to total
= tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>dtau_og</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_og</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_og</strong> (<em>ndarray of float</em>) – Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>cosb_og</strong> (<em>ndarray of float</em>) – Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>) – Surface reflectivity</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray of float</em>) – matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>ubar1</strong> (<em>ndarray of float</em>) – matrix of cosine of the observer angles</p></li>
<li><p><strong>cos_theta</strong> (<em>float</em>) – Cosine of the phase angle of the planet</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>) – Downward incident solar radiation</p></li>
<li><p><strong>single_phase</strong> (<em>str</em>) – Single scattering phase function, default is the two-term henyey-greenstein phase function</p></li>
<li><p><strong>multi_phase</strong> (<em>str</em>) – Multiple scattering phase function, defulat is N=2 Legendre polynomial</p></li>
<li><p><strong>frac_a</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_b</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_c</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C), Default is : 1 - gcosb^2</p></li>
<li><p><strong>constant_back</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the assymetry of back scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>constant_forward</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the assymetry of forward scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>intensity at the top of the atmosphere for all the different ubar1 and ubar2</em></p></li>
<li><p><em>To Do</em></p></li>
<li><p><em>—–</em></p></li>
<li><p><em>- F0PI Solar flux shouldn’t always be 1.. Follow up to make sure that this isn’t a bad</em> – hardwiring to solar, despite “relative albedo”</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_reflected_3d">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_reflected_3d</code><a class="headerlink" href="#picaso.fluxes.get_reflected_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes toon fluxes given tau and everything is 3 dimensional. This is the exact same function
as <cite>get_flux_geom_1d</cite> but is kept separately so we don’t have to do unecessary indexing for
retrievals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>) – Number of levels in the model</p></li>
<li><p><strong>wno</strong> (<em>array of float</em>) – Wave number grid in cm -1</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wave points</p></li>
<li><p><strong>numg</strong> (<em>int</em>) – Number of Gauss angles</p></li>
<li><p><strong>numt</strong> (<em>int</em>) – Number of Chebyshev angles</p></li>
<li><p><strong>dtau_3d</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_3d</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_3d</strong> (<em>ndarray of float</em>) – This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>cosb_3d</strong> (<em>ndarray of float</em>) – This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>gcos2_3d</strong> (<em>ndarray of float</em>) – Parameter that allows us to directly include Rayleigh scattering
= 0.5*tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_cld_3d</strong> (<em>ndarray of float</em>) – Fraction of cloud extinction to total
= tau_cloud/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_ray_3d</strong> (<em>ndarray of float</em>) – Fraction of rayleigh extinction to total
= tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>dtau_og_3d</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_og_3d</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_og_3d</strong> (<em>ndarray of float</em>) – Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>cosb_og_3d</strong> (<em>ndarray of float</em>) – Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>) – Surface reflectivity</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray of float</em>) – matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>ubar1</strong> (<em>ndarray of float</em>) – matrix of cosine of the observer angles</p></li>
<li><p><strong>cos_theta</strong> (<em>float</em>) – Cosine of the phase angle of the planet</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>) – Downward incident solar radiation</p></li>
<li><p><strong>single_phase</strong> (<em>str</em>) – Single scattering phase function, default is the two-term henyey-greenstein phase function</p></li>
<li><p><strong>multi_phase</strong> (<em>str</em>) – Multiple scattering phase function, defulat is N=2 Legendre polynomial</p></li>
<li><p><strong>frac_a</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_b</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_c</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C), Default is : 1 - gcosb^2</p></li>
<li><p><strong>constant_back</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the assymetry of back scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>constant_forward</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the assymetry of forward scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>intensity at the top of the atmosphere for all the different ubar1 and ubar2</em></p></li>
<li><p><em>To Do</em></p></li>
<li><p><em>—–</em></p></li>
<li><p><em>- F0PI Solar flux shouldn’t always be 1.. Follow up to make sure that this isn’t a bad</em> – hardwiring to solar, despite “relative albedo”</p></li>
<li><p><em>- take delta eddington option out of fluxes and move it all over to optics</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_thermal_1d">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_thermal_1d</code><a class="headerlink" href="#picaso.fluxes.get_thermal_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>This function uses the source function method, which is outlined here:
<a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287">https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287</a></p>
<p>The result of this routine is the top of the atmosphere thermal flux as
a function of gauss and chebychev points accross the disk.</p>
<p>Everything here is in CGS units:</p>
<p>Fluxes - erg/s/cm^3
Temperature - K
Wave grid - cm-1
Pressure ; dyne/cm2</p>
<p>Reminder: Flux = pi * Intensity, so if you are trying to compare the result of this with
a black body you will need to compare with pi * BB !</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>) – Number of levels which occur at the grid points (not to be confused with layers which are
mid points)</p></li>
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>) – Wavenumber grid in inverse cm</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumber points</p></li>
<li><p><strong>numg</strong> (<em>int</em>) – Number of gauss points (think longitude points)</p></li>
<li><p><strong>numt</strong> (<em>int</em>) – Number of chebychev points (think latitude points)</p></li>
<li><p><strong>tlevel</strong> (<em>numpy.ndarray</em>) – Temperature as a function of level (not layer)</p></li>
<li><p><strong>dtau</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the per layer optical depth.</p></li>
<li><p><strong>w0</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>cosb</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the asymmetry of the
atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>plevel</strong> (<em>numpy.ndarray</em>) – Pressure for each level (not layer, which is midpoints). CGS units (dyne/cm2)</p></li>
<li><p><strong>ubar1</strong> (<em>numpy.ndarray</em>) – This is a matrix of ng by nt. This describes the outgoing incident angles and is generally
computed in <cite>picaso.disco</cite></p></li>
<li><p><strong>surf_reflect</strong> (<em>numpy.ndarray</em>) – Surface reflectivity as a function of wavenumber.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Thermal flux in CGS units (erg/cm3/s) in a matrix that is
numg x numt x nwno</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_thermal_3d">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_thermal_3d</code><a class="headerlink" href="#picaso.fluxes.get_thermal_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>This function uses the source function method, which is outlined here:
<a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287">https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287</a></p>
<p>The result of this routine is the top of the atmosphere thermal flux as
a function of gauss and chebychev points accross the disk.</p>
<p>Everything here is in CGS units:</p>
<p>Fluxes - erg/s/cm^3
Temperature - K
Wave grid - cm-1
Pressure ; dyne/cm2</p>
<p>Reminder: Flux = pi * Intensity, so if you are trying to compare the result of this with
a black body you will need to compare with pi * BB !</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>) – Number of levels which occur at the grid points (not to be confused with layers which are
mid points)</p></li>
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>) – Wavenumber grid in inverse cm</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumber points</p></li>
<li><p><strong>numg</strong> (<em>int</em>) – Number of gauss points (think longitude points)</p></li>
<li><p><strong>numt</strong> (<em>int</em>) – Number of chebychev points (think latitude points)</p></li>
<li><p><strong>tlevel_3d</strong> (<em>numpy.ndarray</em>) – Temperature as a function of level (not layer). This 3d matrix has dimensions [nlevel,ngangle,ntangle].</p></li>
<li><p><strong>dtau_3d</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the per layer optical depth.
This 4d matrix has dimensions [nlevel, nwave,ngangle,ntangle].</p></li>
<li><p><strong>w0_3d</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.
This 4d matrix has dimensions [nlevel, nwave,ngangle,ntangle].</p></li>
<li><p><strong>cosb_3d</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the asymmetry of the
atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.
This 4d matrix has dimensions [nlevel, nwave,ngangle,ntangle].</p></li>
<li><p><strong>plevel</strong> (<em>numpy.ndarray</em>) – Pressure for each level (not layer, which is midpoints). CGS units (dyne/cm2)</p></li>
<li><p><strong>ubar1</strong> (<em>numpy.ndarray</em>) – This is a matrix of ng by nt. This describes the outgoing incident angles and is generally
computed in <cite>picaso.disco</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Thermal flux in CGS units (erg/cm3/s) in a matrix that is
numg x numt x nwno</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.numba_cumsum">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">numba_cumsum</code><a class="headerlink" href="#picaso.fluxes.numba_cumsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute cumsum along axis=0 to bypass numba not allowing kwargs in
cumsum</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.setup_tri_diag">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">setup_tri_diag</code><a class="headerlink" href="#picaso.fluxes.setup_tri_diag" title="Permalink to this definition">¶</a></dt>
<dd><p>Before we can solve the tridiagonal matrix (See Toon+1989) section
“SOLUTION OF THE TwO-STREAM EQUATIONS FOR MULTIPLE LAYERS”, we
need to set up the coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlayer</strong> (<em>int</em>) – number of layers in the model</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – number of wavelength points</p></li>
<li><p><strong>c_plus_up</strong> (<em>array</em>) – c-plus evaluated at the top of the atmosphere</p></li>
<li><p><strong>c_minus_up</strong> (<em>array</em>) – c_minus evaluated at the top of the atmosphere</p></li>
<li><p><strong>c_plus_down</strong> (<em>array</em>) – c_plus evaluated at the bottom of the atmosphere</p></li>
<li><p><strong>c_minus_down</strong> (<em>array</em>) – c_minus evaluated at the bottom of the atmosphere</p></li>
<li><p><strong>b_top</strong> (<em>array</em>) – The diffuse radiation into the model at the top of the atmosphere</p></li>
<li><p><strong>b_surface</strong> (<em>array</em>) – The diffuse radiation into the model at the bottom. Includes emission, reflection
of the unattenuated portion of the direct beam</p></li>
<li><p><strong>surf_reflect</strong> (<em>array</em>) – Surface reflectivity</p></li>
<li><p><strong>g1</strong> (<em>array</em>) – table 1 toon et al 1989</p></li>
<li><p><strong>g2</strong> (<em>array</em>) – table 1 toon et al 1989</p></li>
<li><p><strong>g3</strong> (<em>array</em>) – table 1 toon et al 1989</p></li>
<li><p><strong>lamba</strong> (<em>array</em>) – Eqn 21 toon et al 1989</p></li>
<li><p><strong>gama</strong> (<em>array</em>) – Eqn 22 toon et al 1989</p></li>
<li><p><strong>dtau</strong> (<em>array</em>) – Opacity per layer</p></li>
<li><p><strong>exptrm_positive</strong> (<em>array</em>) – Eqn 44, expoential terms needed for tridiagonal rotated layered, clipped at 35</p></li>
<li><p><strong>exptrm_minus</strong> (<em>array</em>) – Eqn 44, expoential terms needed for tridiagonal rotated layered, clipped at 35</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>coefficient of the positive exponential term</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.slice_eq">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">slice_eq</code><a class="headerlink" href="#picaso.fluxes.slice_eq" title="Permalink to this definition">¶</a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.slice_gt">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">slice_gt</code><a class="headerlink" href="#picaso.fluxes.slice_gt" title="Permalink to this definition">¶</a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.slice_lt">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">slice_lt</code><a class="headerlink" href="#picaso.fluxes.slice_lt" title="Permalink to this definition">¶</a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.tri_diag_solve">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">tri_diag_solve</code><a class="headerlink" href="#picaso.fluxes.tri_diag_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Tridiagonal Matrix Algorithm solver, a b c d can be NumPy array type or Python list type.
refer to this <a class="reference external" href="http://en.wikipedia.org/wiki/Tridiagonal_matrix_algorithm">wiki</a> and to this <a class="reference external" href="http://www.cfd-online.com/Wiki/Tridiagonal_matrix_algorithm_-_TDMA_(Thomas_algorithm)">explanation</a>.</p>
<p>A, B, C and D refer to:</p>
<div class="math notranslate nohighlight">
\[A(I)*X(I-1) + B(I)*X(I) + C(I)*X(I+1) = D(I)\]</div>
<p>This solver returns X.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>array</em><em> or </em><em>list</em>) – </p></li>
<li><p><strong>B</strong> (<em>array</em><em> or </em><em>list</em>) – </p></li>
<li><p><strong>C</strong> (<em>array</em><em> or </em><em>list</em>) – </p></li>
<li><p><strong>C</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Solution, x</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso.io_utils">
<span id="picaso-io-utils-module"></span><h2>picaso.io_utils module<a class="headerlink" href="#module-picaso.io_utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.io_utils.read_hdf">
<code class="sig-prename descclassname">picaso.io_utils.</code><code class="sig-name descname">read_hdf</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">requires</em>, <em class="sig-param">raise_except=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.io_utils.read_hdf" title="Permalink to this definition">¶</a></dt>
<dd><p>read in H5 format file and pull out specific table based on specific
header information in the requires field. return None if file is not there</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – name of H5 file to read</p></li>
<li><p><strong>requires</strong> (<em>dict</em>) – dictionary with keys and values to get correct table
e.g. {‘wmin’:0.3, ‘wmax’:1, ‘R’:5000} for opacity grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>d</strong> – data from H5 file decoded into python object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>python object</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.io_utils.read_json">
<code class="sig-prename descclassname">picaso.io_utils.</code><code class="sig-name descname">read_json</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.io_utils.read_json" title="Permalink to this definition">¶</a></dt>
<dd><p>read in a JSON format file.  return None if the file is not there.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – name of the JSON file to read</p></li>
<li><p><strong>except</strong> (<em>bool</em>) – if true, raise exception if file is missing. if false, return empty dict.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>d</strong> – data from JSON file decoded into python object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>python object</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso.justdoit">
<span id="picaso-justdoit-module"></span><h2>picaso.justdoit module<a class="headerlink" href="#module-picaso.justdoit" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.justdoit.HJ_cld">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">HJ_cld</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.HJ_cld" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to get rough Jupiter Cloud model with fsed=3</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.HJ_pt">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">HJ_pt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.HJ_pt" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to get Jupiter’s PT profile</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.HJ_pt_3d">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">HJ_pt_3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.HJ_pt_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to get Jupiter’s PT profile</p>
</dd></dl>

<dl class="class">
<dt id="picaso.justdoit.inputs">
<em class="property">class </em><code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">inputs</code><span class="sig-paren">(</span><em class="sig-param">calculation='planet'</em>, <em class="sig-param">chemeq=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to setup planet to run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>calculation</strong> (<em>str</em>) – (Optional) Controls planet or brown dwarf calculation. Default = ‘planet’. Other option is “browndwarf”.</p></li>
<li><p><strong>chemeq</strong> (<em>bool</em>) – (Optional) If true, loads in full chemical equilibrium grid, which will take a little bit of time.
Default = False</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="picaso.justdoit.inputs.phase_angle">
<code class="sig-name descname">phase_angle</code><a class="headerlink" href="#picaso.justdoit.inputs.phase_angle" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set phase angle</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justdoit.inputs.gravity">
<code class="sig-name descname">gravity</code><a class="headerlink" href="#picaso.justdoit.inputs.gravity" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set gravity</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justdoit.inputs.star">
<code class="sig-name descname">star</code><a class="headerlink" href="#picaso.justdoit.inputs.star" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set stellar spec</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justdoit.inputs.atmosphere">
<code class="sig-name descname">atmosphere</code><a class="headerlink" href="#picaso.justdoit.inputs.atmosphere" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set atmosphere composition and PT</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justdoit.inputs.clouds">
<code class="sig-name descname">clouds</code><a class="headerlink" href="#picaso.justdoit.inputs.clouds" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set cloud profile</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justdoit.inputs.approx">
<code class="sig-name descname">approx</code><a class="headerlink" href="#picaso.justdoit.inputs.approx" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set approximation</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justdoit.inputs.spectrum">
<code class="sig-name descname">spectrum</code><a class="headerlink" href="#picaso.justdoit.inputs.spectrum" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>create spectrum</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.TP_line_earth">
<code class="sig-name descname">TP_line_earth</code><span class="sig-paren">(</span><em class="sig-param">P</em>, <em class="sig-param">Tsfc=294.0</em>, <em class="sig-param">Psfc=1.0</em>, <em class="sig-param">gam_trop=0.18</em>, <em class="sig-param">Ptrop=0.199</em>, <em class="sig-param">gam_strat=-0.045</em>, <em class="sig-param">Pstrat=0.001</em>, <em class="sig-param">nlevel=150</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.TP_line_earth" title="Permalink to this definition">¶</a></dt>
<dd><p>Author: Mike R. Line</p>
<p>Estimates Earth’s pressure-temperature profile. All default
values have been tuned to semi reproduce Earth’s temperature
pressure profile.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<em>array</em>) – Pressure array usually np.logspace(-6,2,nlevel)</p></li>
<li><p><strong>Tsfc</strong> (<em>float</em><em>,</em><em>optional</em>) – Surface Temperature (K). Earth is 294 K</p></li>
<li><p><strong>Psfc</strong> (<em>float</em><em> ,</em><em>optional</em>) – Surface Pressure (bar). Earth is 1 bar.</p></li>
<li><p><strong>gam_trop</strong> (<em>float</em><em> ,</em><em>optional</em>) – Tropospheric dry lapse rate. Earth is ~0.18</p></li>
<li><p><strong>Ptrop</strong> (<em>float</em><em> ,</em><em>optional</em>) – Tropospheric pressure. Earth 0.199 bar.</p></li>
<li><p><strong>gam_strat</strong> (<em>float</em><em> ,</em><em>optional</em>) – Stratospheric lapse rate. Earth is -0.045</p></li>
<li><p><strong>Pstrat</strong> (<em>float</em><em> ,</em><em>optional</em>) – Stratospheric pressure (bars). Earth is 0.001 bar. /</p></li>
<li><p><strong>nlevel</strong> (<em>int</em><em> ,</em><em>optional</em>) – Number of grid levels</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Temperature array (K)Psfc</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">approx</code><span class="sig-paren">(</span><em class="sig-param">single_phase='TTHG_ray', multi_phase='N=2', delta_eddington=True, raman='pollack', tthg_frac=[1, -1, 2], tthg_back=-0.5, tthg_forward=1</em><span class="sig-paren">)</span></dt>
<dd><p>This function sets all the default approximations in the code. It transforms the string specificatons
into a number so that they can be used in numba nopython routines.</p>
<p>For <cite>str</cite> cases such as <cite>TTHG_ray</cite> users see all the options by using the function <cite>single_phase_options</cite>
or <cite>multi_phase_options</cite>, etc.</p>
<dl class="simple">
<dt>single_phase<span class="classifier">str</span></dt><dd><p>Single scattering phase function approximation</p>
</dd>
<dt>multi_phase<span class="classifier">str</span></dt><dd><p>Multiple scattering phase function approximation</p>
</dd>
<dt>delta_eddington<span class="classifier">bool</span></dt><dd><p>Turns delta-eddington on and off</p>
</dd>
<dt>raman<span class="classifier">str</span></dt><dd><p>Uses various versions of raman scattering</p>
</dd>
<dt>tthg_frac<span class="classifier">list</span></dt><dd><p>Functional of forward to back scattering with the form of polynomial :
tthg_frac[0] + tthg_frac[1]*g_b^tthg_frac[2]
See eqn. 6 in picaso paper</p>
</dd>
<dt>tthg_back<span class="classifier">float</span></dt><dd><p>Back scattering asymmetry factor gf = g_bar*tthg_back</p>
</dd>
<dt>tthg_forward<span class="classifier">float</span></dt><dd><p>Forward scattering asymmetry factor gb = g_bar * tthg_forward</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">atmosphere</code><span class="sig-paren">(</span><em class="sig-param">df=None</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">exclude_mol=None</em>, <em class="sig-param">**pd_kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Builds a dataframe and makes sure that minimum necessary parameters have been suplied.
Sets number of layers in model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em><em> or </em><em>dict</em>) – (Optional) Dataframe with volume mixing ratios and pressure, temperature profile.
Must contain pressure (bars) at least one molecule</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – (Optional) Filename with pressure, temperature and volume mixing ratios.
Must contain pressure at least one molecule</p></li>
<li><p><strong>exclude_mol</strong> (<em>list of str</em>) – (Optional) List of molecules to ignore from file</p></li>
<li><p><strong>pd_kwargs</strong> (<em>kwargs</em>) – Key word arguments for pd.read_csv to read in supplied atmosphere file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.atmosphere_3d">
<code class="sig-name descname">atmosphere_3d</code><span class="sig-paren">(</span><em class="sig-param">dictionary=None</em>, <em class="sig-param">filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.atmosphere_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a dataframe and makes sure that minimum necessary parameters have been suplied.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>dict</em>) – (Optional) Dataframe with volume mixing ratios and pressure, temperature profile.
Must contain pressure (bars) and at least one molecule</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – (Optional) Pickle filename that is a dictionary structured:
dictionary[int(lat) in degrees][int(lon) in degrees] = pd.DataFrame({‘pressure’:[], ‘temperature’: [],
‘H2O’:[]….}). As well as df[‘phase_angle’] = 0 (in radians).
Therefore, the latitude and longitude keys should be INTEGERS taken from the lat/longs calculated in
inputs.phase_angle! Any other meta data should be  represented by a string.
Must contain pressure and at least one molecule</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>&gt;&gt;import picaso.justdoit as jdi
&gt;&gt;new = jdi.inputs()
&gt;&gt;new.phase_angle(0) #loads the geometry you need to get your 3d model on
&gt;&gt;lats= new.inputs[‘disco’][‘latitude’]*180/np.pi).astype(int)
&gt;&gt;&gt;lons = (new.inputs[‘disco’][‘longitude’]*180/np.pi).astype(int)</p>
<p>Build an empty dictionary to be filled later</p>
<p>&gt;&gt;dict_3d = {la: {lo : [] for lo in lons} for la in lats} #build empty one
&gt;&gt;dict_3d[‘phase_angle’] = 0 #this is a double check for consistency</p>
<p>Now you need to bin your GCM output on this grid and fill the dictionary with the necessary dataframes. For example:</p>
<p>&gt;&gt;dict_3d[lats[0]][lons[0]] = pd.DataFrame({‘pressure’:[], ‘temperature’: [],’H2O’:[]})</p>
<p>Once this is filled you can add it to this function</p>
<p>&gt;&gt;new.atmosphere_3d(dictionary=dict_3d)</p>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.channon_grid_high">
<code class="sig-name descname">channon_grid_high</code><span class="sig-paren">(</span><em class="sig-param">filename='/Users/nbatalh1/Documents/codes/PICASO/picaso/reference/chemistry/ChannonGrid.csv'</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.channon_grid_high" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.channon_grid_low">
<code class="sig-name descname">channon_grid_low</code><span class="sig-paren">(</span><em class="sig-param">filename='/Users/nbatalh1/Documents/codes/PICASO/picaso/reference/chemistry/visscher_abunds_m+0.0_co1.0'</em>, <em class="sig-param">interp_window=11</em>, <em class="sig-param">interp_poly=2</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.channon_grid_low" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate from visscher grid</p>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.chemeq">
<code class="sig-name descname">chemeq</code><span class="sig-paren">(</span><em class="sig-param">CtoO</em>, <em class="sig-param">Met</em>, <em class="sig-param">P=None</em>, <em class="sig-param">T=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.chemeq" title="Permalink to this definition">¶</a></dt>
<dd><p>This interpolates from a precomputed grid of CEA runs (run by M.R. Line)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>P</strong> (<em>array</em>) – Pressure (bars)</p></li>
<li><p><strong>T</strong> (<em>array</em>) – Temperature (K)</p></li>
<li><p><strong>CtoO</strong> (<em>float</em>) – C to O ratio (solar = 0.55)</p></li>
<li><p><strong>Met</strong> (<em>float</em>) – Metallicity relative to solar (solar = 1)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">clouds</code><span class="sig-paren">(</span><em class="sig-param">filename=None</em>, <em class="sig-param">g0=None</em>, <em class="sig-param">w0=None</em>, <em class="sig-param">opd=None</em>, <em class="sig-param">p=None</em>, <em class="sig-param">dp=None</em>, <em class="sig-param">df=None</em>, <em class="sig-param">**pd_kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Cloud specification for the model. Clouds are parameterized by a single scattering albedo (w0),
an assymetry parameter (g0), and a total extinction per layer (opd).</p>
<p>g0,w0, and opd are both wavelength and pressure dependent. Our cloud models come
from eddysed. Their output look something like this where
pressure is in bars and wavenumber is inverse cm. We will sort pressure and wavenumber before we reshape
so the exact order doesn’t matter</p>
<p>pressure wavenumber opd w0 g0
1.   1.   … . .
1.   2.   … . .
1.   3.   … . .
.     . … . .
.     . … . .
1.   M.   … . .
2.   1.   … . .
.     . … . .
N.   .  … . .</p>
<p>If you are creating your own file you have to make sure that you have a
<strong>pressure</strong> (bars) and <a href="#id6"><span class="problematic" id="id7">**</span></a>wavenumber**(inverse cm) column. We will use this to make sure that your cloud
and atmospheric profiles are on the same grid. <a href="#id8"><span class="problematic" id="id9">**</span></a>If there is no pressure or wavelength parameter
we will assume that you are on the same grid as your atmospheric input, and on the
eddysed wavelength grid! **</p>
<p>Users can also input their own fixed cloud parameters, by specifying a single value
for g0,w0,opd and defining the thickness and location of the cloud.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – (Optional) Filename with info on the wavelength and pressure-dependent single scattering
albedo, asymmetry factor, and total extinction per layer. Input associated pd_kwargs
so that the resultant output has columns named : <cite>g0</cite>, <cite>w0</cite> and <cite>opd</cite>. If you are not
using the eddysed output, you will also need a <cite>wavenumber</cite> and <cite>pressure</cite> column in units
of inverse cm, and bars.</p></li>
<li><p><strong>g0</strong> (<em>float</em><em>, </em><em>list of float</em>) – (Optional) Asymmetry factor. Can be a single float for a single cloud. Or a list of floats
for two different cloud layers</p></li>
<li><p><strong>w0</strong> (<em>list of float</em>) – (Optional) Single Scattering Albedo. Can be a single float for a single cloud. Or a list of floats
for two different cloud layers</p></li>
<li><p><strong>opd</strong> (<em>list of float</em>) – (Optional) Total Extinction in <cite>dp</cite>. Can be a single float for a single cloud. Or a list of floats
for two different cloud layers</p></li>
<li><p><strong>p</strong> (<em>list of float</em>) – (Optional) Bottom location of cloud deck (LOG10 bars). Can be a single float for a single cloud. Or a list of floats
for two different cloud layers</p></li>
<li><p><strong>dp</strong> (<em>list of float</em>) – (Optional) Total thickness cloud deck above p (LOG10 bars).
Can be a single float for a single cloud or a list of floats
for two different cloud layers
Cloud will span 10**(np.log10(p-dp))</p></li>
<li><p><strong>df</strong> (<em>pd.DataFrame</em><em>, </em><em>dict</em>) – (Optional) Same as what would be included in the file, but in DataFrame or dict form</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.clouds_3d">
<code class="sig-name descname">clouds_3d</code><span class="sig-paren">(</span><em class="sig-param">filename=None</em>, <em class="sig-param">dictionary=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.clouds_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Cloud specification for the model. Clouds are parameterized by a single scattering albedo (w0),
an assymetry parameter (g0), and a total extinction per layer (opd).</p>
<p>g0,w0, and opd are both wavelength and pressure dependent. Our cloud models come
from eddysed. Their output looks like this (where level 1=TOA, and wavenumber1=Smallest number)</p>
<p>level wavenumber opd w0 g0
1.   1.   … . .
1.   2.   … . .
1.   3.   … . .
.     . … . .
.     . … . .
1.   M.   … . .
2.   1.   … . .
.     . … . .
N.   .  … . .</p>
<p>If you are creating your own file you have to make sure that you have a
<strong>pressure</strong> (bars) and <a href="#id10"><span class="problematic" id="id11">**</span></a>wavenumber**(inverse cm) column. We will use this to make sure that your cloud
and atmospheric profiles are on the same grid. <a href="#id12"><span class="problematic" id="id13">**</span></a>If there is no pressure or wavelength parameter
we will assume that you are on the same grid as your atmospheric input, and on the
eddysed wavelength grid! **</p>
<p>Users can also input their own fixed cloud parameters, by specifying a single value
for g0,w0,opd and defining the thickness and location of the cloud.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – (Optional) Filename with info on the wavelength and pressure-dependent single scattering
albedo, asymmetry factor, and total extinction per layer. Input associated pd_kwargs
so that the resultant output has columns named : <cite>g0</cite>, <cite>w0</cite> and <cite>opd</cite>. If you are not
using the eddysed output, you will also need a <cite>wavenumber</cite> and <cite>pressure</cite> column in units
of inverse cm, and bars.</p></li>
<li><p><strong>dictionary</strong> (<em>dict</em>) – (Optional) Same as what would be included in the file, but in dict form</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>&gt;&gt;import picaso.justdoit as jdi
&gt;&gt;new = jdi.inputs()
&gt;&gt;new.phase_angle(0) #loads the geometry you need to get your 3d model on
&gt;&gt;lats, lons = int(new.inputs[‘disco’][‘latitude’]*180/np.pi), int(new.inputs[‘disco’][‘longitude’]*180/np.pi)</p>
<p>Build an empty dictionary to be filled later</p>
<p>&gt;&gt;dict_3d = {la: {lo : for lo in lons} for la in lats} #build empty one
&gt;&gt;dict_3d[‘phase_angle’] = 0 #add this for a consistensy check</p>
<p>Now you need to bin your 3D clouds GCM output on this grid and fill the dictionary with the necessary dataframes. For example:</p>
<p>&gt;&gt;dict_3d[lats[0]][lons[0]] = pd.DataFrame({‘pressure’:[], ‘temperature’: [],’H2O’:[]})</p>
<p>Once this is filled you can add it to this function</p>
<p>&gt;&gt;new.clouds_3d(dictionary=dict_3d)</p>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.clouds_reset">
<code class="sig-name descname">clouds_reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.clouds_reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset cloud dict to zeros</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">gravity</code><span class="sig-paren">(</span><em class="sig-param">gravity=None</em>, <em class="sig-param">gravity_unit=None</em>, <em class="sig-param">radius=None</em>, <em class="sig-param">radius_unit=None</em>, <em class="sig-param">mass=None</em>, <em class="sig-param">mass_unit=None</em><span class="sig-paren">)</span></dt>
<dd><p>Get gravity based on mass and radius, or gravity inputs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gravity</strong> (<em>float</em>) – (Optional) Gravity of planet</p></li>
<li><p><strong>gravity_unit</strong> (<em>astropy.unit</em>) – (Optional) Unit of Gravity</p></li>
<li><p><strong>radius</strong> (<em>float</em>) – (Optional) radius of planet MUST be specified for thermal emission!</p></li>
<li><p><strong>radius_unit</strong> (<em>astropy.unit</em>) – (Optional) Unit of radius</p></li>
<li><p><strong>mass</strong> (<em>float</em>) – (Optional) mass of planet</p></li>
<li><p><strong>mass_unit</strong> (<em>astropy.unit</em>) – (Optional) Unit of mass</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.guillot_pt">
<code class="sig-name descname">guillot_pt</code><span class="sig-paren">(</span><em class="sig-param">Teq</em>, <em class="sig-param">T_int</em>, <em class="sig-param">logg1</em>, <em class="sig-param">logKir</em>, <em class="sig-param">alpha=0.5</em>, <em class="sig-param">nlevel=61</em>, <em class="sig-param">p_bottom=1.5</em>, <em class="sig-param">p_top=-6</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.guillot_pt" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates temperature pressure profile given parameterization in Guillot 2010 TP profile
called in fx()</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>Teq</strong> (<em>float</em>) – equilibrium temperature</p></li>
<li><p><strong>T_int</strong> (<em>float</em>) – Internal temperature, if low (100) currently set to 100 for everything</p></li>
<li><p><strong>kv1</strong> (<em>float</em>) – see parameterization Guillot 2010 (10.**(logg1+logKir))</p></li>
<li><p><strong>kv2</strong> (<em>float</em>) – see parameterization Guillot 2010 (10.**(logg1+logKir))</p></li>
<li><p><strong>kth</strong> (<em>float</em>) – see parameterization Guillot 2010 (10.**logKir)</p></li>
<li><p><strong>alpha</strong> (<em>float</em><em> , </em><em>optional</em>) – set to 0.5</p></li>
<li><p><strong>nlevel</strong> (<em>int</em><em>, </em><em>optional</em>) – Number of atmospheric layers</p></li>
<li><p><strong>p_bottom</strong> (<em>float</em><em>, </em><em>optional</em>) – Log pressure (bars) of the lower bound pressure</p></li>
<li><p><strong>p_top</strong> (<em>float</em><em> , </em><em>optional</em>) – Log pressure (bars) of the TOA</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>T</strong> (<em>numpy.array</em>) – Temperature grid</p></li>
<li><p><strong>P</strong> (<em>numpy.array</em>) – Pressure grid</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.nostar">
<code class="sig-name descname">nostar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.nostar" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns off planet specific things, so program can run as usual</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">phase_angle</code><span class="sig-paren">(</span><em class="sig-param">phase=0</em>, <em class="sig-param">num_gangle=10</em>, <em class="sig-param">num_tangle=1</em>, <em class="sig-param">symmetry=False</em><span class="sig-paren">)</span></dt>
<dd><p>Define phase angle and number of gauss and tchebychev angles to compute.
Controls all geometry of the calculation. Computes latitude and longitudes.
Computes cos theta and incoming and outgoing angles. Adds everything to class.</p>
<p>Please see geometry notebook for a deep dive into how these angles are incorporated
into the calculation.</p>
<p>Typical numbers:
- 1D Thermal: num_gangle = 10, num_tangle=1
- 1D Reflected light with zero phase : num_gangle = 10, num_tangle=1
- 1D Reflected light with non zero phase : num_gangle = 8, num_tangle=8
- 3D Thermal or Reflected : angles will depend on 3D features interested in resolving.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>float</em><em>,</em><em>int</em>) – Phase angle in radians</p></li>
<li><p><strong>num_gangle</strong> (<em>int</em>) – Number of Gauss angles to integrate over facets (Default is 10). This
is defined as angles over the full sphere. So 10 as the default compute the RT
with 5 points on the west hemisphere and 5 points on the west.
Higher numbers will slow down code.</p></li>
<li><p><strong>num_tangle</strong> (<em>int</em>) – Number of Tchebyshev angles to integrate over facets (Default is 1, which automatically
assumes symmetry).
Must be even if considering symmetry.</p></li>
<li><p><strong>symmetry</strong> (<em>bool</em>) – Default is False. Note, if num_tangle=1 you are automatically considering symmetry.
This will only compute the unique incoming angles so that the calculation
isn’t doing repetetive models. E.g. if num_tangles=10, num_gangles=10. Instead of running a 10x10=100
FT calculations, it will only run 5x5 = 25 (or a quarter of the sphere).</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.sonora">
<code class="sig-name descname">sonora</code><span class="sig-paren">(</span><em class="sig-param">sonora_path</em>, <em class="sig-param">teff</em>, <em class="sig-param">chem='low'</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.sonora" title="Permalink to this definition">¶</a></dt>
<dd><p>This queries Sonora temperature profile that can be downloaded from profiles.tar on
Zenodo: [profile.tar file](<a class="reference external" href="https://zenodo.org/record/1309035#.Xo5GbZNKjGJ">https://zenodo.org/record/1309035#.Xo5GbZNKjGJ</a>)</p>
<p>Note gravity is not an input because it grabs gravity from self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sonora_path</strong> (<em>str</em>) – Path to the untarred profile.tar file from sonora grid</p></li>
<li><p><strong>teff</strong> (<em>float</em>) – teff to query. does not have to be exact (it will query one the nearest neighbor)</p></li>
<li><p><strong>chem</strong> (<em>str</em>) – Default = ‘low’. There are two sonora chemistry grids. the default is use low.
There is sublety to this that is going to be explained at length in the sonora grid paper.
Until then, ONLY use chem=’low’ unless you have reached out to one of the developers.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">spectrum</code><span class="sig-paren">(</span><em class="sig-param">opacityclass</em>, <em class="sig-param">calculation='reflected'</em>, <em class="sig-param">dimension='1d'</em>, <em class="sig-param">full_output=False</em>, <em class="sig-param">plot_opacity=False</em>, <em class="sig-param">as_dict=True</em><span class="sig-paren">)</span></dt>
<dd><p>Run Spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opacityclass</strong> (<em>class</em>) – Opacity class from <cite>justdoit.opannection</cite></p></li>
<li><p><strong>calculation</strong> (<em>str</em>) – Either ‘reflected’ or ‘thermal’ for reflected light or thermal emission.
If running a brown dwarf, this will automatically default to thermal</p></li>
<li><p><strong>dimension</strong> (<em>str</em>) – (Optional) Dimensions of the calculation. Default = ‘1d’. But ‘3d’ is also accepted.
In order to run ‘3d’ calculations, user must build 3d input (see tutorials)</p></li>
<li><p><strong>full_output</strong> (<em>bool</em>) – (Optional) Default = False. Returns atmosphere class, which enables several
plotting capabilities.</p></li>
<li><p><strong>plot_opacity</strong> (<em>bool</em>) – (Optional) Default = False, Creates pop up of the weighted opacity</p></li>
<li><p><strong>as_dict</strong> (<em>bool</em>) – (Optional) Default = True. If true, returns a condensed dictionary to the user.
If false, returns the atmosphere class, which can be used for debugging.
The class is clunky to navigate so if you are consiering navigating through this, ping one of the
developers.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">star</code><span class="sig-paren">(</span><em class="sig-param">opannection</em>, <em class="sig-param">temp=None</em>, <em class="sig-param">metal=None</em>, <em class="sig-param">logg=None</em>, <em class="sig-param">radius=None</em>, <em class="sig-param">radius_unit=None</em>, <em class="sig-param">semi_major=None</em>, <em class="sig-param">semi_major_unit=None</em>, <em class="sig-param">database='ck04models'</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">w_units=None</em>, <em class="sig-param">f_units=None</em><span class="sig-paren">)</span></dt>
<dd><p>Get the stellar spectrum using pysynphot and interpolate onto a much finer grid than the
planet grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opannection</strong> (<em>class picaso.RetrieveOpacities</em>) – This is the opacity class and it’s needed to get the correct wave info and raman scattering cross sections</p></li>
<li><p><strong>temp</strong> (<em>float</em>) – Teff of the stellar model</p></li>
<li><p><strong>metal</strong> (<em>float</em>) – Metallicity of the stellar model</p></li>
<li><p><strong>logg</strong> (<em>float</em>) – Logg cgs of the stellar model</p></li>
<li><p><strong>radius</strong> (<em>float</em>) – Radius of the star</p></li>
<li><p><strong>radius_unit</strong> (<em>astropy.unit</em>) – Any astropy unit (e.g. <cite>radius_unit=astropy.unit.Unit(“R_sun”)</cite>)</p></li>
<li><p><strong>semi_major</strong> (<em>float</em>) – (Optional) Semi major axis of the planet. Used to compute fp/fs for albedo calculations.</p></li>
<li><p><strong>semi_major_unit</strong> (<em>astropy.unit</em>) – (Optional) Any astropy unit (e.g. <cite>radius_unit=astropy.unit.Unit(“au”)</cite>)</p></li>
<li><p><strong>database</strong> (<em>str</em>) – (Optional)The database to pull stellar spectrum from. See documentation for pysynphot.</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – (Optional) Upload your own stellar spectrum. File format = two column white space (wave, flux)</p></li>
<li><p><strong>wunits</strong> (<em>str</em>) – (Optional) Used for stellar file wave units</p></li>
<li><p><strong>funits</strong> (<em>str</em>) – (Optional) Used for stellar file flux units</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.surface_reflect">
<code class="sig-name descname">surface_reflect</code><span class="sig-paren">(</span><em class="sig-param">albedo</em>, <em class="sig-param">wavenumber</em>, <em class="sig-param">old_wavenumber=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.surface_reflect" title="Permalink to this definition">¶</a></dt>
<dd><p>Set atmospheric surface reflectivity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>albedo</strong> (<em>float</em>) – Set constant albedo for surface reflectivity</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.virga">
<code class="sig-name descname">virga</code><span class="sig-paren">(</span><em class="sig-param">condensates</em>, <em class="sig-param">directory</em>, <em class="sig-param">fsed=1</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">mmw=2.2</em>, <em class="sig-param">kz_min=100000.0</em>, <em class="sig-param">full_output=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.virga" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs virga cloud code based on the PT and Kzz profiles
that have been added to inptus class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>condensates</strong> (<em>str</em>) – Condensates to run in cloud model</p></li>
<li><p><strong>fsed</strong> (<em>float</em>) – Sedimentation efficiency</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – Metallicity</p></li>
<li><p><strong>mmw</strong> (<em>float</em>) – Atmospheric mean molecular weight</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.jupiter_cld">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">jupiter_cld</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.jupiter_cld" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to get rough Jupiter Cloud model with fsed=3</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.jupiter_pt">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">jupiter_pt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.jupiter_pt" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to get Jupiter’s PT profile</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.mean_regrid">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">mean_regrid</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">newx=None</em>, <em class="sig-param">R=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.mean_regrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebin the spectrum at a minimum R or on a fixed grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) – Wavenumbers</p></li>
<li><p><strong>y</strong> (<em>array</em>) – Anything (e.g. albedo, flux)</p></li>
<li><p><strong>newx</strong> (<em>array</em>) – new array to regrid on.</p></li>
<li><p><strong>R</strong> (<em>float</em>) – create grid with constant R</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>final x, and final y</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.multi_phase_options">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">multi_phase_options</code><span class="sig-paren">(</span><em class="sig-param">printout=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.multi_phase_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve all the options for multiple scattering radiation</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.opannection">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">opannection</code><span class="sig-paren">(</span><em class="sig-param">wave_range=None</em>, <em class="sig-param">filename_db=None</em>, <em class="sig-param">raman_db=None</em>, <em class="sig-param">resample=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.opannection" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets up database connection to opacities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave_range</strong> (<em>list of float</em>) – Subset of wavelength range for which to run models for
Default : None, which pulls entire grid</p></li>
<li><p><strong>filename_db</strong> (<em>str</em>) – Filename of opacity database to query from
Default is none which pulls opacity file that comes with distribution</p></li>
<li><p><strong>raman_db</strong> (<em>str</em>) – Filename of raman opacity cross section
Default is none which pulls opacity file that comes with distribution</p></li>
<li><p><strong>resample</strong> (<em>int</em>) – Default=1 (no resampling) PROCEED WITH CAUTION!!!!!This will resample your opacites.
This effectively takes opacity[::BINS] depending on what the
sampling requested is. Consult your local theorist before
using this.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.picaso">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">picaso</code><span class="sig-paren">(</span><em class="sig-param">bundle</em>, <em class="sig-param">opacityclass</em>, <em class="sig-param">dimension='1d'</em>, <em class="sig-param">calculation='reflected'</em>, <em class="sig-param">full_output=False</em>, <em class="sig-param">plot_opacity=False</em>, <em class="sig-param">as_dict=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.picaso" title="Permalink to this definition">¶</a></dt>
<dd><p>Currently top level program to run albedo code</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bundle</strong> (<em>dict</em>) – This input dict is built by loading the input = <cite>justdoit.load_inputs()</cite></p></li>
<li><p><strong>opacityclass</strong> (<em>class</em>) – Opacity class from <cite>justdoit.opannection</cite></p></li>
<li><p><strong>dimension</strong> (<em>str</em>) – (Optional) Dimensions of the calculation. Default = ‘1d’. But ‘3d’ is also accepted.
In order to run ‘3d’ calculations, user must build 3d input (see tutorials)</p></li>
<li><p><strong>full_output</strong> (<em>bool</em>) – (Optional) Default = False. Returns atmosphere class, which enables several
plotting capabilities.</p></li>
<li><p><strong>plot_opacity</strong> (<em>bool</em>) – (Optional) Default = False, Creates pop up of the weighted opacity</p></li>
<li><p><strong>as_dict</strong> (<em>bool</em>) – (Optional) Default = True. If true, returns a condensed dictionary to the user.
If false, returns the atmosphere class, which can be used for debugging.
The class is clunky to navigate so if you are consiering navigating through this, ping one of the
developers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary with albedos or fluxes or both (depending on what calculation type)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.raman_options">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">raman_options</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.raman_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve options for raman scattering approximtions</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.single_phase_options">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">single_phase_options</code><span class="sig-paren">(</span><em class="sig-param">printout=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.single_phase_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve all the options for direct radation</p>
</dd></dl>

</div>
<div class="section" id="module-picaso.justplotit">
<span id="picaso-justplotit-module"></span><h2>picaso.justplotit module<a class="headerlink" href="#module-picaso.justplotit" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.justplotit.chunk">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">chunk</code><span class="sig-paren">(</span><em class="sig-param">loc</em>, <em class="sig-param">spacing</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.chunk" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of index output from np.where, this function
separates the list into sequential indexes. For example,
[1,2,3,10,11,12] would be returned as [[1,2,3],[10,11,12]</p>
<dl class="simple">
<dt>loc<span class="classifier">np.array</span></dt><dd><p>Set of indecies from np.where</p>
</dd>
<dt>spacing<span class="classifier">int</span></dt><dd><p>Sets the minimum distance between the chunks. E.g. if spacing = 4 then
[1,2,3,5] would not be chunked because the spacing is only 2.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.cloud">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">cloud</code><span class="sig-paren">(</span><em class="sig-param">full_output</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.cloud" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting the cloud input from <code class="docutils literal notranslate"><span class="pre">picaso</span></code>.</p>
<p>The plot itselfs creates maps of the wavelength dependent single scattering albedo
and cloud opacity as a function of altitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>full_output</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A row of two bokeh plots with the single scattering and optical depth map</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.corr_continuum">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">corr_continuum</code><span class="sig-paren">(</span><em class="sig-param">atm</em>, <em class="sig-param">filename_db</em>, <em class="sig-param">wavenumber</em>, <em class="sig-param">residual</em>, <em class="sig-param">max_plot</em>, <em class="sig-param">threshold</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.corr_continuum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.justplotit.corr_molecular">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">corr_molecular</code><span class="sig-paren">(</span><em class="sig-param">atm</em>, <em class="sig-param">filename_db</em>, <em class="sig-param">wavenumber</em>, <em class="sig-param">residual</em>, <em class="sig-param">max_plot</em>, <em class="sig-param">threshold</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.corr_molecular" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.justplotit.disco">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">disco</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">wavelength</em>, <em class="sig-param">calculation='reflected'</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.disco" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot disco ball with facets. Bokeh is not good with 3D things. So this is in matplotlib</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – Full output from picaso</p></li>
<li><p><strong>wavelength</strong> (<em>list</em>) – Where to plot 3d facets. Can input as many wavelengths as wanted.
Must be a list, must be in microns.</p></li>
<li><p><strong>calculation</strong> (<em>str</em><em>, </em><em>optional</em>) – Default is to plot ‘reflected’ light but can also switch to ‘thermal’ if it has been computed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.explore">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">explore</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">key</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.explore" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to explore a dictionary that is THREE levels deep and return the data sitting at
the end of key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>dict</em>) – Dictionary that you want to search through.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Consider a dictionary that has <cite>df[‘layer’][‘cloud’][‘w0’] = [0,0,0]</cite></p>
<p>&gt;&gt;&gt;explore(df, ‘w0’)
[0,0,0]</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.find_nearest_1d">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">find_nearest_1d</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.find_nearest_1d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.justplotit.find_nearest_2d">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">find_nearest_2d</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">value</em>, <em class="sig-param">axis=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.find_nearest_2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.justplotit.find_nearest_old">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">find_nearest_old</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.find_nearest_old" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.justplotit.flux_at_top">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">flux_at_top</code><span class="sig-paren">(</span><em class="sig-param">full_output, plot_bb=True, R=None, pressures=[0.1, 0.01, 0.001], ng=None, nt=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.flux_at_top" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine to plot the OLR with overlaying black bodies.</p>
<p>Flux units are CGS = erg/s/cm^3</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>dict</em>) – full dictionary output with {‘wavenumber’,’thermal’,’full_output’}</p></li>
<li><p><strong>plot_bb</strong> (<em>bool</em><em> , </em><em>optional</em>) – Default is to plot black bodies for three pressures specified by <cite>pressures</cite></p></li>
<li><p><strong>R</strong> (<em>float</em>) – New constant R to bin to</p></li>
<li><p><strong>pressures</strong> (<em>list</em><em>, </em><em>optional</em>) – Default is a list of three pressures (in bars) =  [1e-1,1e-2,1e-3]</p></li>
<li><p><strong>ng</strong> (<em>int</em>) – Used for 3D calculations to select point on the sphere (equivalent to longitude point)</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – Used for 3D calculations to select point on the sphere (equivalent to latitude point)</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.figure()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.get_bad_bands">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">get_bad_bands</code><span class="sig-paren">(</span><em class="sig-param">residual</em>, <em class="sig-param">sensitivity=3</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.get_bad_bands" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a set of residuals, this program separates out the bad bands into
separate lists and returns the indecies of the bad bands in list form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>residual</strong> (<em>np.array</em>) – Model 1 - model 2</p></li>
<li><p><strong>sensitivity</strong> (<em>float</em>) – This will pick out anything that is worse than stdev(residual)/sensitivity. Larger
numbers pick out more problems.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.lon_lat_to_cartesian">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">lon_lat_to_cartesian</code><span class="sig-paren">(</span><em class="sig-param">lon_r</em>, <em class="sig-param">lat_r</em>, <em class="sig-param">R=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.lon_lat_to_cartesian" title="Permalink to this definition">¶</a></dt>
<dd><p>calculates lon, lat coordinates of a point on a sphere with
radius R</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.map">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">map</code><span class="sig-paren">(</span><em class="sig-param">full_output, pressure=[0.1], plot='temperature', wavelength=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.map" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot disco ball with facets. Bokeh is not good with 3D things. So this is in matplotlib</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – Full output from picaso</p></li>
<li><p><strong>pressure</strong> (<em>list</em>) – What pressure (in bars) to make the map on. Note: this assumes that the
pressure grid is the same for each ng,nt point accross the grid.</p></li>
<li><p><strong>plot</strong> (<em>str</em><em>, </em><em>optional</em>) – Default is to plot ‘temperature’ map but can also switch to any
3d [nlayer, nlong, nlat] or 4d [nlayer, nwave, nlong, nlat] output in full_output. You can check what is available to plot by printing:
<cite>print(full_output[‘layer’].keys()</cite>.
If you are plotting something that is ALSO wavelength dependent you have to
also supply a single wavelength.</p></li>
<li><p><strong>float</strong><strong>, </strong><strong>optional</strong> (<em>wavelength</em><em>,</em>) – This allows users to plot maps of things that are wavelength dependent, like
<cite>taugas</cite> and <cite>taucld</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.mixing_ratio">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">mixing_ratio</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.mixing_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns plot of mixing ratios</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – picaso.atmsetup.ATMSETUP</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.figure()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justplotit.numba_cumsum">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">numba_cumsum</code><a class="headerlink" href="#picaso.justplotit.numba_cumsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute cumsum along axis=0 to bypass numba not allowing kwargs in
cumsum</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.photon_attenuation">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">photon_attenuation</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">at_tau=0.5</em>, <em class="sig-param">return_all=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.photon_attenuation" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot breakdown of gas opacity, cloud opacity,
Rayleigh scattering opacity at a specified pressure level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – picaso.atmsetup.ATMSETUP</p></li>
<li><p><strong>at_tau</strong> (<em>float</em>) – Opacity at which to plot the cumulative opacity.
Default = 0.5.</p></li>
<li><p><strong>return_all</strong> (<em>bool</em><em> , </em><em>optional</em>) – Default is False, returns at_tau pressure levels for
taugas, taucld, and tauray</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.plotting.figure()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bokeh plot</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.plot_cld_input">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">plot_cld_input</code><span class="sig-paren">(</span><em class="sig-param">nwno</em>, <em class="sig-param">nlayer</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">df=None</em>, <em class="sig-param">pressure=None</em>, <em class="sig-param">wavelength=None</em>, <em class="sig-param">**pd_kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_cld_input" title="Permalink to this definition">¶</a></dt>
<dd><p>This function was created to investigate CLD input file for PICASO.</p>
<p>The plot itselfs creates maps of the wavelength dependent single scattering albedo
and cloud opacity and assymetry parameter as a function of altitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumber points. For runs from Ackerman &amp; Marley, this will always be 196.</p></li>
<li><p><strong>nlayer</strong> (<em>int</em>) – Should be one less than the number of levels in your pressure temperature grid. Cloud
opacity is assigned for slabs.</p></li>
<li><p><strong>file</strong> (<em>str</em><em> , </em><em>optional</em>) – (Optional)Path to cloud input file</p></li>
<li><p><strong>df</strong> (<em>str</em>) – (Optional)Dataframe of cloud input file</p></li>
<li><p><strong>wavelength</strong> (<em>array</em><em> , </em><em>optional</em>) – (Optional) this allows you to reset the tick marks to wavelengths instead of indicies</p></li>
<li><p><strong>pressure</strong> (<em>array</em><em>, </em><em>optional</em>) – (Optional) this allows you to reset the tick marks to pressure instead of indicies</p></li>
<li><p><strong>pd_kwargs</strong> (<em>kwargs</em>) – Pandas key word arguments for <cite>pandas.read_csv</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Three bokeh plots with the single scattering, optical depth, and assymetry maps</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.plot_errorbar">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">plot_errorbar</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">e</em>, <em class="sig-param">plot</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_errorbar" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot error bars in bokeh plot</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.plot_format">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">plot_format</code><span class="sig-paren">(</span><em class="sig-param">df</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to reformat plots</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.pt">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">pt</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">ng=None</em>, <em class="sig-param">nt=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.pt" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns plot of pressure temperature profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – picaso.atmsetup.ATMSETUP</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.figure()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.spectrum">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">spectrum</code><span class="sig-paren">(</span><em class="sig-param">xarray</em>, <em class="sig-param">yarray</em>, <em class="sig-param">legend=None</em>, <em class="sig-param">wno_to_micron=True</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot formated albedo spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xarray</strong> (<em>float array</em><em>, </em><em>list of arrays</em>) – wavenumber or micron</p></li>
<li><p><strong>yarray</strong> (<em>float array</em><em>, </em><em>list of arrays</em>) – albedo or fluxes</p></li>
<li><p><strong>legend</strong> (<em>list of str</em><em> , </em><em>optional</em>) – legends for plotting</p></li>
<li><p><strong>wno_to_micron</strong> (<em>bool</em><em> , </em><em>optional</em>) – Converts wavenumber to micron</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.plotting.figure()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bokeh plot</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.spectrum_hires">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">spectrum_hires</code><span class="sig-paren">(</span><em class="sig-param">wno</em>, <em class="sig-param">alb</em>, <em class="sig-param">legend=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.spectrum_hires" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot formated albedo spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno</strong> (<em>float array</em><em>, </em><em>list of arrays</em>) – wavenumber</p></li>
<li><p><strong>alb</strong> (<em>float array</em><em>, </em><em>list of arrays</em>) – albedo</p></li>
<li><p><strong>legend</strong> (<em>list of str</em>) – legends for plotting</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for hv.opts</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bokeh plot</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.taumap">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">taumap</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">at_tau=1</em>, <em class="sig-param">wavelength=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.taumap" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot breakdown of gas opacity, cloud opacity,
Rayleigh scattering opacity at a specified pressure level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – picaso.atmsetup.ATMSETUP</p></li>
<li><p><strong>at_tau</strong> (<em>float</em>) – Opacity at which to plot the cumulative opacity.
Default = 0.5.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.plotting.figure()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bokeh plot</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso.opacity_factory">
<span id="picaso-opacity-factory-module"></span><h2>picaso.opacity_factory module<a class="headerlink" href="#module-picaso.opacity_factory" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.opacity_factory.adapt_array">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">adapt_array</code><span class="sig-paren">(</span><em class="sig-param">arr</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.adapt_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.build_skeleton">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">build_skeleton</code><span class="sig-paren">(</span><em class="sig-param">db_f</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.build_skeleton" title="Permalink to this definition">¶</a></dt>
<dd><p>This functionb builds a skeleton sqlite3 database with three tables:
1) header
2) molecular
3) continuum</p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.continuum_avail">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">continuum_avail</code><span class="sig-paren">(</span><em class="sig-param">db_file</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.continuum_avail" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.convert_array">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">convert_array</code><span class="sig-paren">(</span><em class="sig-param">text</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.convert_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.create_grid">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">create_grid</code><span class="sig-paren">(</span><em class="sig-param">min_wavelength</em>, <em class="sig-param">max_wavelength</em>, <em class="sig-param">constant_R</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.create_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple function to create a wavelength grid defined with a constant R.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_wavelength</strong> (<em>float</em>) – Minimum wavelength in microns</p></li>
<li><p><strong>max_wavelength</strong> (<em>float</em>) – Maximum wavelength in microns</p></li>
<li><p><strong>constant_R</strong> (<em>float</em>) – Constant R spacing</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>wavenumber grid defined at constant Resolution</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.create_grid_minR">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">create_grid_minR</code><span class="sig-paren">(</span><em class="sig-param">min_wavelength</em>, <em class="sig-param">max_wavelength</em>, <em class="sig-param">minimum_R</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.create_grid_minR" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple function to create a wavelength grid defined with a minimum R.
This does not create a “constant” resolution grid. Rather, it defines the R
at the minimum R so that the wavelength grid satisfies all_Rs&gt;R</p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.find_nearest">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">find_nearest</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.find_nearest" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.find_nearest_1d">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">find_nearest_1d</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.find_nearest_1d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.fit_linsky">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">fit_linsky</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">wno</em>, <em class="sig-param">va=3</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.fit_linsky" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds H2-H2 opacity from Linsky (1969) and Lenzuni et al. (1991)
to values that were set to -33 as place holders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Temperature</p></li>
<li><p><strong>wno</strong> (<em>numpy.array</em>) – wave number</p></li>
<li><p><strong>va</strong> (<em>int</em><em> or </em><em>float</em>) – (Optional) 1,2 or 3 (depending on what overtone to compute</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>H2-H2 absorption in cm-1 amagat-2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_continuum">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_continuum</code><span class="sig-paren">(</span><em class="sig-param">db_file</em>, <em class="sig-param">species</em>, <em class="sig-param">temperature</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Grab continuum opacity from sqlite database</p>
<dl class="simple">
<dt>db_file<span class="classifier">str</span></dt><dd><p>sqlite3 database filename</p>
</dd>
<dt>species<span class="classifier">list of str</span></dt><dd><p>Single species name. you can run continuum_avail to see what species are present.</p>
</dd>
<dt>temperature<span class="classifier">list of float</span></dt><dd><p>Temperature to grab. can grab available temperatures from continuum_avail</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_h2minus">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_h2minus</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">new_wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_h2minus" title="Permalink to this definition">¶</a></dt>
<dd><p>This results gives the H2 minus opacity, needed for temperatures greater than 600 K.
K L Bell 1980 J. Phys. B: At. Mol. Phys. 13 1859, Table 1
theta=5040/T(K)</p>
<p>The result is given in cm4/dyn, which is why will will  multiply by nh2*ne*k*T
where:
nh2: number of h2 molecules/cm3
ne: number of electrons/cm3
This will happen when we go to sum opacities. For now returns will be in cm4/dyn</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>numpy.ndarray</em>) – temperature in K</p></li>
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>) – wave number cm-1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>H2 minus opacity in units of cm4/dyn</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_hminusbf">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_hminusbf</code><span class="sig-paren">(</span><em class="sig-param">wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_hminusbf" title="Permalink to this definition">¶</a></dt>
<dd><p>H- bound free opacity, which is only dependent on wavelength. From John 1988 <a class="reference external" href="http://adsabs.harvard.edu/abs/1988A%26A...193..189J">http://adsabs.harvard.edu/abs/1988A%26A…193..189J</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wno</strong> (<em>numpy.ndarray</em>) – Wavenumber in cm-1</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Absorption coefficient in units of cm2</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array of floats</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_hminusff">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_hminusff</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_hminusff" title="Permalink to this definition">¶</a></dt>
<dd><p>H- free free opacity, which is both wavelength and temperature dependent.
From Bell &amp; Berrington (1987)
Also includes factor for simulated emission</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Temperature in K</p></li>
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>) – Wavenumber in cm-1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gives cross section in cm^5</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array of float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_kark_CH4">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_kark_CH4</code><span class="sig-paren">(</span><em class="sig-param">kark_file</em>, <em class="sig-param">new_wno</em>, <em class="sig-param">T</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_kark_CH4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_kark_CH4_noTdependence">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_kark_CH4_noTdependence</code><span class="sig-paren">(</span><em class="sig-param">kark_dir</em>, <em class="sig-param">new_wave</em>, <em class="sig-param">temperature</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_kark_CH4_noTdependence" title="Permalink to this definition">¶</a></dt>
<dd><p>Files from kark+2010 paper</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>opacity in cm2/species</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_molecular">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_molecular</code><span class="sig-paren">(</span><em class="sig-param">db_file</em>, <em class="sig-param">species</em>, <em class="sig-param">temperature</em>, <em class="sig-param">pressure</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_molecular" title="Permalink to this definition">¶</a></dt>
<dd><p>Grab molecular opacity from sqlite database</p>
<dl class="simple">
<dt>db_file<span class="classifier">str</span></dt><dd><p>sqlite3 database filename</p>
</dd>
<dt>species<span class="classifier">list of str</span></dt><dd><p>Single species name. you can run molecular_avail to see what species are present.</p>
</dd>
<dt>temperature<span class="classifier">list of flaot,int</span></dt><dd><p>Temperature to grab. This will grab the nearest pair neighbor so you dont
have to be exact.
This should be used in conjuction with pressure. For example, if you want
one temperature at two pressures, then this should be input as
t = [100,100] (and pressure would be p=[0.1,1] for instance)</p>
</dd>
<dt>pressure<span class="classifier">list of flaot,int</span></dt><dd><p>Pressure to grab. This will grab the nearest pair neighbor so you dont
have to be exact.
This should be used in conjuction with pressure. For example, if you want
one temperature at two pressures, then this should be input as
t = [100,100] (and pressure would be p=[0.1,1] for instance)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_optical_o3">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_optical_o3</code><span class="sig-paren">(</span><em class="sig-param">file_o3</em>, <em class="sig-param">new_wvno_grid</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_optical_o3" title="Permalink to this definition">¶</a></dt>
<dd><p>This hacked ozone is from here:
<a class="reference external" href="http://satellite.mpic.de/spectral_atlas/cross_sections/Ozone/O3.spc">http://satellite.mpic.de/spectral_atlas/cross_sections/Ozone/O3.spc</a></p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_original_data">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_original_data</code><span class="sig-paren">(</span><em class="sig-param">original_file</em>, <em class="sig-param">colnames</em>, <em class="sig-param">new_db</em>, <em class="sig-param">overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_original_data" title="Permalink to this definition">¶</a></dt>
<dd><p>The continuum factory takes the CIA opacity file and adds in extra sources of
opacity from other references to fill in empty bands. It assumes that the original file is
structured as following,with the first column wavenumber and the rest molecules:
1000 198
75.
0.0  -33.0000  -33.0000  -33.0000  -33.0000  -33.0000
20.0   -7.4572   -7.4518   -6.8038   -6.0928   -5.9806
40.0   -6.9547   -6.9765   -6.6322   -5.7934   -5.4823
… … … etc</p>
<p>Where 1000 corresponds to the number of wavelengths, 198 corresponds to the number of temperatures
and 75 is the first temperature. If this structure changes, we will need to restructure this top
level __init__ function that reads it in the original opacity file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_file</strong> (<em>str</em>) – Filepath that points to original opacity file (see description above)</p></li>
<li><p><strong>colnames</strong> (<em>list</em>) – defines the sources of opacity in the original file. For the example file above,
colnames would be [‘wno’,’H2H2’,’H2He’,’H2H’,’H2CH4’,’H2N2’]</p></li>
<li><p><strong>new_db</strong> (<em>str</em>) – New database name</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>) – Default is set to False as to not overwrite any existing files. This parameter controls overwriting
cia database</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.h2h2_overtone">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">h2h2_overtone</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.h2h2_overtone" title="Permalink to this definition">¶</a></dt>
<dd><p>Add in special CIA h2h2 band at 0.8 microns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Temperature</p></li>
<li><p><strong>wno</strong> (<em>numpy.array</em>) – wave number</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>H2-H2 absorption in cm-1 amagat-2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.insert">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">insert</code><span class="sig-paren">(</span><em class="sig-param">cur</em>, <em class="sig-param">conn</em>, <em class="sig-param">mol</em>, <em class="sig-param">T</em>, <em class="sig-param">opacity</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.insert" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert into</p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.insert_wno_grid">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">insert_wno_grid</code><span class="sig-paren">(</span><em class="sig-param">wno_grid</em>, <em class="sig-param">cur</em>, <em class="sig-param">con</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.insert_wno_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts basics into the header file. This puts all the units to the database.</p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.listdir">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">listdir</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.listdir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.molecular_avail">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">molecular_avail</code><span class="sig-paren">(</span><em class="sig-param">db_file</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.molecular_avail" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.open_local">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">open_local</code><span class="sig-paren">(</span><em class="sig-param">db_f</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.open_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Code needed to open up local database, interpret arrays from bytes and return cursor</p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.resample_and_insert_molecular">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">resample_and_insert_molecular</code><span class="sig-paren">(</span><em class="sig-param">molecule</em>, <em class="sig-param">min_wavelength</em>, <em class="sig-param">max_wavelength</em>, <em class="sig-param">new_R</em>, <em class="sig-param">og_directory</em>, <em class="sig-param">new_db</em>, <em class="sig-param">dir_kark_ch4=None</em>, <em class="sig-param">dir_optical_o3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.resample_and_insert_molecular" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to resample 1060 grid data onto lower resolution grid. The general procedure
in this function is to interpolate original 1060 data onto very high resolution
grid (R=1e6). Then, determine number of bins to take given input ‘new_R’. The final
opacity grid will be : original_opacity[::BINS]</p>
<p>NOTE: From several tests “new_R” should be at least 100x higher than the ultimate
planet spectrum you want to bin down to.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>str</em>) – Name of molecule (should match a directory with 1060 files)</p></li>
<li><p><strong>min_wavelength</strong> (<em>float</em>) – Minimum wavelength in database in units of micron</p></li>
<li><p><strong>max_wavelength</strong> (<em>float</em>) – Maximum wavelength in database in units of micron</p></li>
<li><p><strong>new_R</strong> (<em>float</em>) – New R to regrid to. If new_R=None, it will retain the original 1e6 million resolution
of the lbl grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.restruct_continuum">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">restruct_continuum</code><span class="sig-paren">(</span><em class="sig-param">original_file</em>, <em class="sig-param">colnames</em>, <em class="sig-param">new_wno</em>, <em class="sig-param">new_db</em>, <em class="sig-param">overwrite</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.restruct_continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>The continuum factory takes the CIA opacity file and adds in extra sources of
opacity from other references to fill in empty bands. It assumes that the original file is
structured as following,with the first column wavenumber and the rest molecules:
1000 198
75.
0.0  -33.0000  -33.0000  -33.0000  -33.0000  -33.0000
20.0   -7.4572   -7.4518   -6.8038   -6.0928   -5.9806
40.0   -6.9547   -6.9765   -6.6322   -5.7934   -5.4823
… … … etc</p>
<p>Where 1000 corresponds to the number of wavelengths, 198 corresponds to the number of temperatures
and 75 is the first temperature. If this structure changes, we will need to restructure this top
level __init__ function that reads it in the original opacity file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_file</strong> (<em>str</em>) – Filepath that points to original opacity file (see description above)</p></li>
<li><p><strong>colnames</strong> (<em>list</em>) – defines the sources of opacity in the original file. For the example file above,
colnames would be [‘wno’,’H2H2’,’H2He’,’H2H’,’H2CH4’,’H2N2’]</p></li>
<li><p><strong>new_wno</strong> (<em>numpy.ndarray</em><em>, </em><em>list</em>) – wavenumber grid to interpolate onto (units of inverse cm)</p></li>
<li><p><strong>new_db</strong> (<em>str</em>) – New database name</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>) – Default is set to False as to not overwrite any existing files. This parameter controls overwriting
cia database</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.restructure_opacity">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">restructure_opacity</code><span class="sig-paren">(</span><em class="sig-param">new_db</em>, <em class="sig-param">ntemp</em>, <em class="sig-param">temperatures</em>, <em class="sig-param">molecules</em>, <em class="sig-param">og_opacity</em>, <em class="sig-param">old_wno</em>, <em class="sig-param">new_wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.restructure_opacity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.vectorize_rebin_mean">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">vectorize_rebin_mean</code><span class="sig-paren">(</span><em class="sig-param">bins</em>, <em class="sig-param">Fp</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.vectorize_rebin_mean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.vectorize_rebin_median">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">vectorize_rebin_median</code><span class="sig-paren">(</span><em class="sig-param">bins</em>, <em class="sig-param">Fp</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.vectorize_rebin_median" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.vresample_and_insert_molecular">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">vresample_and_insert_molecular</code><span class="sig-paren">(</span><em class="sig-param">molecule</em>, <em class="sig-param">min_wavelength</em>, <em class="sig-param">max_wavelength</em>, <em class="sig-param">new_R</em>, <em class="sig-param">og_directory</em>, <em class="sig-param">new_db</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.vresample_and_insert_molecular" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is identical to resample_and_insert_molecular but it was
written to determine if taking the median was better than taking every BIN’th
data point. It uses a special  vectorize function to speed up the median.
Results are about the same but this is much slower to run.
So dont bother using this unless there is something specific to try.</p>
</dd></dl>

</div>
<div class="section" id="module-picaso.optics">
<span id="picaso-optics-module"></span><h2>picaso.optics module<a class="headerlink" href="#module-picaso.optics" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="picaso.optics.RetrieveOpacities">
<em class="property">class </em><code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">RetrieveOpacities</code><span class="sig-paren">(</span><em class="sig-param">db_filename</em>, <em class="sig-param">raman_data</em>, <em class="sig-param">wave_range=None</em>, <em class="sig-param">location='local'</em>, <em class="sig-param">resample=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This will be the class that will retrieve the opacities from the sqlite3 database. Right
now we are just employing nearest neighbors to grab the respective opacities.
Eventually, we will switch to correlated K.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_filename</strong> (<em>str</em>) – Opacity file name</p></li>
<li><p><strong>raman_data</strong> (<em>str</em>) – file name of the raman cross section data</p></li>
<li><p><strong>wave_range</strong> (<em>list of float</em>) – Wavelength range (in microns) to run.
Default None grabs all the full wavelength range available</p></li>
<li><p><strong>location</strong> (<em>str</em>) – Default = local. This is the only option currently available since
we dont have AWS or other services enabled.</p></li>
<li><p><strong>resample</strong> (<em>int</em>) – Default =1 (no resampling)</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.raman_db">
<code class="sig-name descname">raman_db</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.raman_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Database of Raman cross sections</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.wno">
<code class="sig-name descname">wno</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.wno" title="Permalink to this definition">¶</a></dt>
<dd><p>Wavenumber grid from opacity database (CGS cm-1)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.wave">
<code class="sig-name descname">wave</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.wave" title="Permalink to this definition">¶</a></dt>
<dd><p>Wavelength grid from opacity database (micron)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.nwno">
<code class="sig-name descname">nwno</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.nwno" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of wavenumber points in the grid</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.cia_temps">
<code class="sig-name descname">cia_temps</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.cia_temps" title="Permalink to this definition">¶</a></dt>
<dd><p>CIA temps available from database</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.molecules">
<code class="sig-name descname">molecules</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>Molecules availalbe from database</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.pt_pairs">
<code class="sig-name descname">pt_pairs</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.pt_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>pressure-temperature pairs available from grid (our grid is usually
computed on a fixed 1060 PT grid)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.molecular_opa">
<code class="sig-name descname">molecular_opa</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.molecular_opa" title="Permalink to this definition">¶</a></dt>
<dd><p>Molecular Opacity dictionary that contains all the queried information necessary
to do calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.continuum_opa">
<code class="sig-name descname">continuum_opa</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.continuum_opa" title="Permalink to this definition">¶</a></dt>
<dd><p>Continuum opacity dictionary that contains all the queried information
necessary for the calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.rayleigh_opa">
<code class="sig-name descname">rayleigh_opa</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.rayleigh_opa" title="Permalink to this definition">¶</a></dt>
<dd><p>Rayleigh opacity dictionary for all the sources we have. This is computed as
cm^2/species when the users runs <cite>opannection</cite>. We technically could just
store this in the DB as well. However, because its so fast, it doesn’t take
a lot of time, and because its non-temperature dependent, we only have to do
it once.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.db_connect">
<code class="sig-name descname">db_connect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.db_connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Inherents functionality of <cite>open_local</cite>. Eventually it will
inherent functionality of “open_non_locals” (e.g. cloud or other sources)</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.open_local">
<code class="sig-name descname">open_local</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.open_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens sqlite3 connection and enables array interpretation from bytes</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.get_available_data">
<code class="sig-name descname">get_available_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_available_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets opacity database attributes such as available T-Ps , availalbe molecules. etc.</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.get_available_rayleigh">
<code class="sig-name descname">get_available_rayleigh</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_available_rayleigh" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets rayleigh cross sections when opannection is opened.</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.get_opacities">
<code class="sig-name descname">get_opacities</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_opacities" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets opacities after user specifies atmospheric profile (e.g. full PT and Composition)</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.adapt_array">
<code class="sig-name descname">adapt_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.adapt_array" title="Permalink to this definition">¶</a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.compute_stellar_shits">
<code class="sig-name descname">compute_stellar_shits</code><span class="sig-paren">(</span><em class="sig-param">wno_star</em>, <em class="sig-param">flux_star</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.compute_stellar_shits" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the hires stellar spectrum and computes Raman shifts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno_star</strong> (<em>array</em>) – hires wavelength grid of the star in wave number</p></li>
<li><p><strong>flux_star</strong> (<em>array</em>) – Flux of the star in whatever units. Doesn’t matter for this since it’s returning a ratio</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of the shifted stellar spec divided by the unshifted stellar spec on the model wave
number grid</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.convert_array">
<code class="sig-name descname">convert_array</code><span class="sig-paren">(</span><em class="sig-param">text</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.convert_array" title="Permalink to this definition">¶</a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">get_available_data</code><span class="sig-paren">(</span><em class="sig-param">wave_range</em>, <em class="sig-param">resample</em><span class="sig-paren">)</span></dt>
<dd><p>Get the pressures and temperatures that are available for the continuum and molecules</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">get_available_rayleigh</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.get_continuum_opac">
<code class="sig-name descname">get_continuum_opac</code><span class="sig-paren">(</span><em class="sig-param">temperature</em>, <em class="sig-param">molecule</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_continuum_opac" title="Permalink to this definition">¶</a></dt>
<dd><p>DISCONTINUED.
Based on a temperature, this retrieves the continuum opacity for</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>float array</em>) – An array of temperatures to retrieve the continuum opacity at</p></li>
<li><p><strong>molecule</strong> (<em>str</em>) – Which opacity source to query. currently available: ‘h2h2’,’h2he’,’h2h’,’h2ch4’,’h2n2’</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>number of layers by number of wave points</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.get_molecular_opac">
<code class="sig-name descname">get_molecular_opac</code><span class="sig-paren">(</span><em class="sig-param">temperature</em>, <em class="sig-param">pressure</em>, <em class="sig-param">molecule</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_molecular_opac" title="Permalink to this definition">¶</a></dt>
<dd><p>DISCONTINUED.
Based on temperature, and pressure, retrieves the molecular opacity for
certain molecule</p>
<p>Molecular opacity should be in cm2/molecule units. That is why there is an
multiplication of N_a on return</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temperature</strong> (<em>array of float</em>) – An array of temperatures to retrieve the continuum opacity at</p></li>
<li><p><strong>pressure</strong> (<em>array of float</em>) – Pressures (IN BARS) to retrieve the continuum opacity at</p></li>
<li><p><strong>molecule</strong> (<em>str</em>) – Which opacity source to query. Will get error if not in the db</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">get_opacities</code><span class="sig-paren">(</span><em class="sig-param">atmosphere</em>, <em class="sig-param">dimension='1d'</em><span class="sig-paren">)</span></dt>
<dd><p>Get’s opacities using the atmosphere class</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">open_local</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Code needed to open up local database, interpret arrays from bytes and return cursor</p>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.bin_star">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">bin_star</code><a class="headerlink" href="#picaso.optics.bin_star" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes average of group of points using uniform tophat</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno_new</strong> (<em>numpy.array</em>) – inverse cm grid to bin to (cm-1)</p></li>
<li><p><strong>wno_old</strong> (<em>numpy.array</em>) – inverse cm grid (old grid)</p></li>
<li><p><strong>Fp</strong> (<em>numpy.array</em>) – transmission spectra, which is on wno grid</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.optics.compute_opacity">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">compute_opacity</code><span class="sig-paren">(</span><em class="sig-param">atmosphere</em>, <em class="sig-param">opacityclass</em>, <em class="sig-param">delta_eddington=True</em>, <em class="sig-param">test_mode=False</em>, <em class="sig-param">raman=0</em>, <em class="sig-param">plot_opacity=False</em>, <em class="sig-param">full_output=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.compute_opacity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns total optical depth per slab layer including molecular opacity, continuum opacity.
It should automatically select the molecules needed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmosphere</strong> (<em>class ATMSETUP</em>) – This inherets the class from atmsetup.py</p></li>
<li><p><strong>opacityclass</strong> (<em>class opacity</em>) – This inherets the class from optics.py. It is done this way so that the opacity db doesnt have
to be reloaded in a retrieval</p></li>
<li><p><strong>delta_eddington</strong> (<em>bool</em>) – (Optional) Default=True, With Delta-eddington on, it incorporates the forward peak
contribution by adjusting optical properties such that the fraction of scattered energy
in the forward direction is removed from the scattering parameters</p></li>
<li><p><strong>raman</strong> (<em>int</em>) – (Optional) Default =0 which corresponds to oklopcic+2018 raman scattering cross sections.
Other options include 1 for original pollack approximation for a 6000K blackbody.
And 2 for nothing.</p></li>
<li><p><strong>test_mode</strong> (<em>bool</em>) – (Optional) Default = False to run as normal. This will overwrite the opacities and fix the
delta tau at 0.5.</p></li>
<li><p><strong>full_output</strong> (<em>bool</em>) – (Optional) Default = False. If true, This will add taugas, taucld, tauray to the atmosphere class.
This is done so that the users can debug, plot, etc.</p></li>
<li><p><strong>plot_opacity</strong> (<em>bool</em>) – (Optional) Default = False. If true, Will create a pop up plot of the weighted of each absorber
at the middle layer.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>DTAU</strong> (<em>ndarray</em>) – This is a matrix with # layer by # wavelength. It is the opacity contained within a layer
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>TAU</strong> (<em>ndarray</em>) – This is a matrix with # level by # wavelength. It is the cumsum of opacity contained
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>WBAR</strong> (<em>ndarray</em>) – This is the single scattering albedo that includes rayleigh, raman and user input scattering sources.
It has dimensions: # layer by # wavelength
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>COSB</strong> (<em>ndarray</em>) – This is the asymettry factor which accounts for rayleigh and user specified values
It has dimensions: # layer by # wavelength
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>ftau_cld</strong> (<em>ndarray</em>) – This is the fraction of cloud opacity relative to the total TAUCLD/(TAUCLD + TAURAY)</p></li>
<li><p><strong>ftau_ray</strong> (<em>ndarray</em>) – This is the fraction of rayleigh opacity relative to the total TAURAY/(TAUCLD + TAURAY)</p></li>
<li><p><strong>GCOS2</strong> (<em>ndarray</em>) – This is used for Cahoy+2010 methodology for accounting for rayleigh scattering. It
replaces the use of the actual rayleigh phase function by just multiplying ftau_ray by 2</p></li>
<li><p><strong>DTAU</strong> (<em>ndarray</em>) – This is a matrix with # layer by # wavelength. It is the opacity contained within a layer
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>TAU</strong> (<em>ndarray</em>) – This is a matrix with # level by # wavelength. It is the cumsum of opacity contained
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>Original, never corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>WBAR</strong> (<em>ndarray</em>) – This is the single scattering albedo that includes rayleigh, raman and user input scattering sources.
It has dimensions: # layer by # wavelength
<strong>Original, never corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>COSB</strong> (<em>ndarray</em>) – This is the asymettry factor which accounts for rayleigh and user specified values
It has dimensions: # layer by # wavelength
<strong>Original, never corrected for with Delta-Eddington.</strong></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This was baselined against jupiter with the old fortran code. It matches 100% for all cases
except for hotter cases where Na &amp; K are present. This differences is not a product of the code
but a product of the different opacities (1060 grid versus old 736 grid)</p>
<div class="admonition-todo admonition" id="id14">
<p class="admonition-title">Todo</p>
<p>Add a better approximation than delta-scale (e.g. M.Marley suggests a paper by Cuzzi that has
a better methodology)</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.compute_raman">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">compute_raman</code><a class="headerlink" href="#picaso.optics.compute_raman" title="Permalink to this definition">¶</a></dt>
<dd><p>The Ramam scattering will alter the rayleigh scattering. The returned value is
modified single scattering albedo.</p>
<p>Cross sectiosn from:
<a class="reference external" href="http://iopscience.iop.org/0004-637X/832/1/30/suppdata/apjaa3ec7t2_mrt.txt">http://iopscience.iop.org/0004-637X/832/1/30/suppdata/apjaa3ec7t2_mrt.txt</a></p>
<p>This method is described in Pollack+1986. Albeit not the best method. Sromovsky+2005
pointed out the inconsistencies in this method. You can see from his comparisons
that the Pollack approximations don’t accurately capture the depths of the line centers.
Since then, OKLOPCIC+2016 recomputed cross sections for J&lt;=9. We are using those cross
sections here with a different star. Huge improvement over what we had before.
Number of J levels is hard coded to 10 !</p>
<p>Will be added to the rayleigh scattering as : TAURAY*RAMAN</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wave points</p></li>
<li><p><strong>nlayer</strong> (<em>int</em>) – Number of layers</p></li>
<li><p><strong>wno</strong> (<em>array</em>) – Array of output grid of wavenumbers</p></li>
<li><p><strong>stellar_shifts</strong> (<em>ndarray</em>) – Array of floats that has dimensions (n wave pts x n J levels: 0-9)</p></li>
<li><p><strong>tlayer</strong> (<em>array</em>) – Array of floats that has dimensions nlayer</p></li>
<li><p><strong>cross_sections</strong> (<em>ndarray</em>) – The row of “C’s” from Antonija’s table.</p></li>
<li><p><strong>j_initial</strong> (<em>ndarray</em>) – The row of initial rotational energy states from Antonija’s table</p></li>
<li><p><strong>deltanu</strong> (<em>ndarray</em>) – The row of delta nu’s from Antonia’s table</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.find_nearest">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">find_nearest</code><a class="headerlink" href="#picaso.optics.find_nearest" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="picaso.optics.j_fraction">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">j_fraction</code><a class="headerlink" href="#picaso.optics.j_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>This computes the fraction of molecules at each J level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>j</strong> (<em>int</em>) – The initial rotational levels ranging from J=0 to 9 for hydrogen only</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>f_J in eqn. 3 https</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>//arxiv.org/pdf/1605.07185.pdf</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.numba_cumsum">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">numba_cumsum</code><a class="headerlink" href="#picaso.optics.numba_cumsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute cumsum along axis=0 to bypass numba not allowing kwargs in
cumsum</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.partition_function">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">partition_function</code><a class="headerlink" href="#picaso.optics.partition_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Given j and T computes partition function for ro-vibrational levels of H2.
This is the exponential and the statistical weight g_J in
Eqn 3 in <a class="reference external" href="https://arxiv.org/pdf/1605.07185.pdf">https://arxiv.org/pdf/1605.07185.pdf</a>
It is also used to compute the partition sum Z.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>j</strong> (<em>int</em>) – Energy level</p></li>
<li><p><strong>T</strong> (<em>array float</em>) – Temperature at each atmospheric layer in the atmosphere</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Returns partition function</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.partition_sum">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">partition_sum</code><a class="headerlink" href="#picaso.optics.partition_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the total partition sum. I am truncating it at 20 since it seems to approach 1 around then.
This is also pretty fast to compute so 20 is fine for now.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>T</strong> (<em>array</em>) – Array of temperatures for each layer</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Z, the partition sum</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.optics.raman_pollack">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">raman_pollack</code><span class="sig-paren">(</span><em class="sig-param">nlayer</em>, <em class="sig-param">wave</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.raman_pollack" title="Permalink to this definition">¶</a></dt>
<dd><p>Mystery raman scattering. Couldn’t figure out where it came from.. so discontinuing.
Currently function doesnt’ totally work. In half fortran-half python. Legacy from
fortran albedo code.</p>
<p>This method is described in Pollack+1986. Albeit not the best method. Sromovsky+2005
pointed out the inconsistencies in this method. You can see from his comparisons
that the Pollack approximations don’t accurately capture the depths of the line centers.
Since then, OKLOPCIC+2016 did a much
better model of raman scattring (with ghost lines). Might be worth it to consider a more
sophisticated version of Raman scattering.</p>
<p>Will be added to the rayleigh scattering as : TAURAY*RAMAN</p>
<p>#OLD FORTRAN CODE
#constants
h = 6.6252e-27
c = 2.9978e10
bohrd = 5.2917e-9
hmass = 1.6734e-24
rmu = .5 * hmass</p>
<p>#set wavelength shift of the ramam scatterer
shift_v0 = 4161.0</p>
<p>facip = h * c / ( 1.e-4 * 27.2 * 1.602e-12 )
facray = 1.e16 * bohrd ** 3 * 128. * np.pi ** 5 * bohrd ** 3 / 9.
facv = 2.08 / 2.38 * facray / bohrd ** 2 / ( 8. * np.pi * np.pi * rmu * c * shift_v0 ) * h</p>
<p>#cross section of the unshifted rayleigh and the vibrationally shifted rayleigh
gli = np.zeros(5)
wli = np.zeros(5)
gri = np.zeros(5)
wri = np.zeros(5)
gli[:] = [1.296, .247, .297,  .157,  .003]
wli[:] = [.507, .628, .733, 1.175, 2.526]
gri[:] = [.913, .239, .440,  .344,  .064]
wri[:] = [.537, .639, .789, 1.304, 3.263]</p>
<p>alp = np.zeros(7)
arp = np.zeros(7)
alp[:] = [6.84, 6.96, 7.33, 8.02, 9.18, 11.1, 14.5 ]
arp[:] = [3.66, 3.71, 3.88, 4.19, 4.70, 5.52, 6.88 ]</p>
<p>omega = facip / wavelength</p>
<p>#first compute extinction cross section for unshifted component
#e.g. rayleigh
alpha_l=0
alpha_r=0</p>
<dl class="simple">
<dt>for i in range(5):</dt><dd><p>alpha_l += gli[i] / ( wli[i] ** 2 - omega ** 2 )
alpha_r += gri[i] / ( wri[i] ** 2 - omega ** 2 )</p>
</dd>
</dl>
<p>alpha2 = (( 2. * alpha_r + alpha_l ) / 3. ) ** 2
gamma2 = ( alpha_l - alpha_r ) ** 2
qray = facray * ( 3. * alpha2 + 2./3. * gamma2 ) / wavelength ** 4</p>
<p>#next, compute the extinction cross section for vibrationally
#shifted component
ip = np.zeros(2)
ip[:] = [int(omega/0.05), 5.0]
ip = np.min(ip) + 1
f = omega / 0.05 - float(ip-1)
alpha_pl = ( 1. - f ) * alp[ip] + f * alp[ip+1]
alpha_pr = ( 1. - f ) * arp[ip] + f * arp[ip+1]
alpha_p2 = (( 2. * alpha_pr + alpha_pl ) / 3. ) ** 2
gamma_p2 = ( alpha_pl - alpha_pr ) ** 2
qv = facv / SHIFT( WAVEL, -SHIFTV0 ) ** 4 * ( 3. * alpha_p2 + 2./3. * gamma_p2 )</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.rayleigh_old">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">rayleigh_old</code><a class="headerlink" href="#picaso.optics.rayleigh_old" title="Permalink to this definition">¶</a></dt>
<dd><p>DISCONTINUED
Rayleigh function taken from old albedo code. Keeping this modular, as we may want
to swap out different methods to calculate rayleigh opacity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>colden</strong> (<em>array of float</em>) – Column Density in CGS units</p></li>
<li><p><strong>mixingratios</strong> (<em>array of float</em>) – Mixing ratio as function of altitude for [H2  He CH4 ]</p></li>
<li><p><strong>wave</strong> (<em>array of float</em>) – wavelength (microns) of grid. This should be in DECENDING order to comply with
everything else being in wave numberes</p></li>
<li><p><strong>xmu</strong> (<em>array of float</em>) – mean molecular weight of atmosphere in amu</p></li>
<li><p><strong>amu</strong> (<em>float</em>) – amu constant in grams</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso.test">
<span id="picaso-test-module"></span><h2>picaso.test module<a class="headerlink" href="#module-picaso.test" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.test.dlugach_test">
<code class="sig-prename descclassname">picaso.test.</code><code class="sig-name descname">dlugach_test</code><span class="sig-paren">(</span><em class="sig-param">single_phase='TTHG_ray'</em>, <em class="sig-param">output_dir=None</em>, <em class="sig-param">rayleigh=True</em>, <em class="sig-param">constant_tau=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.test.dlugach_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Test the flux against against Dlugach &amp; Yanovitskij
<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/0019103574901675?via%3Dihub">https://www.sciencedirect.com/science/article/pii/0019103574901675?via%3Dihub</a></p>
<p>There are two tests: rayleigh and constant_tau. This will run through the entire
table of values (XXI). Users can run both or specify one. Constant_tau picks
single value for the asymmetry factors g = [0.5,0.75,0.8,0.85,0.9] and tests
single scattering abled. Rayleigh only varies the ssa (with rayleigh phase fun)</p>
<p>This routine contains the functionality to reproduce table XXI and determine the %
error in various realms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>single_phase</strong> (<em>str</em>) – Single phase function to test with the constant_tau test. Can either be:
“cahoy”,”TTHG_ray”,”TTHG”, and “OTHG”</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – Output directory for results of test. Default is to just return the dataframe (None).</p></li>
<li><p><strong>rayleigh</strong> (<em>bool</em>) – Default is True. Turns on and off the rayleigh phase function test</p></li>
<li><p><strong>constant_tau</strong> (<em>float</em>) – Default=True. Turns on and off the constant tau phase function test</p></li>
<li><p><strong>Retuns</strong> – </p></li>
<li><p><strong>------</strong> – </p></li>
<li><p><strong>of % deviation from Dlugach &amp; Yanovitskij Table XXI</strong> (<em>DataFrame</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.test.madhu_test">
<code class="sig-prename descclassname">picaso.test.</code><code class="sig-name descname">madhu_test</code><span class="sig-paren">(</span><em class="sig-param">rayleigh=True</em>, <em class="sig-param">isotropic=True</em>, <em class="sig-param">asymmetric=True</em>, <em class="sig-param">single_phase='TTHG_ray'</em>, <em class="sig-param">output_dir=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.test.madhu_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Test the flux against against Madhu and Burrows
<a class="reference external" href="https://arxiv.org/pdf/1112.4476.pdf">https://arxiv.org/pdf/1112.4476.pdf</a></p>
<p>There are three tests: rayleigh, isotropic, and lambert. Reproduces Figure 2 of
Madhu and Burrows paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rayleigh</strong> (<em>bool</em>) – Tests rayleigh phase function</p></li>
<li><p><strong>isotropic</strong> (<em>bool</em>) – Tests isotropic phase function</p></li>
<li><p><strong>single_phase</strong> (<em>str</em>) – Single phase function to test with the constant_tau test. Can either be:
“cahoy”,”TTHG_ray”,”TTHG”, and “OTHG”</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – Output directory for results of test. Default is to just return the dataframe (None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataFrame of % deviation from Dlugach &amp; Yanovitskij Table XXI</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso.wavelength">
<span id="picaso-wavelength-module"></span><h2>picaso.wavelength module<a class="headerlink" href="#module-picaso.wavelength" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.wavelength.get_cld_input_grid">
<code class="sig-prename descclassname">picaso.wavelength.</code><code class="sig-name descname">get_cld_input_grid</code><span class="sig-paren">(</span><em class="sig-param">filename_or_grid</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.wavelength.get_cld_input_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>The albedo code relies on the cloud code input, which is traditionally on a 196 wavelength grid.
This method is to retrieve that grid. This file should be kept in the package reference data. Alternatively,
it might be useful to add it directly to the input.cld file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename_or_grid</strong> (<em>str</em><em> or </em><em>ndarray</em>) – filename of the input grid OR a numpy array of wavenumber corresponding to cloud
input</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of wave numbers in increasing order</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.wavelength.regrid">
<code class="sig-prename descclassname">picaso.wavelength.</code><code class="sig-name descname">regrid</code><span class="sig-paren">(</span><em class="sig-param">matrix</em>, <em class="sig-param">old_wno</em>, <em class="sig-param">new_wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.wavelength.regrid" title="Permalink to this definition">¶</a></dt>
<dd><p>This takes in a matrix that is (number of something versus number of wavelength points) and regrids
to a new wave grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> (<em>ndarray</em>) – matrix that is (number of something versus number of wavelength points)</p></li>
<li><p><strong>old_wno</strong> (<em>array</em>) – array that represents the old wavelength grid of the matrix</p></li>
<li><p><strong>new_wno</strong> (<em>array</em>) – array that represents the desired wavelength grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matrix that has been reinterpolated to new wave number grid</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matrix</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-picaso" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="notebooks/11_Sqlite3Tutorial.html" class="btn btn-neutral float-left" title="SQLITE Tutorial" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Natasha E. Batalha

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>