

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Code &mdash; picaso 0.0dev documentation</title>
  

  
  
  
  

  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" type="text/css" />
  

  
        <link rel="index" title="Index"
              href="genindex.html"/>
        <link rel="search" title="Search" href="search.html"/>
    <link rel="top" title="picaso 0.0dev documentation" href="index.html"/>
        <link rel="prev" title="Creating new Opacity Databases" href="notebooks/5_SwappingOpacities.html"/> 

  
  <script src="_static/js/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

   
  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search">
          

          
            <a href="index.html" class="icon icon-home"> picaso
          

          
          </a>

          
            
            
              <div class="version">
                0.0dev
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">The Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://natashabatalha.github.io/picaso/picaso">The Derivations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.atmsetup">picaso.atmsetup module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.build_3d_input">picaso.build_3d_input module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.disco">picaso.disco module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.elements">picaso.elements module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.fluxes">picaso.fluxes module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.io_utils">picaso.io_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.justdoit">picaso.justdoit module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.justplotit">picaso.justplotit module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.opacity_factory">picaso.opacity_factory module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.optics">picaso.optics module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.run_opa_factory">picaso.run_opa_factory module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.test">picaso.test module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.test_optics">picaso.test_optics module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.wavelength">picaso.wavelength module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/natashabatalha/picaso">Github</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Paper</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.atmsetup">picaso.atmsetup module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.build_3d_input">picaso.build_3d_input module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.disco">picaso.disco module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.elements">picaso.elements module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.fluxes">picaso.fluxes module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.io_utils">picaso.io_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.justdoit">picaso.justdoit module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.justplotit">picaso.justplotit module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.opacity_factory">picaso.opacity_factory module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.optics">picaso.optics module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.run_opa_factory">picaso.run_opa_factory module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.test">picaso.test module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.test_optics">picaso.test_optics module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.wavelength">picaso.wavelength module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso">Module contents</a></li>
</ul>
</li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">picaso</a>
        
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>The Code</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/picaso.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast,
.nboutput.nblast {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast + .nbinput {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}
</style>
<div class="section" id="the-code">
<h1>The Code<a class="headerlink" href="#the-code" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-picaso.atmsetup">
<span id="picaso-atmsetup-module"></span><h2>picaso.atmsetup module<a class="headerlink" href="#module-picaso.atmsetup" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="picaso.atmsetup.ATMSETUP">
<em class="property">class </em><code class="descclassname">picaso.atmsetup.</code><code class="descname">ATMSETUP</code><span class="sig-paren">(</span><em>config</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>Reads in default source configuration from JSON and creates a full atmosphere class.</p>
<ul class="simple">
<li>Gets PT profile</li>
<li>Computes mean molecular weight, density, column density, mixing ratios</li>
<li>Gets cloud profile</li>
<li>Gets stellar profile</li>
</ul>
<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.add_warnings">
<code class="descname">add_warnings</code><span class="sig-paren">(</span><em>warn</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.add_warnings" title="Permalink to this definition">¶</a></dt>
<dd><p>Accumulate warnings from ATMSETUP</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.calc_PT">
<code class="descname">calc_PT</code><span class="sig-paren">(</span><em>T</em>, <em>logKir</em>, <em>logg1</em>, <em>logPc</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.calc_PT" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates parameterized PT profile from Guillot. This isntance is here
primary for the retrieval scheme, so this can be updated</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>T</strong> (<em>float</em>) &#8211; </li>
<li><strong>logKir</strong> (<em>float</em>) &#8211; </li>
<li><strong>logg1</strong> (<em>float</em>) &#8211; </li>
<li><strong>logPc</strong> (<em>float</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.disect">
<code class="descname">disect</code><span class="sig-paren">(</span><em>g</em>, <em>t</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.disect" title="Permalink to this definition">¶</a></dt>
<dd><p>This disects the 3d input to a 1d input which is a function of a single gangle and tangle.
This makes it possible for us to get the opacities at each facet before we go into the
flux calculation</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>g</strong> (<em>int</em>) &#8211; Gauss angle index</li>
<li><strong>t</strong> (<em>int</em>) &#8211; Tchebyshev angle index</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_clouds">
<code class="descname">get_clouds</code><span class="sig-paren">(</span><em>wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_clouds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get cloud properties from .cld input returned from eddysed. The eddysed file should have the following specifications</p>
<ol class="arabic simple">
<li>Have the following column names (any order)  opd g0 w0</li>
<li>Be white space delimeted</li>
<li>Has to have values for pressure levels (N) and wavelengths (M). The row order should go:</li>
</ol>
<p>level wave opd w0 g0
1.       1.   ... . .
1.       2.   ... . .
1.       3.   ... . .
.         .     ... . .
.         .     ... . .
1.       M.   ... . .
2.       1.   ... . .
.         .     ... . .
N.       .      ... . .</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The order of the rows is very important because each column will be transformed
into a matrix that has the size: [nlayer,nwave].</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>wno</strong> (<em>array</em>) &#8211; Array in ascending order of wavenumbers. This is used to regrid the cloud output</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-0">
<p class="first admonition-title">Todo</p>
<ul class="simple">
<li>Allow users to add different kinds of &#8220;simple&#8221; cloud options like &#8220;isotropic scattering&#8221; or grey</li>
</ul>
<p class="last">opacity at certain pressure.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_column_density">
<code class="descname">get_column_density</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_column_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the column desntiy based on TP profile: LAYER</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_constants">
<code class="descname">get_constants</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_constants" title="Permalink to this definition">¶</a></dt>
<dd><p>This function gets all conversion factors based on input units and all
constants. Goal here is to get everything to cgs and make sure we are only
call lengths of things once (e.g. number of wavelength points, number of layers etc)</p>
<p>Some stuff will be added to this in other routines (e.g. number of layers)</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_density">
<code class="descname">get_density</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates density of atmospheres used on TP profile: LEVEL</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_gravity">
<code class="descname">get_gravity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_gravity" title="Permalink to this definition">¶</a></dt>
<dd><p>Get gravity based on mass and radius, or gravity inputs</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_mmw">
<code class="descname">get_mmw</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_mmw" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mean molecular weight of the atmosphere</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_needed_continuum">
<code class="descname">get_needed_continuum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_needed_continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>This will define which molecules are needed for the continuum opacities. THis is based on
temperature and molecules. Eventually CIA&#8217;s will expand but we may not necessarily
want all of them.
&#8216;wno&#8217;,&#8217;h2h2&#8217;,&#8217;h2he&#8217;,&#8217;h2h&#8217;,&#8217;h2ch4&#8217;,&#8217;h2n2&#8217;]</p>
<div class="admonition-todo admonition" id="index-1">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Add in temperature dependent to negate h- and things when not necessary</li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_profile">
<code class="descname">get_profile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Get profile from file or from user input file or direct pandas dataframe. If PT profile
is not given, use parameterization</p>
<p>Currently only needs inputs from config file</p>
<div class="admonition-todo admonition" id="index-2">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Add regridding to this by having users be able to set a different nlevel than the input cloud code is</li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_profile_3d">
<code class="descname">get_profile_3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_profile_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>A separate routine is written to get the 3d profile because the inputs are much more
rigid. In this framework, the following restrictions are placed:</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">The input must be in hdf5 format. The tutorial for 3d calculations
can help guid you to make these files correctly.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_stellar_spec">
<code class="descname">get_stellar_spec</code><span class="sig-paren">(</span><em>wno</em>, <em>database</em>, <em>temp</em>, <em>metal</em>, <em>logg</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_stellar_spec" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the stellar spectrum using pysynphot and interpolate onto a much finer grid than the
planet grid.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">If the resolution of the stellar spectrum models increase
to higher resolution you could take out the lines that start with <cite>fine_wno_star</cite> and
<cite>fine_flux-star</cite></p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>wno</strong> (<em>array</em>) &#8211; Array of the planet model output wavenumber grid</li>
<li><strong>database</strong> (<em>str</em>) &#8211; The database to pull stellar spectrum from. See documentation for pysynphot.</li>
<li><strong>temp</strong> (<em>float</em>) &#8211; Teff of the stellar model</li>
<li><strong>metal</strong> (<em>float</em>) &#8211; Metallicity of the stellar model</li>
<li><strong>logg</strong> (<em>float</em>) &#8211; Logg cgs of the stellar model</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Wavenumber and stellar flux in wavenumber and FLAM units</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">wno, flux</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_surf_reflect">
<code class="descname">get_surf_reflect</code><span class="sig-paren">(</span><em>nwno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_surf_reflect" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the surface reflectivity from input</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_weights">
<code class="descname">get_weights</code><span class="sig-paren">(</span><em>molecule</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically gets mean molecular weights of any molecule. Requires that
user inputs case sensitive molecules i.e. TiO instead of TIO.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>molecule</strong> (<em>str</em><em> or </em><em>list</em>) &#8211; any molecule string e.g. &#8220;H2O&#8221;, &#8220;CH4&#8221; etc &#8220;TiO&#8221; or [&#8220;H2O&#8221;, &#8216;CH4&#8217;]</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">molecule as keys with molecular weights as value</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">dict</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-picaso.build_3d_input">
<span id="picaso-build-3d-input-module"></span><h2>picaso.build_3d_input module<a class="headerlink" href="#module-picaso.build_3d_input" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.build_3d_input.make_3d_cld_input">
<code class="descclassname">picaso.build_3d_input.</code><code class="descname">make_3d_cld_input</code><span class="sig-paren">(</span><em>ng</em>, <em>nt</em>, <em>phase_angle</em>, <em>input_file</em>, <em>output_file</em>, <em>lat_range=None</em>, <em>lon_range=None</em>, <em>rand_coverage=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.make_3d_cld_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Program to create 3d CLOUD input. Used to feed GCM input into disco ball.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ng</strong> (<em>int</em>) &#8211; Number of gauss angles</li>
<li><strong>nt</strong> (<em>int</em>) &#8211; Number of Tchebysehv angles</li>
<li><strong>phase_angle</strong> (<em>float</em>) &#8211; Geometry of phase angle</li>
<li><strong>input_file</strong> (<em>str</em>) &#8211; CLD input file you want to create the 3d grid from. Currently takes in a single 1d CLD profile.
Input file must be structured with the following columns in the correct order: [&#8216;lvl&#8217;, &#8216;wv&#8217;,&#8217;opd&#8217;,&#8217;g0&#8217;,&#8217;w0&#8217;,&#8217;sigma&#8217;]
input file</li>
<li><strong>output_file</strong> (<em>str</em>) &#8211; Output file location</li>
<li><strong>lat_range</strong> (<em>list</em>) &#8211; (Optional)Range of latitudes to exclude in the CLD file</li>
<li><strong>lon_range</strong> (<em>list</em>) &#8211; (Optional)Range of longitudes to exclud in the CLD file</li>
<li><strong>rand_coverage</strong> (<em>float</em>) &#8211; (Optional)Fractional cloud coverage. rand_cov=1 introduces full cloud coverage. rand_cov=0 has no
coverage.</li>
<li><strong>**kwargs</strong> (<em>dict</em>) &#8211; Key word arguments used for <cite>panads.read_csv</cite></li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Creates output file. No other returns.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Basic use of creating a 3D file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phase_angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_gauss_angles</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_tcheby_angles</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phase_angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_file</span><span class="o">=</span><span class="n">jdi</span><span class="o">.</span><span class="n">jupiter_cld</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;jupiter3D.hdf5&#39;</span>
<span class="go">&gt;&gt;&gt;make_3d_pt_input(number_gauss_angles, number_tcheby_angles,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">phase_angle</span><span class="p">,</span> <span class="n">input_file</span><span class="p">,</span><span class="n">output_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="picaso.build_3d_input.make_3d_pt_input">
<code class="descclassname">picaso.build_3d_input.</code><code class="descname">make_3d_pt_input</code><span class="sig-paren">(</span><em>ng</em>, <em>nt</em>, <em>phase_angle</em>, <em>input_file</em>, <em>output_file</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.make_3d_pt_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Program to create 3d PT input. Used to feed GCM input into disco ball.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ng</strong> (<em>int</em>) &#8211; Number of gauss angles</li>
<li><strong>nt</strong> (<em>int</em>) &#8211; Number of Tchebysehv angles</li>
<li><strong>phase_angle</strong> (<em>float</em>) &#8211; Geometry of phase angle</li>
<li><strong>input_file</strong> (<em>str</em>) &#8211; PT input file you want to create the 3d grid from. Currently takes in a single 1d PT profile.
Must have labeled, whitespace delimeted columns. In the columns, must have <cite>temperature</cite>,
<cite>pressure</cite>, and at least some molecular species (which are ALL case-sensitive)</li>
<li><strong>output_file</strong> (<em>str</em>) &#8211; Output file location</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Creates output file. No other returns.</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Examples</p>
<p>Basic use of creating a 3D file:</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phase_angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_gauss_angles</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_tcheby_angles</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phase_angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_file</span><span class="o">=</span><span class="n">jdi</span><span class="o">.</span><span class="n">jupiter_pt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;jupiter3D.hdf5&#39;</span>
<span class="go">&gt;&gt;&gt;make_3d_pt_input(number_gauss_angles, number_tcheby_angles,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">phase_angle</span><span class="p">,</span> <span class="n">input_file</span><span class="p">,</span><span class="n">output_file</span><span class="p">)</span>
</pre></div>
</div>
<p>Can also use <cite>**kwargs</cite> to control how pandas reads in input file</p>
<p>&gt;&gt;&gt;make_3d_pt_input(number_gauss_angles, number_tcheby_angles,
&gt;&gt;&gt;         phase_angle, input_file,output_file,usecols=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20,21])</p>
</dd></dl>

</div>
<div class="section" id="module-picaso.disco">
<span id="picaso-disco-module"></span><h2>picaso.disco module<a class="headerlink" href="#module-picaso.disco" title="Permalink to this headline">¶</a></h2>
<dl class="attribute">
<dt id="picaso.disco.compress_disco">
<code class="descclassname">picaso.disco.</code><code class="descname">compress_disco</code><a class="headerlink" href="#picaso.disco.compress_disco" title="Permalink to this definition">¶</a></dt>
<dd><p>Last step in albedo code. Integrates over phase angle based on the
Gaussian-Chebychev weights in geometry.json</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>numg</strong> (<em>int</em>) &#8211; Number of Gauss angles</li>
<li><strong>numt</strong> (<em>int</em>) &#8211; Number of Chebychev Angles</li>
<li><strong>nwno</strong> (<em>int</em>) &#8211; Number of wavenumbers</li>
<li><strong>cos_theta</strong> (<em>float</em>) &#8211; Cosine of phase angle</li>
<li><strong>xint_at_top</strong> (<em>ndarray of floats</em>) &#8211; Planetary intensity at the top of the atmosphere with dimensions (ng, nt, nwno)</li>
<li><strong>gweight</strong> (<em>ndarray of floats</em>) &#8211; Gaussian weights for integration</li>
<li><strong>tweight</strong> (<em>ndarray of floats</em>) &#8211; Chebychev weights for integration</li>
<li><strong>F0PI</strong> (<em>ndarray of floats</em>) &#8211; Stellar flux</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="picaso.disco.compute_disco">
<code class="descclassname">picaso.disco.</code><code class="descname">compute_disco</code><a class="headerlink" href="#picaso.disco.compute_disco" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes ubar0, the incident angle, and ubar1, the outgoing angle from the
chebyshev angles in geometry.json</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>ng</strong> (<em>int</em>) &#8211; Number of gauss angles</li>
<li><strong>nt</strong> (<em>int</em>) &#8211; Number of tchebyshev angles</li>
<li><strong>gangle</strong> (<em>float</em>) &#8211; Gaussian Angles</li>
<li><strong>tangle</strong> (<em>float</em>) &#8211; Chevychev Angles</li>
<li><strong>phase_angle</strong> (<em>float</em>) &#8211; Planetary phase angle</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>ubar0</em> &#8211; the incident angles</li>
<li><em>ubar1</em> &#8211; the outgoing angles</li>
<li><em>cos_theta</em> &#8211; Cosine of the phase angle</li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="picaso.disco.get_angles">
<code class="descclassname">picaso.disco.</code><code class="descname">get_angles</code><span class="sig-paren">(</span><em>num_gangle</em>, <em>num_tangle</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.disco.get_angles" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes angles for disco ball</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>num_gangles</strong> (<em>int</em>) &#8211; Number of Gauss angles</li>
<li><strong>num_tangles</strong> (<em>int</em>) &#8211; Number of Tchebychev angles desired</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Gauss Angles,Gauss Weights,Tchebyshev Angles,Tchebyshev weights</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">np.ndarray, np.ndarray, np.ndarray, np.ndarray</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-picaso.elements">
<span id="picaso-elements-module"></span><h2>picaso.elements module<a class="headerlink" href="#module-picaso.elements" title="Permalink to this headline">¶</a></h2>
<p>Properties of the chemical elements.</p>
<p>Each chemical element is represented as an object instance. Physicochemical
and descriptive properties of the elements are stored as instance attributes.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Author:</th><td class="field-body"><a class="reference external" href="http://www.lfd.uci.edu/~gohlke/">Christoph Gohlke</a></td>
</tr>
<tr class="field-even field"><th class="field-name">Version:</th><td class="field-body">2015.01.29</td>
</tr>
</tbody>
</table>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><a class="reference external" href="http://www.python.org">CPython 2.7 or 3.4</a></li>
</ul>
<p class="rubric">References</p>
<ol class="arabic simple">
<li><a class="reference external" href="http://physics.nist.gov/PhysRefData/Compositions/">http://physics.nist.gov/PhysRefData/Compositions/</a></li>
<li><a class="reference external" href="http://physics.nist.gov/PhysRefData/IonEnergy/tblNew.html">http://physics.nist.gov/PhysRefData/IonEnergy/tblNew.html</a></li>
<li><a class="reference external" href="http://en.wikipedia.org/wiki/%(element.name)s">http://en.wikipedia.org/wiki/%(element.name)s</a></li>
<li><a class="reference external" href="http://www.miranda.org/~jkominek/elements/elements.db">http://www.miranda.org/~jkominek/elements/elements.db</a></li>
</ol>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">elements</span> <span class="k">import</span> <span class="n">ELEMENTS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ELEMENTS</span><span class="p">)</span>
<span class="go">109</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">ELEMENTS</span><span class="p">[</span><span class="mi">109</span><span class="p">])</span>
<span class="go">&#39;Meitnerium&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ele</span> <span class="o">=</span> <span class="n">ELEMENTS</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ele</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">ele</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span> <span class="n">ele</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ele</span><span class="o">.</span><span class="n">eleconfig</span>
<span class="go">(6, &#39;C&#39;, &#39;Carbon&#39;, &#39;[He] 2s2 2p2&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ele</span><span class="o">.</span><span class="n">eleconfig_dict</span>
<span class="go">{(1, &#39;s&#39;): 2, (2, &#39;p&#39;): 2, (2, &#39;s&#39;): 2}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">(</span><span class="n">ele</span><span class="o">.</span><span class="n">mass</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">ELEMENTS</span><span class="p">)</span>
<span class="go">14659.1115599</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">ELEMENTS</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ele</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">ele</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">ele</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="module-picaso.fluxes">
<span id="picaso-fluxes-module"></span><h2>picaso.fluxes module<a class="headerlink" href="#module-picaso.fluxes" title="Permalink to this headline">¶</a></h2>
<dl class="attribute">
<dt id="picaso.fluxes.get_flux_geom_1d">
<code class="descclassname">picaso.fluxes.</code><code class="descname">get_flux_geom_1d</code><a class="headerlink" href="#picaso.fluxes.get_flux_geom_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes toon fluxes given tau and everything is 1 dimensional. This is the exact same function
as <cite>get_flux_geom_3d</cite> but is kept separately so we don&#8217;t have to do unecessary indexing for fast
retrievals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nlevel</strong> (<em>int</em>) &#8211; Number of levels in the model</li>
<li><strong>wno</strong> (<em>array of float</em>) &#8211; Wave number grid in cm -1</li>
<li><strong>nwno</strong> (<em>int</em>) &#8211; Number of wave points</li>
<li><strong>numg</strong> (<em>int</em>) &#8211; Number of Gauss angles</li>
<li><strong>numt</strong> (<em>int</em>) &#8211; Number of Chebyshev angles</li>
<li><strong>DTAU</strong> (<em>ndarray of float</em>) &#8211; This is the opacity contained within each individual layer (defined at midpoints of &#8220;levels&#8221;)
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</li>
<li><strong>TAU</strong> (<em>ndarray of float</em>) &#8211; This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</li>
<li><strong>W0</strong> (<em>ndarray of float</em>) &#8211; This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</li>
<li><strong>COSB</strong> (<em>ndarray of float</em>) &#8211; This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</li>
<li><strong>GCOS2</strong> (<em>ndarray of float</em>) &#8211; Parameter that allows us to directly include Rayleigh scattering
= 0.5*tau_rayleigh/(tau_rayleigh + tau_cloud)</li>
<li><strong>ftau_cld</strong> (<em>ndarray of float</em>) &#8211; Fraction of cloud extinction to total
= tau_cloud/(tau_rayleigh + tau_cloud)</li>
<li><strong>ftau_ray</strong> (<em>ndarray of float</em>) &#8211; Fraction of rayleigh extinction to total
= tau_rayleigh/(tau_rayleigh + tau_cloud)</li>
<li><strong>dtau_og</strong> (<em>ndarray of float</em>) &#8211; This is the opacity contained within each individual layer (defined at midpoints of &#8220;levels&#8221;)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</li>
<li><strong>tau_og</strong> (<em>ndarray of float</em>) &#8211; This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</li>
<li><strong>w0_og</strong> (<em>ndarray of float</em>) &#8211; Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</li>
<li><strong>cosb_og</strong> (<em>ndarray of float</em>) &#8211; Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</li>
<li><strong>surf_reflect</strong> (<em>float</em>) &#8211; Surface reflectivity</li>
<li><strong>ubar0</strong> (<em>ndarray of float</em>) &#8211; matrix of cosine of the incident angle from geometric.json</li>
<li><strong>ubar1</strong> (<em>ndarray of float</em>) &#8211; matrix of cosine of the observer angles</li>
<li><strong>cos_theta</strong> (<em>float</em>) &#8211; Cosine of the phase angle of the planet</li>
<li><strong>F0PI</strong> (<em>array</em>) &#8211; Downward incident solar radiation</li>
<li><strong>single_phase</strong> (<em>str</em>) &#8211; Single scattering phase function, default is the two-term henyey-greenstein phase function</li>
<li><strong>multi_phase</strong> (<em>str</em>) &#8211; Multiple scattering phase function, defulat is N=2 Legendre polynomial</li>
<li><strong>frac_a</strong> (<em>float</em>) &#8211; (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</li>
<li><strong>frac_b</strong> (<em>float</em>) &#8211; (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</li>
<li><strong>frac_c</strong> (<em>float</em>) &#8211; (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C), Default is : 1 - gcosb^2</li>
<li><strong>constant_back</strong> (<em>float</em>) &#8211; (Optional), If using the TTHG phase function. Must specify the assymetry of back scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</li>
<li><strong>constant_forward</strong> (<em>float</em>) &#8211; (Optional), If using the TTHG phase function. Must specify the assymetry of forward scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>intensity at the top of the atmosphere for all the different ubar1 and ubar2</em></li>
<li><em>To Do</em></li>
<li><em>&#8212;&#8211;</em></li>
<li><em>- F0PI Solar flux shouldn&#8217;t always be 1.. Follow up to make sure that this isn&#8217;t a bad</em> &#8211; hardwiring to solar, despite &#8220;relative albedo&#8221;</li>
<li><em>- take delta eddington option out of fluxes and move it all over to optics</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_flux_geom_3d">
<code class="descclassname">picaso.fluxes.</code><code class="descname">get_flux_geom_3d</code><a class="headerlink" href="#picaso.fluxes.get_flux_geom_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes toon fluxes given tau and everything is 3 dimensional. This is the exact same function
as <cite>get_flux_geom_1d</cite> but is kept separately so we don&#8217;t have to do unecessary indexing for
retrievals.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nlevel</strong> (<em>int</em>) &#8211; Number of levels in the model</li>
<li><strong>wno</strong> (<em>array of float</em>) &#8211; Wave number grid in cm -1</li>
<li><strong>nwno</strong> (<em>int</em>) &#8211; Number of wave points</li>
<li><strong>numg</strong> (<em>int</em>) &#8211; Number of Gauss angles</li>
<li><strong>numt</strong> (<em>int</em>) &#8211; Number of Chebyshev angles</li>
<li><strong>dtau_3d</strong> (<em>ndarray of float</em>) &#8211; This is the opacity contained within each individual layer (defined at midpoints of &#8220;levels&#8221;)
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</li>
<li><strong>tau_3d</strong> (<em>ndarray of float</em>) &#8211; This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</li>
<li><strong>w0_3d</strong> (<em>ndarray of float</em>) &#8211; This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</li>
<li><strong>cosb_3d</strong> (<em>ndarray of float</em>) &#8211; This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</li>
<li><strong>gcos2_3d</strong> (<em>ndarray of float</em>) &#8211; Parameter that allows us to directly include Rayleigh scattering
= 0.5*tau_rayleigh/(tau_rayleigh + tau_cloud)</li>
<li><strong>ftau_cld_3d</strong> (<em>ndarray of float</em>) &#8211; Fraction of cloud extinction to total
= tau_cloud/(tau_rayleigh + tau_cloud)</li>
<li><strong>ftau_ray_3d</strong> (<em>ndarray of float</em>) &#8211; Fraction of rayleigh extinction to total
= tau_rayleigh/(tau_rayleigh + tau_cloud)</li>
<li><strong>dtau_og_3d</strong> (<em>ndarray of float</em>) &#8211; This is the opacity contained within each individual layer (defined at midpoints of &#8220;levels&#8221;)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</li>
<li><strong>tau_og_3d</strong> (<em>ndarray of float</em>) &#8211; This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</li>
<li><strong>w0_og_3d</strong> (<em>ndarray of float</em>) &#8211; Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</li>
<li><strong>cosb_og_3d</strong> (<em>ndarray of float</em>) &#8211; Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</li>
<li><strong>surf_reflect</strong> (<em>float</em>) &#8211; Surface reflectivity</li>
<li><strong>ubar0</strong> (<em>ndarray of float</em>) &#8211; matrix of cosine of the incident angle from geometric.json</li>
<li><strong>ubar1</strong> (<em>ndarray of float</em>) &#8211; matrix of cosine of the observer angles</li>
<li><strong>cos_theta</strong> (<em>float</em>) &#8211; Cosine of the phase angle of the planet</li>
<li><strong>F0PI</strong> (<em>array</em>) &#8211; Downward incident solar radiation</li>
<li><strong>single_phase</strong> (<em>str</em>) &#8211; Single scattering phase function, default is the two-term henyey-greenstein phase function</li>
<li><strong>multi_phase</strong> (<em>str</em>) &#8211; Multiple scattering phase function, defulat is N=2 Legendre polynomial</li>
<li><strong>frac_a</strong> (<em>float</em>) &#8211; (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</li>
<li><strong>frac_b</strong> (<em>float</em>) &#8211; (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</li>
<li><strong>frac_c</strong> (<em>float</em>) &#8211; (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C), Default is : 1 - gcosb^2</li>
<li><strong>constant_back</strong> (<em>float</em>) &#8211; (Optional), If using the TTHG phase function. Must specify the assymetry of back scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</li>
<li><strong>constant_forward</strong> (<em>float</em>) &#8211; (Optional), If using the TTHG phase function. Must specify the assymetry of forward scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>intensity at the top of the atmosphere for all the different ubar1 and ubar2</em></li>
<li><em>To Do</em></li>
<li><em>&#8212;&#8211;</em></li>
<li><em>- F0PI Solar flux shouldn&#8217;t always be 1.. Follow up to make sure that this isn&#8217;t a bad</em> &#8211; hardwiring to solar, despite &#8220;relative albedo&#8221;</li>
<li><em>- take delta eddington option out of fluxes and move it all over to optics</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_flux_toon">
<code class="descclassname">picaso.fluxes.</code><code class="descname">get_flux_toon</code><a class="headerlink" href="#picaso.fluxes.get_flux_toon" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">Discontinued function. See <cite>get_flux_geom_1d</cite> and <cite>get_flux_geom_3d</cite>.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nlevel</strong> (<em>int</em>) &#8211; Number of levels in the model</li>
<li><strong>wno</strong> (<em>array of float</em>) &#8211; Wave number grid in cm -1</li>
<li><strong>nwno</strong> (<em>int</em>) &#8211; Number of wave points</li>
<li><strong>dtau</strong> (<em>ndarray of float</em>) &#8211; This is the opacity contained within each individual layer (defined at midpoints of &#8220;levels&#8221;)
Dimensions=# layer by # wave</li>
<li><strong>w0</strong> (<em>ndarray of float</em>) &#8211; This is the single scattering albedo, from scattering, clouds, raman, etc
Dimensions=# layer by # wave</li>
<li><strong>cosbar</strong> (<em>ndarray of float</em>) &#8211; This is the asymmetry factor
Dimensions=# layer by # wave</li>
<li><strong>surf_reflect</strong> (<em>float</em>) &#8211; Surface reflectivity</li>
<li><strong>ubar0</strong> (<em>float</em>) &#8211; Cosine of the incident angle</li>
<li><strong>F0PI</strong> (<em>array</em>) &#8211; Downward incident solar radiation</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">flux_up and flux_down through each layer as a function of wavelength</p>
</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-3">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Replace detla-function adjustment with better approximation (e.g. Cuzzi)</li>
<li><dl class="first docutils">
<dt>F0PI Solar flux shouldn&#8217;t always be 1.. Follow up to make sure that this isn&#8217;t a bad</dt>
<dd>hardwiring to solar</dd>
</dl>
</li>
</ul>
</div>
<p class="rubric">Examples</p>
<div class="highlight-default"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flux_plus</span><span class="p">,</span> <span class="n">flux_minus</span>  <span class="o">=</span> <span class="n">fluxes</span><span class="o">.</span><span class="n">get_flux_toon</span><span class="p">(</span><span class="n">atm</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">nlevel</span><span class="p">,</span> <span class="n">wno</span><span class="p">,</span><span class="n">nwno</span><span class="p">,</span>
<span class="go">                                                                                                tau_dedd,dtau_dedd, w0_dedd, cosb_dedd, surf_reflect, ubar0, F0PI)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.numba_cumsum">
<code class="descclassname">picaso.fluxes.</code><code class="descname">numba_cumsum</code><a class="headerlink" href="#picaso.fluxes.numba_cumsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute cumsum along axis=0 to bypass numba not allowing kwargs in
cumsum</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.setup_tri_diag">
<code class="descclassname">picaso.fluxes.</code><code class="descname">setup_tri_diag</code><a class="headerlink" href="#picaso.fluxes.setup_tri_diag" title="Permalink to this definition">¶</a></dt>
<dd><p>Before we can solve the tridiagonal matrix (See Toon+1989) section
&#8220;SOLUTION OF THE TwO-STREAM EQUATIONS FOR MULTIPLE LAYERS&#8221;, we
need to set up the coefficients.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>nlayer</strong> (<em>int</em>) &#8211; number of layers in the model</li>
<li><strong>nwno</strong> (<em>int</em>) &#8211; number of wavelength points</li>
<li><strong>c_plus_up</strong> (<em>array</em>) &#8211; c-plus evaluated at the top of the atmosphere</li>
<li><strong>c_minus_up</strong> (<em>array</em>) &#8211; c_minus evaluated at the top of the atmosphere</li>
<li><strong>c_plus_down</strong> (<em>array</em>) &#8211; c_plus evaluated at the bottom of the atmosphere</li>
<li><strong>c_minus_down</strong> (<em>array</em>) &#8211; c_minus evaluated at the bottom of the atmosphere</li>
<li><strong>b_top</strong> (<em>array</em>) &#8211; The diffuse radiation into the model at the top of the atmosphere</li>
<li><strong>b_surface</strong> (<em>array</em>) &#8211; The diffuse radiation into the model at the bottom. Includes emission, reflection
of the unattenuated portion of the direct beam</li>
<li><strong>surf_reflect</strong> (<em>array</em>) &#8211; Surface reflectivity</li>
<li><strong>g1</strong> (<em>array</em>) &#8211; table 1 toon et al 1989</li>
<li><strong>g2</strong> (<em>array</em>) &#8211; table 1 toon et al 1989</li>
<li><strong>g3</strong> (<em>array</em>) &#8211; table 1 toon et al 1989</li>
<li><strong>lamba</strong> (<em>array</em>) &#8211; Eqn 21 toon et al 1989</li>
<li><strong>gama</strong> (<em>array</em>) &#8211; Eqn 22 toon et al 1989</li>
<li><strong>dtau</strong> (<em>array</em>) &#8211; Opacity per layer</li>
<li><strong>exptrm_positive</strong> (<em>array</em>) &#8211; Eqn 44, expoential terms needed for tridiagonal rotated layered, clipped at 35</li>
<li><strong>exptrm_minus</strong> (<em>array</em>) &#8211; Eqn 44, expoential terms needed for tridiagonal rotated layered, clipped at 35</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">coefficient of the positive exponential term</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.slice_eq">
<code class="descclassname">picaso.fluxes.</code><code class="descname">slice_eq</code><a class="headerlink" href="#picaso.fluxes.slice_eq" title="Permalink to this definition">¶</a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.slice_gt">
<code class="descclassname">picaso.fluxes.</code><code class="descname">slice_gt</code><a class="headerlink" href="#picaso.fluxes.slice_gt" title="Permalink to this definition">¶</a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.slice_lt">
<code class="descclassname">picaso.fluxes.</code><code class="descname">slice_lt</code><a class="headerlink" href="#picaso.fluxes.slice_lt" title="Permalink to this definition">¶</a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.tri_diag_solve">
<code class="descclassname">picaso.fluxes.</code><code class="descname">tri_diag_solve</code><a class="headerlink" href="#picaso.fluxes.tri_diag_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Tridiagonal Matrix Algorithm solver, a b c d can be NumPy array type or Python list type.
refer to this <a class="reference external" href="http://en.wikipedia.org/wiki/Tridiagonal_matrix_algorithm">wiki</a> and to this <a class="reference external" href="http://www.cfd-online.com/Wiki/Tridiagonal_matrix_algorithm_-_TDMA_(Thomas_algorithm)">explanation</a>.</p>
<p>A, B, C and D refer to:</p>
<div class="math">
\[A(I)*X(I-1) + B(I)*X(I) + C(I)*X(I+1) = D(I)\]</div>
<p>This solver returns X.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>A</strong> (<em>array</em><em> or </em><em>list</em>) &#8211; </li>
<li><strong>B</strong> (<em>array</em><em> or </em><em>list</em>) &#8211; </li>
<li><strong>C</strong> (<em>array</em><em> or </em><em>list</em>) &#8211; </li>
<li><strong>C</strong> &#8211; </li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Solution, x</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-picaso.io_utils">
<span id="picaso-io-utils-module"></span><h2>picaso.io_utils module<a class="headerlink" href="#module-picaso.io_utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.io_utils.read_hdf">
<code class="descclassname">picaso.io_utils.</code><code class="descname">read_hdf</code><span class="sig-paren">(</span><em>filename</em>, <em>requires</em>, <em>raise_except=False</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.io_utils.read_hdf" title="Permalink to this definition">¶</a></dt>
<dd><p>read in H5 format file and pull out specific table based on specific
header information in the requires field. return None if file is not there</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>str</em>) &#8211; name of H5 file to read</li>
<li><strong>requires</strong> (<em>dict</em>) &#8211; dictionary with keys and values to get correct table
e.g. {&#8216;wmin&#8217;:0.3, &#8216;wmax&#8217;:1, &#8216;R&#8217;:5000} for opacity grid</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>d</strong> &#8211; data from H5 file decoded into python object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">python object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="picaso.io_utils.read_json">
<code class="descclassname">picaso.io_utils.</code><code class="descname">read_json</code><span class="sig-paren">(</span><em>filename</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.io_utils.read_json" title="Permalink to this definition">¶</a></dt>
<dd><p>read in a JSON format file.  return None if the file is not there.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>filename</strong> (<em>string</em>) &#8211; name of the JSON file to read</li>
<li><strong>except</strong> (<em>bool</em>) &#8211; if true, raise exception if file is missing. if false, return empty dict.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"><strong>d</strong> &#8211; data from JSON file decoded into python object</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">python object</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-picaso.justdoit">
<span id="picaso-justdoit-module"></span><h2>picaso.justdoit module<a class="headerlink" href="#module-picaso.justdoit" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.justdoit.jupiter_cld">
<code class="descclassname">picaso.justdoit.</code><code class="descname">jupiter_cld</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.jupiter_cld" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to get rough Jupiter Cloud model with fsed=3</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.jupiter_pt">
<code class="descclassname">picaso.justdoit.</code><code class="descname">jupiter_pt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.jupiter_pt" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to get Jupiter&#8217;s PT profile</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.load_inputs">
<code class="descclassname">picaso.justdoit.</code><code class="descname">load_inputs</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.load_inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to load empty inputs</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.multi_phase_options">
<code class="descclassname">picaso.justdoit.</code><code class="descname">multi_phase_options</code><span class="sig-paren">(</span><em>printout=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.multi_phase_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve all the options for multiple scattering radiation</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.picaso">
<code class="descclassname">picaso.justdoit.</code><code class="descname">picaso</code><span class="sig-paren">(</span><em>input</em>, <em>dimension='1d'</em>, <em>full_output=False</em>, <em>plot_opacity=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.picaso" title="Permalink to this definition">¶</a></dt>
<dd><p>Currently top level program to run albedo code</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>input</strong> (<em>dict</em>) &#8211; This input dict is built by loading the input = <cite>justdoit.load_inputs()</cite></li>
<li><strong>dimension</strong> (<em>str</em>) &#8211; (Optional) Dimensions of the calculation. Default = &#8216;1d&#8217;. But &#8216;3d&#8217; is also accepted.
In order to run &#8216;3d&#8217; calculations, user must build 3d input (see tutorials)</li>
<li><strong>full_output</strong> (<em>bool</em>) &#8211; (Optional) Default = False. Returns atmosphere class, which enables several
plotting capabilities.</li>
<li><strong>plot_opacity</strong> (<em>bool</em>) &#8211; (Optional) Default = False, Creates pop up of the weighted opacity</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><em>Wavenumber, albedo if full_output=False</em></li>
<li><em>Wavenumber, albedo, atmosphere if full_output = True</em></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.raman_options">
<code class="descclassname">picaso.justdoit.</code><code class="descname">raman_options</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.raman_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve options for raman scattering approximtions</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.set_approximations">
<code class="descclassname">picaso.justdoit.</code><code class="descname">set_approximations</code><span class="sig-paren">(</span><em>input</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.set_approximations" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a function devoded to defining all the approximations within the code.
This was built to make the code slightly more transparent in terms of options it
is making. A lof of the functions are numba, which means they cannot compare strings.
Therefore, this function returns integers for each option based on placement in a string.
The functions in the rest of the code follow from this.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>input</strong> (<em>dict</em>) &#8211; Input dictionary from main config.json structure</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><ul class="simple">
<li><em>Integer option for single scattering phase function, multiple scattering phase function,</em></li>
<li><em>and raman scattering</em></li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.single_phase_options">
<code class="descclassname">picaso.justdoit.</code><code class="descname">single_phase_options</code><span class="sig-paren">(</span><em>printout=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.single_phase_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve all the options for direct radation</p>
</dd></dl>

</div>
<div class="section" id="module-picaso.justplotit">
<span id="picaso-justplotit-module"></span><h2>picaso.justplotit module<a class="headerlink" href="#module-picaso.justplotit" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.justplotit.cloud">
<code class="descclassname">picaso.justplotit.</code><code class="descname">cloud</code><span class="sig-paren">(</span><em>full_output</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.cloud" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting the cloud input from <code class="docutils literal"><span class="pre">picaso</span></code>.</p>
<p>The plot itselfs creates maps of the wavelength dependent single scattering albedo
and cloud opacity as a function of altitude.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>full</strong> &#8211; </td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">A row of two bokeh plots with the single scattering and optical depth map</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.find_nearest">
<code class="descclassname">picaso.justplotit.</code><code class="descname">find_nearest</code><span class="sig-paren">(</span><em>array</em>, <em>value</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.find_nearest" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.justplotit.mixing_ratio">
<code class="descclassname">picaso.justplotit.</code><code class="descname">mixing_ratio</code><span class="sig-paren">(</span><em>full_output</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.mixing_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns plot of mixing ratios</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>full_output</strong> (<em>class</em>) &#8211; picaso.atmsetup.ATMSETUP</li>
<li><strong>**kwargs</strong> (<em>dict</em>) &#8211; Any key word argument for bokeh.figure()</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justplotit.numba_cumsum">
<code class="descclassname">picaso.justplotit.</code><code class="descname">numba_cumsum</code><a class="headerlink" href="#picaso.justplotit.numba_cumsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute cumsum along axis=0 to bypass numba not allowing kwargs in
cumsum</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.plot_cld_input">
<code class="descclassname">picaso.justplotit.</code><code class="descname">plot_cld_input</code><span class="sig-paren">(</span><em>file</em>, <em>nwno</em>, <em>nlayer</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_cld_input" title="Permalink to this definition">¶</a></dt>
<dd><p>This function was created to investigate CLD input file for PICASO.</p>
<p>The plot itselfs creates maps of the wavelength dependent single scattering albedo
and cloud opacity and assymetry parameter as a function of altitude.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>file</strong> (<em>str</em>) &#8211; Path  to cloud input file</li>
<li><strong>nwno</strong> (<em>int</em>) &#8211; Number of wavenumber points. For runs from Ackerman &amp; Marley, this will always be 196.</li>
<li><strong>nlayer</strong> (<em>int</em>) &#8211; Should be one less than the number of levels in your pressure temperature grid. Cloud
opacity is assigned for slabs.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Three bokeh plots with the single scattering, optical depth, and assymetry maps</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.plot_format">
<code class="descclassname">picaso.justplotit.</code><code class="descname">plot_format</code><span class="sig-paren">(</span><em>df</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to reformat plots</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.pt">
<code class="descclassname">picaso.justplotit.</code><code class="descname">pt</code><span class="sig-paren">(</span><em>full_output</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.pt" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns plot of pressure temperature profile</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>full_output</strong> (<em>class</em>) &#8211; picaso.atmsetup.ATMSETUP</li>
<li><strong>**kwargs</strong> (<em>dict</em>) &#8211; Any key word argument for bokeh.figure()</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.spectrum">
<code class="descclassname">picaso.justplotit.</code><code class="descname">spectrum</code><span class="sig-paren">(</span><em>wno</em>, <em>alb</em>, <em>legend=None</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot formated albedo spectrum</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>wno</strong> (<em>float array</em><em>, </em><em>list of arrays</em>) &#8211; wavenumber</li>
<li><strong>alb</strong> (<em>float array</em><em>, </em><em>list of arrays</em>) &#8211; albedo</li>
<li><strong>legend</strong> (<em>list of str</em>) &#8211; legends for plotting</li>
<li><strong>**kwargs</strong> (<em>dict</em>) &#8211; Any key word argument for bokeh.plotting.figure()</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bokeh plot</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.tau_pressure">
<code class="descclassname">picaso.justplotit.</code><code class="descname">tau_pressure</code><span class="sig-paren">(</span><em>full_output</em>, <em>at_tau=1</em>, <em>**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.tau_pressure" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot breakdown of gas opacity, cloud opacity,
Rayleigh scattering opacity at a specified pressure level.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>full_output</strong> (<em>class</em>) &#8211; picaso.atmsetup.ATMSETUP</li>
<li><strong>at_tau</strong> (<em>float</em>) &#8211; Opacity at which to plot the cumulative opacity.
Default =1 bar.</li>
<li><strong>**kwargs</strong> (<em>dict</em>) &#8211; Any key word argument for bokeh.plotting.figure()</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">bokeh plot</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-picaso.opacity_factory">
<span id="picaso-opacity-factory-module"></span><h2>picaso.opacity_factory module<a class="headerlink" href="#module-picaso.opacity_factory" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="picaso.opacity_factory.ContinuumFactory">
<em class="property">class </em><code class="descclassname">picaso.opacity_factory.</code><code class="descname">ContinuumFactory</code><span class="sig-paren">(</span><em>original_file</em>, <em>colnames</em>, <em>new_wno</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.ContinuumFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>The continuum factory takes the CIA opacity file and adds in extra sources of
opacity from other references to fill in empty bands. It assumes that the original file is
structured as following,with the first column wavenumber and the rest molecules:
1000 198
75.
0.0  -33.0000  -33.0000  -33.0000  -33.0000  -33.0000
20.0   -7.4572   -7.4518   -6.8038   -6.0928   -5.9806
40.0   -6.9547   -6.9765   -6.6322   -5.7934   -5.4823
... ... ... etc</p>
<p>Where 1000 corresponds to the number of wavelengths, 198 corresponds to the number of temperatures
and 75 is the first temperature. If this structure changes, we will need to restructure this top
level __init__ function that reads it in the original opacity file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>original_file</strong> (<em>str</em>) &#8211; Filepath that points to original opacity file (see description above)</li>
<li><strong>colnames</strong> (<em>list</em>) &#8211; defines the sources of opacity in the original file. For the example file above,
colnames would be [&#8216;wno&#8217;,&#8217;h2h2&#8217;,&#8217;h2he&#8217;,&#8217;h2h&#8217;,&#8217;h2ch4&#8217;,&#8217;h2n2&#8217;]</li>
<li><strong>new_wno</strong> (<em>numpy.ndarray</em><em>, </em><em>list</em>) &#8211; wavenumber grid to interpolate onto (units of inverse cm)</li>
<li><strong>overwrite</strong> (<em>bool</em>) &#8211; Default is set to False as to not overwrite any existing files. This parameter controls overwriting
cia database</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-4">
<p class="first admonition-title">Todo</p>
<ul class="last simple">
<li>Change this to be able to input the filename specified by the input config file</li>
</ul>
</div>
<dl class="method">
<dt id="picaso.opacity_factory.ContinuumFactory.fit_linsky">
<code class="descname">fit_linsky</code><span class="sig-paren">(</span><em>t</em>, <em>wno</em>, <em>va=3</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.ContinuumFactory.fit_linsky" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds H2-H2 opacity from Linsky (1969) and Lenzuni et al. (1991)
to values that were set to -33 as place holders.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> (<em>float</em>) &#8211; Temperature</li>
<li><strong>wno</strong> (<em>numpy.array</em>) &#8211; wave number</li>
<li><strong>va</strong> (<em>int</em><em> or </em><em>float</em>) &#8211; (Optional) 1,2 or 3 (depending on what overtone to compute</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">H2-H2 absorption in cm-1 amagat-2</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="picaso.opacity_factory.ContinuumFactory.get_h2minus">
<code class="descname">get_h2minus</code><span class="sig-paren">(</span><em>t</em>, <em>wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.ContinuumFactory.get_h2minus" title="Permalink to this definition">¶</a></dt>
<dd><p>This results gives the H2 minus opacity, needed for temperatures greater than 600 K.
K L Bell 1980 J. Phys. B: At. Mol. Phys. 13 1859, Table 1
theta=5040/T(K)</p>
<p>The result is given in cm4/dyn, which is why will will  multiply by nh2*ne*k*T
where:
nh2: number of h2 molecules/cm3
ne: number of electrons/cm3
This will happen when we go to sum opacities. For now returns will be in cm4/dyn</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> (<em>numpy.ndarray</em>) &#8211; temperature in K</li>
<li><strong>wno</strong> (<em>numpy.ndarray</em>) &#8211; wave number cm-1</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">H2 minus opacity in units of cm4/dyn</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="picaso.opacity_factory.ContinuumFactory.get_hminusbf">
<code class="descname">get_hminusbf</code><span class="sig-paren">(</span><em>wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.ContinuumFactory.get_hminusbf" title="Permalink to this definition">¶</a></dt>
<dd><p>H- bound free opacity, which is only dependent on wavelength. From John 1988 <a class="reference external" href="http://adsabs.harvard.edu/abs/1988A%26A...193..189J">http://adsabs.harvard.edu/abs/1988A%26A...193..189J</a></p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>wno</strong> (<em>numpy.ndarray</em>) &#8211; Wavenumber in cm-1</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">Absorption coefficient in units of cm2</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array of floats</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="picaso.opacity_factory.ContinuumFactory.get_hminusff">
<code class="descname">get_hminusff</code><span class="sig-paren">(</span><em>t</em>, <em>wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.ContinuumFactory.get_hminusff" title="Permalink to this definition">¶</a></dt>
<dd><p>H- free free opacity, which is both wavelength and temperature dependent.
From Bell &amp; Berrington (1987)
Also includes factor for simulated emission</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>t</strong> (<em>float</em>) &#8211; Temperature in K</li>
<li><strong>wno</strong> (<em>numpy.ndarray</em>) &#8211; Wavenumber in cm-1</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">Gives cross section in cm^5</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">array of float</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="picaso.opacity_factory.ContinuumFactory.restructure_opacity">
<code class="descname">restructure_opacity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.ContinuumFactory.restructure_opacity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="picaso.opacity_factory.MolecularFactory">
<em class="property">class </em><code class="descclassname">picaso.opacity_factory.</code><code class="descname">MolecularFactory</code><span class="sig-paren">(</span><em>original_dir</em>, <em>new_wno</em>, <em>overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.MolecularFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>This class contains everything needed to take Richard&#8217;s Opacities and turn them into
usable HDF5 database for fast querying.</p>
<p>This directly translates Richards old opacities from the original albedo code to the new
HDF5 format. Each molecule has the 1060 files with the following header structure:</p>
<p>ch4_2014 opacities from 0.3 to 1 microns at R~5000 resolution
wavelength       opacity (cm2/g)</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">When this routine puts everything into the hdf5 database it will reorder everything
by wavenumber!! This way molcular opacity and continuum opacity are on the same grid</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>original_dir</strong> (<em>str</em>) &#8211; Pointer to the original directory that contains all the opacities. This folder should
contain a bunch of different folders (one for each molecule).</td>
</tr>
</tbody>
</table>
<dl class="method">
<dt id="picaso.opacity_factory.MolecularFactory.restructure_opacity">
<code class="descname">restructure_opacity</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.MolecularFactory.restructure_opacity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.listdir">
<code class="descclassname">picaso.opacity_factory.</code><code class="descname">listdir</code><span class="sig-paren">(</span><em>path</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.listdir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-picaso.optics">
<span id="picaso-optics-module"></span><h2>picaso.optics module<a class="headerlink" href="#module-picaso.optics" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="picaso.optics.RetrieveOpacities">
<em class="property">class </em><code class="descclassname">picaso.optics.</code><code class="descname">RetrieveOpacities</code><span class="sig-paren">(</span><em>wno</em>, <em>wave</em>, <em>continuum_data</em>, <em>molecular_data</em>, <em>raman_data</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal"><span class="pre">object</span></code></p>
<p>This will be the class that will retrieve the opacities from the h5 database. Right
now we are just employing nearest neighbors to grab the respective opacities.
Eventually, we will want to do something like correlated K.</p>
<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.get_continuum_atlayer">
<code class="descname">get_continuum_atlayer</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_continuum_atlayer" title="Permalink to this definition">¶</a></dt>
<dd><p>given a temperature and molecule, retrieve the wavelength depedent opacity</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.get_molopac_atlayer">
<code class="descname">get_molopac_atlayer</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_molopac_atlayer" title="Permalink to this definition">¶</a></dt>
<dd><p>given a pressure and temperature, retrieve the wavelength dependent opacity</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.compute_stellar_shits">
<code class="descname">compute_stellar_shits</code><span class="sig-paren">(</span><em>wno_star</em>, <em>flux_star</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.compute_stellar_shits" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the hires stellar spectrum and computes Raman shifts</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>wno_star</strong> (<em>array</em>) &#8211; hires wavelength grid of the star in wave number</li>
<li><strong>flux_star</strong> (<em>array</em>) &#8211; Flux of the star in whatever units. Doesn&#8217;t matter for this since it&#8217;s returning a ratio</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">array of the shifted stellar spec divided by the unshifted stellar spec on the model wave
number grid</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">matrix</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.get_continuum_opac">
<code class="descname">get_continuum_opac</code><span class="sig-paren">(</span><em>temperature</em>, <em>molecule</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_continuum_opac" title="Permalink to this definition">¶</a></dt>
<dd><p>Based on a temperature, this retrieves the continuum opacity for</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>temperature</strong> (<em>float array</em>) &#8211; An array of temperatures to retrieve the continuum opacity at</li>
<li><strong>molecule</strong> (<em>str</em>) &#8211; Which opacity source to query. currently available: &#8216;h2h2&#8217;,&#8217;h2he&#8217;,&#8217;h2h&#8217;,&#8217;h2ch4&#8217;,&#8217;h2n2&#8217;</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">number of layers by number of wave points</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">matrix</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.get_molecular_opac">
<code class="descname">get_molecular_opac</code><span class="sig-paren">(</span><em>temperature</em>, <em>pressure</em>, <em>molecule</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_molecular_opac" title="Permalink to this definition">¶</a></dt>
<dd><p>Based on temperature, and pressure, retrieves the molecular opacity for
certain molecule</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>temperature</strong> (<em>array of float</em>) &#8211; An array of temperatures to retrieve the continuum opacity at</li>
<li><strong>pressure</strong> (<em>array of float</em>) &#8211; Pressures (IN BARS) to retrieve the continuum opacity at</li>
<li><strong>molecule</strong> (<em>str</em>) &#8211; Which opacity source to query. Will get error if not in the db</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.bin_star">
<code class="descclassname">picaso.optics.</code><code class="descname">bin_star</code><a class="headerlink" href="#picaso.optics.bin_star" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes average of group of points using uniform tophat</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>wno_new</strong> (<em>numpy.array</em>) &#8211; inverse cm grid to bin to (cm-1)</li>
<li><strong>wno_old</strong> (<em>numpy.array</em>) &#8211; inverse cm grid (old grid)</li>
<li><strong>Fp</strong> (<em>numpy.array</em>) &#8211; transmission spectra, which is on wno grid</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="picaso.optics.compute_opacity">
<code class="descclassname">picaso.optics.</code><code class="descname">compute_opacity</code><span class="sig-paren">(</span><em>atmosphere</em>, <em>opacityclass</em>, <em>delta_eddington=True</em>, <em>test_mode=False</em>, <em>raman=0</em>, <em>plot_opacity=False</em>, <em>full_output=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.compute_opacity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns total optical depth per slab layer including molecular opacity, continuum opacity.
It should automatically select the molecules needed</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>atmosphere</strong> (<em>class ATMSETUP</em>) &#8211; This inherets the class from atmsetup.py</li>
<li><strong>opacityclass</strong> (<em>class opacity</em>) &#8211; This inherets the class from optics.py. It is done this way so that the opacity db doesnt have
to be reloaded in a retrieval</li>
<li><strong>delta_eddington</strong> (<em>bool</em>) &#8211; (Optional) Default=True, With Delta-eddington on, it incorporates the forward peak
contribution by adjusting optical properties such that the fraction of scattered energy
in the forward direction is removed from the scattering parameters</li>
<li><strong>raman</strong> (<em>int</em>) &#8211; (Optional) Default =0 which corresponds to oklopcic+2018 raman scattering cross sections.
Other options include 1 for original pollack approximation for a 6000K blackbody.
And 2 for nothing.</li>
<li><strong>test_mode</strong> (<em>bool</em>) &#8211; (Optional) Default = False to run as normal. This will overwrite the opacities and fix the
delta tau at 0.5.</li>
<li><strong>full_output</strong> (<em>bool</em>) &#8211; (Optional) Default = False. If true, This will add taugas, taucld, tauray to the atmosphere class.
This is done so that the users can debug, plot, etc.</li>
<li><strong>plot_opacity</strong> (<em>bool</em>) &#8211; (Optional) Default = False. If true, Will create a pop up plot of the weighted of each absorber
at the middle layer.</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first last"><ul class="simple">
<li><strong>DTAU</strong> (<em>ndarray</em>) &#8211; This is a matrix with # layer by # wavelength. It is the opacity contained within a layer
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>If requested, this is corrected for with Delta-Eddington.</strong></li>
<li><strong>TAU</strong> (<em>ndarray</em>) &#8211; This is a matrix with # level by # wavelength. It is the cumsum of opacity contained
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>If requested, this is corrected for with Delta-Eddington.</strong></li>
<li><strong>WBAR</strong> (<em>ndarray</em>) &#8211; This is the single scattering albedo that includes rayleigh, raman and user input scattering sources.
It has dimensions: # layer by # wavelength
<strong>If requested, this is corrected for with Delta-Eddington.</strong></li>
<li><strong>COSB</strong> (<em>ndarray</em>) &#8211; This is the asymettry factor which accounts for rayleigh and user specified values
It has dimensions: # layer by # wavelength
<strong>If requested, this is corrected for with Delta-Eddington.</strong></li>
<li><strong>ftau_cld</strong> (<em>ndarray</em>) &#8211; This is the fraction of cloud opacity relative to the total TAUCLD/(TAUCLD + TAURAY)</li>
<li><strong>ftau_ray</strong> (<em>ndarray</em>) &#8211; This is the fraction of rayleigh opacity relative to the total TAURAY/(TAUCLD + TAURAY)</li>
<li><strong>GCOS2</strong> (<em>ndarray</em>) &#8211; This is used for Cahoy+2010 methodology for accounting for rayleigh scattering. It
replaces the use of the actual rayleigh phase function by just multiplying ftau_ray by 2</li>
<li><strong>DTAU</strong> (<em>ndarray</em>) &#8211; This is a matrix with # layer by # wavelength. It is the opacity contained within a layer
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>If requested, this is corrected for with Delta-Eddington.</strong></li>
<li><strong>TAU</strong> (<em>ndarray</em>) &#8211; This is a matrix with # level by # wavelength. It is the cumsum of opacity contained
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>Original, never corrected for with Delta-Eddington.</strong></li>
<li><strong>WBAR</strong> (<em>ndarray</em>) &#8211; This is the single scattering albedo that includes rayleigh, raman and user input scattering sources.
It has dimensions: # layer by # wavelength
<strong>Original, never corrected for with Delta-Eddington.</strong></li>
<li><strong>COSB</strong> (<em>ndarray</em>) &#8211; This is the asymettry factor which accounts for rayleigh and user specified values
It has dimensions: # layer by # wavelength
<strong>Original, never corrected for with Delta-Eddington.</strong></li>
</ul>
</p>
</td>
</tr>
</tbody>
</table>
<p class="rubric">Notes</p>
<p>This was baselined against jupiter with the old fortran code. It matches 100% for all cases
except for hotter cases where Na &amp; K are present. This differences is not a product of the code
but a product of the different opacities (1060 grid versus old 736 grid)</p>
<div class="admonition-todo admonition" id="index-5">
<p class="first admonition-title">Todo</p>
<ul class="simple">
<li>Add a better approximation than delta-scale (e.g. M.Marley suggests a paper by Cuzzi that has</li>
</ul>
<p class="last">a better methodology)</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.compute_raman">
<code class="descclassname">picaso.optics.</code><code class="descname">compute_raman</code><a class="headerlink" href="#picaso.optics.compute_raman" title="Permalink to this definition">¶</a></dt>
<dd><p>The Ramam scattering will alter the rayleigh scattering. The returned value is
modified single scattering albedo.</p>
<p>Cross sectiosn from:
<a class="reference external" href="http://iopscience.iop.org/0004-637X/832/1/30/suppdata/apjaa3ec7t2_mrt.txt">http://iopscience.iop.org/0004-637X/832/1/30/suppdata/apjaa3ec7t2_mrt.txt</a></p>
<p>This method is described in Pollack+1986. Albeit not the best method. Sromovsky+2005
pointed out the inconsistencies in this method. You can see from his comparisons
that the Pollack approximations don&#8217;t accurately capture the depths of the line centers.
Since then, OKLOPCIC+2016 recomputed cross sections for J&lt;=9. We are using those cross
sections here with a different star. Huge improvement over what we had before.
Number of J levels is hard coded to 10 !</p>
<p>Will be added to the rayleigh scattering as : TAURAY*RAMAN</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>nwno</strong> (<em>int</em>) &#8211; Number of wave points</li>
<li><strong>nlayer</strong> (<em>int</em>) &#8211; Number of layers</li>
<li><strong>wno</strong> (<em>array</em>) &#8211; Array of output grid of wavenumbers</li>
<li><strong>stellar_shifts</strong> (<em>ndarray</em>) &#8211; Array of floats that has dimensions (n wave pts x n J levels: 0-9)</li>
<li><strong>tlayer</strong> (<em>array</em>) &#8211; Array of floats that has dimensions nlayer</li>
<li><strong>cross_sections</strong> (<em>ndarray</em>) &#8211; The row of &#8220;C&#8217;s&#8221; from Antonija&#8217;s table.</li>
<li><strong>j_initial</strong> (<em>ndarray</em>) &#8211; The row of initial rotational energy states from Antonija&#8217;s table</li>
<li><strong>deltanu</strong> (<em>ndarray</em>) &#8211; The row of delta nu&#8217;s from Antonia&#8217;s table</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.find_nearest">
<code class="descclassname">picaso.optics.</code><code class="descname">find_nearest</code><a class="headerlink" href="#picaso.optics.find_nearest" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="picaso.optics.j_fraction">
<code class="descclassname">picaso.optics.</code><code class="descname">j_fraction</code><a class="headerlink" href="#picaso.optics.j_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>This computes the fraction of molecules at each J level.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>j</strong> (<em>int</em>) &#8211; The initial rotational levels ranging from J=0 to 9 for hydrogen only</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><strong>f_J in eqn. 3 https</strong></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">//arxiv.org/pdf/1605.07185.pdf</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.numba_cumsum">
<code class="descclassname">picaso.optics.</code><code class="descname">numba_cumsum</code><a class="headerlink" href="#picaso.optics.numba_cumsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute cumsum along axis=0 to bypass numba not allowing kwargs in
cumsum</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.partition_function">
<code class="descclassname">picaso.optics.</code><code class="descname">partition_function</code><a class="headerlink" href="#picaso.optics.partition_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Given j and T computes partition function for ro-vibrational levels of H2.
This is the exponential and the statistical weight g_J in
Eqn 3 in <a class="reference external" href="https://arxiv.org/pdf/1605.07185.pdf">https://arxiv.org/pdf/1605.07185.pdf</a>
It is also used to compute the partition sum Z.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>j</strong> (<em>int</em>) &#8211; Energy level</li>
<li><strong>T</strong> (<em>array float</em>) &#8211; Temperature at each atmospheric layer in the atmosphere</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">Returns partition function</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.partition_sum">
<code class="descclassname">picaso.optics.</code><code class="descname">partition_sum</code><a class="headerlink" href="#picaso.optics.partition_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the total partition sum. I am truncating it at 20 since it seems to approach 1 around then.
This is also pretty fast to compute so 20 is fine for now.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>T</strong> (<em>array</em>) &#8211; Array of temperatures for each layer</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"></td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">Z, the partition sum</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="picaso.optics.raman_pollack">
<code class="descclassname">picaso.optics.</code><code class="descname">raman_pollack</code><span class="sig-paren">(</span><em>nlayer</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.raman_pollack" title="Permalink to this definition">¶</a></dt>
<dd><p>Mystery raman scattering. Couldn&#8217;t figure out where it came from.. so discontinuing.
Currently function doesnt&#8217; totally work. In half fortran-half python. Legacy from
fortran albedo code.</p>
<p>This method is described in Pollack+1986. Albeit not the best method. Sromovsky+2005
pointed out the inconsistencies in this method. You can see from his comparisons
that the Pollack approximations don&#8217;t accurately capture the depths of the line centers.
Since then, OKLOPCIC+2016 did a much
better model of raman scattring (with ghost lines). Might be worth it to consider a more
sophisticated version of Raman scattering.</p>
<p>Will be added to the rayleigh scattering as : TAURAY*RAMAN</p>
<p>#OLD FORTRAN CODE
#constants
h = 6.6252e-27
c = 2.9978e10
bohrd = 5.2917e-9
hmass = 1.6734e-24
rmu = .5 * hmass</p>
<p>#set wavelength shift of the ramam scatterer
shift_v0 = 4161.0</p>
<p>facip = h * c / ( 1.e-4 * 27.2 * 1.602e-12 )
facray = 1.e16 * bohrd ** 3 * 128. * np.pi ** 5 * bohrd ** 3 / 9.
facv = 2.08 / 2.38 * facray / bohrd ** 2 / ( 8. * np.pi * np.pi * rmu * c * shift_v0 ) * h</p>
<p>#cross section of the unshifted rayleigh and the vibrationally shifted rayleigh
gli = np.zeros(5)
wli = np.zeros(5)
gri = np.zeros(5)
wri = np.zeros(5)
gli[:] = [1.296, .247, .297,  .157,  .003]
wli[:] = [.507, .628, .733, 1.175, 2.526]
gri[:] = [.913, .239, .440,  .344,  .064]
wri[:] = [.537, .639, .789, 1.304, 3.263]</p>
<p>alp = np.zeros(7)
arp = np.zeros(7)
alp[:] = [6.84, 6.96, 7.33, 8.02, 9.18, 11.1, 14.5 ]
arp[:] = [3.66, 3.71, 3.88, 4.19, 4.70, 5.52, 6.88 ]</p>
<p>omega = facip / wavelength</p>
<p>#first compute extinction cross section for unshifted component
#e.g. rayleigh
alpha_l=0
alpha_r=0</p>
<dl class="docutils">
<dt>for i in range(5):</dt>
<dd>alpha_l += gli[i] / ( wli[i] ** 2 - omega ** 2 )
alpha_r += gri[i] / ( wri[i] ** 2 - omega ** 2 )</dd>
</dl>
<p>alpha2 = (( 2. * alpha_r + alpha_l ) / 3. ) ** 2
gamma2 = ( alpha_l - alpha_r ) ** 2
qray = facray * ( 3. * alpha2 + 2./3. * gamma2 ) / wavelength ** 4</p>
<p>#next, compute the extinction cross section for vibrationally
#shifted component
ip = np.zeros(2)
ip[:] = [int(omega/0.05), 5.0]
ip = np.min(ip) + 1
f = omega / 0.05 - float(ip-1)
alpha_pl = ( 1. - f ) * alp[ip] + f * alp[ip+1]
alpha_pr = ( 1. - f ) * arp[ip] + f * arp[ip+1]
alpha_p2 = (( 2. * alpha_pr + alpha_pl ) / 3. ) ** 2
gamma_p2 = ( alpha_pl - alpha_pr ) ** 2
qv = facv / SHIFT( WAVEL, -SHIFTV0 ) ** 4 * ( 3. * alpha_p2 + 2./3. * gamma_p2 )</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.rayleigh">
<code class="descclassname">picaso.optics.</code><code class="descname">rayleigh</code><a class="headerlink" href="#picaso.optics.rayleigh" title="Permalink to this definition">¶</a></dt>
<dd><p>Rayleigh function taken from old albedo code. Keeping this modular, as we may want
to swap out different methods to calculate rayleigh opacity</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>colden</strong> (<em>array of float</em>) &#8211; Column Density in CGS units</li>
<li><strong>H2</strong> (<em>array of float</em>) &#8211; Mixing ratio as function of altitude for H2</li>
<li><strong>He</strong> (<em>array of flaot</em>) &#8211; Mixing ratio as a function of altitude for He</li>
<li><strong>CH4</strong> (<em>array of float</em>) &#8211; Mixing ratio as a function of altitude fro CH4</li>
<li><strong>wave</strong> (<em>array of float</em>) &#8211; wavelength (microns) of grid. This should be in DECENDING order to comply with
everything else being in wave numberes</li>
<li><strong>xmu</strong> (<em>array of float</em>) &#8211; mean molecular weight of atmosphere in amu</li>
<li><strong>amu</strong> (<em>float</em>) &#8211; amu constant in grams</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-picaso.run_opa_factory">
<span id="picaso-run-opa-factory-module"></span><h2>picaso.run_opa_factory module<a class="headerlink" href="#module-picaso.run_opa_factory" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.run_opa_factory.continuum">
<code class="descclassname">picaso.run_opa_factory.</code><code class="descname">continuum</code><span class="sig-paren">(</span><em>new_wno_file='../scripts/newwave_2000.coverage', original_file='../testing_notebooks/CIA_DS_aug_2015.dat', colnames=['wno', 'H2H2', 'H2He', 'H2H', 'H2CH4', 'H2N2']</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.run_opa_factory.continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a top level function to run the opacity facotry to compute the continuum.
It leverages D. Saumom&#8217;s continuum opacity file and regrids it to the wavelength
that the user is attempting to create a spectrum on.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>new_wno_file</strong> (<em>str</em>) &#8211; This is a pointer to the filename that is whitespace delimeted with at least one column
called &#8220;wavenumber&#8221;</li>
<li><strong>original_file</strong> (<em>str</em>) &#8211; This is a pointer to the original continuum opacity file that is structured according to
D. Saumon. This will eventually be replaced with the opacity db structure.</li>
<li><strong>colnames</strong> (<em>list</em><em>, </em><em>str</em>) &#8211; This identifies the continuum absorbers that are located within the original_file with
opacities. In future updates, the file might be updated to include more continuum
absorbers.</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="picaso.run_opa_factory.molecular">
<code class="descclassname">picaso.run_opa_factory.</code><code class="descname">molecular</code><span class="sig-paren">(</span><em>original_dir='/Users/natashabatalha/Documents/AlbedoCodeWC/opacities/'</em>, <em>new_wno_file='../scripts/newwave_2000.coverage'</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.run_opa_factory.molecular" title="Permalink to this definition">¶</a></dt>
<dd><p>Currently, picaso is operating on a BYO opacities. Therefore, this function should be used
to go through a large directory of opacities and restructure them to the hdf5 databse that
picaso uses.</p>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p class="last">This function is <strong>not</strong> yet general enough to be used by the public. It is highly tied to
the opacity grid calculated by R. Freedman and used by ExoARC group. There are several
subleties to how this database is created. For example, alkalis are added through a
separate script. Please contact
<a class="reference external" href="mailto:natasha&#46;e&#46;batalha&#37;&#52;&#48;gmail&#46;com">natasha<span>&#46;</span>e<span>&#46;</span>batalha<span>&#64;</span>gmail<span>&#46;</span>com</a> if you have questions about opacities.</p>
</div>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>new_wno_file</strong> (<em>str</em>) &#8211; This is a pointer to the filename that is whitespace delimeted with at least one column
called &#8220;wavenumber&#8221;</li>
<li><strong>original_dier</strong> (<em>str</em>) &#8211; This is a pointer to the a file that should have a directory for each molecule.</li>
</ul>
</td>
</tr>
</tbody>
</table>
<div class="admonition-todo admonition" id="index-6">
<p class="first admonition-title">Todo</p>
<p class="last">-Right now users have to add Na K CH4 from function <cite>addNa&amp;K&amp;CH4.py</cite> in scripts. Come up with a better method than when we
have a better opacity database</p>
</div>
</dd></dl>

</div>
<div class="section" id="module-picaso.test">
<span id="picaso-test-module"></span><h2>picaso.test module<a class="headerlink" href="#module-picaso.test" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.test.dlugach_test">
<code class="descclassname">picaso.test.</code><code class="descname">dlugach_test</code><span class="sig-paren">(</span><em>single_phase='TTHG_ray'</em>, <em>output_dir=None</em>, <em>rayleigh=True</em>, <em>constant_tau=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.test.dlugach_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Test the flux against against Dlugach &amp; Yanovitskij
<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/0019103574901675?via%3Dihub">https://www.sciencedirect.com/science/article/pii/0019103574901675?via%3Dihub</a></p>
<p>There are two tests: rayleigh and constant_tau. This will run through the entire
table of values (XXI). Users can run both or specify one. Constant_tau picks
single value for the asymmetry factors g = [0.5,0.75,0.8,0.85,0.9] and tests
single scattering abled. Rayleigh only varies the ssa (with rayleigh phase fun)</p>
<p>This routine contains the functionality to reproduce table XXI and determine the %
error in various realms</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>single_phase</strong> (<em>str</em>) &#8211; Single phase function to test with the constant_tau test. Can either be:
&#8220;cahoy&#8221;,&#8221;TTHG_ray&#8221;,&#8221;TTHG&#8221;, and &#8220;OTHG&#8221;</li>
<li><strong>output_dir</strong> (<em>str</em>) &#8211; Output directory for results of test. Default is to just return the dataframe (None).</li>
<li><strong>rayleigh</strong> (<em>bool</em>) &#8211; Default is True. Turns on and off the rayleigh phase function test</li>
<li><strong>constant_tau</strong> (<em>float</em>) &#8211; Default=True. Turns on and off the constant tau phase function test</li>
<li><strong>Retuns</strong> &#8211; </li>
<li><strong>------</strong> &#8211; </li>
<li><strong>of % deviation from Dlugach &amp; Yanovitskij Table XXI</strong> (<em>DataFrame</em>) &#8211; </li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="picaso.test.madhu_test">
<code class="descclassname">picaso.test.</code><code class="descname">madhu_test</code><span class="sig-paren">(</span><em>rayleigh=True</em>, <em>isotropic=True</em>, <em>asymmetric=True</em>, <em>single_phase='TTHG_ray'</em>, <em>output_dir=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.test.madhu_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Test the flux against against Madhu and Burrows
<a class="reference external" href="https://arxiv.org/pdf/1112.4476.pdf">https://arxiv.org/pdf/1112.4476.pdf</a></p>
<p>There are three tests: rayleigh, isotropic, and lambert. Reproduces Figure 2 of
Madhu and Burrows paper.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>rayleigh</strong> (<em>bool</em>) &#8211; Tests rayleigh phase function</li>
<li><strong>isotropic</strong> (<em>bool</em>) &#8211; Tests isotropic phase function</li>
<li><strong>single_phase</strong> (<em>str</em>) &#8211; Single phase function to test with the constant_tau test. Can either be:
&#8220;cahoy&#8221;,&#8221;TTHG_ray&#8221;,&#8221;TTHG&#8221;, and &#8220;OTHG&#8221;</li>
<li><strong>output_dir</strong> (<em>str</em>) &#8211; Output directory for results of test. Default is to just return the dataframe (None).</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first"></p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">DataFrame of % deviation from Dlugach &amp; Yanovitskij Table XXI</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-picaso.test_optics">
<span id="picaso-test-optics-module"></span><h2>picaso.test_optics module<a class="headerlink" href="#module-picaso.test_optics" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.test_optics.test_optc">
<code class="descclassname">picaso.test_optics.</code><code class="descname">test_optc</code><span class="sig-paren">(</span><em>input</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.test_optics.test_optc" title="Permalink to this definition">¶</a></dt>
<dd><p>Currently top level program to run albedo code</p>
</dd></dl>

</div>
<div class="section" id="module-picaso.wavelength">
<span id="picaso-wavelength-module"></span><h2>picaso.wavelength module<a class="headerlink" href="#module-picaso.wavelength" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.wavelength.get_cld_input_grid">
<code class="descclassname">picaso.wavelength.</code><code class="descname">get_cld_input_grid</code><span class="sig-paren">(</span><em>filename_or_grid</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.wavelength.get_cld_input_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>The albedo code relies on the cloud code input, which is traditionally on a 196 wavelength grid.
This method is to retrieve that grid. This file should be kept in the package reference data. Alternatively,
it might be useful to add it directly to the input.cld file.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><strong>filename_or_grid</strong> (<em>str</em><em> or </em><em>ndarray</em>) &#8211; filename of the input grid OR a numpy array of wavenumber corresponding to cloud
input</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body">array of wave numbers in increasing order</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body">array</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="picaso.wavelength.get_output_grid">
<code class="descclassname">picaso.wavelength.</code><code class="descname">get_output_grid</code><span class="sig-paren">(</span><em>filename</em>, <em>wmin=0.3</em>, <em>wmax=1</em>, <em>R=5000</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.wavelength.get_output_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Defines wavelength grid from HDF5 file.(comparable to SETSPV)</p>
<p>Currently, only single option for wavelength grid, could be expanded to include more
grids, more opacities. Currently there is only one grid, so all values are defaulted to
0.3-1 at R=5000</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first last simple">
<li><strong>filename</strong> (<em>name of file</em>) &#8211; filename</li>
<li><strong>wmin</strong> (<em>float</em>) &#8211; minimum wavelength</li>
<li><strong>wmax</strong> (<em>float</em>) &#8211; maximum wavelength</li>
<li><strong>R</strong> (<em>float</em>) &#8211; Resolution</li>
</ul>
</td>
</tr>
</tbody>
</table>
</dd></dl>

<dl class="function">
<dt id="picaso.wavelength.regrid">
<code class="descclassname">picaso.wavelength.</code><code class="descname">regrid</code><span class="sig-paren">(</span><em>matrix</em>, <em>old_wno</em>, <em>new_wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.wavelength.regrid" title="Permalink to this definition">¶</a></dt>
<dd><p>This takes in a matrix that is (number of something versus number of wavelength points) and regrids
to a new wave grid.</p>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field-odd field"><th class="field-name">Parameters:</th><td class="field-body"><ul class="first simple">
<li><strong>matrix</strong> (<em>ndarray</em>) &#8211; matrix that is (number of something versus number of wavelength points)</li>
<li><strong>old_wno</strong> (<em>array</em>) &#8211; array that represents the old wavelength grid of the matrix</li>
<li><strong>new_wno</strong> (<em>array</em>) &#8211; array that represents the desired wavelength grid</li>
</ul>
</td>
</tr>
<tr class="field-even field"><th class="field-name">Returns:</th><td class="field-body"><p class="first">matrix that has been reinterpolated to new wave number grid</p>
</td>
</tr>
<tr class="field-odd field"><th class="field-name">Return type:</th><td class="field-body"><p class="first last">matrix</p>
</td>
</tr>
</tbody>
</table>
</dd></dl>

</div>
<div class="section" id="module-picaso">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-picaso" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           <div class="articleComments">
            
           </div>
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="notebooks/5_SwappingOpacities.html" class="btn btn-neutral" title="Creating new Opacity Databases" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2018, Natasha E. Batalha.

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.0dev',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true,
            SOURCELINK_SUFFIX: '.txt'
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jquery/3.3.1/jquery.min.js"></script>
      <script type="text/javascript" src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/js/bootstrap.min.js"></script>
      <script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>