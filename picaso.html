

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Code &mdash; picaso 2.1 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing to PICASO" href="contribution.html" />
    <link rel="prev" title="FAQs" href="notebooks/FAQs.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> picaso
          

          
          </a>

          
            
            
              <div class="version">
                2.1
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">The Tutorials</a></li>
<li class="toctree-l1"><a class="reference external" href="https://natashabatalha.github.io/picaso_dev">The Derivations</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.atmsetup">picaso.atmsetup module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#picaso-build-3d-input-module">picaso.build_3d_input module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.disco">picaso.disco module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.elements">picaso.elements module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.fluxes">picaso.fluxes module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.io_utils">picaso.io_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#picaso-justdoit-module">picaso.justdoit module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.justplotit">picaso.justplotit module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.opacity_factory">picaso.opacity_factory module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.optics">picaso.optics module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#picaso-test-module">picaso.test module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.wavelength">picaso.wavelength module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/natashabatalha/picaso">Github</a></li>
<li class="toctree-l1"><a class="reference external" href="https://arxiv.org/abs/1904.09355">The Paper</a></li>
<li class="toctree-l1"><a class="reference internal" href="contribution.html">Contributing</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">picaso</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>The Code</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/picaso.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="the-code">
<h1>The Code<a class="headerlink" href="#the-code" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-picaso.atmsetup">
<span id="picaso-atmsetup-module"></span><h2>picaso.atmsetup module<a class="headerlink" href="#module-picaso.atmsetup" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="picaso.atmsetup.ATMSETUP">
<em class="property">class </em><code class="sig-prename descclassname">picaso.atmsetup.</code><code class="sig-name descname">ATMSETUP</code><span class="sig-paren">(</span><em class="sig-param">config</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Reads in default source configuration from JSON and creates a full atmosphere class.</p>
<ul class="simple">
<li><p>Gets PT profile</p></li>
<li><p>Computes mean molecular weight, density, column density, mixing ratios</p></li>
<li><p>Gets cloud profile</p></li>
<li><p>Gets stellar profile</p></li>
</ul>
<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.add_warnings">
<code class="sig-name descname">add_warnings</code><span class="sig-paren">(</span><em class="sig-param">warn</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.add_warnings" title="Permalink to this definition">¶</a></dt>
<dd><p>Accumulate warnings from ATMSETUP</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.as_dict">
<code class="sig-name descname">as_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get output into picklable dict format</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.calc_PT">
<code class="sig-name descname">calc_PT</code><span class="sig-paren">(</span><em class="sig-param">logPc</em>, <em class="sig-param">T</em>, <em class="sig-param">logKir</em>, <em class="sig-param">logg1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.calc_PT" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates parameterized PT profile from Guillot. This isntance is here
primary for the retrieval scheme, so this can be updated</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> (<em>float</em>) – </p></li>
<li><p><strong>logKir</strong> (<em>float</em>) – </p></li>
<li><p><strong>logg1</strong> (<em>float</em>) – </p></li>
<li><p><strong>logPc</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.disect">
<code class="sig-name descname">disect</code><span class="sig-paren">(</span><em class="sig-param">g</em>, <em class="sig-param">t</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.disect" title="Permalink to this definition">¶</a></dt>
<dd><p>This disects the 3d input to a 1d input which is a function of a single gangle and tangle.
This makes it possible for us to get the opacities at each facet before we go into the
flux calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> (<em>int</em>) – Gauss angle index</p></li>
<li><p><strong>t</strong> (<em>int</em>) – Tchebyshev angle index</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_altitude">
<code class="sig-name descname">get_altitude</code><span class="sig-paren">(</span><em class="sig-param">p_reference=1</em>, <em class="sig-param">constant_gravity=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_altitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates z and gravity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_reference</strong> (<em>float</em>) – Reference pressure for radius. (bars)</p></li>
<li><p><strong>constant_gravity</strong> (<em>bool</em>) – creates zero altitude dependence in the height</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_clouds">
<code class="sig-name descname">get_clouds</code><span class="sig-paren">(</span><em class="sig-param">wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_clouds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get cloud properties from .cld input returned from eddysed. The eddysed file should have the following specifications</p>
<ol class="arabic simple">
<li><p>Have the following column names (any order)  opd g0 w0</p></li>
<li><p>Be white space delimeted</p></li>
<li><p>Has to have values for pressure levels (N) and wwavenumbers (M). The row order should go:</p></li>
</ol>
<p>level wavenumber opd w0 g0
1.   1.   … . .
1.   2.   … . .
1.   3.   … . .
.     . … . .
.     . … . .
1.   M.   … . .
2.   1.   … . .
.     . … . .
N.   .  … . .</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The order of the rows is very important because each column will be transformed
into a matrix that has the size: [nlayer,nwave].</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wno</strong> (<em>array</em>) – Array in ascending order of wavenumbers. This is used to regrid the cloud output</p>
</dd>
</dl>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Take regridding out of here and add it to <cite>justdoit</cite></p></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_column_density">
<code class="sig-name descname">get_column_density</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_column_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the column desntiy based on TP profile: LAYER</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_constants">
<code class="sig-name descname">get_constants</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_constants" title="Permalink to this definition">¶</a></dt>
<dd><p>This function gets all conversion factors based on input units and all
constants. Goal here is to get everything to cgs and make sure we are only
call lengths of things once (e.g. number of wavelength points, number of layers etc)</p>
<p>Some stuff will be added to this in other routines (e.g. number of layers)</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_density">
<code class="sig-name descname">get_density</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates density of atmospheres used on TP profile: LEVEL</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_mmw">
<code class="sig-name descname">get_mmw</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_mmw" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mean molecular weight of the atmosphere</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_needed_continuum">
<code class="sig-name descname">get_needed_continuum</code><span class="sig-paren">(</span><em class="sig-param">available_ray_mol</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_needed_continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>This will define which molecules are needed for the continuum opacities. THis is based on
temperature and molecules. Eventually CIA’s will expand but we may not necessarily
want all of them.
‘wno’,’h2h2’,’h2he’,’h2h’,’h2ch4’,’h2n2’]</p>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Add in temperature dependent to negate h- and things when not necessary</p></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_profile">
<code class="sig-name descname">get_profile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Get profile from file or from user input file or direct pandas dataframe. If PT profile
is not given, use parameterization</p>
<p>Currently only needs inputs from config file</p>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Add regridding to this by having users be able to set a different nlevel than the input cloud code is</p></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_profile_3d">
<code class="sig-name descname">get_profile_3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_profile_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Get profile from file or from user input file or direct pandas dataframe. If PT profile
is not given, use parameterization</p>
<p>Currently only needs inputs from config file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat</strong> (<em>array</em>) – Array of latitudes (radians)</p></li>
<li><p><strong>lon</strong> (<em>array</em>) – Array of longitudes (radians)</p></li>
</ul>
</dd>
</dl>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Add regridding to this by having users be able to set a different nlevel than the input cloud code is</p></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_surf_reflect">
<code class="sig-name descname">get_surf_reflect</code><span class="sig-paren">(</span><em class="sig-param">nwno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_surf_reflect" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the surface reflectivity from input</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_weights">
<code class="sig-name descname">get_weights</code><span class="sig-paren">(</span><em class="sig-param">molecule</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically gets mean molecular weights of any molecule. Requires that
user inputs case sensitive molecules i.e. TiO instead of TIO.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>str</em><em> or </em><em>list</em>) – any molecule string e.g. “H2O”, “CH4” etc “TiO” or [“H2O”, ‘CH4’]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>molecule as keys with molecular weights as value</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="picaso-build-3d-input-module">
<h2>picaso.build_3d_input module<a class="headerlink" href="#picaso-build-3d-input-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-picaso.disco">
<span id="picaso-disco-module"></span><h2>picaso.disco module<a class="headerlink" href="#module-picaso.disco" title="Permalink to this headline">¶</a></h2>
<dl class="attribute">
<dt id="picaso.disco.compress_disco">
<code class="sig-prename descclassname">picaso.disco.</code><code class="sig-name descname">compress_disco</code><a class="headerlink" href="#picaso.disco.compress_disco" title="Permalink to this definition">¶</a></dt>
<dd><p>Last step in albedo code. Integrates over phase angle based on the
Gaussian-Chebychev weights in geometry.json</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumbers</p></li>
<li><p><strong>cos_theta</strong> (<em>float</em>) – Cosine of phase angle</p></li>
<li><p><strong>xint_at_top</strong> (<em>ndarray of floats</em>) – Planetary intensity at the top of the atmosphere with dimensions (ng, nt, nwno)</p></li>
<li><p><strong>gweight</strong> (<em>ndarray of floats</em>) – Gaussian weights for integration</p></li>
<li><p><strong>tweight</strong> (<em>ndarray of floats</em>) – Chebychev weights for integration</p></li>
<li><p><strong>F0PI</strong> (<em>ndarray of floats</em>) – Stellar flux</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.disco.compress_thermal">
<code class="sig-prename descclassname">picaso.disco.</code><code class="sig-name descname">compress_thermal</code><a class="headerlink" href="#picaso.disco.compress_thermal" title="Permalink to this definition">¶</a></dt>
<dd><p>Last step in albedo code. Integrates over phase angle based on the
Gaussian-Chebychev weights in geometry.json</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumbers</p></li>
<li><p><strong>ubar1</strong> (<em>ndarray of floats</em>) – Outgoing angles</p></li>
<li><p><strong>flux_at_top</strong> (<em>ndarray of floats</em>) – Thermal Flux at the top of the atmosphere with dimensions (ng, nt, nwno)</p></li>
<li><p><strong>gweight</strong> (<em>ndarray of floats</em>) – Gaussian weights for integration</p></li>
<li><p><strong>tweight</strong> (<em>ndarray of floats</em>) – Chebychev weights for integration</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.disco.compute_disco">
<code class="sig-prename descclassname">picaso.disco.</code><code class="sig-name descname">compute_disco</code><a class="headerlink" href="#picaso.disco.compute_disco" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes ubar0, the incident angle, and ubar1, the outgoing angle from the
chebyshev angles in geometry.json</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ng</strong> (<em>int</em>) – Number of gauss angles</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – Number of tchebyshev angles</p></li>
<li><p><strong>gangle</strong> (<em>float</em>) – Gaussian Angles</p></li>
<li><p><strong>tangle</strong> (<em>float</em>) – Chevychev Angles</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>) – Planetary phase angle</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>ubar0</em> – the incident angles</p></li>
<li><p><em>ubar1</em> – the outgoing angles</p></li>
<li><p><em>cos_theta</em> – Cosine of the phase angle</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.disco.get_angles_1d">
<code class="sig-prename descclassname">picaso.disco.</code><code class="sig-name descname">get_angles_1d</code><span class="sig-paren">(</span><em class="sig-param">ngauss</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.disco.get_angles_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes integration over half sphere. ngauss=5 is 5 angles over half a
sphere.</p>
<p>These are taken from :
Abramowitz and Stegun Table 25.8
<a class="reference external" href="https://books.google.com/books?id=32HJ1orVXDEC&amp;pg=PA876&amp;lpg=PA876&amp;dq=Abramowitz+and+Stegun+Table+25.8&amp;source=bl&amp;ots=_eKu6k5SG8&amp;sig=ACfU3U0_piSAi8aDHOVd0itf_QSAFxcFLQ&amp;hl=en&amp;sa=X&amp;ved=2ahUKEwj5neLR2fDoAhXemHIEHUSVCjEQ6AEwD3oECAwQKQ#v=onepage&amp;q=Abramowitz%20and%20Stegun%20Table%2025.8&amp;f=false">https://books.google.com/books?id=32HJ1orVXDEC&amp;pg=PA876&amp;lpg=PA876&amp;dq=Abramowitz+and+Stegun+Table+25.8&amp;source=bl&amp;ots=_eKu6k5SG8&amp;sig=ACfU3U0_piSAi8aDHOVd0itf_QSAFxcFLQ&amp;hl=en&amp;sa=X&amp;ved=2ahUKEwj5neLR2fDoAhXemHIEHUSVCjEQ6AEwD3oECAwQKQ#v=onepage&amp;q=Abramowitz%20and%20Stegun%20Table%2025.8&amp;f=false</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ngauss</strong> (<em>int</em>) – Can only be 5, 6, 7, 8</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.disco.get_angles_3d">
<code class="sig-prename descclassname">picaso.disco.</code><code class="sig-name descname">get_angles_3d</code><span class="sig-paren">(</span><em class="sig-param">num_gangle</em>, <em class="sig-param">num_tangle</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.disco.get_angles_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes angles for full disco ball</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_gangles</strong> (<em>int</em>) – Number of Gauss angles</p></li>
<li><p><strong>num_tangles</strong> (<em>int</em>) – Number of Tchebychev angles desired</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gauss Angles,Gauss Weights,Tchebyshev Angles,Tchebyshev weights</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray, np.ndarray, np.ndarray, np.ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso.elements">
<span id="picaso-elements-module"></span><h2>picaso.elements module<a class="headerlink" href="#module-picaso.elements" title="Permalink to this headline">¶</a></h2>
<p>Properties of the chemical elements.</p>
<p>Each chemical element is represented as an object instance. Physicochemical
and descriptive properties of the elements are stored as instance attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p><a class="reference external" href="http://www.lfd.uci.edu/~gohlke/">Christoph Gohlke</a></p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>2015.01.29</p>
</dd>
</dl>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="http://www.python.org">CPython 2.7 or 3.4</a></p></li>
</ul>
<p class="rubric">References</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="http://physics.nist.gov/PhysRefData/Compositions/">http://physics.nist.gov/PhysRefData/Compositions/</a></p></li>
<li><p><a class="reference external" href="http://physics.nist.gov/PhysRefData/IonEnergy/tblNew.html">http://physics.nist.gov/PhysRefData/IonEnergy/tblNew.html</a></p></li>
<li><p><a class="reference external" href="http://en.wikipedia.org/wiki/%(element.name)s">http://en.wikipedia.org/wiki/%(element.name)s</a></p></li>
<li><p><a class="reference external" href="http://www.miranda.org/~jkominek/elements/elements.db">http://www.miranda.org/~jkominek/elements/elements.db</a></p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">elements</span> <span class="kn">import</span> <span class="n">ELEMENTS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ELEMENTS</span><span class="p">)</span>
<span class="go">109</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">ELEMENTS</span><span class="p">[</span><span class="mi">109</span><span class="p">])</span>
<span class="go">&#39;Meitnerium&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ele</span> <span class="o">=</span> <span class="n">ELEMENTS</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ele</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">ele</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span> <span class="n">ele</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ele</span><span class="o">.</span><span class="n">eleconfig</span>
<span class="go">(6, &#39;C&#39;, &#39;Carbon&#39;, &#39;[He] 2s2 2p2&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ele</span><span class="o">.</span><span class="n">eleconfig_dict</span>
<span class="go">{(1, &#39;s&#39;): 2, (2, &#39;p&#39;): 2, (2, &#39;s&#39;): 2}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">(</span><span class="n">ele</span><span class="o">.</span><span class="n">mass</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">ELEMENTS</span><span class="p">)</span>
<span class="go">14659.1115599</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">ELEMENTS</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ele</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">ele</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">ele</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="module-picaso.fluxes">
<span id="picaso-fluxes-module"></span><h2>picaso.fluxes module<a class="headerlink" href="#module-picaso.fluxes" title="Permalink to this headline">¶</a></h2>
<dl class="attribute">
<dt id="picaso.fluxes.blackbody">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">blackbody</code><a class="headerlink" href="#picaso.fluxes.blackbody" title="Permalink to this definition">¶</a></dt>
<dd><p>Blackbody flux in cgs units in per unit wavelength</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>array</em><em>,</em><em>float</em>) – Temperature (K)</p></li>
<li><p><strong>w</strong> (<em>array</em><em>, </em><em>float</em>) – Wavelength (cm)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray with shape ntemp x numwave</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.fluxes.get_flux_toon">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_flux_toon</code><span class="sig-paren">(</span><em class="sig-param">nlevel</em>, <em class="sig-param">wno</em>, <em class="sig-param">nwno</em>, <em class="sig-param">tau</em>, <em class="sig-param">dtau</em>, <em class="sig-param">w0</em>, <em class="sig-param">cosbar</em>, <em class="sig-param">surf_reflect</em>, <em class="sig-param">ubar0</em>, <em class="sig-param">F0PI</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.get_flux_toon" title="Permalink to this definition">¶</a></dt>
<dd><div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Discontinued function. See <cite>get_flux_geom_1d</cite> and <cite>get_flux_geom_3d</cite>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>) – Number of levels in the model</p></li>
<li><p><strong>wno</strong> (<em>array of float</em>) – Wave number grid in cm -1</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wave points</p></li>
<li><p><strong>dtau</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
Dimensions=# layer by # wave</p></li>
<li><p><strong>w0</strong> (<em>ndarray of float</em>) – This is the single scattering albedo, from scattering, clouds, raman, etc
Dimensions=# layer by # wave</p></li>
<li><p><strong>cosbar</strong> (<em>ndarray of float</em>) – This is the asymmetry factor
Dimensions=# layer by # wave</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>) – Surface reflectivity</p></li>
<li><p><strong>ubar0</strong> (<em>float</em>) – Cosine of the incident angle</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>) – Downward incident solar radiation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>flux_up and flux_down through each layer as a function of wavelength</p>
</dd>
</dl>
<div class="admonition-todo admonition" id="id5">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Replace detla-function adjustment with better approximation (e.g. Cuzzi)</p></li>
<li><dl class="simple">
<dt>F0PI Solar flux shouldn’t always be 1.. Follow up to make sure that this isn’t a bad</dt><dd><p>hardwiring to solar</p>
</dd>
</dl>
</li>
</ul>
</div>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">flux_plus</span><span class="p">,</span> <span class="n">flux_minus</span>  <span class="o">=</span> <span class="n">fluxes</span><span class="o">.</span><span class="n">get_flux_toon</span><span class="p">(</span><span class="n">atm</span><span class="o">.</span><span class="n">c</span><span class="o">.</span><span class="n">nlevel</span><span class="p">,</span> <span class="n">wno</span><span class="p">,</span><span class="n">nwno</span><span class="p">,</span>
<span class="go">                                                tau_dedd,dtau_dedd, w0_dedd, cosb_dedd, surf_reflect, ubar0, F0PI)</span>
</pre></div>
</div>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_reflected_1d">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_reflected_1d</code><a class="headerlink" href="#picaso.fluxes.get_reflected_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes toon fluxes given tau and everything is 1 dimensional. This is the exact same function
as <cite>get_flux_geom_3d</cite> but is kept separately so we don’t have to do unecessary indexing for fast
retrievals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>) – Number of levels in the model</p></li>
<li><p><strong>wno</strong> (<em>array of float</em>) – Wave number grid in cm -1</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wave points</p></li>
<li><p><strong>numg</strong> (<em>int</em>) – Number of Gauss angles</p></li>
<li><p><strong>numt</strong> (<em>int</em>) – Number of Chebyshev angles</p></li>
<li><p><strong>DTAU</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>TAU</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</p></li>
<li><p><strong>W0</strong> (<em>ndarray of float</em>) – This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>COSB</strong> (<em>ndarray of float</em>) – This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>GCOS2</strong> (<em>ndarray of float</em>) – Parameter that allows us to directly include Rayleigh scattering
= 0.5*tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_cld</strong> (<em>ndarray of float</em>) – Fraction of cloud extinction to total
= tau_cloud/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_ray</strong> (<em>ndarray of float</em>) – Fraction of rayleigh extinction to total
= tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>dtau_og</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_og</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_og</strong> (<em>ndarray of float</em>) – Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>cosb_og</strong> (<em>ndarray of float</em>) – Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>) – Surface reflectivity</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray of float</em>) – matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>ubar1</strong> (<em>ndarray of float</em>) – matrix of cosine of the observer angles</p></li>
<li><p><strong>cos_theta</strong> (<em>float</em>) – Cosine of the phase angle of the planet</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>) – Downward incident solar radiation</p></li>
<li><p><strong>single_phase</strong> (<em>str</em>) – Single scattering phase function, default is the two-term henyey-greenstein phase function</p></li>
<li><p><strong>multi_phase</strong> (<em>str</em>) – Multiple scattering phase function, defulat is N=2 Legendre polynomial</p></li>
<li><p><strong>frac_a</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_b</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_c</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C), Default is : 1 - gcosb^2</p></li>
<li><p><strong>constant_back</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the assymetry of back scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>constant_forward</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the assymetry of forward scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>tridiagonal</strong> (<em>int</em>) – 0 for tridiagonal, 1 for pentadiagonal</p></li>
<li><p><strong>calc_type</strong> (<em>int</em>) – 0 for Outgoing Intensity on Top, 1 for layer and level upwelling and downwelling fluxes</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>intensity at the top of the atmosphere for all the different ubar1 and ubar2 if calc_type is 0 and</em> – layer and level upwelling and downwelling fluxes if calc_type is 1</p></li>
<li><p><em>To Do</em></p></li>
<li><p><em>—–</em></p></li>
<li><p><em>- F0PI Solar flux shouldn’t always be 1.. Follow up to make sure that this isn’t a bad</em> – hardwiring to solar, despite “relative albedo”</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_reflected_3d">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_reflected_3d</code><a class="headerlink" href="#picaso.fluxes.get_reflected_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes toon fluxes given tau and everything is 3 dimensional. This is the exact same function
as <cite>get_flux_geom_1d</cite> but is kept separately so we don’t have to do unecessary indexing for
retrievals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>) – Number of levels in the model</p></li>
<li><p><strong>wno</strong> (<em>array of float</em>) – Wave number grid in cm -1</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wave points</p></li>
<li><p><strong>numg</strong> (<em>int</em>) – Number of Gauss angles</p></li>
<li><p><strong>numt</strong> (<em>int</em>) – Number of Chebyshev angles</p></li>
<li><p><strong>dtau_3d</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_3d</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_3d</strong> (<em>ndarray of float</em>) – This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>cosb_3d</strong> (<em>ndarray of float</em>) – This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>gcos2_3d</strong> (<em>ndarray of float</em>) – Parameter that allows us to directly include Rayleigh scattering
= 0.5*tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_cld_3d</strong> (<em>ndarray of float</em>) – Fraction of cloud extinction to total
= tau_cloud/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_ray_3d</strong> (<em>ndarray of float</em>) – Fraction of rayleigh extinction to total
= tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>dtau_og_3d</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_og_3d</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_og_3d</strong> (<em>ndarray of float</em>) – Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>cosb_og_3d</strong> (<em>ndarray of float</em>) – Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>) – Surface reflectivity</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray of float</em>) – matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>ubar1</strong> (<em>ndarray of float</em>) – matrix of cosine of the observer angles</p></li>
<li><p><strong>cos_theta</strong> (<em>float</em>) – Cosine of the phase angle of the planet</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>) – Downward incident solar radiation</p></li>
<li><p><strong>single_phase</strong> (<em>str</em>) – Single scattering phase function, default is the two-term henyey-greenstein phase function</p></li>
<li><p><strong>multi_phase</strong> (<em>str</em>) – Multiple scattering phase function, defulat is N=2 Legendre polynomial</p></li>
<li><p><strong>frac_a</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_b</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_c</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C), Default is : 1 - gcosb^2</p></li>
<li><p><strong>constant_back</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the assymetry of back scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>constant_forward</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the assymetry of forward scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>tridiagonal</strong> (<em>int</em>) – 0 for tridiagonal, 1 for pentadiagonal</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>intensity at the top of the atmosphere for all the different ubar1 and ubar2</em></p></li>
<li><p><em>To Do</em></p></li>
<li><p><em>—–</em></p></li>
<li><p><em>- F0PI Solar flux shouldn’t always be 1.. Follow up to make sure that this isn’t a bad</em> – hardwiring to solar, despite “relative albedo”</p></li>
<li><p><em>- take delta eddington option out of fluxes and move it all over to optics</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.fluxes.get_reflected_new">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_reflected_new</code><span class="sig-paren">(</span><em class="sig-param">nlevel</em>, <em class="sig-param">nwno</em>, <em class="sig-param">numg</em>, <em class="sig-param">numt</em>, <em class="sig-param">dtau</em>, <em class="sig-param">tau</em>, <em class="sig-param">w0</em>, <em class="sig-param">cosb</em>, <em class="sig-param">gcos2</em>, <em class="sig-param">ftau_cld</em>, <em class="sig-param">ftau_ray</em>, <em class="sig-param">dtau_og</em>, <em class="sig-param">tau_og</em>, <em class="sig-param">w0_og</em>, <em class="sig-param">cosb_og</em>, <em class="sig-param">surf_reflect</em>, <em class="sig-param">ubar0</em>, <em class="sig-param">ubar1</em>, <em class="sig-param">cos_theta</em>, <em class="sig-param">F0PI</em>, <em class="sig-param">single_phase</em>, <em class="sig-param">multi_phase</em>, <em class="sig-param">frac_a</em>, <em class="sig-param">frac_b</em>, <em class="sig-param">frac_c</em>, <em class="sig-param">constant_back</em>, <em class="sig-param">constant_forward</em>, <em class="sig-param">dim</em>, <em class="sig-param">stream</em>, <em class="sig-param">print_time</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.get_reflected_new" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes rooney fluxes given tau and everything is 3 dimensional. This is the exact same function
as <cite>get_flux_geom_1d</cite> but is kept separately so we don’t have to do unecessary indexing for
retrievals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>) – Number of levels in the model</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wave points</p></li>
<li><p><strong>numg</strong> (<em>int</em>) – Number of Gauss angles</p></li>
<li><p><strong>numt</strong> (<em>int</em>) – Number of Chebyshev angles</p></li>
<li><p><strong>dtau_3d</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_3d</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_3d</strong> (<em>ndarray of float</em>) – This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>cosb_3d</strong> (<em>ndarray of float</em>) – This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>gcos2_3d</strong> (<em>ndarray of float</em>) – Parameter that allows us to directly include Rayleigh scattering
= 0.5*tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>dtau_og_3d</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_og_3d</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_og_3d</strong> (<em>ndarray of float</em>) – Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>cosb_og_3d</strong> (<em>ndarray of float</em>) – Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>) – Surface reflectivity</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray of float</em>) – matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>ubar1</strong> (<em>ndarray of float</em>) – matrix of cosine of the observer angles</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>) – Downward incident solar radiation</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>intensity at the top of the atmosphere for all the different ubar1 and ubar2</em></p></li>
<li><p><em>To Do</em></p></li>
<li><p><em>—–</em></p></li>
<li><p><em>- F0PI Solar flux shouldn’t always be 1.. Follow up to make sure that this isn’t a bad</em> – hardwiring to solar, despite “relative albedo”</p></li>
<li><p><em>- take delta eddington option out of fluxes and move it all over to optics</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_thermal_1d">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_thermal_1d</code><a class="headerlink" href="#picaso.fluxes.get_thermal_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>This function uses the source function method, which is outlined here:
<a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287">https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287</a></p>
<p>The result of this routine is the top of the atmosphere thermal flux as
a function of gauss and chebychev points accross the disk.</p>
<p>Everything here is in CGS units:</p>
<p>Fluxes - erg/s/cm^3
Temperature - K
Wave grid - cm-1
Pressure ; dyne/cm2</p>
<p>Reminder: Flux = pi * Intensity, so if you are trying to compare the result of this with
a black body you will need to compare with pi * BB !</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>) – Number of levels which occur at the grid points (not to be confused with layers which are
mid points)</p></li>
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>) – Wavenumber grid in inverse cm</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumber points</p></li>
<li><p><strong>numg</strong> (<em>int</em>) – Number of gauss points (think longitude points)</p></li>
<li><p><strong>numt</strong> (<em>int</em>) – Number of chebychev points (think latitude points)</p></li>
<li><p><strong>tlevel</strong> (<em>numpy.ndarray</em>) – Temperature as a function of level (not layer)</p></li>
<li><p><strong>dtau</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the per layer optical depth.</p></li>
<li><p><strong>w0</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>cosb</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the asymmetry of the
atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>plevel</strong> (<em>numpy.ndarray</em>) – Pressure for each level (not layer, which is midpoints). CGS units (dyne/cm2)</p></li>
<li><p><strong>ubar1</strong> (<em>numpy.ndarray</em>) – This is a matrix of ng by nt. This describes the outgoing incident angles and is generally
computed in <cite>picaso.disco</cite></p></li>
<li><p><strong>surf_reflect</strong> (<em>numpy.ndarray</em>) – Surface reflectivity as a function of wavenumber.</p></li>
<li><p><strong>tridiagonal</strong> (<em>int</em>) – 0 for tridiagonal, 1 for pentadiagonal</p></li>
<li><p><strong>calc_type</strong> (<em>int</em>) – 0 for outgoing flux at top level output, 1 for upward and downward layer and level flux outputs</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>numpy.ndarray</em> – Thermal flux in CGS units (erg/cm3/s) in a matrix that is
numg x numt x nwno if calc_type=0</p></li>
<li><p><em>numpy.ndarray, numpy.ndarray, numpy.ndarray, numpy.ndarray</em> – Thermal flux in CGS units (erg/cm3/s) in four matrices if calc_type=0: that is
level downward flux and level upward flux numg x numt x nlevel x nwno and then
layer downward flux and layer upward flux numg x numt x nlayer x nwno</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_thermal_3d">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_thermal_3d</code><a class="headerlink" href="#picaso.fluxes.get_thermal_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>This function uses the source function method, which is outlined here:
<a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287">https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287</a></p>
<p>The result of this routine is the top of the atmosphere thermal flux as
a function of gauss and chebychev points accross the disk.</p>
<p>Everything here is in CGS units:</p>
<p>Fluxes - erg/s/cm^3
Temperature - K
Wave grid - cm-1
Pressure ; dyne/cm2</p>
<p>Reminder: Flux = pi * Intensity, so if you are trying to compare the result of this with
a black body you will need to compare with pi * BB !</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>) – Number of levels which occur at the grid points (not to be confused with layers which are
mid points)</p></li>
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>) – Wavenumber grid in inverse cm</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumber points</p></li>
<li><p><strong>numg</strong> (<em>int</em>) – Number of gauss points (think longitude points)</p></li>
<li><p><strong>numt</strong> (<em>int</em>) – Number of chebychev points (think latitude points)</p></li>
<li><p><strong>tlevel_3d</strong> (<em>numpy.ndarray</em>) – Temperature as a function of level (not layer). This 3d matrix has dimensions [nlevel,ngangle,ntangle].</p></li>
<li><p><strong>dtau_3d</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the per layer optical depth.
This 4d matrix has dimensions [nlevel, nwave,ngangle,ntangle].</p></li>
<li><p><strong>w0_3d</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.
This 4d matrix has dimensions [nlevel, nwave,ngangle,ntangle].</p></li>
<li><p><strong>cosb_3d</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the asymmetry of the
atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.
This 4d matrix has dimensions [nlevel, nwave,ngangle,ntangle].</p></li>
<li><p><strong>plevel</strong> (<em>numpy.ndarray</em>) – Pressure for each level (not layer, which is midpoints). CGS units (dyne/cm2)</p></li>
<li><p><strong>ubar1</strong> (<em>numpy.ndarray</em>) – This is a matrix of ng by nt. This describes the outgoing incident angles and is generally
computed in <cite>picaso.disco</cite></p></li>
<li><p><strong>tridiagonal</strong> (<em>int</em>) – Zero for tridiagonal solver. 1 for pentadiagonal (not yet implemented)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Thermal flux in CGS units (erg/cm3/s) in a matrix that is
numg x numt x nwno</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_transit_1d">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_transit_1d</code><a class="headerlink" href="#picaso.fluxes.get_transit_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine to get the transmission spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>z</strong> (<em>float</em><em>, </em><em>array</em>) – Altitude in decreasing order (cm)</p></li>
<li><p><strong>dz</strong> (<em>float</em><em>, </em><em>array</em>) – length of each atmospheric layer</p></li>
<li><p><strong>nlevel</strong> (<em>int</em>) – Number of levels</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavelength points</p></li>
<li><p><strong>rstar</strong> (<em>float</em>) – Radius of star (cm)</p></li>
<li><p><strong>mmw</strong> (<em>float</em><em>, </em><em>array</em>) – Mean molecular weight</p></li>
<li><p><strong>k_b</strong> (<em>float</em>) – Boltzman constant cgs</p></li>
<li><p><strong>amu</strong> (<em>float</em>) – Atomic mass units cgs</p></li>
<li><p><strong>player</strong> (<em>float</em><em>, </em><em>array</em>) – Pressure at layers (dyn/cm2)</p></li>
<li><p><strong>tlayer</strong> (<em>float</em><em>, </em><em>array</em>) – Temperature at layers (K)</p></li>
<li><p><strong>colden</strong> (<em>float</em><em>, </em><em>array</em>) – Column density conputed in atmsetup.get_column_density()</p></li>
<li><p><strong>DTAU</strong> (<em>float</em><em>, </em><em>array</em>) – Matrix of summed tau opacities from optics. This is
TAUGAS + TAURAY + TAUCLD</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Rp**2 /Rs**2 as a function of wavelength</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.fluxes.get_transit_3d">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_transit_3d</code><span class="sig-paren">(</span><em class="sig-param">nlevel</em>, <em class="sig-param">nwno</em>, <em class="sig-param">radius</em>, <em class="sig-param">gravity</em>, <em class="sig-param">rstar</em>, <em class="sig-param">mass</em>, <em class="sig-param">mmw</em>, <em class="sig-param">k_b</em>, <em class="sig-param">G</em>, <em class="sig-param">amu</em>, <em class="sig-param">p_reference</em>, <em class="sig-param">plevel</em>, <em class="sig-param">tlevel</em>, <em class="sig-param">player</em>, <em class="sig-param">tlayer</em>, <em class="sig-param">colden</em>, <em class="sig-param">DTAU</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.get_transit_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine to get the 3D transmission spectrum</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.numba_cumsum">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">numba_cumsum</code><a class="headerlink" href="#picaso.fluxes.numba_cumsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute cumsum along axis=0 to bypass numba not allowing kwargs in
cumsum</p>
</dd></dl>

<dl class="function">
<dt id="picaso.fluxes.pent_diag_solve">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">pent_diag_solve</code><span class="sig-paren">(</span><em class="sig-param">l</em>, <em class="sig-param">A</em>, <em class="sig-param">B</em>, <em class="sig-param">C</em>, <em class="sig-param">D</em>, <em class="sig-param">E</em>, <em class="sig-param">F</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.pent_diag_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Pentadiagonal Matrix solver</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>array</em><em> or </em><em>list</em>) – </p></li>
<li><p><strong>B</strong> (<em>array</em><em> or </em><em>list</em>) – </p></li>
<li><p><strong>C</strong> (<em>array</em><em> or </em><em>list</em>) – </p></li>
<li><p><strong>D</strong> (<em>array</em><em> or </em><em>list</em>) – </p></li>
<li><p><strong>E</strong> (<em>array</em><em> or </em><em>list</em>) – </p></li>
<li><p><strong>F</strong> (<em>array</em><em> or </em><em>list</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Solution, x</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.fluxes.setup_2_stream">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">setup_2_stream</code><span class="sig-paren">(</span><em class="sig-param">nlayer</em>, <em class="sig-param">nwno</em>, <em class="sig-param">W0</em>, <em class="sig-param">b_top</em>, <em class="sig-param">b_surface</em>, <em class="sig-param">surf_reflect</em>, <em class="sig-param">F0PI</em>, <em class="sig-param">ubar0</em>, <em class="sig-param">dtau</em>, <em class="sig-param">tau</em>, <em class="sig-param">w_single</em>, <em class="sig-param">w_multi</em>, <em class="sig-param">ubar1</em>, <em class="sig-param">P</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.setup_2_stream" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlayer</strong> (<em>int</em>) – number of layers in the model</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – number of wavelength points ## need to include this</p></li>
<li><p><strong>W0</strong> (<em>int</em>) – single scattering albedo</p></li>
<li><p><strong>b_top</strong> (<em>array</em>) – The diffuse radiation into the model at the top of the atmosphere</p></li>
<li><p><strong>b_surface</strong> (<em>arra</em>) – The diffuse radiation into the model at the bottom. Includes emission, reflection
of the unattenuated portion of the direct beam</p></li>
<li><p><strong>surf_reflect</strong> (<em>array</em>) – Surface reflectivity</p></li>
<li><p><strong>F0PI</strong> (<em>int</em>) – solar radiation</p></li>
<li><p><strong>ubar0</strong> (<em>array</em>) – cosine of solar incident angle</p></li>
<li><p><strong>dtau</strong> (<em>array</em>) – Opacity per layer</p></li>
<li><p><strong>g</strong> (<em>array</em>) – asymmety parameters</p></li>
<li><p><strong>P</strong> (<em>array</em>) – Legendre polynomials</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.fluxes.setup_2_stream_scaled">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">setup_2_stream_scaled</code><span class="sig-paren">(</span><em class="sig-param">nlayer</em>, <em class="sig-param">nwno</em>, <em class="sig-param">W0</em>, <em class="sig-param">b_top</em>, <em class="sig-param">b_surface</em>, <em class="sig-param">surf_reflect</em>, <em class="sig-param">F0PI</em>, <em class="sig-param">ubar0</em>, <em class="sig-param">dtau</em>, <em class="sig-param">tau</em>, <em class="sig-param">w_single</em>, <em class="sig-param">w_multi</em>, <em class="sig-param">ubar1</em>, <em class="sig-param">P</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.setup_2_stream_scaled" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlayer</strong> (<em>int</em>) – number of layers in the model</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – number of wavelength points ## need to include this</p></li>
<li><p><strong>W0</strong> (<em>int</em>) – single scattering albedo</p></li>
<li><p><strong>b_top</strong> (<em>array</em>) – The diffuse radiation into the model at the top of the atmosphere</p></li>
<li><p><strong>b_surface</strong> (<em>arra</em>) – The diffuse radiation into the model at the bottom. Includes emission, reflection
of the unattenuated portion of the direct beam</p></li>
<li><p><strong>surf_reflect</strong> (<em>array</em>) – Surface reflectivity</p></li>
<li><p><strong>F0PI</strong> (<em>int</em>) – solar radiation</p></li>
<li><p><strong>ubar0</strong> (<em>array</em>) – cosine of solar incident angle</p></li>
<li><p><strong>dtau</strong> (<em>array</em>) – Opacity per layer</p></li>
<li><p><strong>g</strong> (<em>array</em>) – asymmety parameters</p></li>
<li><p><strong>P</strong> (<em>array</em>) – Legendre polynomials</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.fluxes.setup_4_stream">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">setup_4_stream</code><span class="sig-paren">(</span><em class="sig-param">nlayer</em>, <em class="sig-param">nwno</em>, <em class="sig-param">W0</em>, <em class="sig-param">b_top</em>, <em class="sig-param">b_surface</em>, <em class="sig-param">surf_reflect</em>, <em class="sig-param">F0PI</em>, <em class="sig-param">ubar0</em>, <em class="sig-param">dtau</em>, <em class="sig-param">tau</em>, <em class="sig-param">w_single</em>, <em class="sig-param">w_multi</em>, <em class="sig-param">ubar1</em>, <em class="sig-param">P</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.setup_4_stream" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlayer</strong> (<em>int</em>) – number of layers in the model</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – number of wavelength points ## need to include this</p></li>
<li><p><strong>W0</strong> (<em>int</em>) – single scattering albedo</p></li>
<li><p><strong>b_top</strong> (<em>array</em>) – The diffuse radiation into the model at the top of the atmosphere</p></li>
<li><p><strong>b_surface</strong> (<em>array</em>) – The diffuse radiation into the model at the bottom. Includes emission, reflection
of the unattenuated portion of the direct beam</p></li>
<li><p><strong>surf_reflect</strong> (<em>array</em>) – Surface reflectivity</p></li>
<li><p><strong>F0PI</strong> (<em>int</em>) – solar radiation</p></li>
<li><p><strong>ubar0</strong> (<em>array</em>) – cosine of solar incident angle</p></li>
<li><p><strong>dtau</strong> (<em>array</em>) – Opacity per layer</p></li>
<li><p><strong>g</strong> (<em>array</em>) – asymmetry parameters</p></li>
<li><p><strong>P</strong> (<em>array</em>) – Legendre polynomials</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.fluxes.setup_4_stream_scaled">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">setup_4_stream_scaled</code><span class="sig-paren">(</span><em class="sig-param">nlayer</em>, <em class="sig-param">nwno</em>, <em class="sig-param">W0</em>, <em class="sig-param">b_top</em>, <em class="sig-param">b_surface</em>, <em class="sig-param">surf_reflect</em>, <em class="sig-param">F0PI</em>, <em class="sig-param">ubar0</em>, <em class="sig-param">dtau</em>, <em class="sig-param">tau</em>, <em class="sig-param">w_single</em>, <em class="sig-param">w_multi</em>, <em class="sig-param">ubar1</em>, <em class="sig-param">P</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.setup_4_stream_scaled" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlayer</strong> (<em>int</em>) – number of layers in the model</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – number of wavelength points ## need to include this</p></li>
<li><p><strong>W0</strong> (<em>int</em>) – single scattering albedo</p></li>
<li><p><strong>b_top</strong> (<em>array</em>) – The diffuse radiation into the model at the top of the atmosphere</p></li>
<li><p><strong>b_surface</strong> (<em>array</em>) – The diffuse radiation into the model at the bottom. Includes emission, reflection
of the unattenuated portion of the direct beam</p></li>
<li><p><strong>surf_reflect</strong> (<em>array</em>) – Surface reflectivity</p></li>
<li><p><strong>F0PI</strong> (<em>int</em>) – solar radiation</p></li>
<li><p><strong>ubar0</strong> (<em>array</em>) – cosine of solar incident angle</p></li>
<li><p><strong>dtau</strong> (<em>array</em>) – Opacity per layer</p></li>
<li><p><strong>g</strong> (<em>array</em>) – asymmetry parameters</p></li>
<li><p><strong>P</strong> (<em>array</em>) – Legendre polynomials</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.fluxes.setup_pent_diag">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">setup_pent_diag</code><span class="sig-paren">(</span><em class="sig-param">nlayer</em>, <em class="sig-param">nwno</em>, <em class="sig-param">c_plus_up</em>, <em class="sig-param">c_minus_up</em>, <em class="sig-param">c_plus_down</em>, <em class="sig-param">c_minus_down</em>, <em class="sig-param">b_top</em>, <em class="sig-param">b_surface</em>, <em class="sig-param">surf_reflect</em>, <em class="sig-param">gama</em>, <em class="sig-param">dtau</em>, <em class="sig-param">exptrm_positive</em>, <em class="sig-param">exptrm_minus</em>, <em class="sig-param">g1</em>, <em class="sig-param">g2</em>, <em class="sig-param">exptrm</em>, <em class="sig-param">lamda</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.setup_pent_diag" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlayer</strong> (<em>int</em>) – number of layers in the model</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – number of wavelength points</p></li>
<li><p><strong>c_plus_up</strong> (<em>array</em>) – c-plus evaluated at the top of the atmosphere</p></li>
<li><p><strong>c_minus_up</strong> (<em>array</em>) – c_minus evaluated at the top of the atmosphere</p></li>
<li><p><strong>c_plus_down</strong> (<em>array</em>) – c_plus evaluated at the bottom of the atmosphere</p></li>
<li><p><strong>c_minus_down</strong> (<em>array</em>) – c_minus evaluated at the bottom of the atmosphere</p></li>
<li><p><strong>b_top</strong> (<em>array</em>) – The diffuse radiation into the model at the top of the atmosphere</p></li>
<li><p><strong>b_surface</strong> (<em>array</em>) – The diffuse radiation into the model at the bottom. Includes emission, reflection
of the unattenuated portion of the direct beam</p></li>
<li><p><strong>surf_reflect</strong> (<em>array</em>) – Surface reflectivity</p></li>
<li><p><strong>g1</strong> (<em>array</em>) – table 1 toon et al 1989</p></li>
<li><p><strong>g2</strong> (<em>array</em>) – table 1 toon et al 1989</p></li>
<li><p><strong>g3</strong> (<em>array</em>) – table 1 toon et al 1989</p></li>
<li><p><strong>lamba</strong> (<em>array</em>) – Eqn 21 toon et al 1989</p></li>
<li><p><strong>gama</strong> (<em>array</em>) – Eqn 22 toon et al 1989</p></li>
<li><p><strong>dtau</strong> (<em>array</em>) – Opacity per layer</p></li>
<li><p><strong>exptrm_positive</strong> (<em>array</em>) – Eqn 44, expoential terms needed for tridiagonal rotated layered, clipped at 35</p></li>
<li><p><strong>exptrm_minus</strong> (<em>array</em>) – Eqn 44, expoential terms needed for tridiagonal rotated layered, clipped at 35</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>coefficient of the positive exponential term</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.setup_tri_diag">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">setup_tri_diag</code><a class="headerlink" href="#picaso.fluxes.setup_tri_diag" title="Permalink to this definition">¶</a></dt>
<dd><p>Before we can solve the tridiagonal matrix (See Toon+1989) section
“SOLUTION OF THE TwO-STREAM EQUATIONS FOR MULTIPLE LAYERS”, we
need to set up the coefficients.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlayer</strong> (<em>int</em>) – number of layers in the model</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – number of wavelength points</p></li>
<li><p><strong>c_plus_up</strong> (<em>array</em>) – c-plus evaluated at the top of the atmosphere</p></li>
<li><p><strong>c_minus_up</strong> (<em>array</em>) – c_minus evaluated at the top of the atmosphere</p></li>
<li><p><strong>c_plus_down</strong> (<em>array</em>) – c_plus evaluated at the bottom of the atmosphere</p></li>
<li><p><strong>c_minus_down</strong> (<em>array</em>) – c_minus evaluated at the bottom of the atmosphere</p></li>
<li><p><strong>b_top</strong> (<em>array</em>) – The diffuse radiation into the model at the top of the atmosphere</p></li>
<li><p><strong>b_surface</strong> (<em>array</em>) – The diffuse radiation into the model at the bottom. Includes emission, reflection
of the unattenuated portion of the direct beam</p></li>
<li><p><strong>surf_reflect</strong> (<em>array</em>) – Surface reflectivity</p></li>
<li><p><strong>g1</strong> (<em>array</em>) – table 1 toon et al 1989</p></li>
<li><p><strong>g2</strong> (<em>array</em>) – table 1 toon et al 1989</p></li>
<li><p><strong>g3</strong> (<em>array</em>) – table 1 toon et al 1989</p></li>
<li><p><strong>lamba</strong> (<em>array</em>) – Eqn 21 toon et al 1989</p></li>
<li><p><strong>gama</strong> (<em>array</em>) – Eqn 22 toon et al 1989</p></li>
<li><p><strong>dtau</strong> (<em>array</em>) – Opacity per layer</p></li>
<li><p><strong>exptrm_positive</strong> (<em>array</em>) – Eqn 44, expoential terms needed for tridiagonal rotated layered, clipped at 35</p></li>
<li><p><strong>exptrm_minus</strong> (<em>array</em>) – Eqn 44, expoential terms needed for tridiagonal rotated layered, clipped at 35</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>coefficient of the positive exponential term</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.slice_eq">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">slice_eq</code><a class="headerlink" href="#picaso.fluxes.slice_eq" title="Permalink to this definition">¶</a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.slice_gt">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">slice_gt</code><a class="headerlink" href="#picaso.fluxes.slice_gt" title="Permalink to this definition">¶</a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.slice_lt">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">slice_lt</code><a class="headerlink" href="#picaso.fluxes.slice_lt" title="Permalink to this definition">¶</a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="function">
<dt id="picaso.fluxes.solve_4_stream">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">solve_4_stream</code><span class="sig-paren">(</span><em class="sig-param">M</em>, <em class="sig-param">B</em>, <em class="sig-param">A</em>, <em class="sig-param">N</em>, <em class="sig-param">F</em>, <em class="sig-param">G</em>, <em class="sig-param">A_int</em>, <em class="sig-param">N_int</em>, <em class="sig-param">stream</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.solve_4_stream" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.tri_diag_solve">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">tri_diag_solve</code><a class="headerlink" href="#picaso.fluxes.tri_diag_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Tridiagonal Matrix Algorithm solver, a b c d can be NumPy array type or Python list type.
refer to this <a class="reference external" href="http://en.wikipedia.org/wiki/Tridiagonal_matrix_algorithm">wiki</a> and to this <a class="reference external" href="http://www.cfd-online.com/Wiki/Tridiagonal_matrix_algorithm_-_TDMA_(Thomas_algorithm)">explanation</a>.</p>
<p>A, B, C and D refer to:</p>
<div class="math notranslate nohighlight">
\[A(I)*X(I-1) + B(I)*X(I) + C(I)*X(I+1) = D(I)\]</div>
<p>This solver returns X.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>A</strong> (<em>array</em><em> or </em><em>list</em>) – </p></li>
<li><p><strong>B</strong> (<em>array</em><em> or </em><em>list</em>) – </p></li>
<li><p><strong>C</strong> (<em>array</em><em> or </em><em>list</em>) – </p></li>
<li><p><strong>C</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Solution, x</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso.io_utils">
<span id="picaso-io-utils-module"></span><h2>picaso.io_utils module<a class="headerlink" href="#module-picaso.io_utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.io_utils.read_hdf">
<code class="sig-prename descclassname">picaso.io_utils.</code><code class="sig-name descname">read_hdf</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">requires</em>, <em class="sig-param">raise_except=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.io_utils.read_hdf" title="Permalink to this definition">¶</a></dt>
<dd><p>read in H5 format file and pull out specific table based on specific
header information in the requires field. return None if file is not there</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – name of H5 file to read</p></li>
<li><p><strong>requires</strong> (<em>dict</em>) – dictionary with keys and values to get correct table
e.g. {‘wmin’:0.3, ‘wmax’:1, ‘R’:5000} for opacity grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>d</strong> – data from H5 file decoded into python object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>python object</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.io_utils.read_json">
<code class="sig-prename descclassname">picaso.io_utils.</code><code class="sig-name descname">read_json</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.io_utils.read_json" title="Permalink to this definition">¶</a></dt>
<dd><p>read in a JSON format file.  return None if the file is not there.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – name of the JSON file to read</p></li>
<li><p><strong>except</strong> (<em>bool</em>) – if true, raise exception if file is missing. if false, return empty dict.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>d</strong> – data from JSON file decoded into python object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>python object</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="picaso-justdoit-module">
<h2>picaso.justdoit module<a class="headerlink" href="#picaso-justdoit-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-picaso.justplotit">
<span id="picaso-justplotit-module"></span><h2>picaso.justplotit module<a class="headerlink" href="#module-picaso.justplotit" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.justplotit.chunk">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">chunk</code><span class="sig-paren">(</span><em class="sig-param">loc</em>, <em class="sig-param">spacing</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.chunk" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a list of index output from np.where, this function
separates the list into sequential indexes. For example,
[1,2,3,10,11,12] would be returned as [[1,2,3],[10,11,12]</p>
<dl class="simple">
<dt>loc<span class="classifier">np.array</span></dt><dd><p>Set of indecies from np.where</p>
</dd>
<dt>spacing<span class="classifier">int</span></dt><dd><p>Sets the minimum distance between the chunks. E.g. if spacing = 4 then
[1,2,3,5] would not be chunked because the spacing is only 2.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.cloud">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">cloud</code><span class="sig-paren">(</span><em class="sig-param">full_output</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.cloud" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting the cloud input from <code class="docutils literal notranslate"><span class="pre">picaso</span></code>.</p>
<p>The plot itselfs creates maps of the wavelength dependent single scattering albedo
and cloud opacity as a function of altitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>full_output</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A row of two bokeh plots with the single scattering and optical depth map</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.corr_continuum">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">corr_continuum</code><span class="sig-paren">(</span><em class="sig-param">atm</em>, <em class="sig-param">filename_db</em>, <em class="sig-param">wavenumber</em>, <em class="sig-param">residual</em>, <em class="sig-param">max_plot</em>, <em class="sig-param">threshold</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.corr_continuum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.justplotit.corr_molecular">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">corr_molecular</code><span class="sig-paren">(</span><em class="sig-param">atm</em>, <em class="sig-param">filename_db</em>, <em class="sig-param">wavenumber</em>, <em class="sig-param">residual</em>, <em class="sig-param">max_plot</em>, <em class="sig-param">threshold</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.corr_molecular" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.justplotit.disco">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">disco</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">wavelength</em>, <em class="sig-param">calculation='reflected'</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.disco" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot disco ball with facets. Bokeh is not good with 3D things. So this is in matplotlib</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – Full output from picaso</p></li>
<li><p><strong>wavelength</strong> (<em>list</em>) – Where to plot 3d facets. Can input as many wavelengths as wanted.
Must be a list, must be in microns.</p></li>
<li><p><strong>calculation</strong> (<em>str</em><em>, </em><em>optional</em>) – Default is to plot ‘reflected’ light but can also switch to ‘thermal’ if it has been computed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.explore">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">explore</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">key</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.explore" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to explore a dictionary that is THREE levels deep and return the data sitting at
the end of key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>dict</em>) – Dictionary that you want to search through.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Consider a dictionary that has <cite>df[‘layer’][‘cloud’][‘w0’] = [0,0,0]</cite></p>
<p>&gt;&gt;&gt;explore(df, ‘w0’)
[0,0,0]</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.find_nearest_1d">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">find_nearest_1d</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.find_nearest_1d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.justplotit.find_nearest_2d">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">find_nearest_2d</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">value</em>, <em class="sig-param">axis=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.find_nearest_2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.justplotit.find_nearest_old">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">find_nearest_old</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.find_nearest_old" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.justplotit.flux_at_top">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">flux_at_top</code><span class="sig-paren">(</span><em class="sig-param">full_output, plot_bb=True, R=None, pressures=[0.1, 0.01, 0.001], ng=None, nt=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.flux_at_top" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine to plot the OLR with overlaying black bodies.</p>
<p>Flux units are CGS = erg/s/cm^3</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>dict</em>) – full dictionary output with {‘wavenumber’,’thermal’,’full_output’}</p></li>
<li><p><strong>plot_bb</strong> (<em>bool</em><em> , </em><em>optional</em>) – Default is to plot black bodies for three pressures specified by <cite>pressures</cite></p></li>
<li><p><strong>R</strong> (<em>float</em>) – New constant R to bin to</p></li>
<li><p><strong>pressures</strong> (<em>list</em><em>, </em><em>optional</em>) – Default is a list of three pressures (in bars) =  [1e-1,1e-2,1e-3]</p></li>
<li><p><strong>ng</strong> (<em>int</em>) – Used for 3D calculations to select point on the sphere (equivalent to longitude point)</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – Used for 3D calculations to select point on the sphere (equivalent to latitude point)</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.figure()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.get_bad_bands">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">get_bad_bands</code><span class="sig-paren">(</span><em class="sig-param">residual</em>, <em class="sig-param">sensitivity=3</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.get_bad_bands" title="Permalink to this definition">¶</a></dt>
<dd><p>Given a set of residuals, this program separates out the bad bands into
separate lists and returns the indecies of the bad bands in list form.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>residual</strong> (<em>np.array</em>) – Model 1 - model 2</p></li>
<li><p><strong>sensitivity</strong> (<em>float</em>) – This will pick out anything that is worse than stdev(residual)/sensitivity. Larger
numbers pick out more problems.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.lon_lat_to_cartesian">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">lon_lat_to_cartesian</code><span class="sig-paren">(</span><em class="sig-param">lon_r</em>, <em class="sig-param">lat_r</em>, <em class="sig-param">R=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.lon_lat_to_cartesian" title="Permalink to this definition">¶</a></dt>
<dd><p>calculates lon, lat coordinates of a point on a sphere with
radius R</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.map">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">map</code><span class="sig-paren">(</span><em class="sig-param">full_output, pressure=[0.1], plot='temperature', wavelength=None, igauss=0</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.map" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot disco ball with facets. Bokeh is not good with 3D things. So this is in matplotlib</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – Full output from picaso</p></li>
<li><p><strong>pressure</strong> (<em>list</em>) – What pressure (in bars) to make the map on. Note: this assumes that the
pressure grid is the same for each ng,nt point accross the grid.</p></li>
<li><p><strong>plot</strong> (<em>str</em><em>, </em><em>optional</em>) – Default is to plot ‘temperature’ map but can also switch to any
3d [nlayer, nlong, nlat] or 4d [nlayer, nwave, nlong, nlat] output in full_output. You can check what is available to plot by printing:
<cite>print(full_output[‘layer’].keys()</cite>.
If you are plotting something that is ALSO wavelength dependent you have to
also supply a single wavelength.</p></li>
<li><p><strong>float</strong><strong>, </strong><strong>optional</strong> (<em>wavelength</em><em>,</em>) – This allows users to plot maps of things that are wavelength dependent, like
<cite>taugas</cite> and <cite>taucld</cite>.</p></li>
<li><p><strong>igauss</strong> (<em>int</em>) – Gauss point to plot if using ktables this can be greater than 0 up to ngauss-1. Otherwise,
This must be zero for monochromatic opacities.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.mean_regrid">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">mean_regrid</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">newx=None</em>, <em class="sig-param">R=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.mean_regrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebin the spectrum at a minimum R or on a fixed grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) – Wavenumbers</p></li>
<li><p><strong>y</strong> (<em>array</em>) – Anything (e.g. albedo, flux)</p></li>
<li><p><strong>newx</strong> (<em>array</em>) – new array to regrid on.</p></li>
<li><p><strong>R</strong> (<em>float</em>) – create grid with constant R</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>final x, and final y</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.mixing_ratio">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">mixing_ratio</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.mixing_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns plot of mixing ratios</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – picaso.atmsetup.ATMSETUP</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.figure()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justplotit.numba_cumsum">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">numba_cumsum</code><a class="headerlink" href="#picaso.justplotit.numba_cumsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute cumsum along axis=0 to bypass numba not allowing kwargs in
cumsum</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.photon_attenuation">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">photon_attenuation</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">at_tau=0.5</em>, <em class="sig-param">return_output=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.photon_attenuation" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot breakdown of gas opacity, cloud opacity,
Rayleigh scattering opacity at a specified pressure level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – picaso.atmsetup.ATMSETUP</p></li>
<li><p><strong>at_tau</strong> (<em>float</em>) – Opacity at which to plot the cumulative opacity.
Default = 0.5.</p></li>
<li><p><strong>return_output</strong> (<em>bool</em>) – Return photon attenuation plot values</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.plotting.figure()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>if return_output=False</strong> (<em>bokeh plot</em>)</p></li>
<li><p><strong>else</strong> (<em>bokeh plot,wave,at_pressures_gas,at_pressures_cld,at_pressures_ray</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.plot_cld_input">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">plot_cld_input</code><span class="sig-paren">(</span><em class="sig-param">nwno</em>, <em class="sig-param">nlayer</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">df=None</em>, <em class="sig-param">pressure=None</em>, <em class="sig-param">wavelength=None</em>, <em class="sig-param">**pd_kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_cld_input" title="Permalink to this definition">¶</a></dt>
<dd><p>This function was created to investigate CLD input file for PICASO.</p>
<p>The plot itselfs creates maps of the wavelength dependent single scattering albedo
and cloud opacity and assymetry parameter as a function of altitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumber points. For runs from Ackerman &amp; Marley, this will always be 196.</p></li>
<li><p><strong>nlayer</strong> (<em>int</em>) – Should be one less than the number of levels in your pressure temperature grid. Cloud
opacity is assigned for slabs.</p></li>
<li><p><strong>file</strong> (<em>str</em><em> , </em><em>optional</em>) – (Optional)Path to cloud input file</p></li>
<li><p><strong>df</strong> (<em>str</em>) – (Optional)Dataframe of cloud input file</p></li>
<li><p><strong>wavelength</strong> (<em>array</em><em> , </em><em>optional</em>) – (Optional) this allows you to reset the tick marks to wavelengths instead of indicies</p></li>
<li><p><strong>pressure</strong> (<em>array</em><em>, </em><em>optional</em>) – (Optional) this allows you to reset the tick marks to pressure instead of indicies</p></li>
<li><p><strong>pd_kwargs</strong> (<em>kwargs</em>) – Pandas key word arguments for <cite>pandas.read_csv</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Three bokeh plots with the single scattering, optical depth, and assymetry maps</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.plot_errorbar">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">plot_errorbar</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">e</em>, <em class="sig-param">plot</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_errorbar" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot error bars in bokeh plot</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.plot_format">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">plot_format</code><span class="sig-paren">(</span><em class="sig-param">df</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to reformat plots</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.pt">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">pt</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">ng=None</em>, <em class="sig-param">nt=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.pt" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns plot of pressure temperature profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – picaso.atmsetup.ATMSETUP</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.figure()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.spectrum">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">spectrum</code><span class="sig-paren">(</span><em class="sig-param">xarray, yarray, legend=None, wno_to_micron=True, palette=['#0072B2', '#E69F00', '#F0E442', '#009E73', '#56B4E9', '#D55E00', '#CC79A7', '#000000'], **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot formated albedo spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xarray</strong> (<em>float array</em><em>, </em><em>list of arrays</em>) – wavenumber or micron</p></li>
<li><p><strong>yarray</strong> (<em>float array</em><em>, </em><em>list of arrays</em>) – albedo or fluxes</p></li>
<li><p><strong>legend</strong> (<em>list of str</em><em> , </em><em>optional</em>) – legends for plotting</p></li>
<li><p><strong>wno_to_micron</strong> (<em>bool</em><em> , </em><em>optional</em>) – Converts wavenumber to micron</p></li>
<li><p><strong>palette</strong> (<em>list</em><em>,</em><em>optional</em>) – List of colors for lines. Default only has 8 colors so if you input more lines, you must
give a different pallete</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.plotting.figure()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bokeh plot</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.spectrum_hires">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">spectrum_hires</code><span class="sig-paren">(</span><em class="sig-param">wno</em>, <em class="sig-param">alb</em>, <em class="sig-param">legend=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.spectrum_hires" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot formated albedo spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno</strong> (<em>float array</em><em>, </em><em>list of arrays</em>) – wavenumber</p></li>
<li><p><strong>alb</strong> (<em>float array</em><em>, </em><em>list of arrays</em>) – albedo</p></li>
<li><p><strong>legend</strong> (<em>list of str</em>) – legends for plotting</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for hv.opts</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bokeh plot</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.taumap">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">taumap</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">at_tau=1</em>, <em class="sig-param">wavelength=1</em>, <em class="sig-param">igauss=0</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.taumap" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot breakdown of gas opacity, cloud opacity,
Rayleigh scattering opacity at a specified pressure level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – full_output from dictionary picaso output</p></li>
<li><p><strong>at_tau</strong> (<em>float</em>) – Opacity at which to plot the cumulative opacity.
Default = 0.5.</p></li>
<li><p><strong>igauss</strong> (<em>int</em>) – Gauss point to plot if using ktables this can be greater than 0 up to ngauss-1. Otherwise,
This must be zero for monochromatic opacities.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.plotting.figure()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bokeh plot</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso.opacity_factory">
<span id="picaso-opacity-factory-module"></span><h2>picaso.opacity_factory module<a class="headerlink" href="#module-picaso.opacity_factory" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.opacity_factory.adapt_array">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">adapt_array</code><span class="sig-paren">(</span><em class="sig-param">arr</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.adapt_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.build_skeleton">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">build_skeleton</code><span class="sig-paren">(</span><em class="sig-param">db_f</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.build_skeleton" title="Permalink to this definition">¶</a></dt>
<dd><p>This functionb builds a skeleton sqlite3 database with three tables:
1) header
2) molecular
3) continuum</p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.continuum_avail">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">continuum_avail</code><span class="sig-paren">(</span><em class="sig-param">db_file</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.continuum_avail" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.convert_array">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">convert_array</code><span class="sig-paren">(</span><em class="sig-param">text</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.convert_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.create_grid">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">create_grid</code><span class="sig-paren">(</span><em class="sig-param">min_wavelength</em>, <em class="sig-param">max_wavelength</em>, <em class="sig-param">constant_R</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.create_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple function to create a wavelength grid defined with a constant R.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_wavelength</strong> (<em>float</em>) – Minimum wavelength in microns</p></li>
<li><p><strong>max_wavelength</strong> (<em>float</em>) – Maximum wavelength in microns</p></li>
<li><p><strong>constant_R</strong> (<em>float</em>) – Constant R spacing</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>wavenumber grid defined at constant Resolution</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.create_grid_minR">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">create_grid_minR</code><span class="sig-paren">(</span><em class="sig-param">min_wavelength</em>, <em class="sig-param">max_wavelength</em>, <em class="sig-param">minimum_R</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.create_grid_minR" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple function to create a wavelength grid defined with a minimum R.
This does not create a “constant” resolution grid. Rather, it defines the R
at the minimum R so that the wavelength grid satisfies all_Rs&gt;R</p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.find_nearest">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">find_nearest</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.find_nearest" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.find_nearest_1d">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">find_nearest_1d</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.find_nearest_1d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.fit_linsky">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">fit_linsky</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">wno</em>, <em class="sig-param">va=3</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.fit_linsky" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds H2-H2 opacity from Linsky (1969) and Lenzuni et al. (1991)
to values that were set to -33 as place holders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Temperature</p></li>
<li><p><strong>wno</strong> (<em>numpy.array</em>) – wave number</p></li>
<li><p><strong>va</strong> (<em>int</em><em> or </em><em>float</em>) – (Optional) 1,2 or 3 (depending on what overtone to compute</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>H2-H2 absorption in cm-1 amagat-2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_continuum">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_continuum</code><span class="sig-paren">(</span><em class="sig-param">db_file</em>, <em class="sig-param">species</em>, <em class="sig-param">temperature</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Grab continuum opacity from sqlite database</p>
<dl class="simple">
<dt>db_file<span class="classifier">str</span></dt><dd><p>sqlite3 database filename</p>
</dd>
<dt>species<span class="classifier">list of str</span></dt><dd><p>Single species name. you can run continuum_avail to see what species are present.</p>
</dd>
<dt>temperature<span class="classifier">list of float</span></dt><dd><p>Temperature to grab. can grab available temperatures from continuum_avail</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_h2minus">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_h2minus</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">new_wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_h2minus" title="Permalink to this definition">¶</a></dt>
<dd><p>This results gives the H2 minus opacity, needed for temperatures greater than 600 K.
K L Bell 1980 J. Phys. B: At. Mol. Phys. 13 1859, Table 1
theta=5040/T(K)</p>
<p>The result is given in cm4/dyn, which is why will will  multiply by nh2*ne*k*T
where:
nh2: number of h2 molecules/cm3
ne: number of electrons/cm3
This will happen when we go to sum opacities. For now returns will be in cm4/dyn</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>numpy.ndarray</em>) – temperature in K</p></li>
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>) – wave number cm-1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>H2 minus opacity in units of cm4/dyn</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_hminusbf">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_hminusbf</code><span class="sig-paren">(</span><em class="sig-param">wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_hminusbf" title="Permalink to this definition">¶</a></dt>
<dd><p>H- bound free opacity, which is only dependent on wavelength. From John 1988 <a class="reference external" href="http://adsabs.harvard.edu/abs/1988A%26A...193..189J">http://adsabs.harvard.edu/abs/1988A%26A…193..189J</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wno</strong> (<em>numpy.ndarray</em>) – Wavenumber in cm-1</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Absorption coefficient in units of cm2</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array of floats</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_hminusff">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_hminusff</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_hminusff" title="Permalink to this definition">¶</a></dt>
<dd><p>H- free free opacity, which is both wavelength and temperature dependent.
From Bell &amp; Berrington (1987)
Also includes factor for simulated emission</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Temperature in K</p></li>
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>) – Wavenumber in cm-1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gives cross section in cm^5</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array of float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_kark_CH4">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_kark_CH4</code><span class="sig-paren">(</span><em class="sig-param">kark_file</em>, <em class="sig-param">new_wno</em>, <em class="sig-param">T</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_kark_CH4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_kark_CH4_noTdependence">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_kark_CH4_noTdependence</code><span class="sig-paren">(</span><em class="sig-param">kark_dir</em>, <em class="sig-param">new_wave</em>, <em class="sig-param">temperature</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_kark_CH4_noTdependence" title="Permalink to this definition">¶</a></dt>
<dd><p>Files from kark+2010 paper</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>opacity in cm2/species</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_molecular">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_molecular</code><span class="sig-paren">(</span><em class="sig-param">db_file</em>, <em class="sig-param">species</em>, <em class="sig-param">temperature</em>, <em class="sig-param">pressure</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_molecular" title="Permalink to this definition">¶</a></dt>
<dd><p>Grab molecular opacity from sqlite database</p>
<dl class="simple">
<dt>db_file<span class="classifier">str</span></dt><dd><p>sqlite3 database filename</p>
</dd>
<dt>species<span class="classifier">list of str</span></dt><dd><p>Single species name. you can run molecular_avail to see what species are present.</p>
</dd>
<dt>temperature<span class="classifier">list of flaot,int</span></dt><dd><p>Temperature to grab. This will grab the nearest pair neighbor so you dont
have to be exact.
This should be used in conjuction with pressure. For example, if you want
one temperature at two pressures, then this should be input as
t = [100,100] (and pressure would be p=[0.1,1] for instance)</p>
</dd>
<dt>pressure<span class="classifier">list of flaot,int</span></dt><dd><p>Pressure to grab. This will grab the nearest pair neighbor so you dont
have to be exact.
This should be used in conjuction with pressure. For example, if you want
one temperature at two pressures, then this should be input as
t = [100,100] (and pressure would be p=[0.1,1] for instance)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_optical_o3">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_optical_o3</code><span class="sig-paren">(</span><em class="sig-param">file_o3</em>, <em class="sig-param">new_wvno_grid</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_optical_o3" title="Permalink to this definition">¶</a></dt>
<dd><p>This hacked ozone is from here:
<a class="reference external" href="http://satellite.mpic.de/spectral_atlas/cross_sections/Ozone/O3.spc">http://satellite.mpic.de/spectral_atlas/cross_sections/Ozone/O3.spc</a></p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_original_data">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_original_data</code><span class="sig-paren">(</span><em class="sig-param">original_file</em>, <em class="sig-param">colnames</em>, <em class="sig-param">new_db</em>, <em class="sig-param">overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_original_data" title="Permalink to this definition">¶</a></dt>
<dd><p>The continuum factory takes the CIA opacity file and adds in extra sources of
opacity from other references to fill in empty bands. It assumes that the original file is
structured as following,with the first column wavenumber and the rest molecules:
1000 198
75.
0.0  -33.0000  -33.0000  -33.0000  -33.0000  -33.0000
20.0   -7.4572   -7.4518   -6.8038   -6.0928   -5.9806
40.0   -6.9547   -6.9765   -6.6322   -5.7934   -5.4823
… … … etc</p>
<p>Where 1000 corresponds to the number of wavelengths, 198 corresponds to the number of temperatures
and 75 is the first temperature. If this structure changes, we will need to restructure this top
level __init__ function that reads it in the original opacity file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_file</strong> (<em>str</em>) – Filepath that points to original opacity file (see description above)</p></li>
<li><p><strong>colnames</strong> (<em>list</em>) – defines the sources of opacity in the original file. For the example file above,
colnames would be [‘wno’,’H2H2’,’H2He’,’H2H’,’H2CH4’,’H2N2’]</p></li>
<li><p><strong>new_db</strong> (<em>str</em>) – New database name</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>) – Default is set to False as to not overwrite any existing files. This parameter controls overwriting
cia database</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.h2h2_overtone">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">h2h2_overtone</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.h2h2_overtone" title="Permalink to this definition">¶</a></dt>
<dd><p>Add in special CIA h2h2 band at 0.8 microns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Temperature</p></li>
<li><p><strong>wno</strong> (<em>numpy.array</em>) – wave number</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>H2-H2 absorption in cm-1 amagat-2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.insert">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">insert</code><span class="sig-paren">(</span><em class="sig-param">cur</em>, <em class="sig-param">conn</em>, <em class="sig-param">mol</em>, <em class="sig-param">T</em>, <em class="sig-param">opacity</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.insert" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert into</p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.insert_molecular_1060">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">insert_molecular_1060</code><span class="sig-paren">(</span><em class="sig-param">molecule</em>, <em class="sig-param">min_wavelength</em>, <em class="sig-param">max_wavelength</em>, <em class="sig-param">new_R</em>, <em class="sig-param">og_directory</em>, <em class="sig-param">new_db</em>, <em class="sig-param">dir_kark_ch4=None</em>, <em class="sig-param">dir_optical_o3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.insert_molecular_1060" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to resample 1060 grid data onto lower resolution grid. The general procedure
in this function is to interpolate original 1060 data onto very high resolution
grid (R=1e6). Then, determine number of bins to take given input ‘new_R’. The final
opacity grid will be : original_opacity[::BINS]</p>
<p>NOTE: From several tests “new_R” should be at least 100x higher than the ultimate
planet spectrum you want to bin down to.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>str</em>) – Name of molecule (should match a directory with 1060 files)</p></li>
<li><p><strong>min_wavelength</strong> (<em>float</em>) – Minimum wavelength in database in units of micron</p></li>
<li><p><strong>max_wavelength</strong> (<em>float</em>) – Maximum wavelength in database in units of micron</p></li>
<li><p><strong>new_R</strong> (<em>float</em>) – New R to regrid to. If new_R=None, it will retain the original 1e6 million resolution
of the lbl grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.insert_molecular_1460">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">insert_molecular_1460</code><span class="sig-paren">(</span><em class="sig-param">molecule</em>, <em class="sig-param">min_wavelength</em>, <em class="sig-param">max_wavelength</em>, <em class="sig-param">new_R</em>, <em class="sig-param">og_directory</em>, <em class="sig-param">new_db</em>, <em class="sig-param">dir_kark_ch4=None</em>, <em class="sig-param">dir_optical_o3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.insert_molecular_1460" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to resample Ehsan’s 1460 grid data onto lower resolution grid, 1060 grid. The general procedure
in this function is to interpolate original 1060 data onto very high resolution
grid (R=1e6). Then, determine number of bins to take given input ‘new_R’. The final
opacity grid will be : original_opacity[::BINS]</p>
<p>NOTE: From several tests “new_R” should be at least 100x higher than the ultimate
planet spectrum you want to bin down to.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>str</em>) – Name of molecule (should match a directory with 1060 files)</p></li>
<li><p><strong>min_wavelength</strong> (<em>float</em>) – Minimum wavelength in database in units of micron</p></li>
<li><p><strong>max_wavelength</strong> (<em>float</em>) – Maximum wavelength in database in units of micron</p></li>
<li><p><strong>new_R</strong> (<em>float</em>) – New R to regrid to. If new_R=None, it will retain the original 1e6 million resolution
of the lbl grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.insert_wno_grid">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">insert_wno_grid</code><span class="sig-paren">(</span><em class="sig-param">wno_grid</em>, <em class="sig-param">cur</em>, <em class="sig-param">con</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.insert_wno_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts basics into the header file. This puts all the units to the database.</p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.listdir">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">listdir</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.listdir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.molecular_avail">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">molecular_avail</code><span class="sig-paren">(</span><em class="sig-param">db_file</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.molecular_avail" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.open_local">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">open_local</code><span class="sig-paren">(</span><em class="sig-param">db_f</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.open_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Code needed to open up local database, interpret arrays from bytes and return cursor</p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.restruct_continuum">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">restruct_continuum</code><span class="sig-paren">(</span><em class="sig-param">original_file</em>, <em class="sig-param">colnames</em>, <em class="sig-param">new_wno</em>, <em class="sig-param">new_db</em>, <em class="sig-param">overwrite</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.restruct_continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>The continuum factory takes the CIA opacity file and adds in extra sources of
opacity from other references to fill in empty bands. It assumes that the original file is
structured as following,with the first column wavenumber and the rest molecules:
1000 198
75.
0.0  -33.0000  -33.0000  -33.0000  -33.0000  -33.0000
20.0   -7.4572   -7.4518   -6.8038   -6.0928   -5.9806
40.0   -6.9547   -6.9765   -6.6322   -5.7934   -5.4823
… … … etc</p>
<p>Where 1000 corresponds to the number of wavelengths, 198 corresponds to the number of temperatures
and 75 is the first temperature. If this structure changes, we will need to restructure this top
level __init__ function that reads it in the original opacity file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_file</strong> (<em>str</em>) – Filepath that points to original opacity file (see description above)</p></li>
<li><p><strong>colnames</strong> (<em>list</em>) – defines the sources of opacity in the original file. For the example file above,
colnames would be [‘wno’,’H2H2’,’H2He’,’H2H’,’H2CH4’,’H2N2’]</p></li>
<li><p><strong>new_wno</strong> (<em>numpy.ndarray</em><em>, </em><em>list</em>) – wavenumber grid to interpolate onto (units of inverse cm)</p></li>
<li><p><strong>new_db</strong> (<em>str</em>) – New database name</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>) – Default is set to False as to not overwrite any existing files. This parameter controls overwriting
cia database</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.restructure_opacity">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">restructure_opacity</code><span class="sig-paren">(</span><em class="sig-param">new_db</em>, <em class="sig-param">ntemp</em>, <em class="sig-param">temperatures</em>, <em class="sig-param">molecules</em>, <em class="sig-param">og_opacity</em>, <em class="sig-param">old_wno</em>, <em class="sig-param">new_wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.restructure_opacity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.vectorize_rebin_mean">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">vectorize_rebin_mean</code><span class="sig-paren">(</span><em class="sig-param">bins</em>, <em class="sig-param">Fp</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.vectorize_rebin_mean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.vectorize_rebin_median">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">vectorize_rebin_median</code><span class="sig-paren">(</span><em class="sig-param">bins</em>, <em class="sig-param">Fp</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.vectorize_rebin_median" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.vresample_and_insert_molecular">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">vresample_and_insert_molecular</code><span class="sig-paren">(</span><em class="sig-param">molecule</em>, <em class="sig-param">min_wavelength</em>, <em class="sig-param">max_wavelength</em>, <em class="sig-param">new_R</em>, <em class="sig-param">og_directory</em>, <em class="sig-param">new_db</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.vresample_and_insert_molecular" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is identical to resample_and_insert_molecular but it was
written to determine if taking the median was better than taking every BIN’th
data point. It uses a special  vectorize function to speed up the median.
Results are about the same but this is much slower to run.
So dont bother using this unless there is something specific to try.</p>
</dd></dl>

</div>
<div class="section" id="module-picaso.optics">
<span id="picaso-optics-module"></span><h2>picaso.optics module<a class="headerlink" href="#module-picaso.optics" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="picaso.optics.RetrieveCKs">
<em class="property">class </em><code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">RetrieveCKs</code><span class="sig-paren">(</span><em class="sig-param">ck_dir</em>, <em class="sig-param">cont_dir</em>, <em class="sig-param">wave_range=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This will be the class to retrieve correlated-k tables from the database.
Right now this is in beta mode and is retrieving the direct heritage
196 grid files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ck_dir</strong> (<em>str</em>) – Directory of the pre-mixed correlated k table data. Check that you are pointing to a
directory with the files “ascii_data” and “full_abunds”.</p></li>
<li><p><strong>cont_dir</strong> (<em>str</em>) – This should be in the references directory on Github. This has all the continuum opacity
that you need (e.g. H2H2). It also has some extra cross sections that you may want to add
in like Karkoschka methane and the optical ozone band.</p></li>
<li><p><strong>wave_range</strong> (<em>list</em>) – NOT FUNCTIONAL YET.
Wavelength range to compuate in the format [min micron, max micron]</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="picaso.optics.RetrieveCKs.adapt_array">
<code class="sig-name descname">adapt_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.adapt_array" title="Permalink to this definition">¶</a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.convert_array">
<code class="sig-name descname">convert_array</code><span class="sig-paren">(</span><em class="sig-param">text</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.convert_array" title="Permalink to this definition">¶</a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_available_continuum">
<code class="sig-name descname">get_available_continuum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_available_continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the pressures and temperatures that are available for the continuum and molecules</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_available_rayleigh">
<code class="sig-name descname">get_available_rayleigh</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_available_rayleigh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_continuum">
<code class="sig-name descname">get_continuum</code><span class="sig-paren">(</span><em class="sig-param">atmosphere</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_continuum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_legacy_data">
<code class="sig-name descname">get_legacy_data</code><span class="sig-paren">(</span><em class="sig-param">wave_range</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_legacy_data" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_opacities">
<code class="sig-name descname">get_opacities</code><span class="sig-paren">(</span><em class="sig-param">atmosphere</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_opacities" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_pre_mix_ck">
<code class="sig-name descname">get_pre_mix_ck</code><span class="sig-paren">(</span><em class="sig-param">atmosphere</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_pre_mix_ck" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in atmosphere profile and returns an array which is
nlayer by ngauss by nwno</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.open_local">
<code class="sig-name descname">open_local</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.open_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Code needed to open up local database, interpret arrays from bytes and return cursor</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="picaso.optics.RetrieveOpacities">
<em class="property">class </em><code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">RetrieveOpacities</code><span class="sig-paren">(</span><em class="sig-param">db_filename</em>, <em class="sig-param">raman_data</em>, <em class="sig-param">wave_range=None</em>, <em class="sig-param">location='local'</em>, <em class="sig-param">resample=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This will be the class that will retrieve the opacities from the sqlite3 database. Right
now we are just employing nearest neighbors to grab the respective opacities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_filename</strong> (<em>str</em>) – Opacity file name</p></li>
<li><p><strong>raman_data</strong> (<em>str</em>) – file name of the raman cross section data</p></li>
<li><p><strong>wave_range</strong> (<em>list of float</em>) – Wavelength range (in microns) to run.
Default None grabs all the full wavelength range available</p></li>
<li><p><strong>location</strong> (<em>str</em>) – Default = local. This is the only option currently available since
we dont have AWS or other services enabled.</p></li>
<li><p><strong>resample</strong> (<em>int</em>) – Default =1 (no resampling)</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.raman_db">
<code class="sig-name descname">raman_db</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.raman_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Database of Raman cross sections</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.wno">
<code class="sig-name descname">wno</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.wno" title="Permalink to this definition">¶</a></dt>
<dd><p>Wavenumber grid from opacity database (CGS cm-1)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.wave">
<code class="sig-name descname">wave</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.wave" title="Permalink to this definition">¶</a></dt>
<dd><p>Wavelength grid from opacity database (micron)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.nwno">
<code class="sig-name descname">nwno</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.nwno" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of wavenumber points in the grid</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.cia_temps">
<code class="sig-name descname">cia_temps</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.cia_temps" title="Permalink to this definition">¶</a></dt>
<dd><p>CIA temps available from database</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.molecules">
<code class="sig-name descname">molecules</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>Molecules availalbe from database</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.pt_pairs">
<code class="sig-name descname">pt_pairs</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.pt_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>pressure-temperature pairs available from grid (our grid is usually
computed on a fixed 1060 PT grid)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.molecular_opa">
<code class="sig-name descname">molecular_opa</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.molecular_opa" title="Permalink to this definition">¶</a></dt>
<dd><p>Molecular Opacity dictionary that contains all the queried information necessary
to do calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.continuum_opa">
<code class="sig-name descname">continuum_opa</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.continuum_opa" title="Permalink to this definition">¶</a></dt>
<dd><p>Continuum opacity dictionary that contains all the queried information
necessary for the calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.rayleigh_opa">
<code class="sig-name descname">rayleigh_opa</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.rayleigh_opa" title="Permalink to this definition">¶</a></dt>
<dd><p>Rayleigh opacity dictionary for all the sources we have. This is computed as
cm^2/species when the users runs <cite>opannection</cite>. We technically could just
store this in the DB as well. However, because its so fast, it doesn’t take
a lot of time, and because its non-temperature dependent, we only have to do
it once.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.db_connect">
<code class="sig-name descname">db_connect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.db_connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Inherents functionality of <cite>open_local</cite>. Eventually it will
inherent functionality of “open_non_locals” (e.g. cloud or other sources)</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.open_local">
<code class="sig-name descname">open_local</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.open_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens sqlite3 connection and enables array interpretation from bytes</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.get_available_data">
<code class="sig-name descname">get_available_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_available_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets opacity database attributes such as available T-Ps , availalbe molecules. etc.</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.get_available_rayleigh">
<code class="sig-name descname">get_available_rayleigh</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_available_rayleigh" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets rayleigh cross sections when opannection is opened.</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.get_opacities">
<code class="sig-name descname">get_opacities</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_opacities" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets opacities after user specifies atmospheric profile (e.g. full PT and Composition)</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.adapt_array">
<code class="sig-name descname">adapt_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.adapt_array" title="Permalink to this definition">¶</a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.compute_stellar_shits">
<code class="sig-name descname">compute_stellar_shits</code><span class="sig-paren">(</span><em class="sig-param">wno_star</em>, <em class="sig-param">flux_star</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.compute_stellar_shits" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the hires stellar spectrum and computes Raman shifts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno_star</strong> (<em>array</em>) – hires wavelength grid of the star in wave number</p></li>
<li><p><strong>flux_star</strong> (<em>array</em>) – Flux of the star in whatever units. Doesn’t matter for this since it’s returning a ratio</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of the shifted stellar spec divided by the unshifted stellar spec on the model wave
number grid</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.convert_array">
<code class="sig-name descname">convert_array</code><span class="sig-paren">(</span><em class="sig-param">text</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.convert_array" title="Permalink to this definition">¶</a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">get_available_data</code><span class="sig-paren">(</span><em class="sig-param">wave_range</em>, <em class="sig-param">resample</em><span class="sig-paren">)</span></dt>
<dd><p>Get the pressures and temperatures that are available for the continuum and molecules</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">get_available_rayleigh</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">get_opacities</code><span class="sig-paren">(</span><em class="sig-param">atmosphere</em>, <em class="sig-param">dimension='1d'</em><span class="sig-paren">)</span></dt>
<dd><p>Get’s opacities using the atmosphere class</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">open_local</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Code needed to open up local database, interpret arrays from bytes and return cursor</p>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="picaso.optics.adapt_array">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">adapt_array</code><span class="sig-paren">(</span><em class="sig-param">arr</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.adapt_array" title="Permalink to this definition">¶</a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.bin_star">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">bin_star</code><a class="headerlink" href="#picaso.optics.bin_star" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes average of group of points using uniform tophat</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno_new</strong> (<em>numpy.array</em>) – inverse cm grid to bin to (cm-1)</p></li>
<li><p><strong>wno_old</strong> (<em>numpy.array</em>) – inverse cm grid (old grid)</p></li>
<li><p><strong>Fp</strong> (<em>numpy.array</em>) – transmission spectra, which is on wno grid</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.optics.compute_opacity">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">compute_opacity</code><span class="sig-paren">(</span><em class="sig-param">atmosphere</em>, <em class="sig-param">opacityclass</em>, <em class="sig-param">ngauss=1</em>, <em class="sig-param">stream=2</em>, <em class="sig-param">delta_eddington=True</em>, <em class="sig-param">test_mode=False</em>, <em class="sig-param">raman=0</em>, <em class="sig-param">plot_opacity=False</em>, <em class="sig-param">full_output=False</em>, <em class="sig-param">return_mode=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.compute_opacity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns total optical depth per slab layer including molecular opacity, continuum opacity.
It should automatically select the molecules needed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmosphere</strong> (<em>class ATMSETUP</em>) – This inherets the class from atmsetup.py</p></li>
<li><p><strong>opacityclass</strong> (<em>class opacity</em>) – This inherets the class from optics.py. It is done this way so that the opacity db doesnt have
to be reloaded in a retrieval</p></li>
<li><p><strong>ngauss</strong> (<em>int</em>) – Number of gauss angles if using correlated-k. If using monochromatic opacites,
ngauss should one.</p></li>
<li><p><strong>stream</strong> (<em>int</em>) – Number of streams (only affects detal eddington approximation)</p></li>
<li><p><strong>delta_eddington</strong> (<em>bool</em>) – (Optional) Default=True, With Delta-eddington on, it incorporates the forward peak
contribution by adjusting optical properties such that the fraction of scattered energy
in the forward direction is removed from the scattering parameters</p></li>
<li><p><strong>raman</strong> (<em>int</em>) – (Optional) Default =0 which corresponds to oklopcic+2018 raman scattering cross sections.
Other options include 1 for original pollack approximation for a 6000K blackbody.
And 2 for nothing.</p></li>
<li><p><strong>test_mode</strong> (<em>bool</em>) – (Optional) Default = False to run as normal. This will overwrite the opacities and fix the
delta tau at 0.5.</p></li>
<li><p><strong>full_output</strong> (<em>bool</em>) – (Optional) Default = False. If true, This will add taugas, taucld, tauray to the atmosphere class.
This is done so that the users can debug, plot, etc.</p></li>
<li><p><strong>plot_opacity</strong> (<em>bool</em>) – (Optional) Default = False. If true, Will create a pop up plot of the weighted of each absorber
at the middle layer</p></li>
<li><p><strong>return_mode</strong> (<em>bool</em>) – (Optional) Default = False, If true, will only return matrices for all the weighted opacity
contributions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>DTAU</strong> (<em>ndarray</em>) – This is a matrix with # layer by # wavelength. It is the opacity contained within a layer
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>TAU</strong> (<em>ndarray</em>) – This is a matrix with # level by # wavelength. It is the cumsum of opacity contained
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>WBAR</strong> (<em>ndarray</em>) – This is the single scattering albedo that includes rayleigh, raman and user input scattering sources.
It has dimensions: # layer by # wavelength
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>COSB</strong> (<em>ndarray</em>) – This is the asymettry factor which accounts for rayleigh and user specified values
It has dimensions: # layer by # wavelength
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>ftau_cld</strong> (<em>ndarray</em>) – This is the fraction of cloud opacity relative to the total TAUCLD/(TAUCLD + TAURAY)</p></li>
<li><p><strong>ftau_ray</strong> (<em>ndarray</em>) – This is the fraction of rayleigh opacity relative to the total TAURAY/(TAUCLD + TAURAY)</p></li>
<li><p><strong>GCOS2</strong> (<em>ndarray</em>) – This is used for Cahoy+2010 methodology for accounting for rayleigh scattering. It
replaces the use of the actual rayleigh phase function by just multiplying ftau_ray by 2</p></li>
<li><p><strong>DTAU</strong> (<em>ndarray</em>) – This is a matrix with # layer by # wavelength. It is the opacity contained within a layer
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>TAU</strong> (<em>ndarray</em>) – This is a matrix with # level by # wavelength. It is the cumsum of opacity contained
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>Original, never corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>WBAR</strong> (<em>ndarray</em>) – This is the single scattering albedo that includes rayleigh, raman and user input scattering sources.
It has dimensions: # layer by # wavelength
<strong>Original, never corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>COSB</strong> (<em>ndarray</em>) – This is the asymettry factor which accounts for rayleigh and user specified values
It has dimensions: # layer by # wavelength
<strong>Original, never corrected for with Delta-Eddington.</strong></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This was baselined against jupiter with the old fortran code. It matches 100% for all cases
except for hotter cases where Na &amp; K are present. This differences is not a product of the code
but a product of the different opacities (1060 grid versus old 736 grid)</p>
<div class="admonition-todo admonition" id="id6">
<p class="admonition-title">Todo</p>
<p>Add a better approximation than delta-scale (e.g. M.Marley suggests a paper by Cuzzi that has
a better methodology)</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.compute_raman">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">compute_raman</code><a class="headerlink" href="#picaso.optics.compute_raman" title="Permalink to this definition">¶</a></dt>
<dd><p>The Ramam scattering will alter the rayleigh scattering. The returned value is
modified single scattering albedo.</p>
<p>Cross sectiosn from:
<a class="reference external" href="http://iopscience.iop.org/0004-637X/832/1/30/suppdata/apjaa3ec7t2_mrt.txt">http://iopscience.iop.org/0004-637X/832/1/30/suppdata/apjaa3ec7t2_mrt.txt</a></p>
<p>This method is described in Pollack+1986. Albeit not the best method. Sromovsky+2005
pointed out the inconsistencies in this method. You can see from his comparisons
that the Pollack approximations don’t accurately capture the depths of the line centers.
Since then, OKLOPCIC+2016 recomputed cross sections for J&lt;=9. We are using those cross
sections here with a different star. Huge improvement over what we had before.
Number of J levels is hard coded to 10 !</p>
<p>Will be added to the rayleigh scattering as : TAURAY*RAMAN</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wave points</p></li>
<li><p><strong>nlayer</strong> (<em>int</em>) – Number of layers</p></li>
<li><p><strong>wno</strong> (<em>array</em>) – Array of output grid of wavenumbers</p></li>
<li><p><strong>stellar_shifts</strong> (<em>ndarray</em>) – Array of floats that has dimensions (n wave pts x n J levels: 0-9)</p></li>
<li><p><strong>tlayer</strong> (<em>array</em>) – Array of floats that has dimensions nlayer</p></li>
<li><p><strong>cross_sections</strong> (<em>ndarray</em>) – The row of “C’s” from Antonija’s table.</p></li>
<li><p><strong>j_initial</strong> (<em>ndarray</em>) – The row of initial rotational energy states from Antonija’s table</p></li>
<li><p><strong>deltanu</strong> (<em>ndarray</em>) – The row of delta nu’s from Antonia’s table</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.optics.convert_array">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">convert_array</code><span class="sig-paren">(</span><em class="sig-param">clas</em>, <em class="sig-param">text</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.convert_array" title="Permalink to this definition">¶</a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.find_nearest">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">find_nearest</code><a class="headerlink" href="#picaso.optics.find_nearest" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="picaso.optics.j_fraction">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">j_fraction</code><a class="headerlink" href="#picaso.optics.j_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>This computes the fraction of molecules at each J level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>j</strong> (<em>int</em>) – The initial rotational levels ranging from J=0 to 9 for hydrogen only</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>f_J in eqn. 3 https</strong></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>//arxiv.org/pdf/1605.07185.pdf</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.numba_cumsum">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">numba_cumsum</code><a class="headerlink" href="#picaso.optics.numba_cumsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute cumsum along axis=0 to bypass numba not allowing kwargs in
cumsum</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.partition_function">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">partition_function</code><a class="headerlink" href="#picaso.optics.partition_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Given j and T computes partition function for ro-vibrational levels of H2.
This is the exponential and the statistical weight g_J in
Eqn 3 in <a class="reference external" href="https://arxiv.org/pdf/1605.07185.pdf">https://arxiv.org/pdf/1605.07185.pdf</a>
It is also used to compute the partition sum Z.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>j</strong> (<em>int</em>) – Energy level</p></li>
<li><p><strong>T</strong> (<em>array float</em>) – Temperature at each atmospheric layer in the atmosphere</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Returns partition function</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.partition_sum">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">partition_sum</code><a class="headerlink" href="#picaso.optics.partition_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the total partition sum. I am truncating it at 20 since it seems to approach 1 around then.
This is also pretty fast to compute so 20 is fine for now.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>T</strong> (<em>array</em>) – Array of temperatures for each layer</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Z, the partition sum</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.optics.raman_pollack">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">raman_pollack</code><span class="sig-paren">(</span><em class="sig-param">nlayer</em>, <em class="sig-param">wave</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.raman_pollack" title="Permalink to this definition">¶</a></dt>
<dd><p>Mystery raman scattering. Couldn’t figure out where it came from.. so discontinuing.
Currently function doesnt’ totally work. In half fortran-half python. Legacy from
fortran albedo code.</p>
<p>This method is described in Pollack+1986. Albeit not the best method. Sromovsky+2005
pointed out the inconsistencies in this method. You can see from his comparisons
that the Pollack approximations don’t accurately capture the depths of the line centers.
Since then, OKLOPCIC+2016 did a much
better model of raman scattring (with ghost lines). Might be worth it to consider a more
sophisticated version of Raman scattering.</p>
<p>Will be added to the rayleigh scattering as : TAURAY*RAMAN</p>
<p>#OLD FORTRAN CODE
#constants
h = 6.6252e-27
c = 2.9978e10
bohrd = 5.2917e-9
hmass = 1.6734e-24
rmu = .5 * hmass</p>
<p>#set wavelength shift of the ramam scatterer
shift_v0 = 4161.0</p>
<p>facip = h * c / ( 1.e-4 * 27.2 * 1.602e-12 )
facray = 1.e16 * bohrd ** 3 * 128. * np.pi ** 5 * bohrd ** 3 / 9.
facv = 2.08 / 2.38 * facray / bohrd ** 2 / ( 8. * np.pi * np.pi * rmu * c * shift_v0 ) * h</p>
<p>#cross section of the unshifted rayleigh and the vibrationally shifted rayleigh
gli = np.zeros(5)
wli = np.zeros(5)
gri = np.zeros(5)
wri = np.zeros(5)
gli[:] = [1.296, .247, .297,  .157,  .003]
wli[:] = [.507, .628, .733, 1.175, 2.526]
gri[:] = [.913, .239, .440,  .344,  .064]
wri[:] = [.537, .639, .789, 1.304, 3.263]</p>
<p>alp = np.zeros(7)
arp = np.zeros(7)
alp[:] = [6.84, 6.96, 7.33, 8.02, 9.18, 11.1, 14.5 ]
arp[:] = [3.66, 3.71, 3.88, 4.19, 4.70, 5.52, 6.88 ]</p>
<p>omega = facip / wavelength</p>
<p>#first compute extinction cross section for unshifted component
#e.g. rayleigh
alpha_l=0
alpha_r=0</p>
<dl class="simple">
<dt>for i in range(5):</dt><dd><p>alpha_l += gli[i] / ( wli[i] ** 2 - omega ** 2 )
alpha_r += gri[i] / ( wri[i] ** 2 - omega ** 2 )</p>
</dd>
</dl>
<p>alpha2 = (( 2. * alpha_r + alpha_l ) / 3. ) ** 2
gamma2 = ( alpha_l - alpha_r ) ** 2
qray = facray * ( 3. * alpha2 + 2./3. * gamma2 ) / wavelength ** 4</p>
<p>#next, compute the extinction cross section for vibrationally
#shifted component
ip = np.zeros(2)
ip[:] = [int(omega/0.05), 5.0]
ip = np.min(ip) + 1
f = omega / 0.05 - float(ip-1)
alpha_pl = ( 1. - f ) * alp[ip] + f * alp[ip+1]
alpha_pr = ( 1. - f ) * arp[ip] + f * arp[ip+1]
alpha_p2 = (( 2. * alpha_pr + alpha_pl ) / 3. ) ** 2
gamma_p2 = ( alpha_pl - alpha_pr ) ** 2
qv = facv / SHIFT( WAVEL, -SHIFTV0 ) ** 4 * ( 3. * alpha_p2 + 2./3. * gamma_p2 )</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.rayleigh_old">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">rayleigh_old</code><a class="headerlink" href="#picaso.optics.rayleigh_old" title="Permalink to this definition">¶</a></dt>
<dd><p>DISCONTINUED
Rayleigh function taken from old albedo code. Keeping this modular, as we may want
to swap out different methods to calculate rayleigh opacity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>colden</strong> (<em>array of float</em>) – Column Density in CGS units</p></li>
<li><p><strong>mixingratios</strong> (<em>array of float</em>) – Mixing ratio as function of altitude for [H2  He CH4 ]</p></li>
<li><p><strong>wave</strong> (<em>array of float</em>) – wavelength (microns) of grid. This should be in DECENDING order to comply with
everything else being in wave numberes</p></li>
<li><p><strong>xmu</strong> (<em>array of float</em>) – mean molecular weight of atmosphere in amu</p></li>
<li><p><strong>amu</strong> (<em>float</em>) – amu constant in grams</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="picaso-test-module">
<h2>picaso.test module<a class="headerlink" href="#picaso-test-module" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-picaso.wavelength">
<span id="picaso-wavelength-module"></span><h2>picaso.wavelength module<a class="headerlink" href="#module-picaso.wavelength" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.wavelength.get_cld_input_grid">
<code class="sig-prename descclassname">picaso.wavelength.</code><code class="sig-name descname">get_cld_input_grid</code><span class="sig-paren">(</span><em class="sig-param">filename_or_grid='wave_EGP.dat'</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.wavelength.get_cld_input_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>The albedo code relies on the cloud code input, which is traditionally on a 196 wavelength grid.
This method is to retrieve that grid. This file should be kept in the package reference data. Alternatively,
it might be useful to add it directly to the input.cld file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename_or_grid</strong> (<em>str</em><em> or </em><em>ndarray</em>) – filename of the input grid OR a numpy array of wavenumber corresponding to cloud
input</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of wave numbers in increasing order</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.wavelength.regrid">
<code class="sig-prename descclassname">picaso.wavelength.</code><code class="sig-name descname">regrid</code><span class="sig-paren">(</span><em class="sig-param">matrix</em>, <em class="sig-param">old_wno</em>, <em class="sig-param">new_wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.wavelength.regrid" title="Permalink to this definition">¶</a></dt>
<dd><p>This takes in a matrix that is (number of something versus number of wavelength points) and regrids
to a new wave grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> (<em>ndarray</em>) – matrix that is (number of something versus number of wavelength points)</p></li>
<li><p><strong>old_wno</strong> (<em>array</em>) – array that represents the old wavelength grid of the matrix</p></li>
<li><p><strong>new_wno</strong> (<em>array</em>) – array that represents the desired wavelength grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matrix that has been reinterpolated to new wave number grid</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matrix</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-picaso" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="contribution.html" class="btn btn-neutral float-right" title="Contributing to PICASO" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="notebooks/FAQs.html" class="btn btn-neutral float-left" title="FAQs" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>