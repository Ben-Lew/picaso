

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Code &mdash; picaso 3.0 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script type="text/javascript" src="_static/jquery.js"></script>
        <script type="text/javascript" src="_static/underscore.js"></script>
        <script type="text/javascript" src="_static/doctools.js"></script>
        <script type="text/javascript" src="_static/language_data.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script async="async" type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true, "ignoreClass": "document", "processClass": "math|output_area"}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Contributing to PICASO" href="contribution.html" />
    <link rel="prev" title="What do I reference?" href="notebooks/References.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> picaso
          

          
          </a>

          
            
            
              <div class="version">
                3.0
              </div>
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="tutorials.html">The Tutorials</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">The Code</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#submodules">Submodules</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.atmsetup">picaso.atmsetup module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.build_3d_input">picaso.build_3d_input module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.disco">picaso.disco module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.elements">picaso.elements module</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#requirements">Requirements</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.fluxes">picaso.fluxes module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.io_utils">picaso.io_utils module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.justdoit">picaso.justdoit module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.justplotit">picaso.justplotit module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.opacity_factory">picaso.opacity_factory module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.optics">picaso.optics module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.test">picaso.test module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso.wavelength">picaso.wavelength module</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-picaso">Module contents</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="contribution.html">Contributing</a></li>
<li class="toctree-l1"><a class="reference internal" href="workshops.html">Workshop Material</a></li>
<li class="toctree-l1"><a class="reference external" href="https://natashabatalha.github.io/picaso_dev">The Derivations</a></li>
<li class="toctree-l1"><a class="reference external" href="https://github.com/natashabatalha/picaso">Github</a></li>
<li class="toctree-l1"><a class="reference internal" href="credit.html">The Papers</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">picaso</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>The Code</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/picaso.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="the-code">
<h1>The Code<a class="headerlink" href="#the-code" title="Permalink to this headline">¶</a></h1>
<div class="section" id="submodules">
<h2>Submodules<a class="headerlink" href="#submodules" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-picaso.atmsetup">
<span id="picaso-atmsetup-module"></span><h2>picaso.atmsetup module<a class="headerlink" href="#module-picaso.atmsetup" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="picaso.atmsetup.ATMSETUP">
<em class="property">class </em><code class="sig-prename descclassname">picaso.atmsetup.</code><code class="sig-name descname">ATMSETUP</code><span class="sig-paren">(</span><em class="sig-param">config</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Reads in default source configuration from JSON and creates a full atmosphere class.</p>
<ul class="simple">
<li><p>Gets PT profile</p></li>
<li><p>Computes mean molecular weight, density, column density, mixing ratios</p></li>
<li><p>Gets cloud profile</p></li>
<li><p>Gets stellar profile</p></li>
</ul>
<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.add_warnings">
<code class="sig-name descname">add_warnings</code><span class="sig-paren">(</span><em class="sig-param">warn</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.add_warnings" title="Permalink to this definition">¶</a></dt>
<dd><p>Accumulate warnings from ATMSETUP</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.as_dict">
<code class="sig-name descname">as_dict</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.as_dict" title="Permalink to this definition">¶</a></dt>
<dd><p>Get output into picklable dict format</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.calc_PT">
<code class="sig-name descname">calc_PT</code><span class="sig-paren">(</span><em class="sig-param">logPc</em>, <em class="sig-param">T</em>, <em class="sig-param">logKir</em>, <em class="sig-param">logg1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.calc_PT" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates parameterized PT profile from Guillot. This isntance is here
primary for the retrieval scheme, so this can be updated</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>T</strong> (<em>float</em>) – </p></li>
<li><p><strong>logKir</strong> (<em>float</em>) – </p></li>
<li><p><strong>logg1</strong> (<em>float</em>) – </p></li>
<li><p><strong>logPc</strong> (<em>float</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.disect">
<code class="sig-name descname">disect</code><span class="sig-paren">(</span><em class="sig-param">g</em>, <em class="sig-param">t</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.disect" title="Permalink to this definition">¶</a></dt>
<dd><p>This disects the 3d input to a 1d input which is a function of a single gangle and tangle.
This makes it possible for us to get the opacities at each facet before we go into the
flux calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g</strong> (<em>int</em>) – Gauss angle index</p></li>
<li><p><strong>t</strong> (<em>int</em>) – Tchebyshev angle index</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_altitude">
<code class="sig-name descname">get_altitude</code><span class="sig-paren">(</span><em class="sig-param">p_reference=1</em>, <em class="sig-param">constant_gravity=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_altitude" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates z and gravity</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>p_reference</strong> (<em>float</em>) – Reference pressure for radius. (bars)</p></li>
<li><p><strong>constant_gravity</strong> (<em>bool</em>) – creates zero altitude dependence in the height</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_clouds">
<code class="sig-name descname">get_clouds</code><span class="sig-paren">(</span><em class="sig-param">wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_clouds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get cloud properties from .cld input returned from eddysed. The eddysed file should have the following specifications</p>
<ol class="arabic simple">
<li><p>Have the following column names (any order)  opd g0 w0</p></li>
<li><p>Be white space delimeted</p></li>
<li><p>Has to have values for pressure levels (N) and wwavenumbers (M). The row order should go:</p></li>
</ol>
<p>level wavenumber opd w0 g0
1.   1.   … . .
1.   2.   … . .
1.   3.   … . .
.     . … . .
.     . … . .
1.   M.   … . .
2.   1.   … . .
.     . … . .
N.   .  … . .</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The order of the rows is very important because each column will be transformed
into a matrix that has the size: [nlayer,nwave].</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wno</strong> (<em>array</em>) – Array in ascending order of wavenumbers. This is used to regrid the cloud output</p>
</dd>
</dl>
<div class="admonition-todo admonition" id="id1">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Take regridding out of here and add it to <cite>justdoit</cite></p></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_column_density">
<code class="sig-name descname">get_column_density</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_column_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates the column desntiy based on TP profile: LAYER</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_constants">
<code class="sig-name descname">get_constants</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_constants" title="Permalink to this definition">¶</a></dt>
<dd><p>This function gets all conversion factors based on input units and all
constants. Goal here is to get everything to cgs and make sure we are only
call lengths of things once (e.g. number of wavelength points, number of layers etc)</p>
<p>Some stuff will be added to this in other routines (e.g. number of layers)</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_density">
<code class="sig-name descname">get_density</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_density" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates density of atmospheres used on TP profile: LEVEL</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_mmw">
<code class="sig-name descname">get_mmw</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_mmw" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the mean molecular weight of the atmosphere</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_needed_continuum">
<code class="sig-name descname">get_needed_continuum</code><span class="sig-paren">(</span><em class="sig-param">available_ray_mol</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_needed_continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>This will define which molecules are needed for the continuum opacities. THis is based on
temperature and molecules. Eventually CIA’s will expand but we may not necessarily
want all of them.
‘wno’,’h2h2’,’h2he’,’h2h’,’h2ch4’,’h2n2’]</p>
<div class="admonition-todo admonition" id="id2">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Add in temperature dependent to negate h- and things when not necessary</p></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_profile">
<code class="sig-name descname">get_profile</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Get profile from file or from user input file or direct pandas dataframe. If PT profile
is not given, use parameterization</p>
<p>Currently only needs inputs from config file</p>
<div class="admonition-todo admonition" id="id3">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Add regridding to this by having users be able to set a different nlevel than the input cloud code is</p></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_profile_3d">
<code class="sig-name descname">get_profile_3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_profile_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Get profile from file or from user input file or direct pandas dataframe. If PT profile
is not given, use parameterization</p>
<p>Currently only needs inputs from config file</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lat</strong> (<em>array</em>) – Array of latitudes (radians)</p></li>
<li><p><strong>lon</strong> (<em>array</em>) – Array of longitudes (radians)</p></li>
</ul>
</dd>
</dl>
<div class="admonition-todo admonition" id="id4">
<p class="admonition-title">Todo</p>
<ul class="simple">
<li><p>Add regridding to this by having users be able to set a different nlevel than the input cloud code is</p></li>
</ul>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_surf_reflect">
<code class="sig-name descname">get_surf_reflect</code><span class="sig-paren">(</span><em class="sig-param">nwno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_surf_reflect" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets the surface reflectivity from input</p>
</dd></dl>

<dl class="method">
<dt id="picaso.atmsetup.ATMSETUP.get_weights">
<code class="sig-name descname">get_weights</code><span class="sig-paren">(</span><em class="sig-param">molecule</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.atmsetup.ATMSETUP.get_weights" title="Permalink to this definition">¶</a></dt>
<dd><p>Automatically gets mean molecular weights of any molecule. Requires that
user inputs case sensitive molecules i.e. TiO instead of TIO.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>molecule</strong> (<em>str</em><em> or </em><em>list</em>) – any molecule string e.g. “H2O”, “CH4” etc “TiO” or [“H2O”, ‘CH4’]</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>molecule as keys with molecular weights as value</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-picaso.build_3d_input">
<span id="picaso-build-3d-input-module"></span><h2>picaso.build_3d_input module<a class="headerlink" href="#module-picaso.build_3d_input" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.build_3d_input.lon_lat_to_cartesian">
<code class="sig-prename descclassname">picaso.build_3d_input.</code><code class="sig-name descname">lon_lat_to_cartesian</code><span class="sig-paren">(</span><em class="sig-param">lon</em>, <em class="sig-param">lat</em>, <em class="sig-param">R=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.lon_lat_to_cartesian" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculates lon, lat coordinates of a point on a sphere with
radius R</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>lon</strong> (<em>array</em>) – Longitude</p></li>
<li><p><strong>lat</strong> (<em>array</em>) – Latitude</p></li>
<li><p><strong>R</strong> (<em>float</em>) – radius of sphere</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>x, y, z</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.build_3d_input.make_3d_cld_input">
<code class="sig-prename descclassname">picaso.build_3d_input.</code><code class="sig-name descname">make_3d_cld_input</code><span class="sig-paren">(</span><em class="sig-param">ng</em>, <em class="sig-param">nt</em>, <em class="sig-param">phase_angle</em>, <em class="sig-param">input_file</em>, <em class="sig-param">output_file</em>, <em class="sig-param">lat_range=None</em>, <em class="sig-param">lon_range=None</em>, <em class="sig-param">rand_coverage=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.make_3d_cld_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Discontinued
Program to create 3d CLOUD input. Used to feed GCM input into disco ball.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ng</strong> (<em>int</em>) – Number of gauss angles</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – Number of Tchebysehv angles</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>) – Geometry of phase angle</p></li>
<li><p><strong>input_file</strong> (<em>str</em>) – CLD input file you want to create the 3d grid from. Currently takes in a single 1d CLD profile.
Input file must be structured with the following columns in the correct order: [‘lvl’, ‘wv’,’opd’,’g0’,’w0’,’sigma’]
input file</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – Output file location</p></li>
<li><p><strong>lat_range</strong> (<em>list</em>) – (Optional)Range of latitudes to exclude in the CLD file</p></li>
<li><p><strong>lon_range</strong> (<em>list</em>) – (Optional)Range of longitudes to exclud in the CLD file</p></li>
<li><p><strong>rand_coverage</strong> (<em>float</em>) – (Optional)Fractional cloud coverage. rand_cov=1 introduces full cloud coverage. rand_cov=0 has no
coverage.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Key word arguments used for <cite>panads.read_csv</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Creates output file. No other returns.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Basic use of creating a 3D file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phase_angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_gauss_angles</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_tcheby_angles</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phase_angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_file</span><span class="o">=</span><span class="n">jdi</span><span class="o">.</span><span class="n">jupiter_cld</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;jupiter3D.hdf5&#39;</span>
<span class="go">&gt;&gt;&gt;make_3d_pt_input(number_gauss_angles, number_tcheby_angles,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">phase_angle</span><span class="p">,</span> <span class="n">input_file</span><span class="p">,</span><span class="n">output_file</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="function">
<dt id="picaso.build_3d_input.make_3d_pt_input">
<code class="sig-prename descclassname">picaso.build_3d_input.</code><code class="sig-name descname">make_3d_pt_input</code><span class="sig-paren">(</span><em class="sig-param">ng</em>, <em class="sig-param">nt</em>, <em class="sig-param">phase_angle</em>, <em class="sig-param">input_file</em>, <em class="sig-param">output_file</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.make_3d_pt_input" title="Permalink to this definition">¶</a></dt>
<dd><p>Discontinued
Program to create 3d PT input. Used to feed GCM input into disco ball.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ng</strong> (<em>int</em>) – Number of gauss angles</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – Number of Tchebysehv angles</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>) – Geometry of phase angle</p></li>
<li><p><strong>input_file</strong> (<em>str</em>) – PT input file you want to create the 3d grid from. Currently takes in a single 1d PT profile.
Must have labeled, whitespace delimeted columns. In the columns, must have <cite>temperature</cite>,
<cite>pressure</cite>, and at least some molecular species (which are ALL case-sensitive)</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – Output file location</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Creates output file. No other returns.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Basic use of creating a 3D file:</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">phase_angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_gauss_angles</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">number_tcheby_angles</span> <span class="o">=</span> <span class="mi">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">phase_angle</span> <span class="o">=</span> <span class="mi">0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_file</span><span class="o">=</span><span class="n">jdi</span><span class="o">.</span><span class="n">jupiter_pt</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output_file</span><span class="o">=</span><span class="s1">&#39;jupiter3D.hdf5&#39;</span>
<span class="go">&gt;&gt;&gt;make_3d_pt_input(number_gauss_angles, number_tcheby_angles,</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">phase_angle</span><span class="p">,</span> <span class="n">input_file</span><span class="p">,</span><span class="n">output_file</span><span class="p">)</span>
</pre></div>
</div>
<p>Can also use <cite>**kwargs</cite> to control how pandas reads in input file</p>
<p>&gt;&gt;&gt;make_3d_pt_input(number_gauss_angles, number_tcheby_angles,
&gt;&gt;&gt;         phase_angle, input_file,output_file,usecols=[1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,20,21])</p>
</dd></dl>

<dl class="function">
<dt id="picaso.build_3d_input.rebin_mitgcm_cld">
<code class="sig-prename descclassname">picaso.build_3d_input.</code><code class="sig-name descname">rebin_mitgcm_cld</code><span class="sig-paren">(</span><em class="sig-param">ng, nt, phase_angle, input_file, output_file, names=['i', 'j', 'opd', 'g0', 'w0']</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.rebin_mitgcm_cld" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebin post processed GCM cloud grid to a smaller grid. This function creates a pickle file
that can be directly input into <cite>clouds_3d</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ng</strong> (<em>int</em>) – Number of gauss angles</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – Number of Tchebysehv angles</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>) – Geometry of phase angle (radians)</p></li>
<li><p><strong>input_file</strong> (<em>str</em>) – PT input file you want to create the 3d grid from. Currently takes in a single 1d PT profile.
Must have labeled, whitespace delimeted columns. In the columns, must have <cite>temperature</cite>,
<cite>pressure</cite>, and at least some molecular species (which are ALL case-sensitive)</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – output file location</p></li>
<li><p><strong>names</strong> (<em>list</em><em>,</em><em>str</em><em>,</em><em>optional</em>) – List of names for the post processed file. The Default value is what generallly
comes out of A&amp;M code.. But double check before running!!</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.build_3d_input.rebin_mitgcm_pt">
<code class="sig-prename descclassname">picaso.build_3d_input.</code><code class="sig-name descname">rebin_mitgcm_pt</code><span class="sig-paren">(</span><em class="sig-param">ng</em>, <em class="sig-param">nt</em>, <em class="sig-param">phase_angle</em>, <em class="sig-param">input_file</em>, <em class="sig-param">output_file</em>, <em class="sig-param">p_unit='Pa'</em>, <em class="sig-param">kzz_unit='m*m/s'</em>, <em class="sig-param">run_chem=False</em>, <em class="sig-param">MH=None</em>, <em class="sig-param">CtoO=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.rebin_mitgcm_pt" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebin GCM grid to a smaller grid. This function creates a pickle file
that can be directly input into <cite>atmosphere_3d</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ng</strong> (<em>int</em>) – Number of gauss angles</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – Number of Tchebysehv angles</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>) – Geometry of phase angle (radians)</p></li>
<li><p><strong>input_file</strong> (<em>str</em>) – PT input file you want to create the 3d grid from. Currently takes in a single 1d PT profile.
Must have labeled, whitespace delimeted columns. In the columns, must have <cite>temperature</cite>,
<cite>pressure</cite>, and at least some molecular species (which are ALL case-sensitive)</p></li>
<li><p><strong>output_file</strong> (<em>str</em>) – output file location</p></li>
<li><p><strong>p_unit</strong> (<em>str</em><em>,</em><em>optional</em>) – Pressure Unit (default Pascal)</p></li>
<li><p><strong>kzz_unit</strong> (<em>str</em><em>,</em><em>optional</em>) – Kzz Unit (default is m*m/s)</p></li>
<li><p><strong>run_chem</strong> (<em>bool</em><em> , </em><em>optional</em>) – (Optional) runs chemistry and adds to json file</p></li>
<li><p><strong>run_chem</strong> – (Optional) MIT gcm output doesn’t usually come with chemistry in the files
If this is the case then you can post process chemistry by setting this to True.</p></li>
<li><p><strong>MH</strong> (<em>float</em><em> , </em><em>optional</em>) – (Optional) This is only used if run_chem is set to True. It is the Metallicity of
the planet in NON log units. MH = 1 is solar.</p></li>
<li><p><strong>CtoO</strong> (<em>float</em><em> , </em><em>optional</em>) – (Optional) This is the C/O ratio of the planet also in NON log units.
CtoO = 0.55 is solar.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.build_3d_input.regrid_xarray">
<code class="sig-prename descclassname">picaso.build_3d_input.</code><code class="sig-name descname">regrid_xarray</code><span class="sig-paren">(</span><em class="sig-param">xarray_original</em>, <em class="sig-param">num_gangle=None</em>, <em class="sig-param">num_tangle=None</em>, <em class="sig-param">phase_angle=None</em>, <em class="sig-param">latitude=None</em>, <em class="sig-param">longitude=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.regrid_xarray" title="Permalink to this definition">¶</a></dt>
<dd><p>This regrid functionality uses the xarray and xesmf method. It requires to additional
packages that are not required by the rest of PICASO (xesmf). See
tutorial for additional tips on how to structure your xarray input.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xarray_original</strong> (<em>xarray</em>) – xarray of all 3d input you would like regridded</p></li>
<li><p><strong>num_gangle</strong> (<em>int</em>) – Number of gauss angles (not needed if directly supply lat and lons)</p></li>
<li><p><strong>num_tangle</strong> (<em>int</em>) – Number of cheychev angles (not needed if directly supply lat and lons)</p></li>
<li><p><strong>phase_angle</strong> (<em>int</em>) – Radians phase angle (not needed if directly supply lat and lons)</p></li>
<li><p><strong>latitude</strong> (<em>array</em>) – array of latitudes in degrees (not needed if supplied num_gangle, num_tangle, phase_angle)</p></li>
<li><p><strong>longitude</strong> (<em>array</em>) – array of longitudes in degrees (not needed if supplied num_gangle, num_tangle, phase_angle)</p></li>
<li><p><strong>Output</strong> – </p></li>
<li><p><strong>------</strong> – Dictionary of regridded data and new latitude longitude grid</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.build_3d_input.variable_pressure_example">
<code class="sig-prename descclassname">picaso.build_3d_input.</code><code class="sig-name descname">variable_pressure_example</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.build_3d_input.variable_pressure_example" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-picaso.disco">
<span id="picaso-disco-module"></span><h2>picaso.disco module<a class="headerlink" href="#module-picaso.disco" title="Permalink to this headline">¶</a></h2>
<dl class="attribute">
<dt id="picaso.disco.compress_disco">
<code class="sig-prename descclassname">picaso.disco.</code><code class="sig-name descname">compress_disco</code><a class="headerlink" href="#picaso.disco.compress_disco" title="Permalink to this definition">¶</a></dt>
<dd><p>Last step in albedo code. Integrates over phase angle based on the
Gaussian-Chebychev weights in geometry.json</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumbers</p></li>
<li><p><strong>cos_theta</strong> (<em>float</em>) – Cosine of phase angle</p></li>
<li><p><strong>xint_at_top</strong> (<em>ndarray of floats</em>) – Planetary intensity at the top of the atmosphere with dimensions (ng, nt, nwno)</p></li>
<li><p><strong>gweight</strong> (<em>ndarray of floats</em>) – Gaussian weights for integration</p></li>
<li><p><strong>tweight</strong> (<em>ndarray of floats</em>) – Chebychev weights for integration</p></li>
<li><p><strong>F0PI</strong> (<em>ndarray of floats</em>) – Stellar flux</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.disco.compress_thermal">
<code class="sig-prename descclassname">picaso.disco.</code><code class="sig-name descname">compress_thermal</code><a class="headerlink" href="#picaso.disco.compress_thermal" title="Permalink to this definition">¶</a></dt>
<dd><p>Last step in albedo code. Integrates over phase angle based on the
Gaussian-Chebychev weights in disco.get_angles_1d or 3d</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumbers</p></li>
<li><p><strong>flux_at_top</strong> (<em>ndarray of floats</em>) – Thermal Flux at the top of the atmosphere with dimensions (ng, nt, nwno)
or could also be (ng,nt,nlayer,nwno)</p></li>
<li><p><strong>gweight</strong> (<em>ndarray of floats</em>) – Gaussian weights for integration</p></li>
<li><p><strong>tweight</strong> (<em>ndarray of floats</em>) – Chebychev weights for integration</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.disco.compute_disco">
<code class="sig-prename descclassname">picaso.disco.</code><code class="sig-name descname">compute_disco</code><a class="headerlink" href="#picaso.disco.compute_disco" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes ubar0, the incident angle, and ubar1, the outgoing angle from the
chebyshev angles in geometry.json</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ng</strong> (<em>int</em>) – Number of gauss angles</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – Number of tchebyshev angles</p></li>
<li><p><strong>gangle</strong> (<em>float</em>) – Gaussian Angles</p></li>
<li><p><strong>tangle</strong> (<em>float</em>) – Chevychev Angles</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>) – Planetary phase angle</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>ubar0</em> – the incident angles</p></li>
<li><p><em>ubar1</em> – the outgoing angles</p></li>
<li><p><em>cos_theta</em> – Cosine of the phase angle</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.disco.get_angles_1d">
<code class="sig-prename descclassname">picaso.disco.</code><code class="sig-name descname">get_angles_1d</code><span class="sig-paren">(</span><em class="sig-param">ngauss</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.disco.get_angles_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes integration over half sphere. ngauss=5 is 5 angles over half a
sphere.</p>
<p>These are taken from :
Abramowitz and Stegun Table 25.8
<a class="reference external" href="https://books.google.com/books?id=32HJ1orVXDEC&amp;pg=PA876&amp;lpg=PA876&amp;dq=Abramowitz+and+Stegun+Table+25.8&amp;source=bl&amp;ots=_eKu6k5SG8&amp;sig=ACfU3U0_piSAi8aDHOVd0itf_QSAFxcFLQ&amp;hl=en&amp;sa=X&amp;ved=2ahUKEwj5neLR2fDoAhXemHIEHUSVCjEQ6AEwD3oECAwQKQ#v=onepage&amp;q=Abramowitz%20and%20Stegun%20Table%2025.8&amp;f=false">https://books.google.com/books?id=32HJ1orVXDEC&amp;pg=PA876&amp;lpg=PA876&amp;dq=Abramowitz+and+Stegun+Table+25.8&amp;source=bl&amp;ots=_eKu6k5SG8&amp;sig=ACfU3U0_piSAi8aDHOVd0itf_QSAFxcFLQ&amp;hl=en&amp;sa=X&amp;ved=2ahUKEwj5neLR2fDoAhXemHIEHUSVCjEQ6AEwD3oECAwQKQ#v=onepage&amp;q=Abramowitz%20and%20Stegun%20Table%2025.8&amp;f=false</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ngauss</strong> (<em>int</em>) – Can only be 5, 6, 7, 8</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.disco.get_angles_3d">
<code class="sig-prename descclassname">picaso.disco.</code><code class="sig-name descname">get_angles_3d</code><span class="sig-paren">(</span><em class="sig-param">num_gangle</em>, <em class="sig-param">num_tangle</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.disco.get_angles_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes angles for full disco ball</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_gangles</strong> (<em>int</em>) – Number of Gauss angles</p></li>
<li><p><strong>num_tangles</strong> (<em>int</em>) – Number of Tchebychev angles desired</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gauss Angles,Gauss Weights,Tchebyshev Angles,Tchebyshev weights</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>np.ndarray, np.ndarray, np.ndarray, np.ndarray</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso.elements">
<span id="picaso-elements-module"></span><h2>picaso.elements module<a class="headerlink" href="#module-picaso.elements" title="Permalink to this headline">¶</a></h2>
<p>Properties of the chemical elements.</p>
<p>Each chemical element is represented as an object instance. Physicochemical
and descriptive properties of the elements are stored as instance attributes.</p>
<dl class="field-list simple">
<dt class="field-odd">Author</dt>
<dd class="field-odd"><p><a class="reference external" href="http://www.lfd.uci.edu/~gohlke/">Christoph Gohlke</a></p>
</dd>
<dt class="field-even">Version</dt>
<dd class="field-even"><p>2015.01.29</p>
</dd>
</dl>
<div class="section" id="requirements">
<h3>Requirements<a class="headerlink" href="#requirements" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p><a class="reference external" href="http://www.python.org">CPython 2.7 or 3.4</a></p></li>
</ul>
<p class="rubric">References</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="http://physics.nist.gov/PhysRefData/Compositions/">http://physics.nist.gov/PhysRefData/Compositions/</a></p></li>
<li><p><a class="reference external" href="http://physics.nist.gov/PhysRefData/IonEnergy/tblNew.html">http://physics.nist.gov/PhysRefData/IonEnergy/tblNew.html</a></p></li>
<li><p><a class="reference external" href="http://en.wikipedia.org/wiki/%(element.name)s">http://en.wikipedia.org/wiki/%(element.name)s</a></p></li>
<li><p><a class="reference external" href="http://www.miranda.org/~jkominek/elements/elements.db">http://www.miranda.org/~jkominek/elements/elements.db</a></p></li>
</ol>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">elements</span> <span class="kn">import</span> <span class="n">ELEMENTS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">len</span><span class="p">(</span><span class="n">ELEMENTS</span><span class="p">)</span>
<span class="go">109</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">str</span><span class="p">(</span><span class="n">ELEMENTS</span><span class="p">[</span><span class="mi">109</span><span class="p">])</span>
<span class="go">&#39;Meitnerium&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ele</span> <span class="o">=</span> <span class="n">ELEMENTS</span><span class="p">[</span><span class="s1">&#39;C&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ele</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">ele</span><span class="o">.</span><span class="n">symbol</span><span class="p">,</span> <span class="n">ele</span><span class="o">.</span><span class="n">name</span><span class="p">,</span> <span class="n">ele</span><span class="o">.</span><span class="n">eleconfig</span>
<span class="go">(6, &#39;C&#39;, &#39;Carbon&#39;, &#39;[He] 2s2 2p2&#39;)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ele</span><span class="o">.</span><span class="n">eleconfig_dict</span>
<span class="go">{(1, &#39;s&#39;): 2, (2, &#39;p&#39;): 2, (2, &#39;s&#39;): 2}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">sum</span><span class="p">(</span><span class="n">ele</span><span class="o">.</span><span class="n">mass</span> <span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">ELEMENTS</span><span class="p">)</span>
<span class="go">14659.1115599</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">ele</span> <span class="ow">in</span> <span class="n">ELEMENTS</span><span class="p">:</span>
<span class="gp">... </span>    <span class="n">ele</span><span class="o">.</span><span class="n">validate</span><span class="p">()</span>
<span class="gp">... </span>    <span class="n">ele</span> <span class="o">=</span> <span class="nb">eval</span><span class="p">(</span><span class="nb">repr</span><span class="p">(</span><span class="n">ele</span><span class="p">))</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="module-picaso.fluxes">
<span id="picaso-fluxes-module"></span><h2>picaso.fluxes module<a class="headerlink" href="#module-picaso.fluxes" title="Permalink to this headline">¶</a></h2>
<dl class="attribute">
<dt id="picaso.fluxes.blackbody">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">blackbody</code><a class="headerlink" href="#picaso.fluxes.blackbody" title="Permalink to this definition">¶</a></dt>
<dd><p>Blackbody flux in cgs units in per unit wavelength</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>array</em><em>,</em><em>float</em>) – Temperature (K)</p></li>
<li><p><strong>w</strong> (<em>array</em><em>, </em><em>float</em>) – Wavelength (cm)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>ndarray with shape ntemp x numwave</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.blackbody_climate">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">blackbody_climate</code><a class="headerlink" href="#picaso.fluxes.blackbody_climate" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.calculate_flux">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">calculate_flux</code><a class="headerlink" href="#picaso.fluxes.calculate_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate fluxes</p>
</dd></dl>

<dl class="function">
<dt id="picaso.fluxes.chapman">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">chapman</code><span class="sig-paren">(</span><em class="sig-param">pressure</em>, <em class="sig-param">pm</em>, <em class="sig-param">hratio</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.chapman" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes Chapman function for use in tidal routine</p>
<dl class="simple">
<dt>Parameters</dt><dd></dd>
<dt>pressure<span class="classifier">float</span></dt><dd><p>pressure</p>
</dd>
<dt>pm<span class="classifier">float</span></dt><dd><p>Some pressure (?)</p>
</dd>
<dt>hratio<span class="classifier">float</span></dt><dd><p>Ratio of Scale Height over Chapman Scale Height</p>
</dd>
<dt>Returns</dt><dd><p>Chapman function</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.did_grad_cp">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">did_grad_cp</code><a class="headerlink" href="#picaso.fluxes.did_grad_cp" title="Permalink to this definition">¶</a></dt>
<dd><p>param t: Temperature  value
:type t: float
:param p: Pressure value
:type p: float
:param t_table: array of Temperature values with 53 entries
:type t_table: array
:param p_table: array of Pressure value with 26 entries
:type p_table: array
:param grad: array of gradients of dimension 53*26
:type grad: array
:param cp: array of cp of dimension 53*26
:type cp: array
:param calc_type: not used to make compatible with nopython.
:type calc_type: int</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>grad_x,cp_x</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>float</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_kzz">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_kzz</code><a class="headerlink" href="#picaso.fluxes.get_kzz" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_reflected_1d">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_reflected_1d</code><a class="headerlink" href="#picaso.fluxes.get_reflected_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes toon fluxes given tau and everything is 1 dimensional. This is the exact same function
as <cite>get_flux_geom_3d</cite> but is kept separately so we don’t have to do unecessary indexing for fast
retrievals.
:param nlevel: Number of levels in the model
:type nlevel: int
:param wno: Wave number grid in cm -1
:type wno: array of float
:param nwno: Number of wave points
:type nwno: int
:param numg: Number of Gauss angles
:type numg: int
:param numt: Number of Chebyshev angles
:type numt: int
:param DTAU: This is the opacity contained within each individual layer (defined at midpoints of “levels”)</p>
<blockquote>
<div><p>WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TAU</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</p></li>
<li><p><strong>W0</strong> (<em>ndarray of float</em>) – This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>COSB</strong> (<em>ndarray of float</em>) – This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>GCOS2</strong> (<em>ndarray of float</em>) – Parameter that allows us to directly include Rayleigh scattering
= 0.5*tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_cld</strong> (<em>ndarray of float</em>) – Fraction of cloud extinction to total
= tau_cloud/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_ray</strong> (<em>ndarray of float</em>) – Fraction of rayleigh extinction to total
= tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>dtau_og</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_og</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_og</strong> (<em>ndarray of float</em>) – Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>cosb_og</strong> (<em>ndarray of float</em>) – Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>) – Surface reflectivity</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray of float</em>) – matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>ubar1</strong> (<em>ndarray of float</em>) – matrix of cosine of the observer angles</p></li>
<li><p><strong>cos_theta</strong> (<em>float</em>) – Cosine of the phase angle of the planet</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>) – Downward incident solar radiation</p></li>
<li><p><strong>single_phase</strong> (<em>str</em>) – Single scattering phase function, default is the two-term henyey-greenstein phase function</p></li>
<li><p><strong>multi_phase</strong> (<em>str</em>) – Multiple scattering phase function, defulat is N=2 Legendre polynomial</p></li>
<li><p><strong>frac_a</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_b</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_c</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C), Default is : 1 - gcosb^2</p></li>
<li><p><strong>constant_back</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the assymetry of back scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>constant_forward</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the assymetry of forward scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>tridiagonal</strong> (<em>int</em>) – 0 for tridiagonal, 1 for pentadiagonal</p></li>
<li><p><strong>toon_coefficients</strong> (<em>int</em>) – 0 for quadrature (default) 1 for eddington</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>intensity at the top of the atmosphere for all the different ubar1 and ubar2</em></p></li>
<li><p><em>To Do</em></p></li>
<li><p><em>—–</em></p></li>
<li><p><em>- F0PI Solar flux shouldn’t always be 1.. Follow up to make sure that this isn’t a bad</em> – hardwiring to solar, despite “relative albedo”</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_reflected_1d_gfluxv">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_reflected_1d_gfluxv</code><a class="headerlink" href="#picaso.fluxes.get_reflected_1d_gfluxv" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes upwelling and downwelling layer and level toon fluxes given tau and everything is 1 dimensional. This is the exact same function
as <a href="#id5"><span class="problematic" id="id6">`</span></a>GFLUXV.f’.
retrievals.
:param nlevel: Number of levels in the model
:type nlevel: int
:param wno: Wave number grid in cm -1
:type wno: array of float
:param nwno: Number of wave points
:type nwno: int
:param numg: Number of Gauss angles
:type numg: int
:param numt: Number of Chebyshev angles
:type numt: int
:param DTAU: This is the opacity contained within each individual layer (defined at midpoints of “levels”)</p>
<blockquote>
<div><p>WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TAU</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</p></li>
<li><p><strong>W0</strong> (<em>ndarray of float</em>) – This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>COSB</strong> (<em>ndarray of float</em>) – This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>) – Surface reflectivity</p></li>
<li><p><strong>b_top</strong> (<em>float</em>) – Top Boundary Conditions</p></li>
<li><p><strong>b_surface</strong> (<em>float</em>) – Surface Boundary Conditions</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray of float</em>) – matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>) – Downward incident solar radiation</p></li>
<li><p><strong>delta_approx</strong> (<em>int</em>) – 0 for no Delta Approx, 1 for Delta Approx</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>intensity at the top of the atmosphere for all the different ubar1 and ubar2</em></p></li>
<li><p><em>To Do</em></p></li>
<li><p><em>—–</em></p></li>
<li><p><em>- F0PI Solar flux shouldn’t always be 1.. Follow up to make sure that this isn’t a bad</em> – hardwiring to solar, despite “relative albedo”</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_reflected_1d_newclima">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_reflected_1d_newclima</code><a class="headerlink" href="#picaso.fluxes.get_reflected_1d_newclima" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes toon fluxes given tau and everything is 1 dimensional. This is the exact same function
as <cite>get_flux_geom_3d</cite> but is kept separately so we don’t have to do unecessary indexing for fast
retrievals.
:param nlevel: Number of levels in the model
:type nlevel: int
:param wno: Wave number grid in cm -1
:type wno: array of float
:param nwno: Number of wave points
:type nwno: int
:param numg: Number of Gauss angles
:type numg: int
:param numt: Number of Chebyshev angles
:type numt: int
:param DTAU: This is the opacity contained within each individual layer (defined at midpoints of “levels”)</p>
<blockquote>
<div><p>WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>TAU</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</p></li>
<li><p><strong>W0</strong> (<em>ndarray of float</em>) – This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>COSB</strong> (<em>ndarray of float</em>) – This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>GCOS2</strong> (<em>ndarray of float</em>) – Parameter that allows us to directly include Rayleigh scattering
= 0.5*tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_cld</strong> (<em>ndarray of float</em>) – Fraction of cloud extinction to total
= tau_cloud/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_ray</strong> (<em>ndarray of float</em>) – Fraction of rayleigh extinction to total
= tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>dtau_og</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_og</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_og</strong> (<em>ndarray of float</em>) – Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>cosb_og</strong> (<em>ndarray of float</em>) – Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>) – Surface reflectivity</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray of float</em>) – matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>ubar1</strong> (<em>ndarray of float</em>) – matrix of cosine of the observer angles</p></li>
<li><p><strong>cos_theta</strong> (<em>float</em>) – Cosine of the phase angle of the planet</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>) – Downward incident solar radiation</p></li>
<li><p><strong>single_phase</strong> (<em>str</em>) – Single scattering phase function, default is the two-term henyey-greenstein phase function</p></li>
<li><p><strong>multi_phase</strong> (<em>str</em>) – Multiple scattering phase function, defulat is N=2 Legendre polynomial</p></li>
<li><p><strong>frac_a</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_b</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_c</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C), Default is : 1 - gcosb^2</p></li>
<li><p><strong>constant_back</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the assymetry of back scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>constant_forward</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the assymetry of forward scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>tridiagonal</strong> (<em>int</em>) – 0 for tridiagonal, 1 for pentadiagonal</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>intensity at the top of the atmosphere for all the different ubar1 and ubar2</em></p></li>
<li><p><em>To Do</em></p></li>
<li><p><em>—–</em></p></li>
<li><p><em>- F0PI Solar flux shouldn’t always be 1.. Follow up to make sure that this isn’t a bad</em> – hardwiring to solar, despite “relative albedo”</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_reflected_3d">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_reflected_3d</code><a class="headerlink" href="#picaso.fluxes.get_reflected_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes toon fluxes given tau and everything is 3 dimensional. This is the exact same function
as <cite>get_flux_geom_1d</cite> but is kept separately so we don’t have to do unecessary indexing for
retrievals.
:param nlevel: Number of levels in the model
:type nlevel: int
:param wno: Wave number grid in cm -1
:type wno: array of float
:param nwno: Number of wave points
:type nwno: int
:param numg: Number of Gauss angles
:type numg: int
:param numt: Number of Chebyshev angles
:type numt: int
:param dtau_3d: This is the opacity contained within each individual layer (defined at midpoints of “levels”)</p>
<blockquote>
<div><p>WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>tau_3d</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_3d</strong> (<em>ndarray of float</em>) – This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>cosb_3d</strong> (<em>ndarray of float</em>) – This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>gcos2_3d</strong> (<em>ndarray of float</em>) – Parameter that allows us to directly include Rayleigh scattering
= 0.5*tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_cld_3d</strong> (<em>ndarray of float</em>) – Fraction of cloud extinction to total
= tau_cloud/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_ray_3d</strong> (<em>ndarray of float</em>) – Fraction of rayleigh extinction to total
= tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>dtau_og_3d</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_og_3d</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_og_3d</strong> (<em>ndarray of float</em>) – Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>cosb_og_3d</strong> (<em>ndarray of float</em>) – Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>) – Surface reflectivity</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray of float</em>) – matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>ubar1</strong> (<em>ndarray of float</em>) – matrix of cosine of the observer angles</p></li>
<li><p><strong>cos_theta</strong> (<em>float</em>) – Cosine of the phase angle of the planet</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>) – Downward incident solar radiation</p></li>
<li><p><strong>single_phase</strong> (<em>str</em>) – Single scattering phase function, default is the two-term henyey-greenstein phase function</p></li>
<li><p><strong>multi_phase</strong> (<em>str</em>) – Multiple scattering phase function, defulat is N=2 Legendre polynomial</p></li>
<li><p><strong>frac_a</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_b</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_c</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C), Default is : 1 - gcosb^2</p></li>
<li><p><strong>constant_back</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the assymetry of back scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>constant_forward</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the assymetry of forward scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>tridiagonal</strong> (<em>int</em>) – 0 for tridiagonal, 1 for pentadiagonal</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>intensity at the top of the atmosphere for all the different ubar1 and ubar2</em></p></li>
<li><p><em>To Do</em></p></li>
<li><p><em>—–</em></p></li>
<li><p><em>- F0PI Solar flux shouldn’t always be 1.. Follow up to make sure that this isn’t a bad</em> – hardwiring to solar, despite “relative albedo”</p></li>
<li><p><em>- take delta eddington option out of fluxes and move it all over to optics</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_reflected_SH">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_reflected_SH</code><a class="headerlink" href="#picaso.fluxes.get_reflected_SH" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes rooney fluxes given tau and everything is 3 dimensional. This is the exact same function
as <cite>get_flux_geom_1d</cite> but is kept separately so we don’t have to do unecessary indexing for
retrievals.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>) – Number of levels in the model</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wave points</p></li>
<li><p><strong>numg</strong> (<em>int</em>) – Number of Gauss angles</p></li>
<li><p><strong>numt</strong> (<em>int</em>) – Number of Chebyshev angles</p></li>
<li><p><strong>dtau</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT D-Eddington Correction
Dimensions=# level by # wave</p></li>
<li><p><strong>w0</strong> (<em>ndarray of float</em>) – This is the single scattering albedo, from scattering, clouds, raman, etc
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>cosb</strong> (<em>ndarray of float</em>) – This is the asymmetry factor
WITHOUT D-Eddington Correction
Dimensions=# layer by # wave</p></li>
<li><p><strong>ftau_cld</strong> (<em>ndarray of float</em>) – Fraction of cloud extinction to total
= tau_cloud/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>ftau_ray</strong> (<em>ndarray of float</em>) – Fraction of rayleigh extinction to total
= tau_rayleigh/(tau_rayleigh + tau_cloud)</p></li>
<li><p><strong>f_deltaM</strong> (<em>ndarray of float</em>) – Fractional scattering coefficient for delta-M calculation
f_deltaM = 0 if delta_eddington=False</p></li>
<li><p><strong>dtau_og</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_og</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_og</strong> (<em>ndarray of float</em>) – Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>cosb_og</strong> (<em>ndarray of float</em>) – Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>surf_reflect</strong> (<em>float</em>) – Surface reflectivity</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray of float</em>) – matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>ubar1</strong> (<em>ndarray of float</em>) – matrix of cosine of the observer angles</p></li>
<li><p><strong>cos_theta</strong> (<em>float</em>) – Cosine of the phase angle of the planet</p></li>
<li><p><strong>F0PI</strong> (<em>array</em>) – Downward incident solar radiation</p></li>
<li><p><strong>w_single_form</strong> (<em>str</em>) – Single scattering phase function approximation for SH</p></li>
<li><p><strong>w_multi_form</strong> (<em>str</em>) – Multiple scattering phase function approximation for SH</p></li>
<li><p><strong>psingle_form</strong> (<em>str</em>) – Scattering phase function approximation for psingle in SH</p></li>
<li><p><strong>w_single_rayleigh</strong> (<em>str</em>) – Toggle rayleigh scattering on/off for single scattering in SH</p></li>
<li><p><strong>w_multi_rayleigh</strong> (<em>str</em>) – Toggle rayleigh scattering on/off for multi scattering in SH</p></li>
<li><p><strong>psingle_rayleigh</strong> (<em>str</em>) – Toggle rayleigh scattering on/off for psingle in SH</p></li>
<li><p><strong>frac_a</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_b</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C)</p></li>
<li><p><strong>frac_c</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the functional form for fraction
of forward to back scattering (A + B * gcosb^C), Default is : 1 - gcosb^2</p></li>
<li><p><strong>constant_back</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the assymetry of back scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>constant_forward</strong> (<em>float</em>) – (Optional), If using the TTHG phase function. Must specify the assymetry of forward scatterer.
Remember, the output of A &amp; M code does not separate back and forward scattering.</p></li>
<li><p><strong>stream</strong> (<em>int</em>) – Order of expansion of Legendre polynomials (2 or 4)</p></li>
<li><p><strong>b_top</strong> (<em>float</em>) – Upper boundary condition for incoming intensity</p></li>
<li><p><strong>flx</strong> (<em>int</em>) – Toggle calculation of layerwise fluxes (0 = do not calculate, 1 = calculate)</p></li>
<li><p><strong>single_form</strong> (<em>int</em>) – Toggle which version of p_single to use (0 = explicit, 1 = legendre)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>intensity at the top of the atmosphere for all the different ubar1 and ubar2</em></p></li>
<li><p><em>To Do</em></p></li>
<li><p><em>—–</em></p></li>
<li><p><em>- F0PI Solar flux shouldn’t always be 1.. Follow up to make sure that this isn’t a bad</em> – hardwiring to solar, despite “relative albedo”</p></li>
<li><p><em>- take delta eddington option out of fluxes and move it all over to optics</em></p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_thermal_1d">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_thermal_1d</code><a class="headerlink" href="#picaso.fluxes.get_thermal_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>This function uses the source function method, which is outlined here:
<a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287">https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287</a></p>
<p>The result of this routine is the top of the atmosphere thermal flux as
a function of gauss and chebychev points accross the disk.
Everything here is in CGS units:
Fluxes - erg/s/cm^3
Temperature - K
Wave grid - cm-1
Pressure ; dyne/cm2
Reminder: Flux = pi * Intensity, so if you are trying to compare the result of this with
a black body you will need to compare with pi * BB !
:param nlevel: Number of levels which occur at the grid points (not to be confused with layers which are</p>
<blockquote>
<div><p>mid points)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>) – Wavenumber grid in inverse cm</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumber points</p></li>
<li><p><strong>numg</strong> (<em>int</em>) – Number of gauss points (think longitude points)</p></li>
<li><p><strong>numt</strong> (<em>int</em>) – Number of chebychev points (think latitude points)</p></li>
<li><p><strong>tlevel</strong> (<em>numpy.ndarray</em>) – Temperature as a function of level (not layer)</p></li>
<li><p><strong>dtau</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the per layer optical depth.</p></li>
<li><p><strong>w0</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>cosb</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the asymmetry of the
atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>plevel</strong> (<em>numpy.ndarray</em>) – Pressure for each level (not layer, which is midpoints). CGS units (dyne/cm2)</p></li>
<li><p><strong>ubar1</strong> (<em>numpy.ndarray</em>) – This is a matrix of ng by nt. This describes the outgoing incident angles and is generally
computed in <cite>picaso.disco</cite></p></li>
<li><p><strong>surf_reflect</strong> (<em>numpy.ndarray</em>) – Surface reflectivity as a function of wavenumber.</p></li>
<li><p><strong>hard_surface</strong> (<em>int</em>) – 0 for no hard surface (e.g. Jupiter/Neptune), 1 for hard surface (terrestrial)</p></li>
<li><p><strong>tridiagonal</strong> (<em>int</em>) – 0 for tridiagonal, 1 for pentadiagonal</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Thermal flux in CGS units (erg/cm3/s) in a matrix that is
numg x numt x nwno</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_thermal_1d_gfluxi">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_thermal_1d_gfluxi</code><a class="headerlink" href="#picaso.fluxes.get_thermal_1d_gfluxi" title="Permalink to this definition">¶</a></dt>
<dd><p>This function uses the source function method, which is outlined here:
<a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287">https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287</a></p>
<p>The result of this routine is the top of the atmosphere thermal flux as
a function of gauss and chebychev points accross the disk.
Everything here is in CGS units:
Fluxes - erg/s/cm^3
Temperature - K
Wave grid - cm-1
Pressure ; dyne/cm2
Reminder: Flux = pi * Intensity, so if you are trying to compare the result of this with
a black body you will need to compare with pi * BB !
:param nlevel: Number of levels which occur at the grid points (not to be confused with layers which are</p>
<blockquote>
<div><p>mid points)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>) – Wavenumber grid in inverse cm</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumber points</p></li>
<li><p><strong>numg</strong> (<em>int</em>) – Number of gauss points (think longitude points)</p></li>
<li><p><strong>numt</strong> (<em>int</em>) – Number of chebychev points (think latitude points)</p></li>
<li><p><strong>tlevel</strong> (<em>numpy.ndarray</em>) – Temperature as a function of level (not layer)</p></li>
<li><p><strong>dtau</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the per layer optical depth.</p></li>
<li><p><strong>w0</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>cosb</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the asymmetry of the
atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>plevel</strong> (<em>numpy.ndarray</em>) – Pressure for each level (not layer, which is midpoints). CGS units (dyne/cm2)</p></li>
<li><p><strong>ubar1</strong> (<em>numpy.ndarray</em>) – This is a matrix of ng by nt. This describes the outgoing incident angles and is generally
computed in <cite>picaso.disco</cite></p></li>
<li><p><strong>surf_reflect</strong> (<em>numpy.ndarray</em>) – Surface reflectivity as a function of wavenumber.</p></li>
<li><p><strong>tridiagonal</strong> (<em>int</em>) – 0 for tridiagonal, 1 for pentadiagonal</p></li>
<li><p><strong>calc_type</strong> (<em>int</em>) – 0 for outgoing flux at top level output, 1 for upward and downward layer and level flux outputs</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>numpy.ndarray</em> – Thermal flux in CGS units (erg/cm3/s) in a matrix that is
numg x numt x nwno if calc_type=0</p></li>
<li><p><em>numpy.ndarray, numpy.ndarray, numpy.ndarray, numpy.ndarray</em> – Thermal flux in CGS units (erg/cm3/s) in four matrices if calc_type=0: that is
level downward flux and level upward flux numg x numt x nlevel x nwno and then
layer downward flux and layer upward flux numg x numt x nlayer x nwno</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_thermal_1d_newclima">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_thermal_1d_newclima</code><a class="headerlink" href="#picaso.fluxes.get_thermal_1d_newclima" title="Permalink to this definition">¶</a></dt>
<dd><p>This function uses the source function method, which is outlined here:
<a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287">https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287</a></p>
<p>The result of this routine is the top of the atmosphere thermal flux as
a function of gauss and chebychev points accross the disk.</p>
<p>Everything here is in CGS units:</p>
<p>Fluxes - erg/s/cm^3
Temperature - K
Wave grid - cm-1
Pressure ; dyne/cm2</p>
<p>Reminder: Flux = pi * Intensity, so if you are trying to compare the result of this with
a black body you will need to compare with pi * BB !</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>) – Number of levels which occur at the grid points (not to be confused with layers which are
mid points)</p></li>
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>) – Wavenumber grid in inverse cm</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumber points</p></li>
<li><p><strong>numg</strong> (<em>int</em>) – Number of gauss points (think longitude points)</p></li>
<li><p><strong>numt</strong> (<em>int</em>) – Number of chebychev points (think latitude points)</p></li>
<li><p><strong>tlevel</strong> (<em>numpy.ndarray</em>) – Temperature as a function of level (not layer)</p></li>
<li><p><strong>dtau</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the per layer optical depth.</p></li>
<li><p><strong>w0</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>cosb</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the asymmetry of the
atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>plevel</strong> (<em>numpy.ndarray</em>) – Pressure for each level (not layer, which is midpoints). CGS units (dyne/cm2)</p></li>
<li><p><strong>ubar1</strong> (<em>numpy.ndarray</em>) – This is a matrix of ng by nt. This describes the outgoing incident angles and is generally
computed in <cite>picaso.disco</cite></p></li>
<li><p><strong>surf_reflect</strong> (<em>numpy.ndarray</em>) – Surface reflectivity as a function of wavenumber.</p></li>
<li><p><strong>hard_surface</strong> (<em>int</em>) – 0 for no hard surface (e.g. Jupiter/Neptune), 1 for hard surface (terrestrial)</p></li>
<li><p><strong>tridiagonal</strong> (<em>int</em>) – 0 for tridiagonal, 1 for pentadiagonal</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Thermal flux in CGS units (erg/cm3/s) in a matrix that is
numg x numt x nwno</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_thermal_3d">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_thermal_3d</code><a class="headerlink" href="#picaso.fluxes.get_thermal_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>This function uses the source function method, which is outlined here:
<a class="reference external" href="https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287">https://agupubs.onlinelibrary.wiley.com/doi/pdf/10.1029/JD094iD13p16287</a></p>
<p>The result of this routine is the top of the atmosphere thermal flux as
a function of gauss and chebychev points accross the disk.
Everything here is in CGS units:
Fluxes - erg/s/cm^3
Temperature - K
Wave grid - cm-1
Pressure ; dyne/cm2
Reminder: Flux = pi * Intensity, so if you are trying to compare the result of this with
a black body you will need to compare with pi * BB !
:param nlevel: Number of levels which occur at the grid points (not to be confused with layers which are</p>
<blockquote>
<div><p>mid points)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>) – Wavenumber grid in inverse cm</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumber points</p></li>
<li><p><strong>numg</strong> (<em>int</em>) – Number of gauss points (think longitude points)</p></li>
<li><p><strong>numt</strong> (<em>int</em>) – Number of chebychev points (think latitude points)</p></li>
<li><p><strong>tlevel_3d</strong> (<em>numpy.ndarray</em>) – Temperature as a function of level (not layer). This 3d matrix has dimensions [nlevel,ngangle,ntangle].</p></li>
<li><p><strong>dtau_3d</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the per layer optical depth.
This 4d matrix has dimensions [nlevel, nwave,ngangle,ntangle].</p></li>
<li><p><strong>w0_3d</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.
This 4d matrix has dimensions [nlevel, nwave,ngangle,ntangle].</p></li>
<li><p><strong>cosb_3d</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the asymmetry of the
atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.
This 4d matrix has dimensions [nlevel, nwave,ngangle,ntangle].</p></li>
<li><p><strong>plevel</strong> (<em>numpy.ndarray</em>) – Pressure for each level (not layer, which is midpoints). CGS units (dyne/cm2)</p></li>
<li><p><strong>ubar1</strong> (<em>numpy.ndarray</em>) – This is a matrix of ng by nt. This describes the outgoing incident angles and is generally
computed in <cite>picaso.disco</cite></p></li>
<li><p><strong>tridiagonal</strong> (<em>int</em>) – Zero for tridiagonal solver. 1 for pentadiagonal (not yet implemented)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Thermal flux in CGS units (erg/cm3/s) in a matrix that is
numg x numt x nwno</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_thermal_SH">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_thermal_SH</code><a class="headerlink" href="#picaso.fluxes.get_thermal_SH" title="Permalink to this definition">¶</a></dt>
<dd><p>The result of this routine is the top of the atmosphere thermal intensity as
a function of gauss and chebychev points accross the disk.</p>
<p>Everything here is in CGS units:</p>
<p>Fluxes - erg/s/cm^3
Temperature - K
Wave grid - cm-1
Pressure ; dyne/cm2</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlevel</strong> (<em>int</em>) – Number of levels which occur at the grid points (not to be confused with layers which are
mid points)</p></li>
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>) – Wavenumber grid in inverse cm</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumber points</p></li>
<li><p><strong>numg</strong> (<em>int</em>) – Number of gauss points (think longitude points)</p></li>
<li><p><strong>numt</strong> (<em>int</em>) – Number of chebychev points (think latitude points)</p></li>
<li><p><strong>tlevel</strong> (<em>numpy.ndarray</em>) – Temperature as a function of level (not layer)</p></li>
<li><p><strong>dtau</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the per layer optical depth.</p></li>
<li><p><strong>tau</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlevel by nwave. This describes the cumulative optical depth.</p></li>
<li><p><strong>w0</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>cosb</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the asymmetry of the
atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>dtau_og</strong> (<em>ndarray of float</em>) – This is the opacity contained within each individual layer (defined at midpoints of “levels”)
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# layer by # wave</p></li>
<li><p><strong>tau_og</strong> (<em>ndarray of float</em>) – This is the cumulative summed opacity
WITHOUT the delta eddington correction, if it was specified by user
Dimensions=# level by # wave</p></li>
<li><p><strong>w0_og</strong> (<em>ndarray of float</em>) – Same as w0 but WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>cosb_og</strong> (<em>ndarray of float</em>) – Same as cosbar buth WITHOUT the delta eddington correction, if it was specified by user</p></li>
<li><p><strong>plevel</strong> (<em>numpy.ndarray</em>) – Pressure for each level (not layer, which is midpoints). CGS units (dyne/cm2)</p></li>
<li><p><strong>ubar1</strong> (<em>numpy.ndarray</em>) – This is a matrix of ng by nt. This describes the outgoing incident angles and is generally
computed in <cite>picaso.disco</cite></p></li>
<li><p><strong>surf_reflect</strong> (<em>numpy.ndarray</em>) – Surface reflectivity as a function of wavenumber.</p></li>
<li><p><strong>stream</strong> (<em>int</em>) – Order of expansion of Legendre polynomials (2 or 4)</p></li>
<li><p><strong>hard_surface</strong> (<em>int</em>) – 0 for no hard surface (e.g. Jupiter/Neptune), 1 for hard surface (terrestrial)</p></li>
<li><p><strong>flx</strong> (<em>int</em>) – Toggle calculation of layerwise fluxes (0 = do not calculate, 1 = calculate)</p></li>
<li><p><strong>calculation</strong> (<em>int</em>) – Toggle calculation method (1 = linear, 2 = exponential)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Thermal flux in CGS units (erg/cm3/s) in a matrix that is
numg x numt x nwno</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarray</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.get_transit_1d">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_transit_1d</code><a class="headerlink" href="#picaso.fluxes.get_transit_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine to get the transmission spectrum
:param z: Altitude in decreasing order (cm)
:type z: float, array
:param dz: length of each atmospheric layer
:type dz: float, array
:param nlevel: Number of levels
:type nlevel: int
:param nwno: Number of wavelength points
:type nwno: int
:param rstar: Radius of star (cm)
:type rstar: float
:param mmw: Mean molecular weight
:type mmw: float, array
:param k_b: Boltzman constant cgs
:type k_b: float
:param amu: Atomic mass units cgs
:type amu: float
:param player: Pressure at layers (dyn/cm2)
:type player: float, array
:param tlayer: Temperature at layers (K)
:type tlayer: float, array
:param colden: Column density conputed in atmsetup.get_column_density()
:type colden: float, array
:param DTAU: Matrix of summed tau opacities from optics. This is</p>
<blockquote>
<div><p>TAUGAS + TAURAY + TAUCLD</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Rp**2 /Rs**2 as a function of wavelength</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.fluxes.get_transit_3d">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">get_transit_3d</code><span class="sig-paren">(</span><em class="sig-param">nlevel</em>, <em class="sig-param">nwno</em>, <em class="sig-param">radius</em>, <em class="sig-param">gravity</em>, <em class="sig-param">rstar</em>, <em class="sig-param">mass</em>, <em class="sig-param">mmw</em>, <em class="sig-param">k_b</em>, <em class="sig-param">G</em>, <em class="sig-param">amu</em>, <em class="sig-param">p_reference</em>, <em class="sig-param">plevel</em>, <em class="sig-param">tlevel</em>, <em class="sig-param">player</em>, <em class="sig-param">tlayer</em>, <em class="sig-param">colden</em>, <em class="sig-param">DTAU</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.get_transit_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine to get the 3D transmission spectrum</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.legP">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">legP</code><a class="headerlink" href="#picaso.fluxes.legP" title="Permalink to this definition">¶</a></dt>
<dd><p>Generate array of Legendre polynomials</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.locate">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">locate</code><a class="headerlink" href="#picaso.fluxes.locate" title="Permalink to this definition">¶</a></dt>
<dd><p>param array: Array to be searched.
:type array: array
:param value: Value to be searched for.
:type value: float</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>location of nearest point by bisection method</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.mat_dot">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">mat_dot</code><a class="headerlink" href="#picaso.fluxes.mat_dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Matrix-vector dot product</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.numba_cumsum">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">numba_cumsum</code><a class="headerlink" href="#picaso.fluxes.numba_cumsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute cumsum along axis=0 to bypass numba not allowing kwargs in
cumsum</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.pent_diag_solve">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">pent_diag_solve</code><a class="headerlink" href="#picaso.fluxes.pent_diag_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Pentadiagonal Matrix solver
:param A:
:type A: array or list
:param B:
:type B: array or list
:param C:
:type C: array or list
:param D:
:type D: array or list
:param E:
:type E: array or list
:param F:
:type F: array or list</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Solution, x</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.fluxes.planck_cgs">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">planck_cgs</code><span class="sig-paren">(</span><em class="sig-param">wave</em>, <em class="sig-param">T</em>, <em class="sig-param">dwave</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.planck_cgs" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.planck_rad">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">planck_rad</code><a class="headerlink" href="#picaso.fluxes.planck_rad" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.fluxes.set_bb">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">set_bb</code><span class="sig-paren">(</span><em class="sig-param">wno</em>, <em class="sig-param">delta_wno</em>, <em class="sig-param">nwno</em>, <em class="sig-param">ntmps</em>, <em class="sig-param">dt</em>, <em class="sig-param">tmin</em>, <em class="sig-param">tmax</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.set_bb" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute a grid of black bodies before the code runs.
This allows us to interpolate on a blackbody instead of computing the planck
function repetitively. This was done because historically computing the
planck function was a bottleneck in speed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno</strong> (<em>array</em><em>, </em><em>float</em>) – Wavenumber array cm-1</p></li>
<li><p><strong>delta_wno</strong> (<em>array</em><em>, </em><em>float</em>) – Wavenumber bins cm-1</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumbers (len(wno))</p></li>
<li><p><strong>ntmps</strong> (<em>int</em>) – Number of temperature points to compute. Default number is set in config.json</p></li>
<li><p><strong>dt</strong> (<em>float</em>) – Spacing in temperature to compute. Default number is set in config.json</p></li>
<li><p><strong>tmin</strong> (<em>float</em>) – Minimum temperature to compute the grid</p></li>
<li><p><strong>tmax</strong> (<em>float</em>) – Maximum temperature to compute the grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>array</em> – black body grid (CGS), number of temperatures x number of wavenumbers</p></li>
<li><p><em>array</em> – spline values for interpolation, number of temperatures x number of wavenumbers</p></li>
<li><p><em>array</em> – temperature grid</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.setup_2_stream_banded">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">setup_2_stream_banded</code><a class="headerlink" href="#picaso.fluxes.setup_2_stream_banded" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup up matrices to solve flux problem for spherical harmonics method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlayer</strong> (<em>int</em>) – Number of layers</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumber points</p></li>
<li><p><strong>w0</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>b_top</strong> (<em>array</em>) – The diffuse radiation into the model at the top of the atmosphere</p></li>
<li><p><strong>b_surface</strong> (<em>array</em>) – The diffuse radiation into the model at the bottom. Includes emission, reflection
of the unattenuated portion of the direct beam</p></li>
<li><p><strong>b_surface_SH4</strong> (<em>array</em>) – Second bottom BC for SH4 method.</p></li>
<li><p><strong>surf_reflect</strong> (<em>numpy.ndarray</em>) – Surface reflectivity as a function of wavenumber.</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray of float</em>) – matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>ubar1</strong> (<em>numpy.ndarray</em>) – This is a matrix of ng by nt. This describes the outgoing incident angles and is generally
computed in <cite>picaso.disco</cite></p></li>
<li><p><strong>dtau</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the per layer optical depth.</p></li>
<li><p><strong>tau</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlevel by nwave. This describes the cumulative optical depth.</p></li>
<li><p><strong>a</strong> (<em>numpy.ndarray</em>) – Coefficients of matrix capturing legendre expansion of phase function for multiple scattering</p></li>
<li><p><strong>b</strong> (<em>numpy.ndarray</em>) – Coefficients of source vector capturing legendre expansion of phase function for single
scattering</p></li>
<li><p><strong>B0</strong> (<em>numpy.ndarray</em>) – Matrix of blackbodies</p></li>
<li><p><strong>B1</strong> (<em>numpy.ndarray</em>) – Eqn (26) Toon 89</p></li>
<li><p><strong>f0</strong> (<em>numpy.ndarray</em>) – Parameter needed for exponential approach to thermal</p></li>
<li><p><strong>fluxes</strong> (<em>int</em>) – Toggle calculation of layerwise fluxes (0 = do not calculate, 1 = calculate)</p></li>
<li><p><strong>calculation</strong> (<em>int</em>) – Toggle calculation method (1 = linear, 2 = exponential)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Matrices and vectors used to calculate fluxes and intensities at each level</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarrays</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.setup_4_stream_banded">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">setup_4_stream_banded</code><a class="headerlink" href="#picaso.fluxes.setup_4_stream_banded" title="Permalink to this definition">¶</a></dt>
<dd><p>Setup up matrices to solve flux problem for spherical harmonics method.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nlayer</strong> (<em>int</em>) – Number of layers</p></li>
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumber points</p></li>
<li><p><strong>w0</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the single scattering albedo of
the atmosphere. Note this is free of any Raman scattering or any d-eddington correction
that is sometimes included in reflected light calculations.</p></li>
<li><p><strong>b_top</strong> (<em>array</em>) – The diffuse radiation into the model at the top of the atmosphere</p></li>
<li><p><strong>b_surface</strong> (<em>array</em>) – The diffuse radiation into the model at the bottom. Includes emission, reflection
of the unattenuated portion of the direct beam</p></li>
<li><p><strong>b_surface_SH4</strong> (<em>array</em>) – Second bottom BC for SH4 method.</p></li>
<li><p><strong>surf_reflect</strong> (<em>numpy.ndarray</em>) – Surface reflectivity as a function of wavenumber.</p></li>
<li><p><strong>ubar0</strong> (<em>ndarray of float</em>) – matrix of cosine of the incident angle from geometric.json</p></li>
<li><p><strong>ubar1</strong> (<em>numpy.ndarray</em>) – This is a matrix of ng by nt. This describes the outgoing incident angles and is generally
computed in <cite>picaso.disco</cite></p></li>
<li><p><strong>dtau</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlayer by nwave. This describes the per layer optical depth.</p></li>
<li><p><strong>tau</strong> (<em>numpy.ndarray</em>) – This is a matrix of nlevel by nwave. This describes the cumulative optical depth.</p></li>
<li><p><strong>a</strong> (<em>numpy.ndarray</em>) – Coefficients of matrix capturing legendre expansion of phase function for multiple scattering</p></li>
<li><p><strong>b</strong> (<em>numpy.ndarray</em>) – Coefficients of source vector capturing legendre expansion of phase function for single
scattering</p></li>
<li><p><strong>B0</strong> (<em>numpy.ndarray</em>) – Matrix of blackbodies</p></li>
<li><p><strong>B1</strong> (<em>numpy.ndarray</em>) – Eqn (26) Toon 89</p></li>
<li><p><strong>f0</strong> (<em>numpy.ndarray</em>) – Parameter needed for exponential approach to thermal</p></li>
<li><p><strong>fluxes</strong> (<em>int</em>) – Toggle calculation of layerwise fluxes (0 = do not calculate, 1 = calculate)</p></li>
<li><p><strong>calculation</strong> (<em>int</em>) – Toggle calculation method (1 = linear, 2 = exponential)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Matrices and vectors used to calculate fluxes and intensities at each level</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>numpy.ndarrays</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.setup_pent_diag">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">setup_pent_diag</code><a class="headerlink" href="#picaso.fluxes.setup_pent_diag" title="Permalink to this definition">¶</a></dt>
<dd><p>param nlayer: number of layers in the model
:type nlayer: int
:param nwno: number of wavelength points
:type nwno: int
:param c_plus_up: c-plus evaluated at the top of the atmosphere
:type c_plus_up: array
:param c_minus_up: c_minus evaluated at the top of the atmosphere
:type c_minus_up: array
:param c_plus_down: c_plus evaluated at the bottom of the atmosphere
:type c_plus_down: array
:param c_minus_down: c_minus evaluated at the bottom of the atmosphere
:type c_minus_down: array
:param b_top: The diffuse radiation into the model at the top of the atmosphere
:type b_top: array
:param b_surface: The diffuse radiation into the model at the bottom. Includes emission, reflection</p>
<blockquote>
<div><p>of the unattenuated portion of the direct beam</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surf_reflect</strong> (<em>array</em>) – Surface reflectivity</p></li>
<li><p><strong>g1</strong> (<em>array</em>) – table 1 toon et al 1989</p></li>
<li><p><strong>g2</strong> (<em>array</em>) – table 1 toon et al 1989</p></li>
<li><p><strong>g3</strong> (<em>array</em>) – table 1 toon et al 1989</p></li>
<li><p><strong>lamba</strong> (<em>array</em>) – Eqn 21 toon et al 1989</p></li>
<li><p><strong>gama</strong> (<em>array</em>) – Eqn 22 toon et al 1989</p></li>
<li><p><strong>dtau</strong> (<em>array</em>) – Opacity per layer</p></li>
<li><p><strong>exptrm_positive</strong> (<em>array</em>) – Eqn 44, expoential terms needed for tridiagonal rotated layered, clipped at 35</p></li>
<li><p><strong>exptrm_minus</strong> (<em>array</em>) – Eqn 44, expoential terms needed for tridiagonal rotated layered, clipped at 35</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>coefficient of the positive exponential term</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.setup_tri_diag">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">setup_tri_diag</code><a class="headerlink" href="#picaso.fluxes.setup_tri_diag" title="Permalink to this definition">¶</a></dt>
<dd><p>Before we can solve the tridiagonal matrix (See Toon+1989) section
“SOLUTION OF THE TwO-STREAM EQUATIONS FOR MULTIPLE LAYERS”, we
need to set up the coefficients.
:param nlayer: number of layers in the model
:type nlayer: int
:param nwno: number of wavelength points
:type nwno: int
:param c_plus_up: c-plus evaluated at the top of the atmosphere
:type c_plus_up: array
:param c_minus_up: c_minus evaluated at the top of the atmosphere
:type c_minus_up: array
:param c_plus_down: c_plus evaluated at the bottom of the atmosphere
:type c_plus_down: array
:param c_minus_down: c_minus evaluated at the bottom of the atmosphere
:type c_minus_down: array
:param b_top: The diffuse radiation into the model at the top of the atmosphere
:type b_top: array
:param b_surface: The diffuse radiation into the model at the bottom. Includes emission, reflection</p>
<blockquote>
<div><p>of the unattenuated portion of the direct beam</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>surf_reflect</strong> (<em>array</em>) – Surface reflectivity</p></li>
<li><p><strong>g1</strong> (<em>array</em>) – table 1 toon et al 1989</p></li>
<li><p><strong>g2</strong> (<em>array</em>) – table 1 toon et al 1989</p></li>
<li><p><strong>g3</strong> (<em>array</em>) – table 1 toon et al 1989</p></li>
<li><p><strong>lamba</strong> (<em>array</em>) – Eqn 21 toon et al 1989</p></li>
<li><p><strong>gama</strong> (<em>array</em>) – Eqn 22 toon et al 1989</p></li>
<li><p><strong>dtau</strong> (<em>array</em>) – Opacity per layer</p></li>
<li><p><strong>exptrm_positive</strong> (<em>array</em>) – Eqn 44, expoential terms needed for tridiagonal rotated layered, clipped at 35</p></li>
<li><p><strong>exptrm_minus</strong> (<em>array</em>) – Eqn 44, expoential terms needed for tridiagonal rotated layered, clipped at 35</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>coefficient of the positive exponential term</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.slice_eq">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">slice_eq</code><a class="headerlink" href="#picaso.fluxes.slice_eq" title="Permalink to this definition">¶</a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.slice_gt">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">slice_gt</code><a class="headerlink" href="#picaso.fluxes.slice_gt" title="Permalink to this definition">¶</a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.slice_lt">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">slice_lt</code><a class="headerlink" href="#picaso.fluxes.slice_lt" title="Permalink to this definition">¶</a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.slice_rav">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">slice_rav</code><a class="headerlink" href="#picaso.fluxes.slice_rav" title="Permalink to this definition">¶</a></dt>
<dd><p>Funciton to replace values with upper or lower limit</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.solve_4_stream_banded">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">solve_4_stream_banded</code><a class="headerlink" href="#picaso.fluxes.solve_4_stream_banded" title="Permalink to this definition">¶</a></dt>
<dd><p>Solve the Spherical Harmonics Problem</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>intgrl_new</strong> (<em>numpy.ndarray</em>) – Integrated source function for source function technique</p></li>
<li><p><strong>flux</strong> (<em>numpy.ndarray</em>) – Upwards lux at bottom of atmosphere</p></li>
<li><p><strong>X</strong> (<em>numpy.ndarray</em>) – Coefficients of flux/intensity matrix problem</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.fluxes.spline">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">spline</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">n</em>, <em class="sig-param">yp0</em>, <em class="sig-param">ypn</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.spline" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.fluxes.tidal_flux">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">tidal_flux</code><span class="sig-paren">(</span><em class="sig-param">T_e</em>, <em class="sig-param">wave_in</em>, <em class="sig-param">nlevel</em>, <em class="sig-param">pressure</em>, <em class="sig-param">pm</em>, <em class="sig-param">hratio</em>, <em class="sig-param">col_den</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.fluxes.tidal_flux" title="Permalink to this definition">¶</a></dt>
<dd><p>Computes Tidal Fluxes in all levels. Py of TIDALWAVE subroutine.</p>
<dl class="simple">
<dt>Parameters</dt><dd><dl class="simple">
<dt>T_e<span class="classifier">float</span></dt><dd><p>Temperature (internal?)</p>
</dd>
<dt>wave_in<span class="classifier">float</span></dt><dd><p>what is this?</p>
</dd>
<dt>nlevel<span class="classifier">int</span></dt><dd><p># of levels</p>
</dd>
<dt>pressure<span class="classifier">array</span></dt><dd><p>pressure array</p>
</dd>
<dt>pm<span class="classifier">float</span></dt><dd><p>Some pressure (?)</p>
</dd>
</dl>
</dd>
<dt>hratio<span class="classifier">float</span></dt><dd><p>Ratio of Scale Height over Chapman Scale Height</p>
</dd>
<dt>col_den<span class="classifier">array</span></dt><dd><p>Column density array</p>
</dd>
<dt>Returns</dt><dd><p>Tidal Fluxes and DE/DM in ergs/g sec</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.tri_diag_solve">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">tri_diag_solve</code><a class="headerlink" href="#picaso.fluxes.tri_diag_solve" title="Permalink to this definition">¶</a></dt>
<dd><p>Tridiagonal Matrix Algorithm solver, a b c d can be NumPy array type or Python list type.
refer to this <a class="reference external" href="http://en.wikipedia.org/wiki/Tridiagonal_matrix_algorithm">wiki</a> and to this <a class="reference external" href="http://www.cfd-online.com/Wiki/Tridiagonal_matrix_algorithm_-_TDMA_(Thomas_algorithm)">explanation</a>.</p>
<p>A, B, C and D refer to:
.. math:: A(I)*X(I-1) + B(I)*X(I) + C(I)*X(I+1) = D(I)
This solver returns X.
:param A:
:type A: array or list
:param B:
:type B: array or list
:param C:
:type C: array or list
:param C:
:type C: array or list</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Solution, x</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.fluxes.vec_dot">
<code class="sig-prename descclassname">picaso.fluxes.</code><code class="sig-name descname">vec_dot</code><a class="headerlink" href="#picaso.fluxes.vec_dot" title="Permalink to this definition">¶</a></dt>
<dd><p>Vector-vector dot product</p>
</dd></dl>

</div>
<div class="section" id="module-picaso.io_utils">
<span id="picaso-io-utils-module"></span><h2>picaso.io_utils module<a class="headerlink" href="#module-picaso.io_utils" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.io_utils.read_hdf">
<code class="sig-prename descclassname">picaso.io_utils.</code><code class="sig-name descname">read_hdf</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">requires</em>, <em class="sig-param">raise_except=False</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.io_utils.read_hdf" title="Permalink to this definition">¶</a></dt>
<dd><p>read in H5 format file and pull out specific table based on specific
header information in the requires field. return None if file is not there</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – name of H5 file to read</p></li>
<li><p><strong>requires</strong> (<em>dict</em>) – dictionary with keys and values to get correct table
e.g. {‘wmin’:0.3, ‘wmax’:1, ‘R’:5000} for opacity grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>d</strong> – data from H5 file decoded into python object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>python object</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.io_utils.read_json">
<code class="sig-prename descclassname">picaso.io_utils.</code><code class="sig-name descname">read_json</code><span class="sig-paren">(</span><em class="sig-param">filename</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.io_utils.read_json" title="Permalink to this definition">¶</a></dt>
<dd><p>read in a JSON format file.  return None if the file is not there.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>string</em>) – name of the JSON file to read</p></li>
<li><p><strong>except</strong> (<em>bool</em>) – if true, raise exception if file is missing. if false, return empty dict.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><strong>d</strong> – data from JSON file decoded into python object</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>python object</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso.justdoit">
<span id="picaso-justdoit-module"></span><h2>picaso.justdoit module<a class="headerlink" href="#module-picaso.justdoit" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.justdoit.HJ_cld">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">HJ_cld</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.HJ_cld" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to get rough Jupiter Cloud model with fsed=3</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.HJ_pt">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">HJ_pt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.HJ_pt" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to get Jupiter’s PT profile</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.HJ_pt_3d">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">HJ_pt_3d</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.HJ_pt_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to get Jupiter’s PT profile</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.OH_conc">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">OH_conc</code><span class="sig-paren">(</span><em class="sig-param">temp</em>, <em class="sig-param">press</em>, <em class="sig-param">x_h2o</em>, <em class="sig-param">x_h2</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.OH_conc" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.justdoit.SH_psingle_form_options">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">SH_psingle_form_options</code><span class="sig-paren">(</span><em class="sig-param">printout=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.SH_psingle_form_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve options for direct scattering form approximation</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.SH_rayleigh_options">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">SH_rayleigh_options</code><span class="sig-paren">(</span><em class="sig-param">printout=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.SH_rayleigh_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve options for rayleigh scattering</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.SH_scattering_options">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">SH_scattering_options</code><span class="sig-paren">(</span><em class="sig-param">printout=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.SH_scattering_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve all the options for scattering radiation in SH</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.all_planets">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">all_planets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.all_planets" title="Permalink to this definition">¶</a></dt>
<dd><p>Load all planets from <a class="reference external" href="https://exoplanetarchive.ipac.caltech.edu">https://exoplanetarchive.ipac.caltech.edu</a></p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.coefficients_options">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">coefficients_options</code><span class="sig-paren">(</span><em class="sig-param">printout=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.coefficients_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve options for coefficients used in Toon calculation</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justdoit.correct_profile">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">correct_profile</code><a class="headerlink" href="#picaso.justdoit.correct_profile" title="Permalink to this definition">¶</a></dt>
<dd><p>indices = wh[0]
for i in range(len(indices)):</p>
<blockquote>
<div><dl class="simple">
<dt>if indices[i] == 0:</dt><dd><p>temp[indices[i]] = min_temp+0.5</p>
</dd>
<dt>elif (temp[indices[i]-1] &gt; min_temp) and (temp[indices[i]+1]) &gt; min_temp :</dt><dd><p>temp_prev = temp[indices[i]-1]
temp_next = temp[indices[i]+1]
press_prev = pressure[indices[i]-1]
press_next = pressure[indices[i]+1]
dtdlnp = (temp_next-temp_prev)/np.log(press_next/press_prev)
temp[indices[i]] = temp_prev +np.log(pressure[indices[i]]/press_prev)*dtdlnp</p>
</dd>
<dt>else :</dt><dd><p>temp[indices[i]] = min_temp+0.5
temp[indices[i]-1] = min_temp+0.5
temp[indices[i]+1] = min_temp + 0.5</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.evolution_track">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">evolution_track</code><span class="sig-paren">(</span><em class="sig-param">mass=1</em>, <em class="sig-param">age='all'</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.evolution_track" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot or grab an effective temperature for a certain age and mass planet.
:param mass: (Optional) Mass of planet, in Jupiter Masses. Only valid options = 1, 2, 4, 6, 8, 10,’all’</p>
<blockquote>
<div><p>If another value is entered, it will find the nearest option.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>age</strong> (<em>float</em><em> or </em><em>str</em><em>, </em><em>optional</em>) – (Optional) Age of planet, in years or ‘all’ to return full model</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>if age=None</strong> (<em>data = {‘cold’:all_data_cold_start, ‘hot’:all_data_hot_start}</em>)</p></li>
<li><p><strong>if age=float</strong> (<em>data = {‘cold’:data_at_age, ‘hot’:data_at_age}</em>)</p></li>
<li><p><strong>if plot=False</strong> (<em>returns data</em>)</p></li>
<li><p><strong>else</strong> (<em>returns data, plot</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justdoit.find_press">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">find_press</code><a class="headerlink" href="#picaso.justdoit.find_press" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.justdoit.find_strat">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">find_strat</code><span class="sig-paren">(</span><em class="sig-param">pressure</em>, <em class="sig-param">temp</em>, <em class="sig-param">dtdp</em>, <em class="sig-param">FOPI</em>, <em class="sig-param">nofczns</em>, <em class="sig-param">nstr</em>, <em class="sig-param">x_max_mult</em>, <em class="sig-param">t_table</em>, <em class="sig-param">p_table</em>, <em class="sig-param">grad</em>, <em class="sig-param">cp</em>, <em class="sig-param">opacityclass</em>, <em class="sig-param">grav</em>, <em class="sig-param">rfaci</em>, <em class="sig-param">rfacv</em>, <em class="sig-param">nlevel</em>, <em class="sig-param">tidal</em>, <em class="sig-param">tmin</em>, <em class="sig-param">tmax</em>, <em class="sig-param">dwni</em>, <em class="sig-param">bb</em>, <em class="sig-param">y2</em>, <em class="sig-param">tp</em>, <em class="sig-param">cloudy</em>, <em class="sig-param">cld_species</em>, <em class="sig-param">mh</em>, <em class="sig-param">fsed</em>, <em class="sig-param">flag_hack</em>, <em class="sig-param">save_profile</em>, <em class="sig-param">all_profiles</em>, <em class="sig-param">opd_cld_climate</em>, <em class="sig-param">g0_cld_climate</em>, <em class="sig-param">w0_cld_climate</em>, <em class="sig-param">flux_net_ir_layer</em>, <em class="sig-param">flux_plus_ir_attop</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.find_strat" title="Permalink to this definition">¶</a></dt>
<dd><p>Function iterating on the TP profile by calling tstart and changing opacities as well
:param it_max: Maximum iterations allowed in the inner no opa change loop
:type it_max: int
:param itmx: Maximum iterations allowed in the outer opa change loop
:type itmx: int
:param conv:
:type conv: float
:param convt: Convergence criteria , if max avg change in temp is less than this then outer loop converges
:type convt: float
:param nofczns: # of conv zones
:type nofczns: int
:param nstr: dimension of 20</p>
<blockquote>
<div><p>NSTR vector describes state of the atmosphere:
0   is top layer
1   is top layer of top convective region
2   is bottom layer of top convective region
3   is top layer of lower radiative region
4   is top layer of lower convective region
5   is bottom layer of lower convective region</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xmaxmult</strong> – </p></li>
<li><p><strong>temp</strong> (<em>array</em>) – Guess temperatures to start with</p></li>
<li><p><strong>pressure</strong> (<em>array</em>) – Atmospheric pressure</p></li>
<li><p><strong>t_table</strong> (<em>array</em>) – Visible flux addition fraction</p></li>
<li><p><strong>nlevel</strong> (<em>int</em>) – # of levels</p></li>
<li><p><strong>temp</strong> – Guess Temperature array, dimension is nlevel</p></li>
<li><p><strong>pressure</strong> – Pressure array</p></li>
<li><p><strong>t_table</strong> – Tabulated Temperature array for convection calculations</p></li>
<li><p><strong>p_table</strong> (<em>array</em>) – Tabulated pressure array for convection calculations</p></li>
<li><p><strong>grad</strong> (<em>array</em>) – Tabulated grad array for convection calculations</p></li>
<li><p><strong>cp</strong> (<em>array</em>) – Tabulated cp array for convection calculations</p></li>
<li><p><strong>opacityclass</strong> (<em>class</em>) – Opacity class created with jdi.oppanection</p></li>
<li><p><strong>grav</strong> (<em>float</em>) – Gravity of planet in SI</p></li>
<li><p><strong>rfaci</strong> (<em>float</em>) – IR flux addition fraction</p></li>
<li><p><strong>rfacv</strong> (<em>float</em>) – Visible flux addition fraction</p></li>
<li><p><strong>nlevel</strong> – # of levels, not layers</p></li>
<li><p><strong>tidal</strong> (<em>array</em>) – Tidal Fluxes dimension = nlevel</p></li>
<li><p><strong>tmin</strong> (<em>float</em>) – Minimum allwed Temp in the profile</p></li>
<li><p><strong>tmax</strong> (<em>float</em>) – Maximum allowed Temp in the profile</p></li>
<li><p><strong>dwni</strong> (<em>array</em>) – Spectral interval corrections (dimension= nwvno)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Temperature array and lapse ratio array if converged
else Temperature array twice</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.find_strat_deq">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">find_strat_deq</code><span class="sig-paren">(</span><em class="sig-param">pressure</em>, <em class="sig-param">temp</em>, <em class="sig-param">dtdp</em>, <em class="sig-param">FOPI</em>, <em class="sig-param">nofczns</em>, <em class="sig-param">nstr</em>, <em class="sig-param">x_max_mult</em>, <em class="sig-param">t_table</em>, <em class="sig-param">p_table</em>, <em class="sig-param">grad</em>, <em class="sig-param">cp</em>, <em class="sig-param">opacityclass</em>, <em class="sig-param">grav</em>, <em class="sig-param">rfaci</em>, <em class="sig-param">rfacv</em>, <em class="sig-param">nlevel</em>, <em class="sig-param">tidal</em>, <em class="sig-param">tmin</em>, <em class="sig-param">tmax</em>, <em class="sig-param">dwni</em>, <em class="sig-param">bb</em>, <em class="sig-param">y2</em>, <em class="sig-param">tp</em>, <em class="sig-param">cloudy</em>, <em class="sig-param">cld_species</em>, <em class="sig-param">mh</em>, <em class="sig-param">fsed</em>, <em class="sig-param">flag_hack</em>, <em class="sig-param">quench_levels</em>, <em class="sig-param">kz</em>, <em class="sig-param">mmw</em>, <em class="sig-param">save_profile</em>, <em class="sig-param">all_profiles</em>, <em class="sig-param">self_consistent_kzz</em>, <em class="sig-param">save_kzz</em>, <em class="sig-param">all_kzz</em>, <em class="sig-param">vulcan_run</em>, <em class="sig-param">opd_cld_climate</em>, <em class="sig-param">g0_cld_climate</em>, <em class="sig-param">w0_cld_climate</em>, <em class="sig-param">flux_net_ir_layer</em>, <em class="sig-param">flux_plus_ir_attop</em>, <em class="sig-param">on_fly=False</em>, <em class="sig-param">gases_fly=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.find_strat_deq" title="Permalink to this definition">¶</a></dt>
<dd><p>Function iterating on the TP profile by calling tstart and changing opacities as well
:param it_max: Maximum iterations allowed in the inner no opa change loop
:type it_max: int
:param itmx: Maximum iterations allowed in the outer opa change loop
:type itmx: int
:param conv:
:type conv: float
:param convt: Convergence criteria , if max avg change in temp is less than this then outer loop converges
:type convt: float
:param nofczns: # of conv zones
:type nofczns: int
:param nstr: dimension of 20</p>
<blockquote>
<div><p>NSTR vector describes state of the atmosphere:
0   is top layer
1   is top layer of top convective region
2   is bottom layer of top convective region
3   is top layer of lower radiative region
4   is top layer of lower convective region
5   is bottom layer of lower convective region</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xmaxmult</strong> – </p></li>
<li><p><strong>temp</strong> (<em>array</em>) – Guess temperatures to start with</p></li>
<li><p><strong>pressure</strong> (<em>array</em>) – Atmospheric pressure</p></li>
<li><p><strong>t_table</strong> (<em>array</em>) – Visible flux addition fraction</p></li>
<li><p><strong>nlevel</strong> (<em>int</em>) – # of levels</p></li>
<li><p><strong>temp</strong> – Guess Temperature array, dimension is nlevel</p></li>
<li><p><strong>pressure</strong> – Pressure array</p></li>
<li><p><strong>t_table</strong> – Tabulated Temperature array for convection calculations</p></li>
<li><p><strong>p_table</strong> (<em>array</em>) – Tabulated pressure array for convection calculations</p></li>
<li><p><strong>grad</strong> (<em>array</em>) – Tabulated grad array for convection calculations</p></li>
<li><p><strong>cp</strong> (<em>array</em>) – Tabulated cp array for convection calculations</p></li>
<li><p><strong>opacityclass</strong> (<em>class</em>) – Opacity class created with jdi.oppanection</p></li>
<li><p><strong>grav</strong> (<em>float</em>) – Gravity of planet in SI</p></li>
<li><p><strong>rfaci</strong> (<em>float</em>) – IR flux addition fraction</p></li>
<li><p><strong>rfacv</strong> (<em>float</em>) – Visible flux addition fraction</p></li>
<li><p><strong>nlevel</strong> – # of levels, not layers</p></li>
<li><p><strong>tidal</strong> (<em>array</em>) – Tidal Fluxes dimension = nlevel</p></li>
<li><p><strong>tmin</strong> (<em>float</em>) – Minimum allwed Temp in the profile</p></li>
<li><p><strong>tmax</strong> (<em>float</em>) – Maximum allowed Temp in the profile</p></li>
<li><p><strong>dwni</strong> (<em>array</em>) – Spectral interval corrections (dimension= nwvno)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Temperature array and lapse ratio array if converged
else Temperature array twice</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.get_contribution">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">get_contribution</code><span class="sig-paren">(</span><em class="sig-param">bundle</em>, <em class="sig-param">opacityclass</em>, <em class="sig-param">at_tau=1</em>, <em class="sig-param">dimension='1d'</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.get_contribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Currently top level program to run albedo code</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>bundle</strong> (<em>dict</em>) – This input dict is built by loading the input = <cite>justdoit.load_inputs()</cite></p></li>
<li><p><strong>opacityclass</strong> (<em>class</em>) – Opacity class from <cite>justdoit.opannection</cite></p></li>
<li><p><strong>at_tau</strong> (<em>float</em>) – (Optional) Default = 1, This is to compute the pressure level at which cumulative opacity reaches
at_tau. Usually users want to know when the cumulative opacity reaches a tau of 1.</p></li>
<li><p><strong>dimension</strong> (<em>str</em>) – (Optional) Default = ‘1d’. Currently only 1d is supported.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>taus_by_species</strong> (<em>dict</em>) – Each dictionary entry is a nlayer x nwave that represents the
per layer optical depth for that molecule. If you do not see
a molecule that you have added as input, check to make sure it is
propertly formatted (e.g. Sodium must be Na not NA, Titanium Oxide must be TiO not TIO)</p></li>
<li><p><strong>cumsum_taus</strong> (<em>dict</em>) – Each dictionary entry is a nlevel x nwave that represents the cumulative summed opacity
for that molecule. If you do not see a molecule that you have added as input, check to make sure it is
propertly formatted (e.g. Sodium must be Na not NA, Titanium Oxide must be TiO not TIO)</p></li>
<li><p><strong>at_pressure_array</strong> (<em>dict</em>) – Each dictionary entry is a nwave array that represents the
pressure level where the cumulative opacity reaches the value specieid by the user through <cite>at_tau</cite>.
If you do not see a molecule that you have added as input, check to make sure it is
a molecule that you have added as input, check to make sure it is
propertly formatted (e.g. Sodium must be Na not NA, Titanium Oxide must be TiO not TIO)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.get_targets">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">get_targets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.get_targets" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to grab available targets using exoplanet archive data.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Dataframe from Exoplanet Archive</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.input_xarray">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">input_xarray</code><span class="sig-paren">(</span><em class="sig-param">xr_usr</em>, <em class="sig-param">opacity</em>, <em class="sig-param">p_reference=10</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.input_xarray" title="Permalink to this definition">¶</a></dt>
<dd><p>This takes an input based on these standards and runs:
-gravity
-phase_angle
-star
-approx (p_reference=10)
-atmosphere
-clouds (if there are any)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xr_usr</strong> (<em>xarray</em>) – xarray based on ERS formatting requirements</p></li>
<li><p><strong>opacity</strong> (<em>justdoit.opannection</em>) – opacity connection</p></li>
<li><p><strong>p_reference</strong> (<em>float</em>) – reference pressure in bars</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Example</p>
<p>case = jdi.input_xarray(xr_user)
case.spectrum(opacity,calculation=’transit_depth’)</p>
</dd></dl>

<dl class="class">
<dt id="picaso.justdoit.inputs">
<em class="property">class </em><code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">inputs</code><span class="sig-paren">(</span><em class="sig-param">calculation='planet'</em>, <em class="sig-param">climate=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class to setup planet to run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>calculation</strong> (<em>str</em>) – (Optional) Controls planet or brown dwarf calculation. Default = ‘planet’. Other option is “browndwarf”.</p></li>
<li><p><strong>climate</strong> (<em>bool</em>) – (Optional) If true, this do a thorough iterative calculation to compute
a temperature pressure profile.</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="picaso.justdoit.inputs.phase_angle">
<code class="sig-name descname">phase_angle</code><a class="headerlink" href="#picaso.justdoit.inputs.phase_angle" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set phase angle</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justdoit.inputs.gravity">
<code class="sig-name descname">gravity</code><a class="headerlink" href="#picaso.justdoit.inputs.gravity" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set gravity</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justdoit.inputs.star">
<code class="sig-name descname">star</code><a class="headerlink" href="#picaso.justdoit.inputs.star" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set stellar spec</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justdoit.inputs.atmosphere">
<code class="sig-name descname">atmosphere</code><a class="headerlink" href="#picaso.justdoit.inputs.atmosphere" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set atmosphere composition and PT</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justdoit.inputs.clouds">
<code class="sig-name descname">clouds</code><a class="headerlink" href="#picaso.justdoit.inputs.clouds" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set cloud profile</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justdoit.inputs.approx">
<code class="sig-name descname">approx</code><a class="headerlink" href="#picaso.justdoit.inputs.approx" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>set approximation</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justdoit.inputs.spectrum">
<code class="sig-name descname">spectrum</code><a class="headerlink" href="#picaso.justdoit.inputs.spectrum" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>create spectrum</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.TP_line_earth">
<code class="sig-name descname">TP_line_earth</code><span class="sig-paren">(</span><em class="sig-param">P</em>, <em class="sig-param">Tsfc=294.0</em>, <em class="sig-param">Psfc=1.0</em>, <em class="sig-param">gam_trop=0.18</em>, <em class="sig-param">Ptrop=0.199</em>, <em class="sig-param">gam_strat=-0.045</em>, <em class="sig-param">Pstrat=0.001</em>, <em class="sig-param">nlevel=150</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.TP_line_earth" title="Permalink to this definition">¶</a></dt>
<dd><p>Author: Mike R. Line
Estimates Earth’s pressure-temperature profile. All default
values have been tuned to semi reproduce Earth’s temperature
pressure profile.
:param P: Pressure array usually np.logspace(-6,2,nlevel)
:type P: array
:param Tsfc: Surface Temperature (K). Earth is 294 K
:type Tsfc: float,optional
:param Psfc: Surface Pressure (bar). Earth is 1 bar.
:type Psfc: float ,optional
:param gam_trop: Tropospheric dry lapse rate. Earth is ~0.18
:type gam_trop: float ,optional
:param Ptrop: Tropospheric pressure. Earth 0.199 bar.
:type Ptrop: float ,optional
:param gam_strat: Stratospheric lapse rate. Earth is -0.045
:type gam_strat: float ,optional
:param Pstrat: Stratospheric pressure (bars). Earth is 0.001 bar. /
:type Pstrat: float ,optional
:param nlevel: Number of grid levels
:type nlevel: int ,optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Temperature array (K)Psfc</p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.T_eff">
<code class="sig-name descname">T_eff</code><span class="sig-paren">(</span><em class="sig-param">Teff=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.T_eff" title="Permalink to this definition">¶</a></dt>
<dd><p>Get Teff for climate run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>T_eff</strong> (<em>float</em>) – (Optional) Effective temperature of Planet</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.add_pt">
<code class="sig-name descname">add_pt</code><span class="sig-paren">(</span><em class="sig-param">T</em>, <em class="sig-param">P</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.add_pt" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds temperature pressure profile to atmosphere
:param T: Temperature Array
:type T: array
:param P: Pressure Array
:type P: array
:param nlevel: # of atmospheric levels
:type nlevel: int</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>T</strong> (<em>numpy.array</em>) – Temperature grid</p></li>
<li><p><strong>P</strong> (<em>numpy.array</em>) – Pressure grid</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">approx</code><span class="sig-paren">(</span><em class="sig-param">single_phase='TTHG_ray', multi_phase='N=2', delta_eddington=True, raman='none', tthg_frac=[1, -1, 2], tthg_back=-0.5, tthg_forward=1, p_reference=1, rt_method='toon', stream=2, blackbody_approx=1, toon_coefficients='quadrature', single_form='explicit', query='nearest_neighbor', w_single_form='TTHG', w_multi_form='TTHG', psingle_form='TTHG', w_single_rayleigh='on', w_multi_rayleigh='on', psingle_rayleigh='on'</em><span class="sig-paren">)</span></dt>
<dd><p>This function sets all the default approximations in the code. It transforms the string specificatons
into a number so that they can be used in numba nopython routines.</p>
<p>For <cite>str</cite> cases such as <cite>TTHG_ray</cite> users see all the options by using the function <cite>single_phase_options</cite>
or <cite>multi_phase_options</cite>, etc.</p>
<dl class="simple">
<dt>single_phase<span class="classifier">str</span></dt><dd><p>Single scattering phase function approximation</p>
</dd>
<dt>multi_phase<span class="classifier">str</span></dt><dd><p>Multiple scattering phase function approximation</p>
</dd>
<dt>delta_eddington<span class="classifier">bool</span></dt><dd><p>Turns delta-eddington on and off</p>
</dd>
<dt>raman<span class="classifier">str</span></dt><dd><p>Uses various versions of raman scattering</p>
</dd>
<dt>tthg_frac<span class="classifier">list</span></dt><dd><p>Functional of forward to back scattering with the form of polynomial :
tthg_frac[0] + tthg_frac[1]*g_b^tthg_frac[2]
See eqn. 6 in picaso paper</p>
</dd>
<dt>tthg_back<span class="classifier">float</span></dt><dd><p>Back scattering asymmetry factor gf = g_bar*tthg_back</p>
</dd>
<dt>tthg_forward<span class="classifier">float</span></dt><dd><p>Forward scattering asymmetry factor gb = g_bar * tthg_forward</p>
</dd>
<dt>p_reference<span class="classifier">float</span></dt><dd><p>Reference pressure (bars) This is an arbitrary pressure that
corresponds do the user’s input of radius. Usually something “at depth”
around 1-10 bars.</p>
</dd>
<dt>method<span class="classifier">str</span></dt><dd><p>Toon (‘toon’) or spherical harmonics (‘SH’).</p>
</dd>
<dt>stream<span class="classifier">int</span></dt><dd><p>Two stream or four stream (options are 2 or 4). For 4 stream need to set method=’SH’</p>
</dd>
<dt>toon_coefficients: str</dt><dd><p>Decide whether to use Quadrature (“quadrature”) or Eddington (“eddington”) schemes
to define Toon coefficients in two-stream approximation (see Table 1 in Toon et al 1989)</p>
</dd>
<dt>blackbody_approx<span class="classifier">int</span></dt><dd><p>blackbody_approx=1 does a linear blackbody approx (eqn 26 toon 89),
while blackbody_approx=2 does an exponential (only an option for SH)</p>
</dd>
<dt>single_form<span class="classifier">str</span></dt><dd><p>form of the phase function can either be written as an ‘explicit’ henyey greinstein
or it can be written as a ‘legendre’ expansion. Default is ‘explicit’</p>
</dd>
<dt>query<span class="classifier">str</span></dt><dd><p>method to grab opacities. either “nearest_neighbor” or “interp” which
interpolates based on 4 nearest neighbors. Default is nearest_neighbor
which is significantly faster.</p>
</dd>
<dt>w_single_form<span class="classifier">str</span></dt><dd><p>Single scattering phase function approximation for SH</p>
</dd>
<dt>w_multi_form<span class="classifier">str</span></dt><dd><p>Multiple scattering phase function approximation for SH</p>
</dd>
<dt>psingle_form<span class="classifier">str</span></dt><dd><p>Scattering phase function approximation for psingle in SH</p>
</dd>
<dt>w_single_rayleigh<span class="classifier">str</span></dt><dd><p>Toggle rayleigh scattering on/off for single scattering in SH</p>
</dd>
<dt>w_multi_rayleigh<span class="classifier">str</span></dt><dd><p>Toggle rayleigh scattering on/off for multi scattering in SH</p>
</dd>
<dt>psingle_rayleigh<span class="classifier">str</span></dt><dd><p>Toggle rayleigh scattering on/off for psingle in SH</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">atmosphere</code><span class="sig-paren">(</span><em class="sig-param">df=None</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">exclude_mol=None</em>, <em class="sig-param">verbose=True</em>, <em class="sig-param">**pd_kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Builds a dataframe and makes sure that minimum necessary parameters have been suplied.
Sets number of layers in model.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pandas.DataFrame</em><em> or </em><em>dict</em>) – (Optional) Dataframe with volume mixing ratios and pressure, temperature profile.
Must contain pressure (bars) at least one molecule</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – (Optional) Filename with pressure, temperature and volume mixing ratios.
Must contain pressure at least one molecule</p></li>
<li><p><strong>exclude_mol</strong> (<em>list of str</em>) – (Optional) List of molecules to ignore from opacity. It will NOT
change other aspects of the calculation like mean molecular weight.
This should be used as exploratory ONLY. if you actually want to remove
the contribution of a molecule entirely from your profile you should remove
it from your input data frame.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – (Optional) prints out warnings. Default set to True</p></li>
<li><p><strong>pd_kwargs</strong> (<em>kwargs</em>) – Key word arguments for pd.read_csv to read in supplied atmosphere file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.atmosphere_3d">
<code class="sig-name descname">atmosphere_3d</code><span class="sig-paren">(</span><em class="sig-param">ds</em>, <em class="sig-param">regrid=True</em>, <em class="sig-param">plot=True</em>, <em class="sig-param">iz_plot=0</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.atmosphere_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks your xarray input to make sure the necessary elements are included. If
requested, it will regrid your output according to what you have specified in
phase_angle() routine. If you have not requested a regrid, it will check to make
sure that the latitude/longitude grid that you have specified in your xarray
is the same one that you have set in the phase_angle() routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>xarray.DataArray</em>) – xarray input grid (see GCM 3D input tutorials)</p></li>
<li><p><strong>regrid</strong> (<em>bool</em>) – If True, this will auto regrid your data, based on the input to the
phase_angle function you have supllied
If False, it will skip regridding. However, this assumes that you have already
regridded your data to the necessary gangles and tangles. PICASO will double check
for you by comparing latitude/longitudes of what is in your xarray to what was computed
in the phase_angle function.</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – If True, this will auto output a regridded plot</p></li>
<li><p><strong>iz_plot</strong> (<em>int</em>) – Altitude index to plot if it is requested</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, this will plot out messages, letting you know if your input data is being transformed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.atmosphere_4d">
<code class="sig-name descname">atmosphere_4d</code><span class="sig-paren">(</span><em class="sig-param">ds=None</em>, <em class="sig-param">shift=None</em>, <em class="sig-param">plot=True</em>, <em class="sig-param">iz_plot=0</em>, <em class="sig-param">verbose=True</em>, <em class="sig-param">zero_point='night_transit'</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.atmosphere_4d" title="Permalink to this definition">¶</a></dt>
<dd><p>Regrids xarray</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>xarray.DataArray</em>) – xarray input grid (see GCM 3D input tutorials)
Only optional if you have already defined your dataframe to
self.inputs[‘atmosphere’][‘profile’]</p></li>
<li><p><strong>shift</strong> (<em>array</em>) – Degrees, for each orbital <cite>phase</cite>, <cite>picaso</cite> will rotate the longitude grid <cite>phase_i`+`shift_i</cite>.
For example, for tidally locked planets, <cite>shift`=0 at all phase angles.
Therefore, `shift</cite> must be input as an array of length <cite>n_phase</cite>, set by phase_angle() routine.
Use plot=True to understand how your grid is being shifted.</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – If True, this will auto output a regridded plot</p></li>
<li><p><strong>iz_plot</strong> (<em>bool</em>) – pressure index to plot</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, this will plot out messages, letting you know if your input data is being transformed</p></li>
<li><p><strong>zero_point</strong> (<em>str</em>) – Is your zero point “night_transit”, or “secondary_eclipse”
Default, “night_transit”</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.channon_grid_high">
<code class="sig-name descname">channon_grid_high</code><span class="sig-paren">(</span><em class="sig-param">filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.channon_grid_high" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.channon_grid_low">
<code class="sig-name descname">channon_grid_low</code><span class="sig-paren">(</span><em class="sig-param">filename=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.channon_grid_low" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolate from visscher grid</p>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.chem_interp">
<code class="sig-name descname">chem_interp</code><span class="sig-paren">(</span><em class="sig-param">chem_grid</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.chem_interp" title="Permalink to this definition">¶</a></dt>
<dd><p>Interpolates chemistry based on dataframe input of either 1460 or 1060 grid
This particular function needs to have all molecules as columns as well as
pressure and temperature</p>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.chemeq_3d">
<code class="sig-name descname">chemeq_3d</code><span class="sig-paren">(</span><em class="sig-param">c_o=1.0</em>, <em class="sig-param">log_mh=0.0</em>, <em class="sig-param">n_cpu=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.chemeq_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>You must have already ran atmosphere_3d or pre-defined an xarray gcm
before running this function.</p>
<p>This function will post-process sonora chemical equillibrium
chemistry onto your 3D grid.</p>
<p>CURRENT options
log m/h: 0.0, 0.5, 1.0, 1.5, 1.7, 2.0
C/O: 0.5X, 1.0X, 1.5X, 2.0X, 2.5X</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_o</strong> (<em>float</em><em>,</em><em>optional</em>) – default = 1 (solar), options= 0.5X, 1.0X, 1.5X, 2.0X, 2.5X</p></li>
<li><p><strong>log_mh</strong> (<em>float</em><em>, </em><em>optional</em>) – default = 0 (solar), options = 0.0, 0.5, 1.0, 1.5, 1.7, 2.0</p></li>
<li><p><strong>n_cpu</strong> (<em>int</em>) – Number of cpu to use for parallelization of chemistry</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.chemeq_deprecate">
<code class="sig-name descname">chemeq_deprecate</code><span class="sig-paren">(</span><em class="sig-param">CtoO</em>, <em class="sig-param">Met</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.chemeq_deprecate" title="Permalink to this definition">¶</a></dt>
<dd><p>This interpolates from a precomputed grid of CEA runs (run by M.R. Line)
:param CtoO: C to O ratio (solar = 0.55)
:type CtoO: float
:param Met: Metallicity relative to solar (solar = 1)
:type Met: float</p>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.chemeq_visscher">
<code class="sig-name descname">chemeq_visscher</code><span class="sig-paren">(</span><em class="sig-param">c_o</em>, <em class="sig-param">log_mh</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.chemeq_visscher" title="Permalink to this definition">¶</a></dt>
<dd><p>Find nearest neighbor from visscher grid
JUNE 2015
MODELS BASED ON 1060-POINT MARLEY GRID
GRAPHITE ACTIVITY ADDED IN TEXT FILES (AFTER OCS)
“ABUNDANCE” INDICATES CONDENSATION CONDITION (O OR 1)
CURRENT GRID
FE/H: 0.0, 0.5, 1.0, 1.5, 1.7, 2.0
C/O: 0.5X, 1.0X, 1.5X, 2.0X, 2.5X
C/O RATIO IS RELATIVE TO SOLAR C/O RATIO OF
CARBON = 7.19E6 ATOMS
OXYGEN = 1.57E7 ATOMS
NOTE THAT THE C/O RATIO IS ADJUSTED BY SIMPLY MULTIPLYING BY C/O FACTOR
THIS MAY YIELD EFFECTIVE METALLICITIES SLIGHTLY HIGHER THAN THE DEFINED METALLICITY</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>co</strong> (<em>int</em>) – carbon to oxygen ratio relative to solar.
Solar = 1</p></li>
<li><p><strong>log_mh</strong> (<em>int</em>) – metallicity (relative to solar)
Will find the nearest value to 0.0, 0.5, 1.0, 1.5, 1.7, 2.0
Solar = 0</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.climate">
<code class="sig-name descname">climate</code><span class="sig-paren">(</span><em class="sig-param">opacityclass</em>, <em class="sig-param">save_all_profiles=False</em>, <em class="sig-param">as_dict=True</em>, <em class="sig-param">with_spec=False</em>, <em class="sig-param">save_all_kzz=False</em>, <em class="sig-param">diseq_chem=False</em>, <em class="sig-param">self_consistent_kzz=False</em>, <em class="sig-param">kz=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.climate" title="Permalink to this definition">¶</a></dt>
<dd><p>Top Function to run the Climate Model</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opacityclass</strong> (<em>class</em>) – Opacity class from <cite>justdoit.opannection</cite></p></li>
<li><p><strong>save_all_profiles</strong> (<em>bool</em>) – If you want to save and return all iterations in the T(P) profile,True/False</p></li>
<li><p><strong>with_spec</strong> (<em>bool</em>) – Runs picaso spectrum at the end to get the full converged outputs, Default=False</p></li>
<li><p><strong>save_all_kzz</strong> (<em>bool</em>) – If you want to save and return all iterations in the kzz profile,True/False</p></li>
<li><p><strong>diseq_chem</strong> (<em>bool</em>) – If you want to run <a href="#id7"><span class="problematic" id="id8">`</span></a>on-the-fly’ mixing (takes longer),True/False</p></li>
<li><p><strong>self_consistent_kzz</strong> (<em>bool</em>) – If you want to run MLT in convective zones and Moses in the radiative zones</p></li>
<li><p><strong>kz</strong> (<em>array</em>) – Kzz input array if user wants constant or whatever input profile (cgs)</p></li>
<li><p><strong>vulcan_run</strong> (<em>bool</em>) – (beta, contact developers)If you want to run vulcan on the fly (takes longer),True/False</p></li>
<li><p><strong>photochem</strong> (<em>bool</em>) – (beta, contact developers)If you want to run photochemistry in vulcan on the fly (takes much longer),True/False</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">clouds</code><span class="sig-paren">(</span><em class="sig-param">filename=None</em>, <em class="sig-param">g0=None</em>, <em class="sig-param">w0=None</em>, <em class="sig-param">opd=None</em>, <em class="sig-param">p=None</em>, <em class="sig-param">dp=None</em>, <em class="sig-param">df=None</em>, <em class="sig-param">**pd_kwargs</em><span class="sig-paren">)</span></dt>
<dd><p>Cloud specification for the model. Clouds are parameterized by a single scattering albedo (w0),
an assymetry parameter (g0), and a total extinction per layer (opd).
g0,w0, and opd are both wavelength and pressure dependent. Our cloud models come
from eddysed. Their output look something like this where
pressure is in bars and wavenumber is inverse cm. We will sort pressure and wavenumber before we reshape
so the exact order doesn’t matter
pressure wavenumber opd w0 g0
1.   1.   … . .
1.   2.   … . .
1.   3.   … . .
.     . … . .
.     . … . .
1.   M.   … . .
2.   1.   … . .
.     . … . .
N.   .  … . .
If you are creating your own file you have to make sure that you have a
<strong>pressure</strong> (bars) and <a href="#id9"><span class="problematic" id="id10">**</span></a>wavenumber**(inverse cm) column. We will use this to make sure that your cloud
and atmospheric profiles are on the same grid. <a href="#id11"><span class="problematic" id="id12">**</span></a>If there is no pressure or wavelength parameter
we will assume that you are on the same grid as your atmospheric input, and on the
eddysed wavelength grid! **
Users can also input their own fixed cloud parameters, by specifying a single value
for g0,w0,opd and defining the thickness and location of the cloud.
:param filename: (Optional) Filename with info on the wavelength and pressure-dependent single scattering</p>
<blockquote>
<div><p>albedo, asymmetry factor, and total extinction per layer. Input associated pd_kwargs
so that the resultant output has columns named : <cite>g0</cite>, <cite>w0</cite> and <cite>opd</cite>. If you are not
using the eddysed output, you will also need a <cite>wavenumber</cite> and <cite>pressure</cite> column in units
of inverse cm, and bars.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>g0</strong> (<em>float</em><em>, </em><em>list of float</em>) – (Optional) Asymmetry factor. Can be a single float for a single cloud. Or a list of floats
for two different cloud layers</p></li>
<li><p><strong>w0</strong> (<em>list of float</em>) – (Optional) Single Scattering Albedo. Can be a single float for a single cloud. Or a list of floats
for two different cloud layers</p></li>
<li><p><strong>opd</strong> (<em>list of float</em>) – (Optional) Total Extinction in <cite>dp</cite>. Can be a single float for a single cloud. Or a list of floats
for two different cloud layers</p></li>
<li><p><strong>p</strong> (<em>list of float</em>) – (Optional) Bottom location of cloud deck (LOG10 bars). Can be a single float for a single cloud. Or a list of floats
for two different cloud layers</p></li>
<li><p><strong>dp</strong> (<em>list of float</em>) – (Optional) Total thickness cloud deck above p (LOG10 bars).
Can be a single float for a single cloud or a list of floats
for two different cloud layers
Cloud will span 10**(np.log10(p-dp))</p></li>
<li><p><strong>df</strong> (<em>pd.DataFrame</em><em>, </em><em>dict</em>) – (Optional) Same as what would be included in the file, but in DataFrame or dict form</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.clouds_3d">
<code class="sig-name descname">clouds_3d</code><span class="sig-paren">(</span><em class="sig-param">ds</em>, <em class="sig-param">regrid=True</em>, <em class="sig-param">plot=True</em>, <em class="sig-param">iz_plot=0</em>, <em class="sig-param">iw_plot=0</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.clouds_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Checks your cloud xarray input to make sure the necessary elements are included. If
requested, it will regrid your output according to what you have specified in
phase_angle() routine. If you have not requested a regrid, it will check to make
sure that the latitude/longitude grid that you have specified in your xarray
is the same one that you have set in the phase_angle() routine.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>xarray.DataArray</em>) – xarray input grid (see cloud GCM 3D input tutorials)</p></li>
<li><p><strong>regrid</strong> (<em>bool</em>) – If True, this will auto regrid your data, based on the input to the
phase_angle function you have supllied
If False, it will skip regridding. However, this assumes that you have already
regridded your data to the necessary gangles and tangles. PICASO will double check
for you by comparing latitude/longitudes of what is in your xarray to what was computed
in the phase_angle function.</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – If True, this will auto output a regridded plot</p></li>
<li><p><strong>iz_plot</strong> (<em>int</em>) – Altitude index to plot if a plot is requested</p></li>
<li><p><strong>iw_plot</strong> (<em>int</em>) – Wavelength index to plot if plot is requested</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, this will plot out messages, letting you know if your input data is being transformed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.clouds_4d">
<code class="sig-name descname">clouds_4d</code><span class="sig-paren">(</span><em class="sig-param">ds=None</em>, <em class="sig-param">plot=True</em>, <em class="sig-param">iz_plot=0</em>, <em class="sig-param">iw_plot=0</em>, <em class="sig-param">verbose=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.clouds_4d" title="Permalink to this definition">¶</a></dt>
<dd><p>Regrids xarray</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds</strong> (<em>xarray.DataArray</em>) – xarray input grid (see GCM 3D input tutorials)
Only optional if you have already defined your dataframe to
self.inputs[‘clouds’][‘profile’]</p></li>
<li><p><strong>plot</strong> (<em>bool</em>) – If True, this will auto output a regridded plot</p></li>
<li><p><strong>iz_plot</strong> (<em>bool</em>) – pressure index to plot</p></li>
<li><p><strong>iw_plot</strong> (<em>bool</em>) – wavelength index to plot</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – If True, this will plot out messages, letting you know if your input data is being transformed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.clouds_reset">
<code class="sig-name descname">clouds_reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.clouds_reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset cloud dict to zeros</p>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.effective_temp">
<code class="sig-name descname">effective_temp</code><span class="sig-paren">(</span><em class="sig-param">teff=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.effective_temp" title="Permalink to this definition">¶</a></dt>
<dd><p>Same as T_eff with different notation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>teff</strong> (<em>float</em>) – (Optional) Effective temperature of Planet</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">gravity</code><span class="sig-paren">(</span><em class="sig-param">gravity=None</em>, <em class="sig-param">gravity_unit=None</em>, <em class="sig-param">radius=None</em>, <em class="sig-param">radius_unit=None</em>, <em class="sig-param">mass=None</em>, <em class="sig-param">mass_unit=None</em><span class="sig-paren">)</span></dt>
<dd><p>Get gravity based on mass and radius, or gravity inputs</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gravity</strong> (<em>float</em>) – (Optional) Gravity of planet</p></li>
<li><p><strong>gravity_unit</strong> (<em>astropy.unit</em>) – (Optional) Unit of Gravity</p></li>
<li><p><strong>radius</strong> (<em>float</em>) – (Optional) radius of planet MUST be specified for thermal emission!</p></li>
<li><p><strong>radius_unit</strong> (<em>astropy.unit</em>) – (Optional) Unit of radius</p></li>
<li><p><strong>mass</strong> (<em>float</em>) – (Optional) mass of planet</p></li>
<li><p><strong>mass_unit</strong> (<em>astropy.unit</em>) – (Optional) Unit of mass</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.guillot_pt">
<code class="sig-name descname">guillot_pt</code><span class="sig-paren">(</span><em class="sig-param">Teq</em>, <em class="sig-param">T_int=100</em>, <em class="sig-param">logg1=-1</em>, <em class="sig-param">logKir=-1.5</em>, <em class="sig-param">alpha=0.5</em>, <em class="sig-param">nlevel=61</em>, <em class="sig-param">p_bottom=1.5</em>, <em class="sig-param">p_top=-6</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.guillot_pt" title="Permalink to this definition">¶</a></dt>
<dd><p>Creates temperature pressure profile given parameterization in Guillot 2010 TP profile
called in fx()
:param Teq: equilibrium temperature
:type Teq: float
:param T_int: Internal temperature, if low (100) currently set to 100 for everything
:type T_int: float
:param kv1: see parameterization Guillot 2010 (10.**(logg1+logKir))
:type kv1: float
:param kv2: see parameterization Guillot 2010 (10.**(logg1+logKir))
:type kv2: float
:param kth: see parameterization Guillot 2010 (10.**logKir)
:type kth: float
:param alpha: set to 0.5
:type alpha: float , optional
:param nlevel: Number of atmospheric layers
:type nlevel: int, optional
:param p_bottom: Log pressure (bars) of the lower bound pressure
:type p_bottom: float, optional
:param p_top: Log pressure (bars) of the TOA
:type p_top: float , optional</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p><strong>T</strong> (<em>numpy.array</em>) – Temperature grid</p></li>
<li><p><strong>P</strong> (<em>numpy.array</em>) – Pressure grid</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.inputs_climate">
<code class="sig-name descname">inputs_climate</code><span class="sig-paren">(</span><em class="sig-param">temp_guess=None</em>, <em class="sig-param">pressure=None</em>, <em class="sig-param">rfaci=1</em>, <em class="sig-param">nofczns=1</em>, <em class="sig-param">nstr=None</em>, <em class="sig-param">rfacv=None</em>, <em class="sig-param">cloudy=False</em>, <em class="sig-param">mh=None</em>, <em class="sig-param">CtoO=None</em>, <em class="sig-param">species=None</em>, <em class="sig-param">fsed=None</em>, <em class="sig-param">T_star=None</em>, <em class="sig-param">logg=None</em>, <em class="sig-param">metal=None</em>, <em class="sig-param">r_star=None</em>, <em class="sig-param">semi_major=None</em>, <em class="sig-param">r_planet=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.inputs_climate" title="Permalink to this definition">¶</a></dt>
<dd><p>Get Inputs for Climate run</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>temp_guess</strong> (<em>array</em>) – Guess T(P) profile to begin with</p></li>
<li><p><strong>pressure</strong> (<em>array</em>) – Pressure Grid for climate code (this wont change on the fly)</p></li>
<li><p><strong>nstr</strong> (<em>array</em>) – NSTR vector describes state of the atmosphere:
0   is top layer [0]
1   is top layer of top convective region
2   is bottom layer of top convective region
3   is top layer of lower radiative region
4   is top layer of lower convective region
5   is bottom layer of lower convective region [nlayer-1]</p></li>
<li><p><strong>nofczns</strong> (<em>integer</em>) – Number of guessed Convective Zones. 1 or 2</p></li>
<li><p><strong>rfacv</strong> (<em>float</em>) – Fractional contribution of reflected light in net flux.
=0 for no stellar irradition,
=0.5 for full day-night heat redistribution
=1 for dayside</p></li>
<li><p><strong>rfaci</strong> (<em>float</em>) – Default=1, Fractional contribution of thermal light in net flux
Usually this is kept at one and then the redistribution is controlled
via rfacv</p></li>
<li><p><strong>cloudy</strong> (<em>bool</em>) – Include Clouds or not (True or False)</p></li>
<li><p><strong>mh</strong> (<em>string</em>) – Metallicity string for 1060 grid, ‘+0.5’,’0.0’,’-0.5’.</p></li>
<li><p><strong>CtoO</strong> (<em>string</em>) – C/O ratio string for 1060 grid</p></li>
<li><p><strong>species</strong> (<em>string</em>) – Cloud species to be included if cloudy</p></li>
<li><p><strong>fsed</strong> (<em>float</em>) – Sedimentation Efficiency (f_sed) if cloudy</p></li>
<li><p><strong>T_star</strong> (<em>float</em>) – Star effective temperature if irradiated</p></li>
<li><p><strong>logg</strong> (<em>float</em>) – Star log(g)</p></li>
<li><p><strong>metal</strong> (<em>float</em>) – Star Metallicity</p></li>
<li><p><strong>r_star</strong> (<em>float</em>) – Stellar Radius in R_sun</p></li>
<li><p><strong>semi_major</strong> (<em>float</em>) – Semi-major axis of Planet (AU)</p></li>
<li><p><strong>r_planet</strong> (<em>planet radius</em>) – Radius of Planet (Rj)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.old_run_climate_model">
<code class="sig-name descname">old_run_climate_model</code><span class="sig-paren">(</span><em class="sig-param">opacityclass</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.old_run_climate_model" title="Permalink to this definition">¶</a></dt>
<dd><p>Top Function to run the Climate Model</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">phase_angle</code><span class="sig-paren">(</span><em class="sig-param">phase=0</em>, <em class="sig-param">num_gangle=10</em>, <em class="sig-param">num_tangle=1</em>, <em class="sig-param">symmetry=False</em>, <em class="sig-param">phase_grid=None</em>, <em class="sig-param">calculation=None</em><span class="sig-paren">)</span></dt>
<dd><p>Define phase angle and number of gauss and tchebychev angles to compute.
Controls all geometry of the calculation. Computes latitude and longitudes.
Computes cos theta and incoming and outgoing angles. Adds everything to class.</p>
<p>Please see geometry notebook for a deep dive into how these angles are incorporated
into the calculation.</p>
<p>Typical numbers:
- 1D Thermal: num_gangle = 10, num_tangle=1
- 1D Reflected light with zero phase : num_gangle = 10, num_tangle=1
- 1D Reflected light with non zero phase : num_gangle = 8, num_tangle=8
- 3D Thermal or Reflected : angles will depend on 3D features interested in resolving.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>float</em><em>,</em><em>int</em>) – Phase angle in radians</p></li>
<li><p><strong>num_gangle</strong> (<em>int</em>) – Number of Gauss angles to integrate over facets (Default is 10). This
is defined as angles over the full sphere. So 10 as the default compute the RT
with 5 points on the west hemisphere and 5 points on the west.
Higher numbers will slow down code.</p></li>
<li><p><strong>num_tangle</strong> (<em>int</em>) – Number of Tchebyshev angles to integrate over facets (Default is 1, which automatically
assumes symmetry).
Must be even if considering symmetry.</p></li>
<li><p><strong>symmetry</strong> (<em>bool</em>) – Default is False. Note, if num_tangle=1 you are automatically considering symmetry.
This will only compute the unique incoming angles so that the calculation
isn’t doing repetetive models. E.g. if num_tangles=10, num_gangles=10. Instead of running a 10x10=100
FT calculations, it will only run 5x5 = 25 (or a quarter of the sphere).</p></li>
<li><p><strong>phase_grid</strong> (<em>array</em>) – This is ONLY for computing phase curves and ONLY can be used</p></li>
<li><p><strong>calculation</strong> (<em>str</em>) – Used for phase curve calculation. Needs to be specified in order
to determine integrable angles correctly.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.phase_curve">
<code class="sig-name descname">phase_curve</code><span class="sig-paren">(</span><em class="sig-param">opacityclass</em>, <em class="sig-param">full_output=False</em>, <em class="sig-param">plot_opacity=False</em>, <em class="sig-param">n_cpu=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.phase_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Run phase curve
:param opacityclass: Opacity class from <cite>justdoit.opannection</cite>
:type opacityclass: class
:param full_output: (Optional) Default = False. Returns atmosphere class, which enables several</p>
<blockquote>
<div><p>plotting capabilities.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>n_cpu</strong> (<em>int</em>) – (Optional) Default = 1 (no parallelization). Number of cpu to parallelize calculation.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.phase_curve_geometry">
<code class="sig-name descname">phase_curve_geometry</code><span class="sig-paren">(</span><em class="sig-param">calculation</em>, <em class="sig-param">phase_grid</em>, <em class="sig-param">num_gangle=10</em>, <em class="sig-param">num_tangle=10</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.phase_curve_geometry" title="Permalink to this definition">¶</a></dt>
<dd><p>Geometry setup for phase curve calculation. This computes all the
necessary</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>calculation</strong> (<em>str</em>) – ‘reflected’ or ‘thermal’</p></li>
<li><p><strong>phase_grid</strong> (<em>float</em>) – phase angle grid to compute phase curve in radians</p></li>
<li><p><strong>num_gangle</strong> (<em>int</em>) – number of gauss angles, equivalent to longitude</p></li>
<li><p><strong>num_tangle</strong> (<em>int</em>) – number of tchebychev angles, equivalent to latitude</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.premix_3d">
<code class="sig-name descname">premix_3d</code><span class="sig-paren">(</span><em class="sig-param">opa</em>, <em class="sig-param">n_cpu=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.premix_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>You must have already ran atmosphere_3d or pre-defined an xarray gcm
before running this function.</p>
<p>This function will post-process sonora chemical equillibrium
chemistry onto your 3D grid.</p>
<p>CURRENT options
log m/h: 0.0, 0.5, 1.0, 1.5, 1.7, 2.0
C/O: 0.5X, 1.0X, 1.5X, 2.0X, 2.5X</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>c_o</strong> (<em>float</em><em>,</em><em>optional</em>) – default = 1 (solar), options= 0.5X, 1.0X, 1.5X, 2.0X, 2.5X</p></li>
<li><p><strong>log_mh</strong> (<em>float</em><em>, </em><em>optional</em>) – default = 0 (solar), options = 0.0, 0.5, 1.0, 1.5, 1.7, 2.0</p></li>
<li><p><strong>n_cpu</strong> (<em>int</em>) – Number of cpu to use for parallelization of chemistry</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.premix_atmosphere">
<code class="sig-name descname">premix_atmosphere</code><span class="sig-paren">(</span><em class="sig-param">opa</em>, <em class="sig-param">df=None</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">**pd_kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.premix_atmosphere" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a dataframe and makes sure that minimum necessary parameters have been suplied.
Sets number of layers in model.
:param opa: Opacity class from opannection : RetrieveCks()
:type opa: class
:param df: (Optional) Dataframe with volume mixing ratios and pressure, temperature profile.</p>
<blockquote>
<div><p>Must contain pressure (bars) at least one molecule</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – (Optional) Filename with pressure, temperature and volume mixing ratios.
Must contain pressure at least one molecule</p></li>
<li><p><strong>exclude_mol</strong> (<em>list of str</em>) – (Optional) List of molecules to ignore from file</p></li>
<li><p><strong>pd_kwargs</strong> (<em>kwargs</em>) – Key word arguments for pd.read_csv to read in supplied atmosphere file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.premix_atmosphere_diseq">
<code class="sig-name descname">premix_atmosphere_diseq</code><span class="sig-paren">(</span><em class="sig-param">opa</em>, <em class="sig-param">quench_levels</em>, <em class="sig-param">t_mix=None</em>, <em class="sig-param">df=None</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">**pd_kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.premix_atmosphere_diseq" title="Permalink to this definition">¶</a></dt>
<dd><p>Builds a dataframe and makes sure that minimum necessary parameters have been suplied.
Sets number of layers in model.
:param opa: Opacity class from opannection : RetrieveCks()
:type opa: class
:param df: (Optional) Dataframe with volume mixing ratios and pressure, temperature profile.</p>
<blockquote>
<div><p>Must contain pressure (bars) at least one molecule</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>filename</strong> (<em>str</em>) – (Optional) Filename with pressure, temperature and volume mixing ratios.
Must contain pressure at least one molecule</p></li>
<li><p><strong>exclude_mol</strong> (<em>list of str</em>) – (Optional) List of molecules to ignore from file</p></li>
<li><p><strong>pd_kwargs</strong> (<em>kwargs</em>) – Key word arguments for pd.read_csv to read in supplied atmosphere file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.run_vulcan">
<code class="sig-name descname">run_vulcan</code><span class="sig-paren">(</span><em class="sig-param">pressure</em>, <em class="sig-param">temp</em>, <em class="sig-param">kz</em>, <em class="sig-param">grav</em>, <em class="sig-param">mmw</em>, <em class="sig-param">T_star=None</em>, <em class="sig-param">logg=None</em>, <em class="sig-param">metal=None</em>, <em class="sig-param">r_star=None</em>, <em class="sig-param">semi_major=None</em>, <em class="sig-param">r_planet=None</em>, <em class="sig-param">first=False</em>, <em class="sig-param">photochem=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.run_vulcan" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.setup_climate">
<code class="sig-name descname">setup_climate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.setup_climate" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns off planet specific things, so program can run as usual</p>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.setup_nostar">
<code class="sig-name descname">setup_nostar</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.setup_nostar" title="Permalink to this definition">¶</a></dt>
<dd><p>Turns off planet specific things, so program can run as usual</p>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.sonora">
<code class="sig-name descname">sonora</code><span class="sig-paren">(</span><em class="sig-param">sonora_path</em>, <em class="sig-param">teff</em>, <em class="sig-param">chem='low'</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.sonora" title="Permalink to this definition">¶</a></dt>
<dd><p>This queries Sonora temperature profile that can be downloaded from profiles.tar on
Zenodo: [profile.tar file](<a class="reference external" href="https://zenodo.org/record/1309035#.Xo5GbZNKjGJ">https://zenodo.org/record/1309035#.Xo5GbZNKjGJ</a>)</p>
<p>Alterntiavely you can grab the sonora bobcat models here:
<a class="reference external" href="https://zenodo.org/record/5063476/files/structures_m%2B0.0.tar.gz?download=1">https://zenodo.org/record/5063476/files/structures_m%2B0.0.tar.gz?download=1</a></p>
<p>Note gravity is not an input because it grabs gravity from self.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sonora_path</strong> (<em>str</em>) – Path to the untarred profile.tar file from sonora grid</p></li>
<li><p><strong>teff</strong> (<em>float</em>) – teff to query. does not have to be exact (it will query one the nearest neighbor)</p></li>
<li><p><strong>chem</strong> (<em>str</em>) – Default = ‘low’. There are two sonora chemistry grids. the default is use low.
There is sublety to this that is going to be explained at length in the sonora grid paper.
Until then, ONLY use chem=’low’ unless you have reached out to one of the developers.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">spectrum</code><span class="sig-paren">(</span><em class="sig-param">opacityclass</em>, <em class="sig-param">calculation='reflected'</em>, <em class="sig-param">dimension='1d'</em>, <em class="sig-param">full_output=False</em>, <em class="sig-param">plot_opacity=False</em>, <em class="sig-param">as_dict=True</em><span class="sig-paren">)</span></dt>
<dd><p>Run Spectrum
:param opacityclass: Opacity class from <cite>justdoit.opannection</cite>
:type opacityclass: class
:param calculation: Either ‘reflected’ or ‘thermal’ for reflected light or thermal emission.</p>
<blockquote>
<div><p>If running a brown dwarf, this will automatically default to thermal</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dimension</strong> (<em>str</em>) – (Optional) Dimensions of the calculation. Default = ‘1d’. But ‘3d’ is also accepted.
In order to run ‘3d’ calculations, user must build 3d input (see tutorials)</p></li>
<li><p><strong>full_output</strong> (<em>bool</em>) – (Optional) Default = False. Returns atmosphere class, which enables several
plotting capabilities.</p></li>
<li><p><strong>plot_opacity</strong> (<em>bool</em>) – (Optional) Default = False, Creates pop up of the weighted opacity</p></li>
<li><p><strong>as_dict</strong> (<em>bool</em>) – (Optional) Default = True. If true, returns a condensed dictionary to the user.
If false, returns the atmosphere class, which can be used for debugging.
The class is clunky to navigate so if you are consiering navigating through this, ping one of the
developers.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">star</code><span class="sig-paren">(</span><em class="sig-param">opannection</em>, <em class="sig-param">temp=None</em>, <em class="sig-param">metal=None</em>, <em class="sig-param">logg=None</em>, <em class="sig-param">radius=None</em>, <em class="sig-param">radius_unit=None</em>, <em class="sig-param">semi_major=None</em>, <em class="sig-param">semi_major_unit=None</em>, <em class="sig-param">deq=False</em>, <em class="sig-param">database='ck04models'</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">w_unit=None</em>, <em class="sig-param">f_unit=None</em><span class="sig-paren">)</span></dt>
<dd><p>Get the stellar spectrum using pysynphot and interpolate onto a much finer grid than the
planet grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>opannection</strong> (<em>class picaso.RetrieveOpacities</em>) – This is the opacity class and it’s needed to get the correct wave info and raman scattering cross sections</p></li>
<li><p><strong>temp</strong> (<em>float</em>) – (Optional) Teff of the stellar model if using the stellar database feature.
Not needed for filename option.</p></li>
<li><p><strong>metal</strong> (<em>float</em>) – (Optional) Metallicity of the stellar model if using the stellar database feature.
Not needed for filename option.</p></li>
<li><p><strong>logg</strong> (<em>float</em>) – (Optional) Logg cgs of the stellar model if using the stellar database feature.
Not needed for filename option.</p></li>
<li><p><strong>radius</strong> (<em>float</em>) – (Optional) Radius of the star. Only needed as input if you want relative flux units (Fp/Fs)</p></li>
<li><p><strong>radius_unit</strong> (<em>astropy.unit</em>) – (Optional) Any astropy unit (e.g. <cite>radius_unit=astropy.unit.Unit(“R_sun”)</cite>)</p></li>
<li><p><strong>semi_major</strong> (<em>float</em>) – (Optional) Semi major axis of the planet. Only needed to compute fp/fs for albedo calculations.</p></li>
<li><p><strong>semi_major_unit</strong> (<em>astropy.unit</em>) – (Optional) Any astropy unit (e.g. <cite>radius_unit=astropy.unit.Unit(“au”)</cite>)</p></li>
<li><p><strong>database</strong> (<em>str</em>) – (Optional)The database to pull stellar spectrum from. See documentation for pysynphot.
Most popular are ‘ck04models’, phoenix’ and</p></li>
<li><p><strong>filename</strong> (<em>str</em>) – (Optional) Upload your own stellar spectrum. File format = two column white space (wave, flux).
Must specify w_unit and f_unit</p></li>
<li><p><strong>w_unit</strong> (<em>str</em>) – (Optional) Used for stellar file wave units. Needed for filename input.
Pick: ‘um’, ‘nm’, ‘cm’, ‘hz’, or ‘Angs’</p></li>
<li><p><strong>f_unit</strong> (<em>str</em>) – (Optional) Used for stellar file flux units. Needed for filename input.
Pick: ‘FLAM’ or ‘Jy’ or ‘erg/cm2/s/Hz’</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.surface_reflect">
<code class="sig-name descname">surface_reflect</code><span class="sig-paren">(</span><em class="sig-param">albedo</em>, <em class="sig-param">wavenumber</em>, <em class="sig-param">old_wavenumber=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.surface_reflect" title="Permalink to this definition">¶</a></dt>
<dd><p>Set atmospheric surface reflectivity. This preps the code to run a terrestrial
planet. This will automatically change the run to “hardsurface”, which alters
the lower boundary condition of the thermal_1d flux calculation.
:param albedo: Set constant albedo for surface reflectivity
:type albedo: float</p>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.virga">
<code class="sig-name descname">virga</code><span class="sig-paren">(</span><em class="sig-param">condensates</em>, <em class="sig-param">directory</em>, <em class="sig-param">fsed=1</em>, <em class="sig-param">b=1</em>, <em class="sig-param">eps=0.01</em>, <em class="sig-param">param='const'</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">mmw=2.2</em>, <em class="sig-param">kz_min=100000.0</em>, <em class="sig-param">sig=2</em>, <em class="sig-param">full_output=False</em>, <em class="sig-param">Teff=None</em>, <em class="sig-param">alpha_pressure=None</em>, <em class="sig-param">supsat=0</em>, <em class="sig-param">gas_mmr=None</em>, <em class="sig-param">do_virtual=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.virga" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs virga cloud code based on the PT and Kzz profiles
that have been added to inptus class.
:param condensates: Condensates to run in cloud model
:type condensates: str
:param fsed: Sedimentation efficiency coefficient
:type fsed: float
:param b: Denominator of exponential in sedimentation efficiency  (if param is ‘exp’)
:type b: float
:param eps: Minimum value of fsed function (if param=exp)
:type eps: float
:param param: fsed parameterisation</p>
<blockquote>
<div><p>‘const’ (constant), ‘exp’ (exponential density derivation), ‘pow’ (power-law)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mh</strong> (<em>float</em>) – Metallicity</p></li>
<li><p><strong>mmw</strong> (<em>float</em>) – Atmospheric mean molecular weight</p></li>
<li><p><strong>kz_min</strong> (<em>float</em>) – Minimum kzz value</p></li>
<li><p><strong>sig</strong> (<em>float</em>) – Width of the log normal distribution for the particle sizes</p></li>
<li><p><strong>Teff</strong> (<em>float</em><em>, </em><em>optional</em>) – Effective temperature. If None, Teff set to temperature at 1 bar</p></li>
<li><p><strong>alpha_pressure</strong> (<em>float</em><em>, </em><em>optional</em>) – Pressure at which we want fsed=alpha for variable fsed calculation.
If None, pressure set to the top of the atmosphere</p></li>
<li><p><strong>gas_mmr</strong> (<em>float</em><em>, </em><em>optional</em>) – Temporary option to set gas_mmr of single condensate (this needs updated)</p></li>
<li><p><strong>do_virtual</strong> (<em>bool</em>) – Turn on and off the “virtual” cloud which is a cloud that forms below
the pressure grid defined by the user.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.justdoit.inputs.virga_3d">
<code class="sig-name descname">virga_3d</code><span class="sig-paren">(</span><em class="sig-param">condensates</em>, <em class="sig-param">directory</em>, <em class="sig-param">fsed=1</em>, <em class="sig-param">mh=1</em>, <em class="sig-param">mmw=2.2</em>, <em class="sig-param">kz_min=100000.0</em>, <em class="sig-param">sig=2</em>, <em class="sig-param">full_output=False</em>, <em class="sig-param">n_cpu=1</em>, <em class="sig-param">verbose=True</em>, <em class="sig-param">smooth_kz=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.inputs.virga_3d" title="Permalink to this definition">¶</a></dt>
<dd><p>Runs virga cloud code based on the PT and Kzz profiles
that have been added to inptus class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>condensates</strong> (<em>str</em>) – Condensates to run in cloud model</p></li>
<li><p><strong>fsed</strong> (<em>float</em>) – Sedimentation efficiency</p></li>
<li><p><strong>mh</strong> (<em>float</em>) – Metallicity</p></li>
<li><p><strong>mmw</strong> (<em>float</em>) – Atmospheric mean molecular weight</p></li>
<li><p><strong>n_cpu</strong> (<em>int</em>) – number cpu to parallelize</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Print statements to help user</p></li>
<li><p><strong>smooth_kz</strong> (<em>bool</em>) – If true, it uses the min_kz value and does a UnivariateSpline
accross the kz values to smooth out the profile</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.jupiter_cld">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">jupiter_cld</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.jupiter_cld" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to get rough Jupiter Cloud model with fsed=3</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.jupiter_pt">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">jupiter_pt</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.jupiter_pt" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to get Jupiter’s PT profile</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.load_planet">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">load_planet</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">opacity</em>, <em class="sig-param">phase_angle=0</em>, <em class="sig-param">stellar_db='ck04models'</em>, <em class="sig-param">verbose=False</em>, <em class="sig-param">**planet_kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.load_planet" title="Permalink to this definition">¶</a></dt>
<dd><p>Wrapper to simplify PICASO run. This really turns picaso into a black box. This was created
specifically Sagan School tutorial. It grabs planet parameters from the user supplied df, then
adds a parametric PT profile (Guillot et al. 2010). The user still has to add chemistry.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – This is single row from <cite>all_planets()</cite></p></li>
<li><p><strong>opacity</strong> (<em>np.array</em>) – Opacity loaded from opannection</p></li>
<li><p><strong>phase_angle</strong> (<em>float</em>) – Observing phase angle (radians)</p></li>
<li><p><strong>stellar_db</strong> (<em>str</em>) – Stellar database to pull from. Default is ck04models but you can also
use phoenix if you have those downloaded.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em> , </em><em>options</em>) – Print out warnings</p></li>
<li><p><strong>planet_kwargs</strong> (<em>dict</em>) – List of parameters to supply NexSci database is values don’t exist</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.multi_phase_options">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">multi_phase_options</code><span class="sig-paren">(</span><em class="sig-param">printout=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.multi_phase_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve all the options for multiple scattering radiation</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.opannection">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">opannection</code><span class="sig-paren">(</span><em class="sig-param">wave_range=None</em>, <em class="sig-param">filename_db=None</em>, <em class="sig-param">raman_db=None</em>, <em class="sig-param">resample=1</em>, <em class="sig-param">ck_db=None</em>, <em class="sig-param">deq=False</em>, <em class="sig-param">on_fly=False</em>, <em class="sig-param">gases_fly=None</em>, <em class="sig-param">ck=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.opannection" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets up database connection to opacities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wave_range</strong> (<em>list of float</em>) – Subset of wavelength range for which to run models for
Default : None, which pulls entire grid</p></li>
<li><p><strong>filename_db</strong> (<em>str</em>) – Filename of opacity database to query from
Default is none which pulls opacity file that comes with distribution</p></li>
<li><p><strong>raman_db</strong> (<em>str</em>) – Filename of raman opacity cross section
Default is none which pulls opacity file that comes with distribution</p></li>
<li><p><strong>resample</strong> (<em>int</em>) – Default=1 (no resampling) PROCEED WITH CAUTION!!!!!This will resample your opacites.
This effectively takes opacity[::BINS] depending on what the
sampling requested is. Consult your local theorist before
using this.</p></li>
<li><p><strong>ck_db</strong> (<em>str</em>) – ASCII filename of ck file</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.picaso">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">picaso</code><span class="sig-paren">(</span><em class="sig-param">bundle</em>, <em class="sig-param">opacityclass</em>, <em class="sig-param">dimension='1d'</em>, <em class="sig-param">calculation='reflected'</em>, <em class="sig-param">full_output=False</em>, <em class="sig-param">plot_opacity=False</em>, <em class="sig-param">as_dict=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.picaso" title="Permalink to this definition">¶</a></dt>
<dd><p>Currently top level program to run albedo code
:param bundle: This input dict is built by loading the input = <cite>justdoit.load_inputs()</cite>
:type bundle: dict
:param opacityclass: Opacity class from <cite>justdoit.opannection</cite>
:type opacityclass: class
:param dimension: (Optional) Dimensions of the calculation. Default = ‘1d’. But ‘3d’ is also accepted.</p>
<blockquote>
<div><p>In order to run ‘3d’ calculations, user must build 3d input (see tutorials)</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>bool</em>) – (Optional) Default = False. Returns atmosphere class, which enables several
plotting capabilities.</p></li>
<li><p><strong>plot_opacity</strong> (<em>bool</em>) – (Optional) Default = False, Creates pop up of the weighted opacity</p></li>
<li><p><strong>as_dict</strong> (<em>bool</em>) – (Optional) Default = True. If true, returns a condensed dictionary to the user.
If false, returns the atmosphere class, which can be used for debugging.
The class is clunky to navigate so if you are consiering navigating through this, ping one of the
developers.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>dictionary with albedos or fluxes or both (depending on what calculation type)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.profile">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">profile</code><span class="sig-paren">(</span><em class="sig-param">it_max</em>, <em class="sig-param">itmx</em>, <em class="sig-param">conv</em>, <em class="sig-param">convt</em>, <em class="sig-param">nofczns</em>, <em class="sig-param">nstr</em>, <em class="sig-param">x_max_mult</em>, <em class="sig-param">temp</em>, <em class="sig-param">pressure</em>, <em class="sig-param">FOPI</em>, <em class="sig-param">t_table</em>, <em class="sig-param">p_table</em>, <em class="sig-param">grad</em>, <em class="sig-param">cp</em>, <em class="sig-param">opacityclass</em>, <em class="sig-param">grav</em>, <em class="sig-param">rfaci</em>, <em class="sig-param">rfacv</em>, <em class="sig-param">nlevel</em>, <em class="sig-param">tidal</em>, <em class="sig-param">tmin</em>, <em class="sig-param">tmax</em>, <em class="sig-param">dwni</em>, <em class="sig-param">bb</em>, <em class="sig-param">y2</em>, <em class="sig-param">tp</em>, <em class="sig-param">final</em>, <em class="sig-param">cloudy</em>, <em class="sig-param">cld_species</em>, <em class="sig-param">mh</em>, <em class="sig-param">fsed</em>, <em class="sig-param">flag_hack</em>, <em class="sig-param">save_profile</em>, <em class="sig-param">all_profiles</em>, <em class="sig-param">opd_cld_climate</em>, <em class="sig-param">g0_cld_climate</em>, <em class="sig-param">w0_cld_climate</em>, <em class="sig-param">flux_net_ir_layer=None</em>, <em class="sig-param">flux_plus_ir_attop=None</em>, <em class="sig-param">first_call_ever=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.profile" title="Permalink to this definition">¶</a></dt>
<dd><p>Function iterating on the TP profile by calling tstart and changing opacities as well
:param it_max: Maximum iterations allowed in the inner no opa change loop
:type it_max: int
:param itmx: Maximum iterations allowed in the outer opa change loop
:type itmx: int
:param conv:
:type conv: float
:param convt: Convergence criteria , if max avg change in temp is less than this then outer loop converges
:type convt: float
:param nofczns: # of conv zones
:type nofczns: int
:param nstr: dimension of 20</p>
<blockquote>
<div><p>NSTR vector describes state of the atmosphere:
0   is top layer
1   is top layer of top convective region
2   is bottom layer of top convective region
3   is top layer of lower radiative region
4   is top layer of lower convective region
5   is bottom layer of lower convective region</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xmaxmult</strong> – </p></li>
<li><p><strong>temp</strong> (<em>array</em>) – Guess temperatures to start with</p></li>
<li><p><strong>pressure</strong> (<em>array</em>) – Atmospheric pressure</p></li>
<li><p><strong>t_table</strong> (<em>array</em>) – Visible flux addition fraction</p></li>
<li><p><strong>nlevel</strong> (<em>int</em>) – # of levels</p></li>
<li><p><strong>temp</strong> – Guess Temperature array, dimension is nlevel</p></li>
<li><p><strong>pressure</strong> – Pressure array</p></li>
<li><p><strong>t_table</strong> – Tabulated Temperature array for convection calculations</p></li>
<li><p><strong>p_table</strong> (<em>array</em>) – Tabulated pressure array for convection calculations</p></li>
<li><p><strong>grad</strong> (<em>array</em>) – Tabulated grad array for convection calculations</p></li>
<li><p><strong>cp</strong> (<em>array</em>) – Tabulated cp array for convection calculations</p></li>
<li><p><strong>opacityclass</strong> (<em>class</em>) – Opacity class created with jdi.oppanection</p></li>
<li><p><strong>grav</strong> (<em>float</em>) – Gravity of planet in SI</p></li>
<li><p><strong>rfaci</strong> (<em>float</em>) – IR flux addition fraction</p></li>
<li><p><strong>rfacv</strong> (<em>float</em>) – Visible flux addition fraction</p></li>
<li><p><strong>nlevel</strong> – # of levels, not layers</p></li>
<li><p><strong>tidal</strong> (<em>array</em>) – Tidal Fluxes dimension = nlevel</p></li>
<li><p><strong>tmin</strong> (<em>float</em>) – Minimum allwed Temp in the profile</p></li>
<li><p><strong>tmax</strong> (<em>float</em>) – Maximum allowed Temp in the profile</p></li>
<li><p><strong>dwni</strong> (<em>array</em>) – Spectral interval corrections (dimension= nwvno)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Temperature array and lapse ratio array if converged
else Temperature array twice</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.profile_deq">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">profile_deq</code><span class="sig-paren">(</span><em class="sig-param">it_max</em>, <em class="sig-param">itmx</em>, <em class="sig-param">conv</em>, <em class="sig-param">convt</em>, <em class="sig-param">nofczns</em>, <em class="sig-param">nstr</em>, <em class="sig-param">x_max_mult</em>, <em class="sig-param">temp</em>, <em class="sig-param">pressure</em>, <em class="sig-param">FOPI</em>, <em class="sig-param">t_table</em>, <em class="sig-param">p_table</em>, <em class="sig-param">grad</em>, <em class="sig-param">cp</em>, <em class="sig-param">opacityclass</em>, <em class="sig-param">grav</em>, <em class="sig-param">rfaci</em>, <em class="sig-param">rfacv</em>, <em class="sig-param">nlevel</em>, <em class="sig-param">tidal</em>, <em class="sig-param">tmin</em>, <em class="sig-param">tmax</em>, <em class="sig-param">dwni</em>, <em class="sig-param">bb</em>, <em class="sig-param">y2</em>, <em class="sig-param">tp</em>, <em class="sig-param">final</em>, <em class="sig-param">cloudy</em>, <em class="sig-param">cld_species</em>, <em class="sig-param">mh</em>, <em class="sig-param">fsed</em>, <em class="sig-param">flag_hack</em>, <em class="sig-param">quench_levels</em>, <em class="sig-param">kz</em>, <em class="sig-param">mmw</em>, <em class="sig-param">save_profile</em>, <em class="sig-param">all_profiles</em>, <em class="sig-param">self_consistent_kzz</em>, <em class="sig-param">save_kzz</em>, <em class="sig-param">all_kzz</em>, <em class="sig-param">vulcan_run</em>, <em class="sig-param">opd_cld_climate</em>, <em class="sig-param">g0_cld_climate</em>, <em class="sig-param">w0_cld_climate</em>, <em class="sig-param">flux_net_ir_layer</em>, <em class="sig-param">flux_plus_ir_attop</em>, <em class="sig-param">on_fly=False</em>, <em class="sig-param">gases_fly=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.profile_deq" title="Permalink to this definition">¶</a></dt>
<dd><p>Function iterating on the TP profile by calling tstart and changing opacities as well
:param it_max: Maximum iterations allowed in the inner no opa change loop
:type it_max: int
:param itmx: Maximum iterations allowed in the outer opa change loop
:type itmx: int
:param conv:
:type conv: float
:param convt: Convergence criteria , if max avg change in temp is less than this then outer loop converges
:type convt: float
:param nofczns: # of conv zones
:type nofczns: int
:param nstr: dimension of 20</p>
<blockquote>
<div><p>NSTR vector describes state of the atmosphere:
0   is top layer
1   is top layer of top convective region
2   is bottom layer of top convective region
3   is top layer of lower radiative region
4   is top layer of lower convective region
5   is bottom layer of lower convective region</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xmaxmult</strong> – </p></li>
<li><p><strong>temp</strong> (<em>array</em>) – Guess temperatures to start with</p></li>
<li><p><strong>pressure</strong> (<em>array</em>) – Atmospheric pressure</p></li>
<li><p><strong>t_table</strong> (<em>array</em>) – Visible flux addition fraction</p></li>
<li><p><strong>nlevel</strong> (<em>int</em>) – # of levels</p></li>
<li><p><strong>temp</strong> – Guess Temperature array, dimension is nlevel</p></li>
<li><p><strong>pressure</strong> – Pressure array</p></li>
<li><p><strong>t_table</strong> – Tabulated Temperature array for convection calculations</p></li>
<li><p><strong>p_table</strong> (<em>array</em>) – Tabulated pressure array for convection calculations</p></li>
<li><p><strong>grad</strong> (<em>array</em>) – Tabulated grad array for convection calculations</p></li>
<li><p><strong>cp</strong> (<em>array</em>) – Tabulated cp array for convection calculations</p></li>
<li><p><strong>opacityclass</strong> (<em>class</em>) – Opacity class created with jdi.oppanection</p></li>
<li><p><strong>grav</strong> (<em>float</em>) – Gravity of planet in SI</p></li>
<li><p><strong>rfaci</strong> (<em>float</em>) – IR flux addition fraction</p></li>
<li><p><strong>rfacv</strong> (<em>float</em>) – Visible flux addition fraction</p></li>
<li><p><strong>nlevel</strong> – # of levels, not layers</p></li>
<li><p><strong>tidal</strong> (<em>array</em>) – Tidal Fluxes dimension = nlevel</p></li>
<li><p><strong>tmin</strong> (<em>float</em>) – Minimum allwed Temp in the profile</p></li>
<li><p><strong>tmax</strong> (<em>float</em>) – Maximum allowed Temp in the profile</p></li>
<li><p><strong>dwni</strong> (<em>array</em>) – Spectral interval corrections (dimension= nwvno)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Temperature array and lapse ratio array if converged
else Temperature array twice</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.query_options">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">query_options</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.query_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve options for querying opacities</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.raman_options">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">raman_options</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.raman_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve options for raman scattering approximtions</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.rt_methodology_options">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">rt_methodology_options</code><span class="sig-paren">(</span><em class="sig-param">printout=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.rt_methodology_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve all the options for methodology</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.single_phase_options">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">single_phase_options</code><span class="sig-paren">(</span><em class="sig-param">printout=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.single_phase_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve all the options for direct radation</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.stream_options">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">stream_options</code><span class="sig-paren">(</span><em class="sig-param">printout=True</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.stream_options" title="Permalink to this definition">¶</a></dt>
<dd><p>Retrieve all the options for stream</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justdoit.young_planets">
<code class="sig-prename descclassname">picaso.justdoit.</code><code class="sig-name descname">young_planets</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justdoit.young_planets" title="Permalink to this definition">¶</a></dt>
<dd><p>Load planets from ZJ’s paper</p>
</dd></dl>

</div>
<div class="section" id="module-picaso.justplotit">
<span id="picaso-justplotit-module"></span><h2>picaso.justplotit module<a class="headerlink" href="#module-picaso.justplotit" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.justplotit.all_optics_1d">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">all_optics_1d</code><span class="sig-paren">(</span><em class="sig-param">full_output, wave_range, return_output=False, legend=None, ng=None, nt=None, colors=['#0072B2', '#E69F00', '#F0E442', '#009E73', '#56B4E9', '#D55E00', '#CC79A7', '#000000'], **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.all_optics_1d" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots 1d profiles of optical depth per layer, single scattering, and
asymmetry averaged over the user input wave_range.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>list</em><em>,</em><em>dict</em>) – Dictonary of outputs or list of dicts</p></li>
<li><p><strong>wave_range</strong> (<em>list</em>) – min and max wavelength in microns</p></li>
<li><p><strong>return_output</strong> (<em>bool</em>) – Default is just to return a figure but you can also
return all the 1d profiles</p></li>
<li><p><strong>legend</strong> (<em>bool</em>) – Default is none. Legend for each component of out</p></li>
<li><p><strong>ng</strong> (<em>int</em>) – gauss index</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – chebychev intex</p></li>
<li><p><strong>**kwargs</strong> (<em>keyword arguments</em>) – Key word arguments will be supplied to each bokeh figure function</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.animate_convergence">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">animate_convergence</code><span class="sig-paren">(</span><em class="sig-param">clima_out, picaso_bundle, opacity, wave_range=[0.3, 6], molecules=['H2O', 'CH4', 'CO', 'NH3']</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.animate_convergence" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to animate climate convergence given all profiles that were
computed throughout the climate run
Animates from the first guess through to the final converged state.
Runs spectra for each of those cases.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>clima_out</strong> (<em>dict</em>) – Output from, for example: clima_out = cl_run.climate(opacity_ck, save_all_profiles=True)</p></li>
<li><p><strong>picaso_bundle</strong> (<em>&lt;picaso.justdoit.inputs&gt;</em>) – This would be the equivalent of cl_run that you used to run climate_model(). This ensures that
your spectra can be rerun</p></li>
<li><p><strong>opacity</strong> (<em>&lt;picaso.optics.RetrieveCKs&gt;</em>) – This is the jdi.opannection that you used as input in the run_climate_model</p></li>
<li><p><strong>wave_range</strong> (<em>list</em>) – sets the wavelngth range of the spectra</p></li>
<li><p><strong>molecules</strong> (<em>list</em>) – list of strings for what molecules to animate</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matplotlib.animation</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.bin_errors">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">bin_errors</code><span class="sig-paren">(</span><em class="sig-param">newx</em>, <em class="sig-param">oldx</em>, <em class="sig-param">dy</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.bin_errors" title="Permalink to this definition">¶</a></dt>
<dd><p>Bin errors properly to account for reduction in noise</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>newx</strong> (<em>array</em>) – New x axis (either micron or wavenumber)</p></li>
<li><p><strong>oldx</strong> (<em>array</em>) – Old x axis (either micron or wavenumber)</p></li>
<li><p><strong>dy</strong> (<em>array</em>) – Error bars</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>new dy</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.brightness_temperature">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">brightness_temperature</code><span class="sig-paren">(</span><em class="sig-param">out_dict</em>, <em class="sig-param">plot=True</em>, <em class="sig-param">R=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.brightness_temperature" title="Permalink to this definition">¶</a></dt>
<dd><blockquote>
<div><p>Plots and returns brightness temperature</p>
<p>$T_{</p>
</div></blockquote>
<p>m bright}=dfrac{a}{{lambda}logleft(dfrac{{b}}{F(lambda){lambda}^5}+1
ight)}$</p>
<blockquote>
<div><p>where a = 1.43877735$       imes$10$^{-2}$ m.K and b = 11.91042952$ imes$10$^{-17}$ m$^4$kg/s$^3$</p>
<dl class="simple">
<dt>out_dict<span class="classifier">dict</span></dt><dd><p>output of bundle.spectrum(opa,full_output=True)</p>
</dd>
<dt>plot<span class="classifier">bool</span></dt><dd><p>If true creates and returns a plot</p>
</dd>
<dt>R<span class="classifier">float</span></dt><dd><p>If not None, rebins the brightness temperature</p>
</dd>
</dl>
</div></blockquote>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.cloud">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">cloud</code><span class="sig-paren">(</span><em class="sig-param">full_output</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.cloud" title="Permalink to this definition">¶</a></dt>
<dd><p>Plotting the cloud input from <code class="docutils literal notranslate"><span class="pre">picaso</span></code>.</p>
<p>The plot itselfs creates maps of the wavelength dependent single scattering albedo
and cloud opacity as a function of altitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>full_output</strong> – </p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>A row of two bokeh plots with the single scattering and optical depth map</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.disco">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">disco</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">wavelength</em>, <em class="sig-param">calculation='reflected'</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.disco" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot disco ball with facets. Bokeh is not good with 3D things. So this is in matplotlib</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – Full output from picaso</p></li>
<li><p><strong>wavelength</strong> (<em>list</em>) – Where to plot 3d facets. Can input as many wavelengths as wanted.
Must be a list, must be in microns.</p></li>
<li><p><strong>calculation</strong> (<em>str</em><em>, </em><em>optional</em>) – Default is to plot ‘reflected’ light but can also switch to ‘thermal’ if it has been computed</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.explore">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">explore</code><span class="sig-paren">(</span><em class="sig-param">df</em>, <em class="sig-param">key</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.explore" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to explore a dictionary that is THREE levels deep and return the data sitting at
the end of key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>df</strong> (<em>dict</em>) – Dictionary that you want to search through.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<p>Consider a dictionary that has <cite>df[‘layer’][‘cloud’][‘w0’] = [0,0,0]</cite></p>
<p>&gt;&gt;&gt;explore(df, ‘w0’)
[0,0,0]</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.find_nearest_1d">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">find_nearest_1d</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.find_nearest_1d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.justplotit.find_nearest_2d">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">find_nearest_2d</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">value</em>, <em class="sig-param">axis=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.find_nearest_2d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.justplotit.find_nearest_old">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">find_nearest_old</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.find_nearest_old" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.justplotit.flux_at_top">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">flux_at_top</code><span class="sig-paren">(</span><em class="sig-param">full_output, plot_bb=True, R=None, pressures=[0.1, 0.01, 0.001], ng=None, nt=None, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.flux_at_top" title="Permalink to this definition">¶</a></dt>
<dd><p>Routine to plot the OLR with overlaying black bodies.</p>
<p>Flux units are CGS = erg/s/cm^3</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>dict</em>) – full dictionary output with {‘wavenumber’,’thermal’,’full_output’}</p></li>
<li><p><strong>plot_bb</strong> (<em>bool</em><em> , </em><em>optional</em>) – Default is to plot black bodies for three pressures specified by <cite>pressures</cite></p></li>
<li><p><strong>R</strong> (<em>float</em>) – New constant R to bin to</p></li>
<li><p><strong>pressures</strong> (<em>list</em><em>, </em><em>optional</em>) – Default is a list of three pressures (in bars) =  [1e-1,1e-2,1e-3]</p></li>
<li><p><strong>ng</strong> (<em>int</em>) – Used for 3D calculations to select point on the sphere (equivalent to longitude point)</p></li>
<li><p><strong>nt</strong> (<em>int</em>) – Used for 3D calculations to select point on the sphere (equivalent to latitude point)</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.figure()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.heatmap_taus">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">heatmap_taus</code><span class="sig-paren">(</span><em class="sig-param">out</em>, <em class="sig-param">R=0</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.heatmap_taus" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots a heatmap of the tau fields (taugas, taucld, tauray)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>out</strong> (<em>dict</em>) – full_ouput dictionary</p></li>
<li><p><strong>R</strong> (<em>int</em>) – Resolution to bin to (if zero, no binning)</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.lon_lat_to_cartesian">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">lon_lat_to_cartesian</code><span class="sig-paren">(</span><em class="sig-param">lon_r</em>, <em class="sig-param">lat_r</em>, <em class="sig-param">R=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.lon_lat_to_cartesian" title="Permalink to this definition">¶</a></dt>
<dd><p>calculates lon, lat coordinates of a point on a sphere with
radius R</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.map">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">map</code><span class="sig-paren">(</span><em class="sig-param">full_output, pressure=[0.1], plot='temperature', wavelength=None, igauss=0</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.map" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot disco ball with facets. Bokeh is not good with 3D things. So this is in matplotlib</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – Full output from picaso</p></li>
<li><p><strong>pressure</strong> (<em>list</em>) – What pressure (in bars) to make the map on. Note: this assumes that the
pressure grid is the same for each ng,nt point accross the grid.</p></li>
<li><p><strong>plot</strong> (<em>str</em><em>, </em><em>optional</em>) – Default is to plot ‘temperature’ map but can also switch to any
3d [nlayer, nlong, nlat] or 4d [nlayer, nwave, nlong, nlat] output in full_output. You can check what is available to plot by printing:
<cite>print(full_output[‘layer’].keys()</cite>.
If you are plotting something that is ALSO wavelength dependent you have to
also supply a single wavelength.</p></li>
<li><p><strong>float</strong><strong>, </strong><strong>optional</strong> (<em>wavelength</em><em>,</em>) – This allows users to plot maps of things that are wavelength dependent, like
<cite>taugas</cite> and <cite>taucld</cite>.</p></li>
<li><p><strong>igauss</strong> (<em>int</em>) – Gauss point to plot if using ktables this can be greater than 0 up to ngauss-1. Otherwise,
This must be zero for monochromatic opacities.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.mean_regrid">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">mean_regrid</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">newx=None</em>, <em class="sig-param">R=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.mean_regrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebin the spectrum at a minimum R or on a fixed grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) – Wavenumbers</p></li>
<li><p><strong>y</strong> (<em>array</em>) – Anything (e.g. albedo, flux)</p></li>
<li><p><strong>newx</strong> (<em>array</em>) – new array to regrid on.</p></li>
<li><p><strong>R</strong> (<em>float</em>) – create grid with constant R</p></li>
<li><p><strong>binwidths</strong> (<em>array</em>) – bin widths centered at x</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>final x, and final y</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.mixing_ratio">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">mixing_ratio</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">limit=50</em>, <em class="sig-param">ng=None</em>, <em class="sig-param">nt=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.mixing_ratio" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns plot of mixing ratios</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – picaso.atmsetup.ATMSETUP</p></li>
<li><p><strong>limit</strong> (<em>int</em>) – Limits the number of curves to 20. Will plot the top 20 molecules
with highest max(abundance). Limit must be &gt;=3.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.figure()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.molecule_contribution">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">molecule_contribution</code><span class="sig-paren">(</span><em class="sig-param">contribution_out</em>, <em class="sig-param">opa</em>, <em class="sig-param">min_pressure=4.5</em>, <em class="sig-param">R=100</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.molecule_contribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to plot &amp; graph the Tau~1 Pressure (bars) of various elements</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>contribution_out</strong> (<em>dict</em>) – contribution_out from jdi.get_contribution.
This function will grab contribution_out[‘tau_p_surface’]
Pressure vs. wavelength optical depth surface at tau specified by user in
get_contribution function (user input for at_tau)</p></li>
<li><p><strong>opa</strong> (<em>picaso.opannection</em>) – Picaso opacity connection to get wavelength</p></li>
<li><p><strong>min_pressure</strong> (<em>float</em><em>, </em><em>int</em>) – Minimum pressure contribution in bars for molecules you want to plot. Ignores all molecules that
are optically thick higher than min_pressure (bars)</p></li>
<li><p><strong>R</strong> (<em>int</em>) – Resolution defined as lambda/dlambda</p></li>
<li><p><strong>Outputs</strong> – </p></li>
<li><p><strong>-------</strong> – </p></li>
<li><p><strong>figure</strong> (<em>bokeh.plotting.figure.Figure</em>) – Shows a default graph of Tau 1 Surface of various molecules and a graph based on user input based on their parameters</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.justplotit.numba_cumsum">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">numba_cumsum</code><a class="headerlink" href="#picaso.justplotit.numba_cumsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute cumsum along axis=0 to bypass numba not allowing kwargs in
cumsum</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.phase_curve">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">phase_curve</code><span class="sig-paren">(</span><em class="sig-param">allout, to_plot, collapse=None, R=100, palette=['#5e4fa2', '#3288bd', '#66c2a5', '#abdda4', '#e6f598', '#ffffbf', '#fee08b', '#fdae61', '#f46d43', '#d53e4f', '#9e0142'], verbose=True, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.phase_curve" title="Permalink to this definition">¶</a></dt>
<dd><p>Plots phase curves</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>allouts</strong> (<em>dict</em>) – picaso allouts element that comes from jdi.phase_curve</p></li>
<li><p><strong>to_plot</strong> (<em>str</em>) – either fpfs_reflected, fpfs_thermal, or thermal, or albedo</p></li>
<li><p><strong>collapse</strong> (<em>str</em><em> or </em><em>float</em><em> or </em><em>list of float</em>) – Allowable options to collapse wavelength axis:
- <cite>‘np.mean’</cite> or <cite>np.sum</cite>
- float or list of float: wavelength(s) in microns (will find the nearest value to this wavelength). Must be in wavenumber range.</p></li>
<li><p><strong>R</strong> (<em>float</em>) – Resolution to regrid before finding nearest wavelength element</p></li>
<li><p><strong>palette</strong> (<em>list</em>) – list of hex from bokeh or other palette</p></li>
<li><p><strong>verbose</strong> (<em>bool</em>) – Print out low level warnings</p></li>
<li><p><strong>kwargs</strong> (<em>dict</em>) – Bokeh plotting kwargs for bokeh.Figure</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.phase_snaps">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">phase_snaps</code><span class="sig-paren">(</span><em class="sig-param">allout</em>, <em class="sig-param">x='longitude'</em>, <em class="sig-param">y='pressure'</em>, <em class="sig-param">z='temperature'</em>, <em class="sig-param">palette='RdBu_r'</em>, <em class="sig-param">y_log=True</em>, <em class="sig-param">x_log=False</em>, <em class="sig-param">z_log=False</em>, <em class="sig-param">col_wrap=3</em>, <em class="sig-param">collapse='np.mean'</em>, <em class="sig-param">igauss=0</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.phase_snaps" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>str</em>) – What to plot on the x axis options = (‘longitude’ or ‘latitude’ or ‘pressure’)</p></li>
<li><p><strong>y</strong> (<em>str</em>) – What to plot on the y axis (‘longitude’ or ‘latitude’ or ‘pressure’)</p></li>
<li><p><strong>z</strong> (<em>str</em>) – What to plot in the heatmap (‘temperature’,’taugas’,’taucld’,’tauray’,’w0’,’g0’,’opd’)</p></li>
<li><p><strong>y_log</strong> (<em>bool</em>) – Makes y axis log</p></li>
<li><p><strong>x_log</strong> (<em>bool</em>) – Makes x axis log</p></li>
<li><p><strong>z_log</strong> (<em>bool</em>) – Makes z axis log (colorbar)</p></li>
<li><p><strong>palette</strong> (<em>str</em>) – Color pallete</p></li>
<li><p><strong>col_wrap</strong> (<em>int</em>) – Column wrap, determines number of columns to split runs into</p></li>
<li><p><strong>collapse</strong> (<em>str</em><em> or </em><em>int</em>) – Collapse lets us know how to collapse the axis, not used. For instance, if plotting
x=longitude, and y=pressure, with collapse=mean, it will take an average along the latitude
axis. If collapse=0, it will take the 0th latitude point.
Allowed collapse functions = np.mean, np.median, np.min, np.max</p></li>
<li><p><strong>igauss</strong> (<em>int</em>) – If using k-coeff gauss points, this can be changed to get different
gauss quadrature points.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.photon_attenuation">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">photon_attenuation</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">at_tau=0.5</em>, <em class="sig-param">return_output=False</em>, <em class="sig-param">igauss=0</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.photon_attenuation" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot breakdown of gas opacity, cloud opacity,
Rayleigh scattering opacity at a specified pressure level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – picaso.atmsetup.ATMSETUP</p></li>
<li><p><strong>at_tau</strong> (<em>float</em>) – Opacity at which to plot the cumulative opacity.
Default = 0.5.</p></li>
<li><p><strong>return_output</strong> (<em>bool</em>) – Return photon attenuation plot values</p></li>
<li><p><strong>igauss</strong> (<em>int</em>) – Gauss angle to plot if using correlated-k method. If not, should always be 0.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.plotting.figure()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>if return_output=False</strong> (<em>bokeh plot</em>)</p></li>
<li><p><strong>else</strong> (<em>bokeh plot,wave,at_pressures_gas,at_pressures_cld,at_pressures_ray</em>)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.plot_cld_input">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">plot_cld_input</code><span class="sig-paren">(</span><em class="sig-param">nwno</em>, <em class="sig-param">nlayer</em>, <em class="sig-param">filename=None</em>, <em class="sig-param">df=None</em>, <em class="sig-param">pressure=None</em>, <em class="sig-param">wavelength=None</em>, <em class="sig-param">**pd_kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_cld_input" title="Permalink to this definition">¶</a></dt>
<dd><p>This function was created to investigate CLD input file for PICASO.</p>
<p>The plot itselfs creates maps of the wavelength dependent single scattering albedo
and cloud opacity and assymetry parameter as a function of altitude.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>nwno</strong> (<em>int</em>) – Number of wavenumber points. For runs from Ackerman &amp; Marley, this will always be 196.</p></li>
<li><p><strong>nlayer</strong> (<em>int</em>) – Should be one less than the number of levels in your pressure temperature grid. Cloud
opacity is assigned for slabs.</p></li>
<li><p><strong>file</strong> (<em>str</em><em> , </em><em>optional</em>) – (Optional)Path to cloud input file</p></li>
<li><p><strong>df</strong> (<em>str</em>) – (Optional)Dataframe of cloud input file</p></li>
<li><p><strong>wavelength</strong> (<em>array</em><em> , </em><em>optional</em>) – (Optional) this allows you to reset the tick marks to wavelengths instead of indicies</p></li>
<li><p><strong>pressure</strong> (<em>array</em><em>, </em><em>optional</em>) – (Optional) this allows you to reset the tick marks to pressure instead of indicies</p></li>
<li><p><strong>pd_kwargs</strong> (<em>kwargs</em>) – Pandas key word arguments for <cite>pandas.read_csv</cite></p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>Three bokeh plots with the single scattering, optical depth, and assymetry maps</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.plot_errorbar">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">plot_errorbar</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">e</em>, <em class="sig-param">plot=None</em>, <em class="sig-param">point_kwargs={}</em>, <em class="sig-param">error_kwargs={}</em>, <em class="sig-param">plot_type='bokeh'</em>, <em class="sig-param">plot_kwargs={}</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_errorbar" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot only symmetric y error bars in bokeh plot</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) – x data</p></li>
<li><p><strong>y</strong> (<em>array</em>) – y data</p></li>
<li><p><strong>e</strong> (<em>array</em>) – +- error for y which will be distributed as y+e, y-e on data point</p></li>
<li><p><strong>plot</strong> (<em>bokeh.figure</em><em>, </em><em>optional</em>) – Bokeh figure to add error bars to</p></li>
<li><p><strong>plot_type</strong> (<em>str</em><em>, </em><em>optional</em>) – type of plot (either bokeh or matplotlib)</p></li>
<li><p><strong>point_kwargs</strong> (<em>dict</em>) – formatting for circles</p></li>
<li><p><strong>error_kwargs</strong> (<em>dict</em>) – formatting for error bar lines</p></li>
<li><p><strong>plot_kwargs</strong> (<em>dict</em>) – plot attriutes for bokeh figure</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.plot_evolution">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">plot_evolution</code><span class="sig-paren">(</span><em class="sig-param">evo</em>, <em class="sig-param">y='Teff'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_evolution" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot evolution of tracks. Requires input from justdoit:</p>
<p>evo = justdoit.evolution_track(mass=’all’,age=’all’)</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>evo</strong> (<em>dict</em>) – Output from the function justdoit.evolution_track(mass=’all’,age=’all’)</p></li>
<li><p><strong>y</strong> (<em>str</em>) – What to plot on the y axis. Can be anything in the pandas that as the mass
attached to the end. E.g. “Teff” is an option because there exists “Teff1Mj”.
But, age_years is not an option as it is not a function of mass.
Current options : [logL, Teff, grav_cgs]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.plot_format">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">plot_format</code><span class="sig-paren">(</span><em class="sig-param">df</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_format" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to reformat plots</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.plot_multierror">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">plot_multierror</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">plot</em>, <em class="sig-param">dx_up=0</em>, <em class="sig-param">dx_low=0</em>, <em class="sig-param">dy_up=0</em>, <em class="sig-param">dy_low=0</em>, <em class="sig-param">point_kwargs={}</em>, <em class="sig-param">error_kwargs={}</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.plot_multierror" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot non-symmetric x and y error bars in bokeh plot</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) – x data</p></li>
<li><p><strong>y</strong> (<em>array</em>) – y data</p></li>
<li><p><strong>dx_up</strong> (<em>array</em><em> or </em><em>int</em><em> or </em><em>float</em>) – upper error bar to be distributed as x + dx_up</p></li>
<li><p><strong>dx_low</strong> (<em>array</em><em> or </em><em>int</em><em> or </em><em>float</em>) – lower error bar to be distributed as x + dx_low</p></li>
<li><p><strong>dy_up</strong> (<em>array</em><em> or </em><em>int</em><em> or </em><em>float</em>) – upper error bar to be distributed as y + dy_up</p></li>
<li><p><strong>dy_low</strong> (<em>array</em><em> or </em><em>int</em><em> or </em><em>float</em>) – lower error bar to be distributed as y + dy_low</p></li>
<li><p><strong>plot</strong> (<em>bokeh.figure</em>) – Bokeh figure to add error bars to</p></li>
<li><p><strong>point_kwargs</strong> (<em>dict</em>) – formatting for circles</p></li>
<li><p><strong>error_kwargs</strong> (<em>dict</em>) – formatting for error bar lines</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.pt">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">pt</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">ng=None</em>, <em class="sig-param">nt=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.pt" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns plot of pressure temperature profile</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – picaso.atmsetup.ATMSETUP</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.figure()</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.spectrum">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">spectrum</code><span class="sig-paren">(</span><em class="sig-param">xarray, yarray, legend=None, wno_to_micron=True, palette=['#0072B2', '#E69F00', '#F0E442', '#009E73', '#56B4E9', '#D55E00', '#CC79A7', '#000000'], muted_alpha=0.2, **kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.spectrum" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot formated albedo spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xarray</strong> (<em>float array</em><em>, </em><em>list of arrays</em>) – wavenumber or micron</p></li>
<li><p><strong>yarray</strong> (<em>float array</em><em>, </em><em>list of arrays</em>) – albedo or fluxes</p></li>
<li><p><strong>legend</strong> (<em>list of str</em><em> , </em><em>optional</em>) – legends for plotting</p></li>
<li><p><strong>wno_to_micron</strong> (<em>bool</em><em> , </em><em>optional</em>) – Converts wavenumber to micron</p></li>
<li><p><strong>palette</strong> (<em>list</em><em>,</em><em>optional</em>) – List of colors for lines. Default only has 8 colors so if you input more lines, you must
give a different pallete</p></li>
<li><p><strong>muted_alpha</strong> (<em>float</em>) – number 0-1 to indicate how muted you want the click functionaity</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.plotting.figure()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bokeh plot</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.spectrum_hires">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">spectrum_hires</code><span class="sig-paren">(</span><em class="sig-param">wno</em>, <em class="sig-param">alb</em>, <em class="sig-param">legend=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.spectrum_hires" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot formated albedo spectrum</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno</strong> (<em>float array</em><em>, </em><em>list of arrays</em>) – wavenumber</p></li>
<li><p><strong>alb</strong> (<em>float array</em><em>, </em><em>list of arrays</em>) – albedo</p></li>
<li><p><strong>legend</strong> (<em>list of str</em>) – legends for plotting</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for hv.opts</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bokeh plot</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.taumap">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">taumap</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">at_tau=1</em>, <em class="sig-param">wavelength=1</em>, <em class="sig-param">igauss=0</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.taumap" title="Permalink to this definition">¶</a></dt>
<dd><p>Plot breakdown of gas opacity, cloud opacity,
Rayleigh scattering opacity at a specified pressure level.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>class</em>) – full_output from dictionary picaso output</p></li>
<li><p><strong>at_tau</strong> (<em>float</em>) – Opacity at which to plot the cumulative opacity.
Default = 0.5.</p></li>
<li><p><strong>igauss</strong> (<em>int</em>) – Gauss point to plot if using ktables this can be greater than 0 up to ngauss-1. Otherwise,
This must be zero for monochromatic opacities.</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for bokeh.plotting.figure()</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>bokeh plot</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.thermal_contribution">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">thermal_contribution</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">tau_max=1.0</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.thermal_contribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Computer the contribution function from <a class="reference external" href="https://doi.org/10.3847/1538-4357/aadd9e">https://doi.org/10.3847/1538-4357/aadd9e</a> equation 4
Note the equation in the paper is missing the - sign in the exponent
:param full_output: full dictionary output with {‘wavenumber’,’thermal’,’full_output’}
:type full_output: dict
:param tau_max: Maximum tau to consider as opaque, largely here to help prevent NaNs and the colorbar from being weird.
:type tau_max: float, optional
:param **kwargs: Any key word argument for pcolormesh
:type **kwargs: dict</p>
</dd></dl>

<dl class="function">
<dt id="picaso.justplotit.transmission_contribution">
<code class="sig-prename descclassname">picaso.justplotit.</code><code class="sig-name descname">transmission_contribution</code><span class="sig-paren">(</span><em class="sig-param">full_output</em>, <em class="sig-param">R=None</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.justplotit.transmission_contribution" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute the transmission contribution function from</p>
<p><a class="reference external" href="https://petitradtrans.readthedocs.io/en/latest/content/notebooks/analysis.html#Transmission-contribution-functions">https://petitradtrans.readthedocs.io/en/latest/content/notebooks/analysis.html#Transmission-contribution-functions</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>full_output</strong> (<em>dict</em>) – full dictionary output with {‘wavenumber’,’thermal’,’full_output’}</p></li>
<li><p><strong>R</strong> (<em>float</em><em>, </em><em>optional</em>) – Resolution for rebinning</p></li>
<li><p><strong>**kwargs</strong> (<em>dict</em>) – Any key word argument for pcolormesh</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><em>fig</em> – matplotlib figure</p></li>
<li><p><em>ax</em> – matplotlib ax</p></li>
<li><p><em>um</em> – micron array</p></li>
<li><p><em>CF_bin</em> – contribution function</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso.opacity_factory">
<span id="picaso-opacity-factory-module"></span><h2>picaso.opacity_factory module<a class="headerlink" href="#module-picaso.opacity_factory" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.opacity_factory.adapt_array">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">adapt_array</code><span class="sig-paren">(</span><em class="sig-param">arr</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.adapt_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.build_skeleton">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">build_skeleton</code><span class="sig-paren">(</span><em class="sig-param">db_f</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.build_skeleton" title="Permalink to this definition">¶</a></dt>
<dd><p>This functionb builds a skeleton sqlite3 database with three tables:
1) header
2) molecular
3) continuum</p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.continuum_avail">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">continuum_avail</code><span class="sig-paren">(</span><em class="sig-param">db_file</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.continuum_avail" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.convert_array">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">convert_array</code><span class="sig-paren">(</span><em class="sig-param">text</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.convert_array" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.create_grid">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">create_grid</code><span class="sig-paren">(</span><em class="sig-param">min_wavelength</em>, <em class="sig-param">max_wavelength</em>, <em class="sig-param">constant_R</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.create_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple function to create a wavelength grid defined with a constant R.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>min_wavelength</strong> (<em>float</em>) – Minimum wavelength in microns</p></li>
<li><p><strong>max_wavelength</strong> (<em>float</em>) – Maximum wavelength in microns</p></li>
<li><p><strong>constant_R</strong> (<em>float</em>) – Constant R spacing</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>wavenumber grid defined at constant Resolution</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.create_grid_minR">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">create_grid_minR</code><span class="sig-paren">(</span><em class="sig-param">min_wavelength</em>, <em class="sig-param">max_wavelength</em>, <em class="sig-param">minimum_R</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.create_grid_minR" title="Permalink to this definition">¶</a></dt>
<dd><p>Simple function to create a wavelength grid defined with a minimum R.
This does not create a “constant” resolution grid. Rather, it defines the R
at the minimum R so that the wavelength grid satisfies all_Rs&gt;R</p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.delete_molecule">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">delete_molecule</code><span class="sig-paren">(</span><em class="sig-param">mol</em>, <em class="sig-param">db_filename</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.delete_molecule" title="Permalink to this definition">¶</a></dt>
<dd><p>Delete a record from the database</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>mol</strong> (<em>str</em>) – molecule to delete</p></li>
<li><p><strong>db_filename</strong> (<em>str</em>) – database to delete record from</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.find_nearest">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">find_nearest</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.find_nearest" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.find_nearest_1d">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">find_nearest_1d</code><span class="sig-paren">(</span><em class="sig-param">array</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.find_nearest_1d" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.fit_linsky">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">fit_linsky</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">wno</em>, <em class="sig-param">va=3</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.fit_linsky" title="Permalink to this definition">¶</a></dt>
<dd><p>Adds H2-H2 opacity from Linsky (1969) and Lenzuni et al. (1991)
to values that were set to -33 as place holders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Temperature</p></li>
<li><p><strong>wno</strong> (<em>numpy.array</em>) – wave number</p></li>
<li><p><strong>va</strong> (<em>int</em><em> or </em><em>float</em>) – (Optional) 1,2 or 3 (depending on what overtone to compute</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>H2-H2 absorption in cm-1 amagat-2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.func_read_gas">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">func_read_gas</code><span class="sig-paren">(</span><em class="sig-param">molecule</em>, <em class="sig-param">og_directory</em>, <em class="sig-param">wv_file_name</em>, <em class="sig-param">order</em>, <em class="sig-param">gfrac</em>, <em class="sig-param">dir_kark_ch4=None</em>, <em class="sig-param">alkali_dir=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.func_read_gas" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to generate correlated-K tables for each individual gas</p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.g_w_2gauss">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">g_w_2gauss</code><span class="sig-paren">(</span><em class="sig-param">order</em>, <em class="sig-param">gfrac</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.g_w_2gauss" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets gauss and weight poitns for correlated-k function
Specifically for the 2-point gauss method</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>order</strong> (<em>int</em>) – gauss order</p></li>
<li><p><strong>gfrac</strong> – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>gauss, weights</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_continuum">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_continuum</code><span class="sig-paren">(</span><em class="sig-param">db_file</em>, <em class="sig-param">species</em>, <em class="sig-param">temperature</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Grab continuum opacity from sqlite database</p>
<dl class="simple">
<dt>db_file<span class="classifier">str</span></dt><dd><p>sqlite3 database filename</p>
</dd>
<dt>species<span class="classifier">list of str</span></dt><dd><p>Single species name. you can run continuum_avail to see what species are present.</p>
</dd>
<dt>temperature<span class="classifier">list of float</span></dt><dd><p>Temperature to grab. can grab available temperatures from continuum_avail</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_h2minus">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_h2minus</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">new_wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_h2minus" title="Permalink to this definition">¶</a></dt>
<dd><p>This results gives the H2 minus opacity, needed for temperatures greater than 600 K.
K L Bell 1980 J. Phys. B: At. Mol. Phys. 13 1859, Table 1
theta=5040/T(K)</p>
<p>The result is given in cm4/dyn, which is why will will  multiply by nh2*ne*k*T
where:
nh2: number of h2 molecules/cm3
ne: number of electrons/cm3
This will happen when we go to sum opacities. For now returns will be in cm4/dyn</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>numpy.ndarray</em>) – temperature in K</p></li>
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>) – wave number cm-1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>H2 minus opacity in units of cm4/dyn</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_hminusbf">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_hminusbf</code><span class="sig-paren">(</span><em class="sig-param">wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_hminusbf" title="Permalink to this definition">¶</a></dt>
<dd><p>H- bound free opacity, which is only dependent on wavelength. From John 1988 <a class="reference external" href="http://adsabs.harvard.edu/abs/1988A%26A...193..189J">http://adsabs.harvard.edu/abs/1988A%26A…193..189J</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>wno</strong> (<em>numpy.ndarray</em>) – Wavenumber in cm-1</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Absorption coefficient in units of cm2</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array of floats</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_hminusff">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_hminusff</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_hminusff" title="Permalink to this definition">¶</a></dt>
<dd><p>H- free free opacity, which is both wavelength and temperature dependent.
From Bell &amp; Berrington (1987)
Also includes factor for simulated emission</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Temperature in K</p></li>
<li><p><strong>wno</strong> (<em>numpy.ndarray</em>) – Wavenumber in cm-1</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Gives cross section in cm^5</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array of float</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_kark_CH4">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_kark_CH4</code><span class="sig-paren">(</span><em class="sig-param">kark_file</em>, <em class="sig-param">new_wno</em>, <em class="sig-param">T</em>, <em class="sig-param">dset</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_kark_CH4" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_kark_CH4_noTdependence">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_kark_CH4_noTdependence</code><span class="sig-paren">(</span><em class="sig-param">kark_dir</em>, <em class="sig-param">new_wave</em>, <em class="sig-param">temperature</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_kark_CH4_noTdependence" title="Permalink to this definition">¶</a></dt>
<dd><p>Files from kark+2010 paper</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>opacity in cm2/species</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_molecular">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_molecular</code><span class="sig-paren">(</span><em class="sig-param">db_file</em>, <em class="sig-param">species</em>, <em class="sig-param">temperature</em>, <em class="sig-param">pressure</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_molecular" title="Permalink to this definition">¶</a></dt>
<dd><p>Grab molecular opacity from sqlite database</p>
<dl class="simple">
<dt>db_file<span class="classifier">str</span></dt><dd><p>sqlite3 database filename</p>
</dd>
<dt>species<span class="classifier">list of str</span></dt><dd><p>Single species name. you can run molecular_avail to see what species are present.</p>
</dd>
<dt>temperature<span class="classifier">list of flaot,int</span></dt><dd><p>Temperature to grab. This will grab the nearest pair neighbor so you dont
have to be exact.
This should be used in conjuction with pressure. For example, if you want
one temperature at two pressures, then this should be input as
t = [100,100] (and pressure would be p=[0.1,1] for instance)</p>
</dd>
<dt>pressure<span class="classifier">list of flaot,int</span></dt><dd><p>Pressure to grab. This will grab the nearest pair neighbor so you dont
have to be exact.
This should be used in conjuction with pressure. For example, if you want
one temperature at two pressures, then this should be input as
t = [100,100] (and pressure would be p=[0.1,1] for instance)</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_optical_o3">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_optical_o3</code><span class="sig-paren">(</span><em class="sig-param">file_o3</em>, <em class="sig-param">new_wvno_grid</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_optical_o3" title="Permalink to this definition">¶</a></dt>
<dd><p>This hacked ozone is from here:
<a class="reference external" href="http://satellite.mpic.de/spectral_atlas/cross_sections/Ozone/O3.spc">http://satellite.mpic.de/spectral_atlas/cross_sections/Ozone/O3.spc</a></p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_original_data">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_original_data</code><span class="sig-paren">(</span><em class="sig-param">original_file</em>, <em class="sig-param">colnames</em>, <em class="sig-param">new_db</em>, <em class="sig-param">overwrite=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_original_data" title="Permalink to this definition">¶</a></dt>
<dd><p>The continuum factory takes the CIA opacity file and adds in extra sources of
opacity from other references to fill in empty bands. It assumes that the original file is
structured as following,with the first column wavenumber and the rest molecules:
1000 198
75.
0.0  -33.0000  -33.0000  -33.0000  -33.0000  -33.0000
20.0   -7.4572   -7.4518   -6.8038   -6.0928   -5.9806
40.0   -6.9547   -6.9765   -6.6322   -5.7934   -5.4823
… … … etc</p>
<p>Where 1000 corresponds to the number of wavelengths, 198 corresponds to the number of temperatures
and 75 is the first temperature. If this structure changes, we will need to restructure this top
level __init__ function that reads it in the original opacity file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_file</strong> (<em>str</em>) – Filepath that points to original opacity file (see description above)</p></li>
<li><p><strong>colnames</strong> (<em>list</em>) – defines the sources of opacity in the original file. For the example file above,
colnames would be [‘wno’,’H2H2’,’H2He’,’H2H’,’H2CH4’,’H2N2’]</p></li>
<li><p><strong>new_db</strong> (<em>str</em>) – New database name</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>) – Default is set to False as to not overwrite any existing files. This parameter controls overwriting
cia database</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.get_wvno_grid">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">get_wvno_grid</code><span class="sig-paren">(</span><em class="sig-param">filename</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.get_wvno_grid" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.h2h2_overtone">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">h2h2_overtone</code><span class="sig-paren">(</span><em class="sig-param">t</em>, <em class="sig-param">wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.h2h2_overtone" title="Permalink to this definition">¶</a></dt>
<dd><p>Add in special CIA h2h2 band at 0.8 microns</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>t</strong> (<em>float</em>) – Temperature</p></li>
<li><p><strong>wno</strong> (<em>numpy.array</em>) – wave number</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>H2-H2 absorption in cm-1 amagat-2</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.insert">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">insert</code><span class="sig-paren">(</span><em class="sig-param">cur</em>, <em class="sig-param">conn</em>, <em class="sig-param">mol</em>, <em class="sig-param">T</em>, <em class="sig-param">opacity</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.insert" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert into</p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.insert_molecular_1060">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">insert_molecular_1060</code><span class="sig-paren">(</span><em class="sig-param">molecule</em>, <em class="sig-param">min_wavelength</em>, <em class="sig-param">max_wavelength</em>, <em class="sig-param">new_R</em>, <em class="sig-param">og_directory</em>, <em class="sig-param">new_db</em>, <em class="sig-param">dir_kark_ch4=None</em>, <em class="sig-param">dir_optical_o3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.insert_molecular_1060" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to resample 1060 grid data onto lower resolution grid. The general procedure
in this function is to interpolate original 1060 data onto very high resolution
grid (R=1e6). Then, determine number of bins to take given input ‘new_R’. The final
opacity grid will be : original_opacity[::BINS]</p>
<p>NOTE: From several tests “new_R” should be at least 100x higher than the ultimate
planet spectrum you want to bin down to.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>str</em>) – Name of molecule (should match a directory with 1060 files)</p></li>
<li><p><strong>min_wavelength</strong> (<em>float</em>) – Minimum wavelength in database in units of micron</p></li>
<li><p><strong>max_wavelength</strong> (<em>float</em>) – Maximum wavelength in database in units of micron</p></li>
<li><p><strong>new_R</strong> (<em>float</em>) – New R to regrid to. If new_R=None, it will retain the original 1e6 million resolution
of the lbl grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.insert_molecular_1460">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">insert_molecular_1460</code><span class="sig-paren">(</span><em class="sig-param">molecule</em>, <em class="sig-param">min_wavelength</em>, <em class="sig-param">max_wavelength</em>, <em class="sig-param">og_directory</em>, <em class="sig-param">new_db</em>, <em class="sig-param">new_R=None</em>, <em class="sig-param">new_dwno=None</em>, <em class="sig-param">old_R=1000000.0</em>, <em class="sig-param">old_dwno=0.0035</em>, <em class="sig-param">alkali_dir='alkalis'</em>, <em class="sig-param">dir_kark_ch4=None</em>, <em class="sig-param">dir_optical_o3=None</em>, <em class="sig-param">insert_direct=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.insert_molecular_1460" title="Permalink to this definition">¶</a></dt>
<dd><p>DEVELOPER USE ONLY.
Function to resample 1060 grid data onto lower resolution grid. The general procedure
in this function is to interpolate original 1060 data onto very high resolution
grid (R=1e6). Then, determine number of bins to take given input ‘new_R’. The final
opacity grid will be : original_opacity[::BINS]</p>
<p>NOTE: From several tests “new_R” should be at least 100x higher than the ultimate
planet spectrum you want to bin down to.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>str</em>) – Name of molecule (should match a directory with 1060 files)</p></li>
<li><p><strong>min_wavelength</strong> (<em>float</em>) – Minimum wavelength in database in units of micron</p></li>
<li><p><strong>max_wavelength</strong> (<em>float</em>) – Maximum wavelength in database in units of micron</p></li>
<li><p><strong>new_R</strong> (<em>int</em><em>,</em><em>float</em><em> , </em><em>optional</em>) – Optional, new R to regrid to. This will create a new wavelength solution that is
constant in R. The other option (new_dwno is to do constant wavenumber bin)
This must be smaller than old_R, which is default to 1e6.</p></li>
<li><p><strong>old_R</strong> (<em>int</em><em>,</em><em>float</em><em>, </em><em>optional</em>) – This is set to match the approximate cross sections that are computed LBL. If you do not
want any resampling, then you need to set new_R=old_R</p></li>
<li><p><strong>new_dwno</strong> (<em>float</em><em>, </em><em>optional</em>) – Optional, new constant wavenumber bin to create wavelength solution. This must be bigger
than old_dwno.</p></li>
<li><p><strong>old_dwno</strong> (<em>float</em><em>, </em><em>optional</em>) – This is set to 0.0035 to match the smallest wavenumber than we compute in our grid.
If you do not want any resampling, then you need to set new_dwno=old_dwno</p></li>
<li><p><strong>og_directory</strong> (<em>str</em>) – Directory of all the cross sections that include folders e.g. “H2O”, “CH4”</p></li>
<li><p><strong>alkali_dir</strong> (<em>str</em>) – Alakalis directory</p></li>
<li><p><strong>new_db</strong> (<em>str</em>) – New database name</p></li>
<li><p><strong>dir_kark_ch4</strong> (<em>str</em>) – Karkoschka methane to hack in</p></li>
<li><p><strong>dir_optical_o3</strong> (<em>str</em>) – optical ozone to hack in</p></li>
<li><p><strong>insert_direct</strong> (<em>bool</em>) – this ignores all other inputs except min and max wavelength and
inserts opacities into the database diretly as is</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.insert_molecular_1460_old">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">insert_molecular_1460_old</code><span class="sig-paren">(</span><em class="sig-param">molecule</em>, <em class="sig-param">min_wavelength</em>, <em class="sig-param">max_wavelength</em>, <em class="sig-param">new_R</em>, <em class="sig-param">og_directory</em>, <em class="sig-param">new_db</em>, <em class="sig-param">dir_kark_ch4=None</em>, <em class="sig-param">dir_optical_o3=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.insert_molecular_1460_old" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to resample Ehsan’s 1460 grid data onto lower resolution grid, 1060 grid. The general procedure
in this function is to interpolate original 1060 data onto very high resolution
grid (R=1e6). Then, determine number of bins to take given input ‘new_R’. The final
opacity grid will be : original_opacity[::BINS]</p>
<p>NOTE: From several tests “new_R” should be at least 100x higher than the ultimate
planet spectrum you want to bin down to.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecule</strong> (<em>str</em>) – Name of molecule (should match a directory with 1060 files)</p></li>
<li><p><strong>min_wavelength</strong> (<em>float</em>) – Minimum wavelength in database in units of micron</p></li>
<li><p><strong>max_wavelength</strong> (<em>float</em>) – Maximum wavelength in database in units of micron</p></li>
<li><p><strong>new_R</strong> (<em>float</em>) – New R to regrid to. If new_R=None, it will retain the original 1e6 million resolution
of the lbl grid.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.insert_wno_grid">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">insert_wno_grid</code><span class="sig-paren">(</span><em class="sig-param">wno_grid</em>, <em class="sig-param">cur</em>, <em class="sig-param">con</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.insert_wno_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>Inserts basics into the header file. This puts all the units to the database.</p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.listdir">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">listdir</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.listdir" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.molecular_avail">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">molecular_avail</code><span class="sig-paren">(</span><em class="sig-param">db_file</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.molecular_avail" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.open_local">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">open_local</code><span class="sig-paren">(</span><em class="sig-param">db_f</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.open_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Code needed to open up local database, interpret arrays from bytes and return cursor</p>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.regrid">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">regrid</code><span class="sig-paren">(</span><em class="sig-param">x</em>, <em class="sig-param">y</em>, <em class="sig-param">newx=None</em>, <em class="sig-param">R=None</em>, <em class="sig-param">statistic='mean'</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.regrid" title="Permalink to this definition">¶</a></dt>
<dd><p>Rebin the spectrum at a minimum R or on a fixed grid</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x</strong> (<em>array</em>) – Wavenumbers</p></li>
<li><p><strong>y</strong> (<em>array</em>) – Anything (e.g. albedo, flux)</p></li>
<li><p><strong>newx</strong> (<em>array</em>) – new array to regrid on.</p></li>
<li><p><strong>R</strong> (<em>float</em>) – create grid with constant R</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>final x, and final y</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.restruct_continuum">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">restruct_continuum</code><span class="sig-paren">(</span><em class="sig-param">original_file</em>, <em class="sig-param">colnames</em>, <em class="sig-param">new_wno</em>, <em class="sig-param">new_db</em>, <em class="sig-param">overwrite</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.restruct_continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>The continuum factory takes the CIA opacity file and adds in extra sources of
opacity from other references to fill in empty bands. It assumes that the original file is
structured as following,with the first column wavenumber and the rest molecules:
1000 198
75.
0.0  -33.0000  -33.0000  -33.0000  -33.0000  -33.0000
20.0   -7.4572   -7.4518   -6.8038   -6.0928   -5.9806
40.0   -6.9547   -6.9765   -6.6322   -5.7934   -5.4823
… … … etc</p>
<p>Where 1000 corresponds to the number of wavelengths, 198 corresponds to the number of temperatures
and 75 is the first temperature. If this structure changes, we will need to restructure this top
level __init__ function that reads it in the original opacity file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>original_file</strong> (<em>str</em>) – Filepath that points to original opacity file (see description above)</p></li>
<li><p><strong>colnames</strong> (<em>list</em>) – defines the sources of opacity in the original file. For the example file above,
colnames would be [‘wno’,’H2H2’,’H2He’,’H2H’,’H2CH4’,’H2N2’]</p></li>
<li><p><strong>new_wno</strong> (<em>numpy.ndarray</em><em>, </em><em>list</em>) – wavenumber grid to interpolate onto (units of inverse cm)</p></li>
<li><p><strong>new_db</strong> (<em>str</em>) – New database name</p></li>
<li><p><strong>overwrite</strong> (<em>bool</em>) – Default is set to False as to not overwrite any existing files. This parameter controls overwriting
cia database</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.restructure_opacity">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">restructure_opacity</code><span class="sig-paren">(</span><em class="sig-param">new_db</em>, <em class="sig-param">ntemp</em>, <em class="sig-param">temperatures</em>, <em class="sig-param">molecules</em>, <em class="sig-param">og_opacity</em>, <em class="sig-param">old_wno</em>, <em class="sig-param">new_wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.restructure_opacity" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.vectorize_rebin_mean">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">vectorize_rebin_mean</code><span class="sig-paren">(</span><em class="sig-param">bins</em>, <em class="sig-param">Fp</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.vectorize_rebin_mean" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.vectorize_rebin_median">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">vectorize_rebin_median</code><span class="sig-paren">(</span><em class="sig-param">bins</em>, <em class="sig-param">Fp</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.vectorize_rebin_median" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.opacity_factory.vresample_and_insert_molecular">
<code class="sig-prename descclassname">picaso.opacity_factory.</code><code class="sig-name descname">vresample_and_insert_molecular</code><span class="sig-paren">(</span><em class="sig-param">molecule</em>, <em class="sig-param">min_wavelength</em>, <em class="sig-param">max_wavelength</em>, <em class="sig-param">new_R</em>, <em class="sig-param">og_directory</em>, <em class="sig-param">new_db</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.opacity_factory.vresample_and_insert_molecular" title="Permalink to this definition">¶</a></dt>
<dd><p>This function is identical to resample_and_insert_molecular but it was
written to determine if taking the median was better than taking every BIN’th
data point. It uses a special  vectorize function to speed up the median.
Results are about the same but this is much slower to run.
So dont bother using this unless there is something specific to try.</p>
</dd></dl>

</div>
<div class="section" id="module-picaso.optics">
<span id="picaso-optics-module"></span><h2>picaso.optics module<a class="headerlink" href="#module-picaso.optics" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="picaso.optics.RetrieveCKs">
<em class="property">class </em><code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">RetrieveCKs</code><span class="sig-paren">(</span><em class="sig-param">ck_dir</em>, <em class="sig-param">cont_dir</em>, <em class="sig-param">wave_range=None</em>, <em class="sig-param">deq=False</em>, <em class="sig-param">on_fly=False</em>, <em class="sig-param">gases_fly=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This will be the class to retrieve correlated-k tables from the database.
Right now this is in beta mode and is retrieving the direct heritage
196 grid files.
:param ck_dir: Directory of the pre-mixed correlated k table data. Check that you are pointing to a</p>
<blockquote>
<div><p>directory with the files “ascii_data” and “full_abunds”.</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cont_dir</strong> (<em>str</em>) – This should be in the references directory on Github. This has all the continuum opacity
that you need (e.g. H2H2). It also has some extra cross sections that you may want to add
in like Karkoschka methane and the optical ozone band.</p></li>
<li><p><strong>wave_range</strong> (<em>list</em>) – NOT FUNCTIONAL YET.
Wavelength range to compuate in the format [min micron, max micron]</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="picaso.optics.RetrieveCKs.adapt_array">
<code class="sig-name descname">adapt_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.adapt_array" title="Permalink to this definition">¶</a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.convert_array">
<code class="sig-name descname">convert_array</code><span class="sig-paren">(</span><em class="sig-param">text</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.convert_array" title="Permalink to this definition">¶</a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_available_continuum">
<code class="sig-name descname">get_available_continuum</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_available_continuum" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the pressures and temperatures that are available for the continuum and molecules</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_available_rayleigh">
<code class="sig-name descname">get_available_rayleigh</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_available_rayleigh" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_continuum">
<code class="sig-name descname">get_continuum</code><span class="sig-paren">(</span><em class="sig-param">atmosphere</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_continuum" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_gauss_pts_661_1460">
<code class="sig-name descname">get_gauss_pts_661_1460</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_gauss_pts_661_1460" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read the legacy data of the 1060 grid computed by Roxana Lupu.
.. note:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">This</span> <span class="n">function</span> <span class="ow">is</span> <span class="o">**</span><span class="n">highly</span><span class="o">**</span> <span class="n">sensitive</span> <span class="n">to</span> <span class="n">the</span> <span class="n">file</span> <span class="nb">format</span><span class="o">.</span> <span class="n">You</span> <span class="n">cannot</span> <span class="n">edit</span> <span class="n">the</span> <span class="n">ascii</span> <span class="n">file</span> <span class="ow">and</span> <span class="n">then</span>
<span class="n">run</span> <span class="n">this</span> <span class="n">function</span><span class="o">.</span> <span class="n">Each</span> <span class="n">specific</span> <span class="n">line</span> <span class="ow">is</span> <span class="n">accounted</span> <span class="k">for</span><span class="o">.</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_legacy_data_1060">
<code class="sig-name descname">get_legacy_data_1060</code><span class="sig-paren">(</span><em class="sig-param">wave_range</em>, <em class="sig-param">deq=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_legacy_data_1060" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read the legacy data of the 1060 grid computed by Roxana Lupu.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is <strong>highly</strong> sensitive to the file format. You cannot edit the ascii file and then
run this function. Each specific line is accounted for.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_legacy_data_1460">
<code class="sig-name descname">get_legacy_data_1460</code><span class="sig-paren">(</span><em class="sig-param">wave_range</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_legacy_data_1460" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to read the legacy data of the 1060 grid computed by Roxana Lupu.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This function is <strong>highly</strong> sensitive to the file format. You cannot edit the ascii file and then
run this function. Each specific line is accounted for.</p>
</div>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_mixing_indices">
<code class="sig-name descname">get_mixing_indices</code><span class="sig-paren">(</span><em class="sig-param">atmosphere</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_mixing_indices" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in atmosphere profile and returns an array which is
nlayer by ngauss by nwno</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_new_wvno_grid_661">
<code class="sig-name descname">get_new_wvno_grid_661</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_new_wvno_grid_661" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_opacities">
<code class="sig-name descname">get_opacities</code><span class="sig-paren">(</span><em class="sig-param">atmosphere</em>, <em class="sig-param">exclude_mol=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_opacities" title="Permalink to this definition">¶</a></dt>
<dd><dl class="simple">
<dt>atmosphere<span class="classifier">class</span></dt><dd><p>picaso atmosphere class</p>
</dd>
<dt>exclude_mol<span class="classifier">int</span></dt><dd><p>Not yet functional for CK option since they are premixed. For individual
CK molecules, this will ignore the optical contribution from one molecule.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_opacities_deq">
<code class="sig-name descname">get_opacities_deq</code><span class="sig-paren">(</span><em class="sig-param">bundle</em>, <em class="sig-param">atmosphere</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_opacities_deq" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_opacities_deq_onfly">
<code class="sig-name descname">get_opacities_deq_onfly</code><span class="sig-paren">(</span><em class="sig-param">bundle</em>, <em class="sig-param">atmosphere</em>, <em class="sig-param">gases_fly=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_opacities_deq_onfly" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_pre_mix_ck">
<code class="sig-name descname">get_pre_mix_ck</code><span class="sig-paren">(</span><em class="sig-param">atmosphere</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_pre_mix_ck" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in atmosphere profile and returns an array which is
nlayer by ngauss by nwno</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_pre_mix_ck_nearest">
<code class="sig-name descname">get_pre_mix_ck_nearest</code><span class="sig-paren">(</span><em class="sig-param">atmosphere</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_pre_mix_ck_nearest" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in atmosphere profile and returns an array which is
nlayer by ngauss by nwno</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.get_pre_mix_ck_sm">
<code class="sig-name descname">get_pre_mix_ck_sm</code><span class="sig-paren">(</span><em class="sig-param">atmosphere</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.get_pre_mix_ck_sm" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes in atmosphere profile and returns an array which is
nlayer by ngauss by nwno</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.load_kcoeff_arrays">
<code class="sig-name descname">load_kcoeff_arrays</code><span class="sig-paren">(</span><em class="sig-param">path</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.load_kcoeff_arrays" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.load_kcoeff_arrays_first">
<code class="sig-name descname">load_kcoeff_arrays_first</code><span class="sig-paren">(</span><em class="sig-param">path</em>, <em class="sig-param">gases_fly</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.load_kcoeff_arrays_first" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.mix_my_opacities">
<code class="sig-name descname">mix_my_opacities</code><span class="sig-paren">(</span><em class="sig-param">bundle</em>, <em class="sig-param">atmosphere</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.mix_my_opacities" title="Permalink to this definition">¶</a></dt>
<dd><p>Top Function to perform “on-the-fly” mixing and then interpolating of 5 opacity sources from Amundsen et al. (2017)</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.mix_my_opacities_gasesfly">
<code class="sig-name descname">mix_my_opacities_gasesfly</code><span class="sig-paren">(</span><em class="sig-param">bundle</em>, <em class="sig-param">atmosphere</em>, <em class="sig-param">gases_fly</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.mix_my_opacities_gasesfly" title="Permalink to this definition">¶</a></dt>
<dd><p>Top Function to perform “on-the-fly” mixing and then interpolating of 5 opacity sources from Amundsen et al. (2017)</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.open_local">
<code class="sig-name descname">open_local</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.open_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Code needed to open up local database, interpret arrays from bytes and return cursor</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.run_cia_spline">
<code class="sig-name descname">run_cia_spline</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.run_cia_spline" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveCKs.run_cia_spline_661">
<code class="sig-name descname">run_cia_spline_661</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveCKs.run_cia_spline_661" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</dd></dl>

<dl class="class">
<dt id="picaso.optics.RetrieveOpacities">
<em class="property">class </em><code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">RetrieveOpacities</code><span class="sig-paren">(</span><em class="sig-param">db_filename</em>, <em class="sig-param">raman_data</em>, <em class="sig-param">wave_range=None</em>, <em class="sig-param">location='local'</em>, <em class="sig-param">resample=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities" title="Permalink to this definition">¶</a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>This will be the class that will retrieve the opacities from the sqlite3 database. Right
now we are just employing nearest neighbors to grab the respective opacities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>db_filename</strong> (<em>str</em>) – Opacity file name</p></li>
<li><p><strong>raman_data</strong> (<em>str</em>) – file name of the raman cross section data</p></li>
<li><p><strong>wave_range</strong> (<em>list of float</em>) – Wavelength range (in microns) to run.
Default None grabs all the full wavelength range available</p></li>
<li><p><strong>location</strong> (<em>str</em>) – Default = local. This is the only option currently available since
we dont have AWS or other services enabled.</p></li>
<li><p><strong>resample</strong> (<em>int</em>) – Default =1 (no resampling)</p></li>
</ul>
</dd>
</dl>
<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.raman_db">
<code class="sig-name descname">raman_db</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.raman_db" title="Permalink to this definition">¶</a></dt>
<dd><p>Database of Raman cross sections</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>pandas.DataFrame</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.wno">
<code class="sig-name descname">wno</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.wno" title="Permalink to this definition">¶</a></dt>
<dd><p>Wavenumber grid from opacity database (CGS cm-1)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.wave">
<code class="sig-name descname">wave</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.wave" title="Permalink to this definition">¶</a></dt>
<dd><p>Wavelength grid from opacity database (micron)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.nwno">
<code class="sig-name descname">nwno</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.nwno" title="Permalink to this definition">¶</a></dt>
<dd><p>Number of wavenumber points in the grid</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>int</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.cia_temps">
<code class="sig-name descname">cia_temps</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.cia_temps" title="Permalink to this definition">¶</a></dt>
<dd><p>CIA temps available from database</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.molecules">
<code class="sig-name descname">molecules</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.molecules" title="Permalink to this definition">¶</a></dt>
<dd><p>Molecules availalbe from database</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.pt_pairs">
<code class="sig-name descname">pt_pairs</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.pt_pairs" title="Permalink to this definition">¶</a></dt>
<dd><p>pressure-temperature pairs available from grid (our grid is usually
computed on a fixed 1060 PT grid)</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.molecular_opa">
<code class="sig-name descname">molecular_opa</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.molecular_opa" title="Permalink to this definition">¶</a></dt>
<dd><p>Molecular Opacity dictionary that contains all the queried information necessary
to do calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.continuum_opa">
<code class="sig-name descname">continuum_opa</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.continuum_opa" title="Permalink to this definition">¶</a></dt>
<dd><p>Continuum opacity dictionary that contains all the queried information
necessary for the calculation</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.RetrieveOpacities.rayleigh_opa">
<code class="sig-name descname">rayleigh_opa</code><a class="headerlink" href="#picaso.optics.RetrieveOpacities.rayleigh_opa" title="Permalink to this definition">¶</a></dt>
<dd><p>Rayleigh opacity dictionary for all the sources we have. This is computed as
cm^2/species when the users runs <cite>opannection</cite>. We technically could just
store this in the DB as well. However, because its so fast, it doesn’t take
a lot of time, and because its non-temperature dependent, we only have to do
it once.</p>
<dl class="field-list simple">
<dt class="field-odd">Type</dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.db_connect">
<code class="sig-name descname">db_connect</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.db_connect" title="Permalink to this definition">¶</a></dt>
<dd><p>Inherents functionality of <cite>open_local</cite>. Eventually it will
inherent functionality of “open_non_locals” (e.g. cloud or other sources)</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.open_local">
<code class="sig-name descname">open_local</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.open_local" title="Permalink to this definition">¶</a></dt>
<dd><p>Opens sqlite3 connection and enables array interpretation from bytes</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.get_available_data">
<code class="sig-name descname">get_available_data</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_available_data" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets opacity database attributes such as available T-Ps , availalbe molecules. etc.</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.get_available_rayleigh">
<code class="sig-name descname">get_available_rayleigh</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_available_rayleigh" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets rayleigh cross sections when opannection is opened.</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.get_opacities">
<code class="sig-name descname">get_opacities</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_opacities" title="Permalink to this definition">¶</a></dt>
<dd><p>Gets opacities after user specifies atmospheric profile (e.g. full PT and Composition)</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.adapt_array">
<code class="sig-name descname">adapt_array</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.adapt_array" title="Permalink to this definition">¶</a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.compute_stellar_shits">
<code class="sig-name descname">compute_stellar_shits</code><span class="sig-paren">(</span><em class="sig-param">wno_star</em>, <em class="sig-param">flux_star</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.compute_stellar_shits" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes the hires stellar spectrum and computes Raman shifts</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno_star</strong> (<em>array</em>) – hires wavelength grid of the star in wave number</p></li>
<li><p><strong>flux_star</strong> (<em>array</em>) – Flux of the star in whatever units. Doesn’t matter for this since it’s returning a ratio</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of the shifted stellar spec divided by the unshifted stellar spec on the model wave
number grid</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matrix</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.convert_array">
<code class="sig-name descname">convert_array</code><span class="sig-paren">(</span><em class="sig-param">text</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.convert_array" title="Permalink to this definition">¶</a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.find_needed_pts">
<code class="sig-name descname">find_needed_pts</code><span class="sig-paren">(</span><em class="sig-param">tlayer</em>, <em class="sig-param">player</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.find_needed_pts" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to identify the PT pairs needed given a set of temperature and pressures.
When the opacity connection is established the PT pairs are read in and added to the
class.</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">get_available_data</code><span class="sig-paren">(</span><em class="sig-param">wave_range</em>, <em class="sig-param">resample</em><span class="sig-paren">)</span></dt>
<dd><p>Get the pressures and temperatures that are available for the continuum and molecules</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">get_available_rayleigh</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd></dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">get_opacities</code><span class="sig-paren">(</span><em class="sig-param">atmosphere</em>, <em class="sig-param">exclude_mol=1</em><span class="sig-paren">)</span></dt>
<dd><p>Get’s opacities using the atmosphere class using interpolation for molecular, but not
continuum. Continuum opacity is grabbed via nearest neighbor methodology.</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.get_opacities_nearest">
<code class="sig-name descname">get_opacities_nearest</code><span class="sig-paren">(</span><em class="sig-param">atmosphere</em>, <em class="sig-param">exclude_mol=1</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.get_opacities_nearest" title="Permalink to this definition">¶</a></dt>
<dd><p>Get’s opacities using the atmosphere class</p>
</dd></dl>

<dl class="method">
<dt>
<code class="sig-name descname">open_local</code><span class="sig-paren">(</span><span class="sig-paren">)</span></dt>
<dd><p>Code needed to open up local database, interpret arrays from bytes and return cursor</p>
</dd></dl>

<dl class="method">
<dt id="picaso.optics.RetrieveOpacities.preload_opacities">
<code class="sig-name descname">preload_opacities</code><span class="sig-paren">(</span><em class="sig-param">molecules</em>, <em class="sig-param">p_range</em>, <em class="sig-param">t_range</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.RetrieveOpacities.preload_opacities" title="Permalink to this definition">¶</a></dt>
<dd><p>Function that pre-loads opacities for certain molecules and p-t range</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>molecules</strong> (<em>list</em>) – list of molecule names</p></li>
<li><p><strong>p_range</strong> (<em>list</em>) – list of floats in bars e.g [1e-2,1]</p></li>
<li><p><strong>t_range</strong> (<em>list</em>) – List of floats in kelvin e.g [300,1000]</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="picaso.optics.adapt_array">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">adapt_array</code><span class="sig-paren">(</span><em class="sig-param">arr</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.adapt_array" title="Permalink to this definition">¶</a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.bin_star">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">bin_star</code><a class="headerlink" href="#picaso.optics.bin_star" title="Permalink to this definition">¶</a></dt>
<dd><p>Takes average of group of points using uniform tophat</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>wno_new</strong> (<em>numpy.array</em>) – inverse cm grid to bin to (cm-1)</p></li>
<li><p><strong>wno_old</strong> (<em>numpy.array</em>) – inverse cm grid (old grid)</p></li>
<li><p><strong>Fp</strong> (<em>numpy.array</em>) – transmission spectra, which is on wno grid</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.optics.compute_opacity">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">compute_opacity</code><span class="sig-paren">(</span><em class="sig-param">atmosphere</em>, <em class="sig-param">opacityclass</em>, <em class="sig-param">ngauss=1</em>, <em class="sig-param">stream=2</em>, <em class="sig-param">delta_eddington=True</em>, <em class="sig-param">test_mode=False</em>, <em class="sig-param">raman=0</em>, <em class="sig-param">plot_opacity=False</em>, <em class="sig-param">full_output=False</em>, <em class="sig-param">return_mode=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.compute_opacity" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns total optical depth per slab layer including molecular opacity, continuum opacity.
It should automatically select the molecules needed</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>atmosphere</strong> (<em>class ATMSETUP</em>) – This inherets the class from atmsetup.py</p></li>
<li><p><strong>opacityclass</strong> (<em>class opacity</em>) – This inherets the class from optics.py. It is done this way so that the opacity db doesnt have
to be reloaded in a retrieval</p></li>
<li><p><strong>ngauss</strong> (<em>int</em>) – Number of gauss angles if using correlated-k. If using monochromatic opacites,
ngauss should one.</p></li>
<li><p><strong>stream</strong> (<em>int</em>) – Number of streams (only affects detal eddington approximation)</p></li>
<li><p><strong>delta_eddington</strong> (<em>bool</em>) – (Optional) Default=True, With Delta-eddington on, it incorporates the forward peak
contribution by adjusting optical properties such that the fraction of scattered energy
in the forward direction is removed from the scattering parameters</p></li>
<li><p><strong>raman</strong> (<em>int</em>) – (Optional) Default =0 which corresponds to oklopcic+2018 raman scattering cross sections.
Other options include 1 for original pollack approximation for a 6000K blackbody.
And 2 for nothing.</p></li>
<li><p><strong>test_mode</strong> (<em>bool</em>) – (Optional) Default = False to run as normal. This will overwrite the opacities and fix the
delta tau at 0.5.</p></li>
<li><p><strong>full_output</strong> (<em>bool</em>) – (Optional) Default = False. If true, This will add taugas, taucld, tauray to the atmosphere class.
This is done so that the users can debug, plot, etc.</p></li>
<li><p><strong>plot_opacity</strong> (<em>bool</em>) – (Optional) Default = False. If true, Will create a pop up plot of the weighted of each absorber
at the middle layer</p></li>
<li><p><strong>return_mode</strong> (<em>bool</em>) – (Optional) Default = False, If true, will only return matrices for all the weighted opacity
contributions</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>DTAU</strong> (<em>ndarray</em>) – This is a matrix with # layer by # wavelength. It is the opacity contained within a layer
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>TAU</strong> (<em>ndarray</em>) – This is a matrix with # level by # wavelength. It is the cumsum of opacity contained
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>WBAR</strong> (<em>ndarray</em>) – This is the single scattering albedo that includes rayleigh, raman and user input scattering sources.
It has dimensions: # layer by # wavelength
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>COSB</strong> (<em>ndarray</em>) – This is the asymettry factor which accounts for rayleigh and user specified values
It has dimensions: # layer by # wavelength
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>ftau_cld</strong> (<em>ndarray</em>) – This is the fraction of cloud opacity relative to the total TAUCLD/(TAUCLD + TAURAY)</p></li>
<li><p><strong>ftau_ray</strong> (<em>ndarray</em>) – This is the fraction of rayleigh opacity relative to the total TAURAY/(TAUCLD + TAURAY)</p></li>
<li><p><strong>GCOS2</strong> (<em>ndarray</em>) – This is used for Cahoy+2010 methodology for accounting for rayleigh scattering. It
replaces the use of the actual rayleigh phase function by just multiplying ftau_ray by 2</p></li>
<li><p><strong>DTAU</strong> (<em>ndarray</em>) – This is a matrix with # layer by # wavelength. It is the opacity contained within a layer
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>If requested, this is corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>TAU</strong> (<em>ndarray</em>) – This is a matrix with # level by # wavelength. It is the cumsum of opacity contained
including the continuum, scattering, cloud (if specified), and molecular opacity
<strong>Original, never corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>WBAR</strong> (<em>ndarray</em>) – This is the single scattering albedo that includes rayleigh, raman and user input scattering sources.
It has dimensions: # layer by # wavelength
<strong>Original, never corrected for with Delta-Eddington.</strong></p></li>
<li><p><strong>COSB</strong> (<em>ndarray</em>) – This is the asymettry factor which accounts for rayleigh and user specified values
It has dimensions: # layer by # wavelength
<strong>Original, never corrected for with Delta-Eddington.</strong></p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Notes</p>
<p>This was baselined against jupiter with the old fortran code. It matches 100% for all cases
except for hotter cases where Na &amp; K are present. This differences is not a product of the code
but a product of the different opacities (1060 grid versus old 736 grid)</p>
<div class="admonition-todo admonition" id="id13">
<p class="admonition-title">Todo</p>
<p>Add a better approximation than delta-scale (e.g. M.Marley suggests a paper by Cuzzi that has
a better methodology)</p>
</div>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.compute_raman">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">compute_raman</code><a class="headerlink" href="#picaso.optics.compute_raman" title="Permalink to this definition">¶</a></dt>
<dd><p>The Ramam scattering will alter the rayleigh scattering. The returned value is
modified single scattering albedo.
Cross sectiosn from:
<a class="reference external" href="http://iopscience.iop.org/0004-637X/832/1/30/suppdata/apjaa3ec7t2_mrt.txt">http://iopscience.iop.org/0004-637X/832/1/30/suppdata/apjaa3ec7t2_mrt.txt</a>
This method is described in Pollack+1986. Albeit not the best method. Sromovsky+2005
pointed out the inconsistencies in this method. You can see from his comparisons
that the Pollack approximations don’t accurately capture the depths of the line centers.
Since then, OKLOPCIC+2016 recomputed cross sections for J&lt;=9. We are using those cross
sections here with a different star. Huge improvement over what we had before.
Number of J levels is hard coded to 10 !
Will be added to the rayleigh scattering as : TAURAY*RAMAN
:param nwno: Number of wave points
:type nwno: int
:param nlayer: Number of layers
:type nlayer: int
:param wno: Array of output grid of wavenumbers
:type wno: array
:param stellar_shifts: Array of floats that has dimensions (n wave pts x n J levels: 0-9)
:type stellar_shifts: ndarray
:param tlayer: Array of floats that has dimensions nlayer
:type tlayer: array
:param cross_sections: The row of “C’s” from Antonija’s table.
:type cross_sections: ndarray
:param j_initial: The row of initial rotational energy states from Antonija’s table
:type j_initial: ndarray
:param deltanu: The row of delta nu’s from Antonia’s table
:type deltanu: ndarray</p>
</dd></dl>

<dl class="function">
<dt id="picaso.optics.convert_array">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">convert_array</code><span class="sig-paren">(</span><em class="sig-param">clas</em>, <em class="sig-param">text</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.convert_array" title="Permalink to this definition">¶</a></dt>
<dd><p>needed to interpret bytes to array</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.find_nearest">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">find_nearest</code><a class="headerlink" href="#picaso.optics.find_nearest" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="picaso.optics.interp_matrix">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">interp_matrix</code><a class="headerlink" href="#picaso.optics.interp_matrix" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="attribute">
<dt id="picaso.optics.j_fraction">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">j_fraction</code><a class="headerlink" href="#picaso.optics.j_fraction" title="Permalink to this definition">¶</a></dt>
<dd><p>This computes the fraction of molecules at each J level.
:param j: The initial rotational levels ranging from J=0 to 9 for hydrogen only
:type j: int</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><strong>f_J in eqn. 3 https</strong></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>//arxiv.org/pdf/1605.07185.pdf</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.numba_cumsum">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">numba_cumsum</code><a class="headerlink" href="#picaso.optics.numba_cumsum" title="Permalink to this definition">¶</a></dt>
<dd><p>Function to compute cumsum along axis=0 to bypass numba not allowing kwargs in
cumsum</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.partition_function">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">partition_function</code><a class="headerlink" href="#picaso.optics.partition_function" title="Permalink to this definition">¶</a></dt>
<dd><p>Given j and T computes partition function for ro-vibrational levels of H2.
This is the exponential and the statistical weight g_J in
Eqn 3 in <a class="reference external" href="https://arxiv.org/pdf/1605.07185.pdf">https://arxiv.org/pdf/1605.07185.pdf</a>
It is also used to compute the partition sum Z.
:param j: Energy level
:type j: int
:param T: Temperature at each atmospheric layer in the atmosphere
:type T: array float</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Returns partition function</p>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.partition_sum">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">partition_sum</code><a class="headerlink" href="#picaso.optics.partition_sum" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the total partition sum. I am truncating it at 20 since it seems to approach 1 around then.
This is also pretty fast to compute so 20 is fine for now.
:param T: Array of temperatures for each layer
:type T: array</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p></p>
</dd>
<dt class="field-even">Return type</dt>
<dd class="field-even"><p>Z, the partition sum</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.optics.raman_pollack">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">raman_pollack</code><span class="sig-paren">(</span><em class="sig-param">nlayer</em>, <em class="sig-param">wave</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.optics.raman_pollack" title="Permalink to this definition">¶</a></dt>
<dd><p>Mystery raman scattering. Couldn’t figure out where it came from.. so discontinuing.
Currently function doesnt’ totally work. In half fortran-half python. Legacy from
fortran albedo code.
This method is described in Pollack+1986. Albeit not the best method. Sromovsky+2005
pointed out the inconsistencies in this method. You can see from his comparisons
that the Pollack approximations don’t accurately capture the depths of the line centers.
Since then, OKLOPCIC+2016 did a much
better model of raman scattring (with ghost lines). Might be worth it to consider a more
sophisticated version of Raman scattering.
Will be added to the rayleigh scattering as : TAURAY*RAMAN</p>
<p>#OLD FORTRAN CODE
#constants
h = 6.6252e-27
c = 2.9978e10
bohrd = 5.2917e-9
hmass = 1.6734e-24
rmu = .5 * hmass
#set wavelength shift of the ramam scatterer
shift_v0 = 4161.0
facip = h * c / ( 1.e-4 * 27.2 * 1.602e-12 )
facray = 1.e16 * bohrd ** 3 * 128. * np.pi ** 5 * bohrd ** 3 / 9.
facv = 2.08 / 2.38 * facray / bohrd ** 2 / ( 8. * np.pi * np.pi * rmu * c * shift_v0 ) * h
#cross section of the unshifted rayleigh and the vibrationally shifted rayleigh
gli = np.zeros(5)
wli = np.zeros(5)
gri = np.zeros(5)
wri = np.zeros(5)
gli[:] = [1.296, .247, .297,  .157,  .003]
wli[:] = [.507, .628, .733, 1.175, 2.526]
gri[:] = [.913, .239, .440,  .344,  .064]
wri[:] = [.537, .639, .789, 1.304, 3.263]
alp = np.zeros(7)
arp = np.zeros(7)
alp[:] = [6.84, 6.96, 7.33, 8.02, 9.18, 11.1, 14.5 ]
arp[:] = [3.66, 3.71, 3.88, 4.19, 4.70, 5.52, 6.88 ]
omega = facip / wavelength
#first compute extinction cross section for unshifted component
#e.g. rayleigh
alpha_l=0
alpha_r=0
for i in range(5):</p>
<blockquote>
<div><p>alpha_l += gli[i] / ( wli[i] ** 2 - omega ** 2 )
alpha_r += gri[i] / ( wri[i] ** 2 - omega ** 2 )</p>
</div></blockquote>
<p>alpha2 = (( 2. * alpha_r + alpha_l ) / 3. ) ** 2
gamma2 = ( alpha_l - alpha_r ) ** 2
qray = facray * ( 3. * alpha2 + 2./3. * gamma2 ) / wavelength ** 4
#next, compute the extinction cross section for vibrationally
#shifted component
ip = np.zeros(2)
ip[:] = [int(omega/0.05), 5.0]
ip = np.min(ip) + 1
f = omega / 0.05 - float(ip-1)
alpha_pl = ( 1. - f ) * alp[ip] + f * alp[ip+1]
alpha_pr = ( 1. - f ) * arp[ip] + f * arp[ip+1]
alpha_p2 = (( 2. * alpha_pr + alpha_pl ) / 3. ) ** 2
gamma_p2 = ( alpha_pl - alpha_pr ) ** 2
qv = facv / SHIFT( WAVEL, -SHIFTV0 ) ** 4 * ( 3. * alpha_p2 + 2./3. * gamma_p2 )</p>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.rayleigh_old">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">rayleigh_old</code><a class="headerlink" href="#picaso.optics.rayleigh_old" title="Permalink to this definition">¶</a></dt>
<dd><p>DISCONTINUED
Rayleigh function taken from old albedo code. Keeping this modular, as we may want
to swap out different methods to calculate rayleigh opacity
:param colden: Column Density in CGS units
:type colden: array of float
:param mixingratios: Mixing ratio as function of altitude for [H2  He CH4 ]
:type mixingratios: array of float
:param wave: wavelength (microns) of grid. This should be in DECENDING order to comply with</p>
<blockquote>
<div><p>everything else being in wave numberes</p>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>xmu</strong> (<em>array of float</em>) – mean molecular weight of atmosphere in amu</p></li>
<li><p><strong>amu</strong> (<em>float</em>) – amu constant in grams</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="attribute">
<dt id="picaso.optics.spline">
<code class="sig-prename descclassname">picaso.optics.</code><code class="sig-name descname">spline</code><a class="headerlink" href="#picaso.optics.spline" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

</div>
<div class="section" id="module-picaso.test">
<span id="picaso-test-module"></span><h2>picaso.test module<a class="headerlink" href="#module-picaso.test" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.test.create_heat_map">
<code class="sig-prename descclassname">picaso.test.</code><code class="sig-name descname">create_heat_map</code><span class="sig-paren">(</span><em class="sig-param">data</em>, <em class="sig-param">rayleigh=True</em>, <em class="sig-param">extend=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.test.create_heat_map" title="Permalink to this definition">¶</a></dt>
<dd></dd></dl>

<dl class="function">
<dt id="picaso.test.dlugach_test">
<code class="sig-prename descclassname">picaso.test.</code><code class="sig-name descname">dlugach_test</code><span class="sig-paren">(</span><em class="sig-param">single_phase='OTHG'</em>, <em class="sig-param">output_dir=None</em>, <em class="sig-param">rayleigh=True</em>, <em class="sig-param">phase=True</em>, <em class="sig-param">method='Toon'</em>, <em class="sig-param">stream=2</em>, <em class="sig-param">Toon_coefficients='quadrature'</em>, <em class="sig-param">delta_eddington=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.test.dlugach_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Test the flux against against Dlugach &amp; Yanovitskij
<a class="reference external" href="https://www.sciencedirect.com/science/article/pii/0019103574901675?via%3Dihub">https://www.sciencedirect.com/science/article/pii/0019103574901675?via%3Dihub</a></p>
<p>There are two tests: rayleigh and constant_tau. This will run through the entire
table of values (XXI). Users can run both or specify one. Constant_tau picks
single value for the asymmetry factors g = [0.5,0.75,0.8,0.85,0.9] and tests
single scattering abled. Rayleigh only varies the ssa (with rayleigh phase fun)</p>
<p>This routine contains the functionality to reproduce table XXI and determine the %
error in various realms</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>single_phase</strong> (<em>str</em>) – Single phase function to test with the constant_tau test. Can either be:
“cahoy”,”TTHG_ray”,”TTHG”, and “OTHG”</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – Output directory for results of test. Default is to just return the dataframe (None).</p></li>
<li><p><strong>rayleigh</strong> (<em>bool</em>) – Default is True. Turns on and off the rayleigh phase function test</p></li>
<li><p><strong>phase</strong> (<em>float</em>) – Default=True. Turns on and off the constant g phase function test</p></li>
<li><p><strong>Retuns</strong> – </p></li>
<li><p><strong>------</strong> – </p></li>
<li><p><strong>of % deviation from Dlugach &amp; Yanovitskij Table XXI</strong> (<em>DataFrame</em>) – </p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.test.madhu_test">
<code class="sig-prename descclassname">picaso.test.</code><code class="sig-name descname">madhu_test</code><span class="sig-paren">(</span><em class="sig-param">rayleigh=True</em>, <em class="sig-param">isotropic=True</em>, <em class="sig-param">asymmetric=True</em>, <em class="sig-param">single_phase='TTHG_ray'</em>, <em class="sig-param">output_dir=None</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.test.madhu_test" title="Permalink to this definition">¶</a></dt>
<dd><p>Test the flux against against Madhu and Burrows
<a class="reference external" href="https://arxiv.org/pdf/1112.4476.pdf">https://arxiv.org/pdf/1112.4476.pdf</a></p>
<p>There are three tests: rayleigh, isotropic, and lambert. Reproduces Figure 2 of
Madhu and Burrows paper.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rayleigh</strong> (<em>bool</em>) – Tests rayleigh phase function</p></li>
<li><p><strong>isotropic</strong> (<em>bool</em>) – Tests isotropic phase function</p></li>
<li><p><strong>single_phase</strong> (<em>str</em>) – Single phase function to test with the constant_tau test. Can either be:
“cahoy”,”TTHG_ray”,”TTHG”, and “OTHG”</p></li>
<li><p><strong>output_dir</strong> (<em>str</em>) – Output directory for results of test. Default is to just return the dataframe (None).</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p></p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>DataFrame of % deviation from Dlugach &amp; Yanovitskij Table XXI</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso.wavelength">
<span id="picaso-wavelength-module"></span><h2>picaso.wavelength module<a class="headerlink" href="#module-picaso.wavelength" title="Permalink to this headline">¶</a></h2>
<dl class="function">
<dt id="picaso.wavelength.get_cld_input_grid">
<code class="sig-prename descclassname">picaso.wavelength.</code><code class="sig-name descname">get_cld_input_grid</code><span class="sig-paren">(</span><em class="sig-param">filename_or_grid='wave_EGP.dat'</em>, <em class="sig-param">grid661=False</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.wavelength.get_cld_input_grid" title="Permalink to this definition">¶</a></dt>
<dd><p>The albedo code relies on the cloud code input, which is traditionally on a 196 wavelength grid.
This method is to retrieve that grid. This file should be kept in the package reference data. Alternatively,
it might be useful to add it directly to the input.cld file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>filename_or_grid</strong> (<em>str</em><em> or </em><em>ndarray</em>) – filename of the input grid OR a numpy array of wavenumber corresponding to cloud
input</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>array of wave numbers in increasing order</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>array</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="picaso.wavelength.regrid">
<code class="sig-prename descclassname">picaso.wavelength.</code><code class="sig-name descname">regrid</code><span class="sig-paren">(</span><em class="sig-param">matrix</em>, <em class="sig-param">old_wno</em>, <em class="sig-param">new_wno</em><span class="sig-paren">)</span><a class="headerlink" href="#picaso.wavelength.regrid" title="Permalink to this definition">¶</a></dt>
<dd><p>This takes in a matrix that is (number of something versus number of wavelength points) and regrids
to a new wave grid.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>matrix</strong> (<em>ndarray</em>) – matrix that is (number of something versus number of wavelength points)</p></li>
<li><p><strong>old_wno</strong> (<em>array</em>) – array that represents the old wavelength grid of the matrix</p></li>
<li><p><strong>new_wno</strong> (<em>array</em>) – array that represents the desired wavelength grid</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>matrix that has been reinterpolated to new wave number grid</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>matrix</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-picaso">
<span id="module-contents"></span><h2>Module contents<a class="headerlink" href="#module-picaso" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="contribution.html" class="btn btn-neutral float-right" title="Contributing to PICASO" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="notebooks/References.html" class="btn btn-neutral float-left" title="What do I reference?" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>